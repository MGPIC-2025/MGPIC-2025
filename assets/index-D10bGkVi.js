import{T as od,a as ei,b as Ql,L as ec,c as Ys,F as Uo,M as Tn,V as Lt,C as rn,d as wn,S as Pt,e as rd,P as Ts,D as _n,f as rs,g as Re,I as tc,Q as Os,h as id,O as nc,i as Ds,j as ad,B as Js,k as ld,l as sc,N as cd,m as ud,n as dd,o as ti,p as oc,R as Dn,q as fd,r as pd,s as hd,t as Pr,u as md,v as vt,w as zt,x as bt,y as gd,z as rc,A as _d,E as lt,G as yd,H as vd,J as bd,K as wd,U as en,W as mo,X as ic,Y as Sd,Z as Md,_ as Td,$ as Cd,a0 as Ed,a1 as ac,a2 as xd,a3 as ya,a4 as va,a5 as ba,a6 as wa,a7 as ni,a8 as Ad,a9 as kd,aa as Dt,ab as Rd,ac as Pd,ad as hn,ae as ur,af as dr,ag as fr,ah as Ns,ai as Id,aj as Ld,ak as xs,al as Cs,am as Sa,an as Od,ao as lc,ap as oo,aq as si,ar as Fo,as as Dd,at as Nd,au as $d,av as Gd,aw as oi,ax as Hd,ay as Ma}from"./three-Sm3FoWE3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();const Ud="debug";function f(...t){switch(Ud){case"debug":console.log(...t);break}}/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Nn(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const Je=Object.freeze({}),As=Object.freeze([]),kt=()=>{},cc=()=>!1,go=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),jo=t=>t.startsWith("onUpdate:"),ft=Object.assign,xi=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Fd=Object.prototype.hasOwnProperty,Ve=(t,e)=>Fd.call(t,e),Se=Array.isArray,is=t=>pr(t)==="[object Map]",uc=t=>pr(t)==="[object Set]",Ee=t=>typeof t=="function",rt=t=>typeof t=="string",qn=t=>typeof t=="symbol",Ke=t=>t!==null&&typeof t=="object",Ai=t=>(Ke(t)||Ee(t))&&Ee(t.then)&&Ee(t.catch),dc=Object.prototype.toString,pr=t=>dc.call(t),ki=t=>pr(t).slice(8,-1),fc=t=>pr(t)==="[object Object]",Ri=t=>rt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Zs=Nn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jd=Nn("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),hr=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},Bd=/-\w/g,sn=hr(t=>t.replace(Bd,e=>e.slice(1).toUpperCase())),zd=/\B([A-Z])/g,Bn=hr(t=>t.replace(zd,"-$1").toLowerCase()),mr=hr(t=>t.charAt(0).toUpperCase()+t.slice(1)),ns=hr(t=>t?`on${mr(t)}`:""),jn=(t,e)=>!Object.is(t,e),js=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},Bo=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},Vd=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Wd=t=>{const e=rt(t)?Number(t):NaN;return isNaN(e)?t:e};let Ta;const _o=()=>Ta||(Ta=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Xt(t){if(Se(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],o=rt(n)?Yd(n):Xt(n);if(o)for(const r in o)e[r]=o[r]}return e}else if(rt(t)||Ke(t))return t}const qd=/;(?![^(]*\))/g,Kd=/:([^]+)/,Xd=/\/\*[^]*?\*\//g;function Yd(t){const e={};return t.replace(Xd,"").split(qd).forEach(s=>{if(s){const n=s.split(Kd);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function nt(t){let e="";if(rt(t))e=t;else if(Se(t))for(let s=0;s<t.length;s++){const n=nt(t[s]);n&&(e+=n+" ")}else if(Ke(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const Jd="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Zd="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Qd="annotation,annotation-xml,maction,maligngroup,malignmark,math,menclose,merror,mfenced,mfrac,mfraction,mglyph,mi,mlabeledtr,mlongdiv,mmultiscripts,mn,mo,mover,mpadded,mphantom,mprescripts,mroot,mrow,ms,mscarries,mscarry,msgroup,msline,mspace,msqrt,msrow,mstack,mstyle,msub,msubsup,msup,mtable,mtd,mtext,mtr,munder,munderover,none,semantics",ef=Nn(Jd),tf=Nn(Zd),nf=Nn(Qd),sf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",of=Nn(sf);function pc(t){return!!t||t===""}const hc=t=>!!(t&&t.__v_isRef===!0),te=t=>rt(t)?t:t==null?"":Se(t)||Ke(t)&&(t.toString===dc||!Ee(t.toString))?hc(t)?te(t.value):JSON.stringify(t,mc,2):String(t),mc=(t,e)=>hc(e)?mc(t,e.value):is(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,o],r)=>(s[Ir(n,r)+" =>"]=o,s),{})}:uc(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>Ir(s))}:qn(e)?Ir(e):Ke(e)&&!Se(e)&&!fc(e)?String(e):e,Ir=(t,e="")=>{var s;return qn(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};function rf(t){return t==null?"initial":typeof t=="string"?t===""?" ":t:((typeof t!="number"||!Number.isFinite(t))&&console.warn("[Vue warn] Invalid value used for CSS binding. Expected a string or a finite number but received:",t),String(t))}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function an(t,...e){console.warn(`[Vue warn] ${t}`,...e)}let jt;class af{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=jt,!e&&jt&&(this.index=(jt.scopes||(jt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=jt;try{return jt=this,e()}finally{jt=s}}else an("cannot run an inactive effect scope.")}on(){++this._on===1&&(this.prevScope=jt,jt=this)}off(){this._on>0&&--this._on===0&&(jt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function lf(){return jt}let Ye;const Lr=new WeakSet;class gc{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,jt&&jt.active&&jt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lr.has(this)&&(Lr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||yc(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ca(this),vc(this);const e=Ye,s=on;Ye=this,on=!0;try{return this.fn()}finally{Ye!==this&&an("Active effect was not restored correctly - this is likely a Vue internal bug."),bc(this),Ye=e,on=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Li(e);this.deps=this.depsTail=void 0,Ca(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ri(this)&&this.run()}get dirty(){return ri(this)}}let _c=0,Qs,eo;function yc(t,e=!1){if(t.flags|=8,e){t.next=eo,eo=t;return}t.next=Qs,Qs=t}function Pi(){_c++}function Ii(){if(--_c>0)return;if(eo){let e=eo;for(eo=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;Qs;){let e=Qs;for(Qs=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function vc(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function bc(t){let e,s=t.depsTail,n=s;for(;n;){const o=n.prevDep;n.version===-1?(n===s&&(s=o),Li(n),cf(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}t.deps=e,t.depsTail=s}function ri(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(wc(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function wc(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ro)||(t.globalVersion=ro,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!ri(t))))return;t.flags|=2;const e=t.dep,s=Ye,n=on;Ye=t,on=!0;try{vc(t);const o=t.fn(t._value);(e.version===0||jn(o,t._value))&&(t.flags|=128,t._value=o,e.version++)}catch(o){throw e.version++,o}finally{Ye=s,on=n,bc(t),t.flags&=-3}}function Li(t,e=!1){const{dep:s,prevSub:n,nextSub:o}=t;if(n&&(n.nextSub=o,t.prevSub=void 0),o&&(o.prevSub=n,t.nextSub=void 0),s.subsHead===t&&(s.subsHead=o),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let r=s.computed.deps;r;r=r.nextDep)Li(r,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function cf(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let on=!0;const Sc=[];function ln(){Sc.push(on),on=!1}function cn(){const t=Sc.pop();on=t===void 0?!0:t}function Ca(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=Ye;Ye=void 0;try{e()}finally{Ye=s}}}let ro=0;class uf{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Oi{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0,this.subsHead=void 0}track(e){if(!Ye||!on||Ye===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Ye)s=this.activeLink=new uf(Ye,this),Ye.deps?(s.prevDep=Ye.depsTail,Ye.depsTail.nextDep=s,Ye.depsTail=s):Ye.deps=Ye.depsTail=s,Mc(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Ye.depsTail,s.nextDep=void 0,Ye.depsTail.nextDep=s,Ye.depsTail=s,Ye.deps===s&&(Ye.deps=n)}return Ye.onTrack&&Ye.onTrack(ft({effect:Ye},e)),s}trigger(e){this.version++,ro++,this.notify(e)}notify(e){Pi();try{for(let s=this.subsHead;s;s=s.nextSub)s.sub.onTrigger&&!(s.sub.flags&8)&&s.sub.onTrigger(ft({effect:s.sub},e));for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Ii()}}}function Mc(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Mc(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subsHead===void 0&&(t.dep.subsHead=t),t.dep.subs=t}}const ii=new WeakMap,as=Symbol("Object iterate"),ai=Symbol("Map keys iterate"),io=Symbol("Array iterate");function Ct(t,e,s){if(on&&Ye){let n=ii.get(t);n||ii.set(t,n=new Map);let o=n.get(s);o||(n.set(s,o=new Oi),o.map=n,o.key=s),o.track({target:t,type:e,key:s})}}function mn(t,e,s,n,o,r){const i=ii.get(t);if(!i){ro++;return}const a=l=>{l&&l.trigger({target:t,type:e,key:s,newValue:n,oldValue:o,oldTarget:r})};if(Pi(),e==="clear")i.forEach(a);else{const l=Se(t),c=l&&Ri(s);if(l&&s==="length"){const u=Number(n);i.forEach((d,p)=>{(p==="length"||p===io||!qn(p)&&p>=u)&&a(d)})}else switch((s!==void 0||i.has(void 0))&&a(i.get(s)),c&&a(i.get(io)),e){case"add":l?c&&a(i.get("length")):(a(i.get(as)),is(t)&&a(i.get(ai)));break;case"delete":l||(a(i.get(as)),is(t)&&a(i.get(ai)));break;case"set":is(t)&&a(i.get(as));break}}Ii()}function bs(t){const e=Le(t);return e===t?e:(Ct(e,"iterate",io),Gt(t)?e:e.map(Et))}function gr(t){return Ct(t=Le(t),"iterate",io),t}const df={__proto__:null,[Symbol.iterator](){return Or(this,Symbol.iterator,Et)},concat(...t){return bs(this).concat(...t.map(e=>Se(e)?bs(e):e))},entries(){return Or(this,"entries",t=>(t[1]=Et(t[1]),t))},every(t,e){return En(this,"every",t,e,void 0,arguments)},filter(t,e){return En(this,"filter",t,e,s=>s.map(Et),arguments)},find(t,e){return En(this,"find",t,e,Et,arguments)},findIndex(t,e){return En(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return En(this,"findLast",t,e,Et,arguments)},findLastIndex(t,e){return En(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return En(this,"forEach",t,e,void 0,arguments)},includes(...t){return Dr(this,"includes",t)},indexOf(...t){return Dr(this,"indexOf",t)},join(t){return bs(this).join(t)},lastIndexOf(...t){return Dr(this,"lastIndexOf",t)},map(t,e){return En(this,"map",t,e,void 0,arguments)},pop(){return Bs(this,"pop")},push(...t){return Bs(this,"push",t)},reduce(t,...e){return Ea(this,"reduce",t,e)},reduceRight(t,...e){return Ea(this,"reduceRight",t,e)},shift(){return Bs(this,"shift")},some(t,e){return En(this,"some",t,e,void 0,arguments)},splice(...t){return Bs(this,"splice",t)},toReversed(){return bs(this).toReversed()},toSorted(t){return bs(this).toSorted(t)},toSpliced(...t){return bs(this).toSpliced(...t)},unshift(...t){return Bs(this,"unshift",t)},values(){return Or(this,"values",Et)}};function Or(t,e,s){const n=gr(t),o=n[e]();return n!==t&&!Gt(t)&&(o._next=o.next,o.next=()=>{const r=o._next();return r.done||(r.value=s(r.value)),r}),o}const ff=Array.prototype;function En(t,e,s,n,o,r){const i=gr(t),a=i!==t&&!Gt(t),l=i[e];if(l!==ff[e]){const d=l.apply(t,r);return a?Et(d):d}let c=s;i!==t&&(a?c=function(d,p){return s.call(this,Et(d),p,t)}:s.length>2&&(c=function(d,p){return s.call(this,d,p,t)}));const u=l.call(i,c,n);return a&&o?o(u):u}function Ea(t,e,s,n){const o=gr(t);let r=s;return o!==t&&(Gt(t)?s.length>3&&(r=function(i,a,l){return s.call(this,i,a,l,t)}):r=function(i,a,l){return s.call(this,i,Et(a),l,t)}),o[e](r,...n)}function Dr(t,e,s){const n=Le(t);Ct(n,"iterate",io);const o=n[e](...s);return(o===-1||o===!1)&&zo(s[0])?(s[0]=Le(s[0]),n[e](...s)):o}function Bs(t,e,s=[]){ln(),Pi();const n=Le(t)[e].apply(t,s);return Ii(),cn(),n}const pf=Nn("__proto__,__v_isRef,__isVue"),Tc=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(qn));function hf(t){qn(t)||(t=String(t));const e=Le(this);return Ct(e,"has",t),e.hasOwnProperty(t)}class Cc{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const o=this._isReadonly,r=this._isShallow;if(s==="__v_isReactive")return!o;if(s==="__v_isReadonly")return o;if(s==="__v_isShallow")return r;if(s==="__v_raw")return n===(o?r?Pc:Rc:r?kc:Ac).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const i=Se(e);if(!o){let l;if(i&&(l=df[s]))return l;if(s==="hasOwnProperty")return hf}const a=Reflect.get(e,s,mt(e)?e:n);if((qn(s)?Tc.has(s):pf(s))||(o||Ct(e,"get",s),r))return a;if(mt(a)){const l=i&&Ri(s)?a:a.value;return o&&Ke(l)?ci(l):l}return Ke(a)?o?ci(a):Di(a):a}}class Ec extends Cc{constructor(e=!1){super(!1,e)}set(e,s,n,o){let r=e[s];if(!this._isShallow){const l=Sn(r);if(!Gt(n)&&!Sn(n)&&(r=Le(r),n=Le(n)),!Se(e)&&mt(r)&&!mt(n))return l?(an(`Set operation on key "${String(s)}" failed: target is readonly.`,e[s]),!0):(r.value=n,!0)}const i=Se(e)&&Ri(s)?Number(s)<e.length:Ve(e,s),a=Reflect.set(e,s,n,mt(e)?e:o);return e===Le(o)&&(i?jn(n,r)&&mn(e,"set",s,n,r):mn(e,"add",s,n)),a}deleteProperty(e,s){const n=Ve(e,s),o=e[s],r=Reflect.deleteProperty(e,s);return r&&n&&mn(e,"delete",s,void 0,o),r}has(e,s){const n=Reflect.has(e,s);return(!qn(s)||!Tc.has(s))&&Ct(e,"has",s),n}ownKeys(e){return Ct(e,"iterate",Se(e)?"length":as),Reflect.ownKeys(e)}}class xc extends Cc{constructor(e=!1){super(!0,e)}set(e,s){return an(`Set operation on key "${String(s)}" failed: target is readonly.`,e),!0}deleteProperty(e,s){return an(`Delete operation on key "${String(s)}" failed: target is readonly.`,e),!0}}const mf=new Ec,gf=new xc,_f=new Ec(!0),yf=new xc(!0),li=t=>t,To=t=>Reflect.getPrototypeOf(t);function vf(t,e,s){return function(...n){const o=this.__v_raw,r=Le(o),i=is(r),a=t==="entries"||t===Symbol.iterator&&i,l=t==="keys"&&i,c=o[t](...n),u=s?li:e?Vo:Et;return!e&&Ct(r,"iterate",l?ai:as),{next(){const{value:d,done:p}=c.next();return p?{value:d,done:p}:{value:a?[u(d[0]),u(d[1])]:u(d),done:p}},[Symbol.iterator](){return this}}}}function Co(t){return function(...e){{const s=e[0]?`on key "${e[0]}" `:"";an(`${mr(t)} operation ${s}failed: target is readonly.`,Le(this))}return t==="delete"?!1:t==="clear"?void 0:this}}function bf(t,e){const s={get(o){const r=this.__v_raw,i=Le(r),a=Le(o);t||(jn(o,a)&&Ct(i,"get",o),Ct(i,"get",a));const{has:l}=To(i),c=e?li:t?Vo:Et;if(l.call(i,o))return c(r.get(o));if(l.call(i,a))return c(r.get(a));r!==i&&r.get(o)},get size(){const o=this.__v_raw;return!t&&Ct(Le(o),"iterate",as),o.size},has(o){const r=this.__v_raw,i=Le(r),a=Le(o);return t||(jn(o,a)&&Ct(i,"has",o),Ct(i,"has",a)),o===a?r.has(o):r.has(o)||r.has(a)},forEach(o,r){const i=this,a=i.__v_raw,l=Le(a),c=e?li:t?Vo:Et;return!t&&Ct(l,"iterate",as),a.forEach((u,d)=>o.call(r,c(u),c(d),i))}};return ft(s,t?{add:Co("add"),set:Co("set"),delete:Co("delete"),clear:Co("clear")}:{add(o){!e&&!Gt(o)&&!Sn(o)&&(o=Le(o));const r=Le(this);return To(r).has.call(r,o)||(r.add(o),mn(r,"add",o,o)),this},set(o,r){!e&&!Gt(r)&&!Sn(r)&&(r=Le(r));const i=Le(this),{has:a,get:l}=To(i);let c=a.call(i,o);c?xa(i,a,o):(o=Le(o),c=a.call(i,o));const u=l.call(i,o);return i.set(o,r),c?jn(r,u)&&mn(i,"set",o,r,u):mn(i,"add",o,r),this},delete(o){const r=Le(this),{has:i,get:a}=To(r);let l=i.call(r,o);l?xa(r,i,o):(o=Le(o),l=i.call(r,o));const c=a?a.call(r,o):void 0,u=r.delete(o);return l&&mn(r,"delete",o,void 0,c),u},clear(){const o=Le(this),r=o.size!==0,i=is(o)?new Map(o):new Set(o),a=o.clear();return r&&mn(o,"clear",void 0,void 0,i),a}}),["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=vf(o,t,e)}),s}function _r(t,e){const s=bf(t,e);return(n,o,r)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(Ve(s,o)&&o in n?s:n,o,r)}const wf={get:_r(!1,!1)},Sf={get:_r(!1,!0)},Mf={get:_r(!0,!1)},Tf={get:_r(!0,!0)};function xa(t,e,s){const n=Le(s);if(n!==s&&e.call(t,n)){const o=ki(t);an(`Reactive ${o} contains both the raw and reactive versions of the same object${o==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const Ac=new WeakMap,kc=new WeakMap,Rc=new WeakMap,Pc=new WeakMap;function Cf(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ef(t){return t.__v_skip||!Object.isExtensible(t)?0:Cf(ki(t))}function Di(t){return Sn(t)?t:yr(t,!1,mf,wf,Ac)}function xf(t){return yr(t,!1,_f,Sf,kc)}function ci(t){return yr(t,!0,gf,Mf,Rc)}function yn(t){return yr(t,!0,yf,Tf,Pc)}function yr(t,e,s,n,o){if(!Ke(t))return an(`value cannot be made ${e?"readonly":"reactive"}: ${String(t)}`),t;if(t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=Ef(t);if(r===0)return t;const i=o.get(t);if(i)return i;const a=new Proxy(t,r===2?n:s);return o.set(t,a),a}function ls(t){return Sn(t)?ls(t.__v_raw):!!(t&&t.__v_isReactive)}function Sn(t){return!!(t&&t.__v_isReadonly)}function Gt(t){return!!(t&&t.__v_isShallow)}function zo(t){return t?!!t.__v_raw:!1}function Le(t){const e=t&&t.__v_raw;return e?Le(e):t}function Af(t){return!Ve(t,"__v_skip")&&Object.isExtensible(t)&&Bo(t,"__v_skip",!0),t}const Et=t=>Ke(t)?Di(t):t,Vo=t=>Ke(t)?ci(t):t;function mt(t){return t?t.__v_isRef===!0:!1}function F(t){return kf(t,!1)}function kf(t,e){return mt(t)?t:new Rf(t,e)}class Rf{constructor(e,s){this.dep=new Oi,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:Le(e),this._value=s?e:Et(e),this.__v_isShallow=s}get value(){return this.dep.track({target:this,type:"get",key:"value"}),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||Gt(e)||Sn(e);e=n?e:Le(e),jn(e,s)&&(this._rawValue=e,this._value=n?e:Et(e),this.dep.trigger({target:this,type:"set",key:"value",newValue:e,oldValue:s}))}}function Pf(t){return mt(t)?t.value:t}const If={get:(t,e,s)=>e==="__v_raw"?t:Pf(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const o=t[e];return mt(o)&&!mt(s)?(o.value=s,!0):Reflect.set(t,e,s,n)}};function Ic(t){return ls(t)?t:new Proxy(t,If)}class Lf{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new Oi(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ro-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Ye!==this)return yc(this,!0),!0}get value(){const e=this.dep.track({target:this,type:"get",key:"value"});return wc(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter?this.setter(e):an("Write operation failed: computed value is readonly")}}function Of(t,e,s=!1){let n,o;Ee(t)?n=t:(n=t.get,o=t.set);const r=new Lf(n,o,s);return e&&!s&&(r.onTrack=e.onTrack,r.onTrigger=e.onTrigger),r}const Eo={},Wo=new WeakMap;let ss;function Df(t,e=!1,s=ss){if(s){let n=Wo.get(s);n||Wo.set(s,n=[]),n.push(t)}else e||an("onWatcherCleanup() was called when there was no active watcher to associate with.")}function Nf(t,e,s=Je){const{immediate:n,deep:o,once:r,scheduler:i,augmentJob:a,call:l}=s,c=T=>{(s.onWarn||an)("Invalid watch source: ",T,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},u=T=>o?T:Gt(T)||o===!1||o===0?Pn(T,1):Pn(T);let d,p,m,g,y=!1,S=!1;if(mt(t)?(p=()=>t.value,y=Gt(t)):ls(t)?(p=()=>u(t),y=!0):Se(t)?(S=!0,y=t.some(T=>ls(T)||Gt(T)),p=()=>t.map(T=>{if(mt(T))return T.value;if(ls(T))return u(T);if(Ee(T))return l?l(T,2):T();c(T)})):Ee(t)?e?p=l?()=>l(t,2):t:p=()=>{if(m){ln();try{m()}finally{cn()}}const T=ss;ss=d;try{return l?l(t,3,[g]):t(g)}finally{ss=T}}:(p=kt,c(t)),e&&o){const T=p,x=o===!0?1/0:o;p=()=>Pn(T(),x)}const E=lf(),I=()=>{d.stop(),E&&E.active&&xi(E.effects,d)};if(r&&e){const T=e;e=(...x)=>{T(...x),I()}}let R=S?new Array(t.length).fill(Eo):Eo;const M=T=>{if(!(!(d.flags&1)||!d.dirty&&!T))if(e){const x=d.run();if(o||y||(S?x.some((j,V)=>jn(j,R[V])):jn(x,R))){m&&m();const j=ss;ss=d;try{const V=[x,R===Eo?void 0:S&&R[0]===Eo?[]:R,g];R=x,l?l(e,3,V):e(...V)}finally{ss=j}}}else d.run()};return a&&a(M),d=new gc(p),d.scheduler=i?()=>i(M,!1):M,g=T=>Df(T,!1,d),m=d.onStop=()=>{const T=Wo.get(d);if(T){if(l)l(T,4);else for(const x of T)x();Wo.delete(d)}},d.onTrack=s.onTrack,d.onTrigger=s.onTrigger,e?n?M(!0):R=d.run():i?i(M.bind(null,!0),!0):d.run(),I.pause=d.pause.bind(d),I.resume=d.resume.bind(d),I.stop=I,I}function Pn(t,e=1/0,s){if(e<=0||!Ke(t)||t.__v_skip||(s=s||new Map,(s.get(t)||0)>=e))return t;if(s.set(t,e),e--,mt(t))Pn(t.value,e,s);else if(Se(t))for(let n=0;n<t.length;n++)Pn(t[n],e,s);else if(uc(t)||is(t))t.forEach(n=>{Pn(n,e,s)});else if(fc(t)){for(const n in t)Pn(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Pn(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const cs=[];function Io(t){cs.push(t)}function Lo(){cs.pop()}let Nr=!1;function Z(t,...e){if(Nr)return;Nr=!0,ln();const s=cs.length?cs[cs.length-1].component:null,n=s&&s.appContext.config.warnHandler,o=$f();if(n)Hs(n,s,11,[t+e.map(r=>{var i,a;return(a=(i=r.toString)==null?void 0:i.call(r))!=null?a:JSON.stringify(r)}).join(""),s&&s.proxy,o.map(({vnode:r})=>`at <${Tr(s,r.type)}>`).join(`
`),o]);else{const r=[`[Vue warn]: ${t}`,...e];o.length&&r.push(`
`,...Gf(o)),console.warn(...r)}cn(),Nr=!1}function $f(){let t=cs[cs.length-1];if(!t)return[];const e=[];for(;t;){const s=e[0];s&&s.vnode===t?s.recurseCount++:e.push({vnode:t,recurseCount:0});const n=t.component&&t.component.parent;t=n&&n.vnode}return e}function Gf(t){const e=[];return t.forEach((s,n)=>{e.push(...n===0?[]:[`
`],...Hf(s))}),e}function Hf({vnode:t,recurseCount:e}){const s=e>0?`... (${e} recursive calls)`:"",n=t.component?t.component.parent==null:!1,o=` at <${Tr(t.component,t.type,n)}`,r=">"+s;return t.props?[o,...Uf(t.props),r]:[o+r]}function Uf(t){const e=[],s=Object.keys(t);return s.slice(0,3).forEach(n=>{e.push(...Lc(n,t[n]))}),s.length>3&&e.push(" ..."),e}function Lc(t,e,s){return rt(e)?(e=JSON.stringify(e),s?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?s?e:[`${t}=${e}`]:mt(e)?(e=Lc(t,Le(e.value),!0),s?e:[`${t}=Ref<`,e,">"]):Ee(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=Le(e),s?e:[`${t}=`,e])}function Ff(t,e){t!==void 0&&(typeof t!="number"?Z(`${e} is not a valid number - got ${JSON.stringify(t)}.`):isNaN(t)&&Z(`${e} is NaN - the duration expression might be incorrect.`))}const Ni={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Hs(t,e,s,n){try{return n?t(...n):t()}catch(o){yo(o,e,s)}}function un(t,e,s,n){if(Ee(t)){const o=Hs(t,e,s,n);return o&&Ai(o)&&o.catch(r=>{yo(r,e,s)}),o}if(Se(t)){const o=[];for(let r=0;r<t.length;r++)o.push(un(t[r],e,s,n));return o}else Z(`Invalid value type passed to callWithAsyncErrorHandling(): ${typeof t}`)}function yo(t,e,s,n=!0){const o=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:i}=e&&e.appContext.config||Je;if(e){let a=e.parent;const l=e.proxy,c=Ni[s];for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](t,l,c)===!1)return}a=a.parent}if(r){ln(),Hs(r,null,10,[t,l,c]),cn();return}}jf(t,s,o,n,i)}function jf(t,e,s,n=!0,o=!1){{const r=Ni[e];if(s&&Io(s),Z(`Unhandled error${r?` during execution of ${r}`:""}`),s&&Lo(),n)throw t;console.error(t)}}const Nt=[];let fn=-1;const ks=[];let Un=null,Ms=0;const Oc=Promise.resolve();let qo=null;const Bf=100;function vn(t){const e=qo||Oc;return t?e.then(this?t.bind(this):t):e}function zf(t){let e=fn+1,s=Nt.length;for(;e<s;){const n=e+s>>>1,o=Nt[n],r=ao(o);r<t||r===t&&o.flags&2?e=n+1:s=n}return e}function vr(t){if(!(t.flags&1)){const e=ao(t),s=Nt[Nt.length-1];!s||!(t.flags&2)&&e>=ao(s)?Nt.push(t):Nt.splice(zf(e),0,t),t.flags|=1,Dc()}}function Dc(){qo||(qo=Oc.then($c))}function $i(t){Se(t)?ks.push(...t):Un&&t.id===-1?Un.splice(Ms+1,0,t):t.flags&1||(ks.push(t),t.flags|=1),Dc()}function Aa(t,e,s=fn+1){for(e=e||new Map;s<Nt.length;s++){const n=Nt[s];if(n&&n.flags&2){if(t&&n.id!==t.uid||Gi(e,n))continue;Nt.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Nc(t){if(ks.length){const e=[...new Set(ks)].sort((s,n)=>ao(s)-ao(n));if(ks.length=0,Un){Un.push(...e);return}for(Un=e,t=t||new Map,Ms=0;Ms<Un.length;Ms++){const s=Un[Ms];Gi(t,s)||(s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2)}Un=null,Ms=0}}const ao=t=>t.id==null?t.flags&2?-1:1/0:t.id;function $c(t){t=t||new Map;const e=s=>Gi(t,s);try{for(fn=0;fn<Nt.length;fn++){const s=Nt[fn];if(s&&!(s.flags&8)){if(e(s))continue;s.flags&4&&(s.flags&=-2),Hs(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2)}}}finally{for(;fn<Nt.length;fn++){const s=Nt[fn];s&&(s.flags&=-2)}fn=-1,Nt.length=0,Nc(t),qo=null,(Nt.length||ks.length)&&$c(t)}}function Gi(t,e){const s=t.get(e)||0;if(s>Bf){const n=e.i,o=n&&Au(n.type);return yo(`Maximum recursive updates exceeded${o?` in component <${o}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`,null,10),!0}return t.set(e,s+1),!1}let nn=!1;const Oo=new Map;_o().__VUE_HMR_RUNTIME__={createRecord:$r(Gc),rerender:$r(qf),reload:$r(Kf)};const fs=new Map;function Vf(t){const e=t.type.__hmrId;let s=fs.get(e);s||(Gc(e,t.type),s=fs.get(e)),s.instances.add(t)}function Wf(t){fs.get(t.type.__hmrId).instances.delete(t)}function Gc(t,e){return fs.has(t)?!1:(fs.set(t,{initialDef:Ko(e),instances:new Set}),!0)}function Ko(t){return ku(t)?t.__vccOpts:t}function qf(t,e){const s=fs.get(t);s&&(s.initialDef.render=e,[...s.instances].forEach(n=>{e&&(n.render=e,Ko(n.type).render=e),n.renderCache=[],nn=!0,n.job.flags&8||n.update(),nn=!1}))}function Kf(t,e){const s=fs.get(t);if(!s)return;e=Ko(e),ka(s.initialDef,e);const n=[...s.instances];for(let o=0;o<n.length;o++){const r=n[o],i=Ko(r.type);let a=Oo.get(i);a||(i!==s.initialDef&&ka(i,e),Oo.set(i,a=new Set)),a.add(r),r.appContext.propsCache.delete(r.type),r.appContext.emitsCache.delete(r.type),r.appContext.optionsCache.delete(r.type),r.ceReload?(a.add(r),r.ceReload(e.styles),a.delete(r)):r.parent?vr(()=>{r.job.flags&8||(nn=!0,r.parent.update(),nn=!1,a.delete(r))}):r.appContext.reload?r.appContext.reload():typeof window<"u"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required."),r.root.ce&&r!==r.root&&r.root.ce._removeChildStyle(i)}$i(()=>{Oo.clear()})}function ka(t,e){ft(t,e);for(const s in t)s!=="__file"&&!(s in e)&&delete t[s]}function $r(t){return(e,s)=>{try{return t(e,s)}catch(n){console.error(n),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let gn,Ks=[],ui=!1;function vo(t,...e){gn?gn.emit(t,...e):ui||Ks.push({event:t,args:e})}function Hc(t,e){var s,n;gn=t,gn?(gn.enabled=!0,Ks.forEach(({event:o,args:r})=>gn.emit(o,...r)),Ks=[]):typeof window<"u"&&window.HTMLElement&&!((n=(s=window.navigator)==null?void 0:s.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(r=>{Hc(r,e)}),setTimeout(()=>{gn||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,ui=!0,Ks=[])},3e3)):(ui=!0,Ks=[])}function Xf(t,e){vo("app:init",t,e,{Fragment:et,Text:wo,Comment:ht,Static:Ps})}function Yf(t){vo("app:unmount",t)}const Jf=Hi("component:added"),Uc=Hi("component:updated"),Zf=Hi("component:removed"),Qf=t=>{gn&&typeof gn.cleanupBuffer=="function"&&!gn.cleanupBuffer(t)&&Zf(t)};function Hi(t){return e=>{vo(t,e.appContext.app,e.uid,e.parent?e.parent.uid:void 0,e)}}const ep=Fc("perf:start"),tp=Fc("perf:end");function Fc(t){return(e,s,n)=>{vo(t,e.appContext.app,e.uid,e,s,n)}}function np(t,e,s){vo("component:emit",t.appContext.app,t,e,s)}let $t=null,jc=null;function Xo(t){const e=$t;return $t=t,jc=t&&t.type.__scopeId||null,e}function Bc(t,e=$t,s){if(!e||t._n)return t;const n=(...o)=>{n._d&&tr(-1);const r=Xo(e);let i;try{i=t(...o)}finally{Xo(r),n._d&&tr(1)}return Uc(e),i};return n._n=!0,n._c=!0,n._d=!0,n}function zc(t){jd(t)&&Z("Do not use built-in directive ids as custom directive id: "+t)}function Vc(t,e){if($t===null)return Z("withDirectives can only be used inside render functions."),t;const s=Mr($t),n=t.dirs||(t.dirs=[]);for(let o=0;o<e.length;o++){let[r,i,a,l=Je]=e[o];r&&(Ee(r)&&(r={mounted:r,updated:r}),r.deep&&Pn(i),n.push({dir:r,instance:s,value:i,oldValue:void 0,arg:a,modifiers:l}))}return t}function Yn(t,e,s,n){const o=t.dirs,r=e&&e.dirs;for(let i=0;i<o.length;i++){const a=o[i];r&&(a.oldValue=r[i].value);let l=a.dir[n];l&&(ln(),un(l,s,8,[t.el,a,t,e]),cn())}}const Wc=Symbol("_vte"),qc=t=>t.__isTeleport,us=t=>t&&(t.disabled||t.disabled===""),Ra=t=>t&&(t.defer||t.defer===""),Pa=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Ia=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,di=(t,e)=>{const s=t&&t.to;if(rt(s))if(e){const n=e(s);return!n&&!us(t)&&Z(`Failed to locate Teleport target with selector "${s}". Note the target element must exist before the component is mounted - i.e. the target cannot be rendered by the component itself, and ideally should be outside of the entire Vue component tree.`),n}else return Z("Current renderer does not support string target for Teleports. (missing querySelector renderer option)"),null;else return!s&&!us(t)&&Z(`Invalid Teleport target: ${s}`),s},Kc={name:"Teleport",__isTeleport:!0,process(t,e,s,n,o,r,i,a,l,c){const{mc:u,pc:d,pbc:p,o:{insert:m,querySelector:g,createText:y,createComment:S}}=c,E=us(e.props);let{shapeFlag:I,children:R,dynamicChildren:M}=e;if(nn&&(l=!1,M=null),t==null){const T=e.el=S("teleport start"),x=e.anchor=S("teleport end");m(T,s,n),m(x,s,n);const j=(G,J)=>{I&16&&u(R,G,J,o,r,i,a,l)},V=()=>{const G=e.target=di(e.props,g),J=Yc(G,e,y,m);G?(i!=="svg"&&Pa(G)?i="svg":i!=="mathml"&&Ia(G)&&(i="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(G),E||(j(G,J),Do(e,!1))):E||Z("Invalid Teleport target on mount:",G,`(${typeof G})`)};E&&(j(s,x),Do(e,!0)),Ra(e.props)?(e.el.__isMounted=!1,Ot(()=>{V(),delete e.el.__isMounted},r)):V()}else{if(Ra(e.props)&&t.el.__isMounted===!1){Ot(()=>{Kc.process(t,e,s,n,o,r,i,a,l,c)},r);return}e.el=t.el,e.targetStart=t.targetStart;const T=e.anchor=t.anchor,x=e.target=t.target,j=e.targetAnchor=t.targetAnchor,V=us(t.props),G=V?s:x,J=V?T:j;if(i==="svg"||Pa(x)?i="svg":(i==="mathml"||Ia(x))&&(i="mathml"),M?(p(t.dynamicChildren,M,G,o,r,i,a),Qo(t,e,!1)):l||d(t,e,G,J,o,r,i,a,!1),E)V?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):xo(e,s,T,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const Q=e.target=di(e.props,g);Q?xo(e,Q,null,c,0):Z("Invalid Teleport target on update:",x,`(${typeof x})`)}else V&&xo(e,x,j,c,1);Do(e,E)}},remove(t,e,s,{um:n,o:{remove:o}},r){const{shapeFlag:i,children:a,anchor:l,targetStart:c,targetAnchor:u,target:d,props:p}=t;if(d&&(o(c),o(u)),r&&o(l),i&16){const m=r||!us(p);for(let g=0;g<a.length;g++){const y=a[g];n(y,e,s,m,!!y.dynamicChildren)}}},move:xo,hydrate:sp};function xo(t,e,s,{o:{insert:n},m:o},r=2){r===0&&n(t.targetAnchor,e,s);const{el:i,anchor:a,shapeFlag:l,children:c,props:u}=t,d=r===2;if(d&&n(i,e,s),(!d||us(u))&&l&16)for(let p=0;p<c.length;p++)o(c[p],e,s,2);d&&n(a,e,s)}function sp(t,e,s,n,o,r,{o:{nextSibling:i,parentNode:a,querySelector:l,insert:c,createText:u}},d){function p(y,S,E,I){S.anchor=d(i(y),S,a(y),s,n,o,r),S.targetStart=E,S.targetAnchor=I}const m=e.target=di(e.props,l),g=us(e.props);if(m){const y=m._lpa||m.firstChild;if(e.shapeFlag&16)if(g)p(t,e,y,y&&i(y));else{e.anchor=i(t);let S=y;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")e.targetStart=S;else if(S.data==="teleport anchor"){e.targetAnchor=S,m._lpa=e.targetAnchor&&i(e.targetAnchor);break}}S=i(S)}e.targetAnchor||Yc(m,e,u,c),d(y&&i(y),e,m,s,n,o,r)}Do(e,g)}else g&&e.shapeFlag&16&&p(t,e,t,i(t));return e.anchor&&i(e.anchor)}const Xc=Kc;function Do(t,e){const s=t.ctx;if(s&&s.ut){let n,o;for(e?(n=t.el,o=t.anchor):(n=t.targetStart,o=t.targetAnchor);n&&n!==o;)n.nodeType===1&&n.setAttribute("data-v-owner",s.uid),n=n.nextSibling;s.ut()}}function Yc(t,e,s,n){const o=e.targetStart=s(""),r=e.targetAnchor=s("");return o[Wc]=r,t&&(n(o,t),n(r,t)),r}const kn=Symbol("_leaveCb"),Ao=Symbol("_enterCb");function op(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ot(()=>{t.isMounted=!0}),wt(()=>{t.isUnmounting=!0}),t}const qt=[Function,Array],Jc={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:qt,onEnter:qt,onAfterEnter:qt,onEnterCancelled:qt,onBeforeLeave:qt,onLeave:qt,onAfterLeave:qt,onLeaveCancelled:qt,onBeforeAppear:qt,onAppear:qt,onAfterAppear:qt,onAppearCancelled:qt},Zc=t=>{const e=t.subTree;return e.component?Zc(e.component):e},rp={name:"BaseTransition",props:Jc,setup(t,{slots:e}){const s=Sr(),n=op();return()=>{const o=e.default&&tu(e.default(),!0);if(!o||!o.length)return;const r=Qc(o),i=Le(t),{mode:a}=i;if(a&&a!=="in-out"&&a!=="out-in"&&a!=="default"&&Z(`invalid <transition> mode: ${a}`),n.isLeaving)return Gr(r);const l=La(r);if(!l)return Gr(r);let c=fi(l,i,n,s,d=>c=d);l.type!==ht&&lo(l,c);let u=s.subTree&&La(s.subTree);if(u&&u.type!==ht&&!os(u,l)&&Zc(s).type!==ht){let d=fi(u,i,n,s);if(lo(u,d),a==="out-in"&&l.type!==ht)return n.isLeaving=!0,d.afterLeave=()=>{n.isLeaving=!1,s.job.flags&8||s.update(),delete d.afterLeave,u=void 0},Gr(r);a==="in-out"&&l.type!==ht?d.delayLeave=(p,m,g)=>{const y=eu(n,u);y[String(u.key)]=u,p[kn]=()=>{m(),p[kn]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return r}}};function Qc(t){let e=t[0];if(t.length>1){let s=!1;for(const n of t)if(n.type!==ht){if(s){Z("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}e=n,s=!0}}return e}const ip=rp;function eu(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function fi(t,e,s,n,o){const{appear:r,mode:i,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:p,onLeave:m,onAfterLeave:g,onLeaveCancelled:y,onBeforeAppear:S,onAppear:E,onAfterAppear:I,onAppearCancelled:R}=e,M=String(t.key),T=eu(s,t),x=(G,J)=>{G&&un(G,n,9,J)},j=(G,J)=>{const Q=J[1];x(G,J),Se(G)?G.every(z=>z.length<=1)&&Q():G.length<=1&&Q()},V={mode:i,persisted:a,beforeEnter(G){let J=l;if(!s.isMounted)if(r)J=S||l;else return;G[kn]&&G[kn](!0);const Q=T[M];Q&&os(t,Q)&&Q.el[kn]&&Q.el[kn](),x(J,[G])},enter(G){let J=c,Q=u,z=d;if(!s.isMounted)if(r)J=E||c,Q=I||u,z=R||d;else return;let be=!1;const P=G[Ao]=de=>{be||(be=!0,de?x(z,[G]):x(Q,[G]),V.delayedLeave&&V.delayedLeave(),G[Ao]=void 0)};J?j(J,[G,P]):P()},leave(G,J){const Q=String(t.key);if(G[Ao]&&G[Ao](!0),s.isUnmounting)return J();x(p,[G]);let z=!1;const be=G[kn]=P=>{z||(z=!0,J(),P?x(y,[G]):x(g,[G]),G[kn]=void 0,T[Q]===t&&delete T[Q])};T[Q]=t,m?j(m,[G,be]):be()},clone(G){const J=fi(G,e,s,n,o);return o&&o(J),J}};return V}function Gr(t){if(bo(t))return t=Mn(t),t.children=null,t}function La(t){if(!bo(t))return qc(t.type)&&t.children?Qc(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:s}=t;if(s){if(e&16)return s[0];if(e&32&&Ee(s.default))return s.default()}}function lo(t,e){t.shapeFlag&6&&t.component?(t.transition=e,lo(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function tu(t,e=!1,s){let n=[],o=0;for(let r=0;r<t.length;r++){let i=t[r];const a=s==null?i.key:String(s)+String(i.key!=null?i.key:r);i.type===et?(i.patchFlag&128&&o++,n=n.concat(tu(i.children,e,a))):(e||i.type!==ht)&&n.push(a!=null?Mn(i,{key:a}):i)}if(o>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}function nu(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Oa=new WeakSet,Yo=new WeakMap;function to(t,e,s,n,o=!1){if(Se(t)){t.forEach((y,S)=>to(y,e&&(Se(e)?e[S]:e),s,n,o));return}if(no(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&to(t,e,s,n.component.subTree);return}const r=n.shapeFlag&4?Mr(n.component):n.el,i=o?null:r,{i:a,r:l}=t;if(!a){Z("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const c=e&&e.r,u=a.refs===Je?a.refs={}:a.refs,d=a.setupState,p=Le(d),m=d===Je?cc:y=>(Ve(p,y)&&!mt(p[y])&&Z(`Template ref "${y}" used on a non-ref value. It will not work in the production build.`),Oa.has(p[y])?!1:Ve(p,y)),g=y=>!Oa.has(y);if(c!=null&&c!==l){if(Da(e),rt(c))u[c]=null,m(c)&&(d[c]=null);else if(mt(c)){g(c)&&(c.value=null);const y=e;y.k&&(u[y.k]=null)}}if(Ee(l))Hs(l,a,12,[i,u]);else{const y=rt(l),S=mt(l);if(y||S){const E=()=>{if(t.f){const I=y?m(l)?d[l]:u[l]:g(l)||!t.k?l.value:u[t.k];if(o)Se(I)&&xi(I,r);else if(Se(I))I.includes(r)||I.push(r);else if(y)u[l]=[r],m(l)&&(d[l]=u[l]);else{const R=[r];g(l)&&(l.value=R),t.k&&(u[t.k]=R)}}else y?(u[l]=i,m(l)&&(d[l]=i)):S?(g(l)&&(l.value=i),t.k&&(u[t.k]=i)):Z("Invalid template ref type:",l,`(${typeof l})`)};if(i){const I=()=>{E(),Yo.delete(t)};I.id=-1,Yo.set(t,I),Ot(I,s)}else Da(t),E()}else Z("Invalid template ref type:",l,`(${typeof l})`)}}function Da(t){const e=Yo.get(t);e&&(e.flags|=8,Yo.delete(t))}_o().requestIdleCallback;_o().cancelIdleCallback;const no=t=>!!t.type.__asyncLoader,bo=t=>t.type.__isKeepAlive;function ap(t,e){su(t,"a",e)}function lp(t,e){su(t,"da",e)}function su(t,e,s=At){const n=t.__wdc||(t.__wdc=()=>{let o=s;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(br(e,n,s),s){let o=s.parent;for(;o&&o.parent;)bo(o.parent.vnode)&&cp(n,e,s,o),o=o.parent}}function cp(t,e,s,n){const o=br(e,t,n,!0);Ui(()=>{xi(n[e],o)},s)}function br(t,e,s=At,n=!1){if(s){const o=s[t]||(s[t]=[]),r=e.__weh||(e.__weh=(...i)=>{ln();const a=So(s),l=un(e,s,t,i);return a(),cn(),l});return n?o.unshift(r):o.push(r),r}else{const o=ns(Ni[t].replace(/ hook$/,""));Z(`${o} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const $n=t=>(e,s=At)=>{(!uo||t==="sp")&&br(t,(...n)=>e(...n),s)},up=$n("bm"),ot=$n("m"),ou=$n("bu"),dp=$n("u"),wt=$n("bum"),Ui=$n("um"),fp=$n("sp"),pp=$n("rtg"),hp=$n("rtc");function mp(t,e=At){br("ec",t,e)}const gp=Symbol.for("v-ndc");function Jt(t,e,s,n){let o;const r=s,i=Se(t);if(i||rt(t)){const a=i&&ls(t);let l=!1,c=!1;a&&(l=!Gt(t),c=Sn(t),t=gr(t)),o=new Array(t.length);for(let u=0,d=t.length;u<d;u++)o[u]=e(l?c?Vo(Et(t[u])):Et(t[u]):t[u],u,void 0,r)}else if(typeof t=="number"){Number.isInteger(t)||Z(`The v-for range expect an integer value but got ${t}.`),o=new Array(t);for(let a=0;a<t;a++)o[a]=e(a+1,a,void 0,r)}else if(Ke(t))if(t[Symbol.iterator])o=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);o=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];o[l]=e(t[u],u,l,r)}}else o=[];return o}const pi=t=>t?Eu(t)?Mr(t):pi(t.parent):null,ds=ft(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>yn(t.props),$attrs:t=>yn(t.attrs),$slots:t=>yn(t.slots),$refs:t=>yn(t.refs),$parent:t=>pi(t.parent),$root:t=>pi(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>au(t),$forceUpdate:t=>t.f||(t.f=()=>{vr(t.update)}),$nextTick:t=>t.n||(t.n=vn.bind(t.proxy)),$watch:t=>Xp.bind(t)}),Fi=t=>t==="_"||t==="$",Hr=(t,e)=>t!==Je&&!t.__isScriptSetup&&Ve(t,e),ru={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:o,props:r,accessCache:i,type:a,appContext:l}=t;if(e==="__isVue")return!0;let c;if(e[0]!=="$"){const m=i[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return o[e];case 4:return s[e];case 3:return r[e]}else{if(Hr(n,e))return i[e]=1,n[e];if(o!==Je&&Ve(o,e))return i[e]=2,o[e];if((c=t.propsOptions[0])&&Ve(c,e))return i[e]=3,r[e];if(s!==Je&&Ve(s,e))return i[e]=4,s[e];hi&&(i[e]=0)}}const u=ds[e];let d,p;if(u)return e==="$attrs"?(Ct(t.attrs,"get",""),er()):e==="$slots"&&Ct(t,"get",e),u(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(s!==Je&&Ve(s,e))return i[e]=4,s[e];if(p=l.config.globalProperties,Ve(p,e))return p[e];$t&&(!rt(e)||e.indexOf("__v")!==0)&&(o!==Je&&Fi(e[0])&&Ve(o,e)?Z(`Property ${JSON.stringify(e)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):t===$t&&Z(`Property ${JSON.stringify(e)} was accessed during render but is not defined on instance.`))},set({_:t},e,s){const{data:n,setupState:o,ctx:r}=t;return Hr(o,e)?(o[e]=s,!0):o.__isScriptSetup&&Ve(o,e)?(Z(`Cannot mutate <script setup> binding "${e}" from Options API.`),!1):n!==Je&&Ve(n,e)?(n[e]=s,!0):Ve(t.props,e)?(Z(`Attempting to mutate prop "${e}". Props are readonly.`),!1):e[0]==="$"&&e.slice(1)in t?(Z(`Attempting to mutate public property "${e}". Properties starting with $ are reserved and readonly.`),!1):(e in t.appContext.config.globalProperties?Object.defineProperty(r,e,{enumerable:!0,configurable:!0,value:s}):r[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:o,propsOptions:r,type:i}},a){let l,c;return!!(s[a]||t!==Je&&a[0]!=="$"&&Ve(t,a)||Hr(e,a)||(l=r[0])&&Ve(l,a)||Ve(n,a)||Ve(ds,a)||Ve(o.config.globalProperties,a)||(c=i.__cssModules)&&c[a])},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:Ve(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};ru.ownKeys=t=>(Z("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(t));function _p(t){const e={};return Object.defineProperty(e,"_",{configurable:!0,enumerable:!1,get:()=>t}),Object.keys(ds).forEach(s=>{Object.defineProperty(e,s,{configurable:!0,enumerable:!1,get:()=>ds[s](t),set:kt})}),e}function yp(t){const{ctx:e,propsOptions:[s]}=t;s&&Object.keys(s).forEach(n=>{Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>t.props[n],set:kt})})}function vp(t){const{ctx:e,setupState:s}=t;Object.keys(Le(s)).forEach(n=>{if(!s.__isScriptSetup){if(Fi(n[0])){Z(`setup() return property ${JSON.stringify(n)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s[n],set:kt})}})}function Na(t){return Se(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}function bp(){const t=Object.create(null);return(e,s)=>{t[s]?Z(`${e} property "${s}" is already defined in ${t[s]}.`):t[s]=e}}let hi=!0;function wp(t){const e=au(t),s=t.proxy,n=t.ctx;hi=!1,e.beforeCreate&&$a(e.beforeCreate,t,"bc");const{data:o,computed:r,methods:i,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:p,beforeUpdate:m,updated:g,activated:y,deactivated:S,beforeDestroy:E,beforeUnmount:I,destroyed:R,unmounted:M,render:T,renderTracked:x,renderTriggered:j,errorCaptured:V,serverPrefetch:G,expose:J,inheritAttrs:Q,components:z,directives:be,filters:P}=e,de=bp();{const[oe]=t.propsOptions;if(oe)for(const fe in oe)de("Props",fe)}if(c&&Sp(c,n,de),i)for(const oe in i){const fe=i[oe];Ee(fe)?(Object.defineProperty(n,oe,{value:fe.bind(s),configurable:!0,enumerable:!0,writable:!0}),de("Methods",oe)):Z(`Method "${oe}" has type "${typeof fe}" in the component definition. Did you reference the function correctly?`)}if(o){Ee(o)||Z("The data option must be a function. Plain object usage is no longer supported.");const oe=o.call(s,s);if(Ai(oe)&&Z("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Ke(oe))Z("data() should return an object.");else{t.data=Di(oe);for(const fe in oe)de("Data",fe),Fi(fe[0])||Object.defineProperty(n,fe,{configurable:!0,enumerable:!0,get:()=>oe[fe],set:kt})}}if(hi=!0,r)for(const oe in r){const fe=r[oe],qe=Ee(fe)?fe.bind(s,s):Ee(fe.get)?fe.get.bind(s,s):kt;qe===kt&&Z(`Computed property "${oe}" has no getter.`);const le=!Ee(fe)&&Ee(fe.set)?fe.set.bind(s):()=>{Z(`Write operation failed: computed property "${oe}" is readonly.`)},k=Ce({get:qe,set:le});Object.defineProperty(n,oe,{enumerable:!0,configurable:!0,get:()=>k.value,set:ue=>k.value=ue}),de("Computed",oe)}if(a)for(const oe in a)iu(a[oe],n,s,oe);if(l){const oe=Ee(l)?l.call(s):l;Reflect.ownKeys(oe).forEach(fe=>{Ap(fe,oe[fe])})}u&&$a(u,t,"c");function Te(oe,fe){Se(fe)?fe.forEach(qe=>oe(qe.bind(s))):fe&&oe(fe.bind(s))}if(Te(up,d),Te(ot,p),Te(ou,m),Te(dp,g),Te(ap,y),Te(lp,S),Te(mp,V),Te(hp,x),Te(pp,j),Te(wt,I),Te(Ui,M),Te(fp,G),Se(J))if(J.length){const oe=t.exposed||(t.exposed={});J.forEach(fe=>{Object.defineProperty(oe,fe,{get:()=>s[fe],set:qe=>s[fe]=qe,enumerable:!0})})}else t.exposed||(t.exposed={});T&&t.render===kt&&(t.render=T),Q!=null&&(t.inheritAttrs=Q),z&&(t.components=z),be&&(t.directives=be),G&&nu(t)}function Sp(t,e,s=kt){Se(t)&&(t=mi(t));for(const n in t){const o=t[n];let r;Ke(o)?"default"in o?r=No(o.from||n,o.default,!0):r=No(o.from||n):r=No(o),mt(r)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):e[n]=r,s("Inject",n)}}function $a(t,e,s){un(Se(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function iu(t,e,s,n){let o=n.includes(".")?vu(s,n):()=>s[n];if(rt(t)){const r=e[t];Ee(r)?ut(o,r):Z(`Invalid watch handler specified by key "${t}"`,r)}else if(Ee(t))ut(o,t.bind(s));else if(Ke(t))if(Se(t))t.forEach(r=>iu(r,e,s,n));else{const r=Ee(t.handler)?t.handler.bind(s):e[t.handler];Ee(r)?ut(o,r,t):Z(`Invalid watch handler specified by key "${t.handler}"`,r)}else Z(`Invalid watch option: "${n}"`,t)}function au(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:o,optionsCache:r,config:{optionMergeStrategies:i}}=t.appContext,a=r.get(e);let l;return a?l=a:!o.length&&!s&&!n?l=e:(l={},o.length&&o.forEach(c=>Jo(l,c,i,!0)),Jo(l,e,i)),Ke(e)&&r.set(e,l),l}function Jo(t,e,s,n=!1){const{mixins:o,extends:r}=e;r&&Jo(t,r,s,!0),o&&o.forEach(i=>Jo(t,i,s,!0));for(const i in e)if(n&&i==="expose")Z('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const a=Mp[i]||s&&s[i];t[i]=a?a(t[i],e[i]):e[i]}return t}const Mp={data:Ga,props:Ha,emits:Ha,methods:Xs,computed:Xs,beforeCreate:It,created:It,beforeMount:It,mounted:It,beforeUpdate:It,updated:It,beforeDestroy:It,beforeUnmount:It,destroyed:It,unmounted:It,activated:It,deactivated:It,errorCaptured:It,serverPrefetch:It,components:Xs,directives:Xs,watch:Cp,provide:Ga,inject:Tp};function Ga(t,e){return e?t?function(){return ft(Ee(t)?t.call(this,this):t,Ee(e)?e.call(this,this):e)}:e:t}function Tp(t,e){return Xs(mi(t),mi(e))}function mi(t){if(Se(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function It(t,e){return t?[...new Set([].concat(t,e))]:e}function Xs(t,e){return t?ft(Object.create(null),t,e):e}function Ha(t,e){return t?Se(t)&&Se(e)?[...new Set([...t,...e])]:ft(Object.create(null),Na(t),Na(e??{})):e}function Cp(t,e){if(!t)return e;if(!e)return t;const s=ft(Object.create(null),t);for(const n in e)s[n]=It(t[n],e[n]);return s}function lu(){return{app:null,config:{isNativeTag:cc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ep=0;function xp(t,e){return function(n,o=null){Ee(n)||(n=ft({},n)),o!=null&&!Ke(o)&&(Z("root props passed to app.mount() must be an object."),o=null);const r=lu(),i=new WeakSet,a=[];let l=!1;const c=r.app={_uid:Ep++,_component:n,_props:o,_container:null,_context:r,_instance:null,version:Xa,get config(){return r.config},set config(u){Z("app.config cannot be replaced. Modify individual options instead.")},use(u,...d){return i.has(u)?Z("Plugin has already been applied to target app."):u&&Ee(u.install)?(i.add(u),u.install(c,...d)):Ee(u)?(i.add(u),u(c,...d)):Z('A plugin must either be a function or an object with an "install" function.'),c},mixin(u){return r.mixins.includes(u)?Z("Mixin has already been applied to target app"+(u.name?`: ${u.name}`:"")):r.mixins.push(u),c},component(u,d){return bi(u,r.config),d?(r.components[u]&&Z(`Component "${u}" has already been registered in target app.`),r.components[u]=d,c):r.components[u]},directive(u,d){return zc(u),d?(r.directives[u]&&Z(`Directive "${u}" has already been registered in target app.`),r.directives[u]=d,c):r.directives[u]},mount(u,d,p){if(l)Z("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{u.__vue_app__&&Z("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const m=c._ceVNode||ct(n,o);return m.appContext=r,p===!0?p="svg":p===!1&&(p=void 0),r.reload=()=>{const g=Mn(m);g.el=null,t(g,u,p)},t(m,u,p),l=!0,c._container=u,u.__vue_app__=c,c._instance=m.component,Xf(c,Xa),Mr(m.component)}},onUnmount(u){typeof u!="function"&&Z(`Expected function as first argument to app.onUnmount(), but got ${typeof u}`),a.push(u)},unmount(){l?(un(a,c._instance,16),t(null,c._container),c._instance=null,Yf(c),delete c._container.__vue_app__):Z("Cannot unmount an app that is not mounted.")},provide(u,d){return u in r.provides&&(Ve(r.provides,u)?Z(`App already provides property with key "${String(u)}". It will be overwritten with the new value.`):Z(`App already provides property with key "${String(u)}" inherited from its parent element. It will be overwritten with the new value.`)),r.provides[u]=d,c},runWithContext(u){const d=Rs;Rs=c;try{return u()}finally{Rs=d}}};return c}}let Rs=null;function Ap(t,e){if(!At)Z("provide() can only be used inside setup().");else{let s=At.provides;const n=At.parent&&At.parent.provides;n===s&&(s=At.provides=Object.create(n)),s[t]=e}}function No(t,e,s=!1){const n=Sr();if(n||Rs){let o=Rs?Rs._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&t in o)return o[t];if(arguments.length>1)return s&&Ee(e)?e.call(n&&n.proxy):e;Z(`injection "${String(t)}" not found.`)}else Z("inject() can only be used inside setup() or functional components.")}const cu={},uu=()=>Object.create(cu),du=t=>Object.getPrototypeOf(t)===cu;function kp(t,e,s,n=!1){const o={},r=uu();t.propsDefaults=Object.create(null),fu(t,e,o,r);for(const i in t.propsOptions[0])i in o||(o[i]=void 0);hu(e||{},o,t),s?t.props=n?o:xf(o):t.type.props?t.props=o:t.props=r,t.attrs=r}function Rp(t){for(;t;){if(t.type.__hmrId)return!0;t=t.parent}}function Pp(t,e,s,n){const{props:o,attrs:r,vnode:{patchFlag:i}}=t,a=Le(o),[l]=t.propsOptions;let c=!1;if(!Rp(t)&&(n||i>0)&&!(i&16)){if(i&8){const u=t.vnode.dynamicProps;for(let d=0;d<u.length;d++){let p=u[d];if(wr(t.emitsOptions,p))continue;const m=e[p];if(l)if(Ve(r,p))m!==r[p]&&(r[p]=m,c=!0);else{const g=sn(p);o[g]=gi(l,a,g,m,t,!1)}else m!==r[p]&&(r[p]=m,c=!0)}}}else{fu(t,e,o,r)&&(c=!0);let u;for(const d in a)(!e||!Ve(e,d)&&((u=Bn(d))===d||!Ve(e,u)))&&(l?s&&(s[d]!==void 0||s[u]!==void 0)&&(o[d]=gi(l,a,d,void 0,t,!0)):delete o[d]);if(r!==a)for(const d in r)(!e||!Ve(e,d))&&(delete r[d],c=!0)}c&&mn(t.attrs,"set",""),hu(e||{},o,t)}function fu(t,e,s,n){const[o,r]=t.propsOptions;let i=!1,a;if(e)for(let l in e){if(Zs(l))continue;const c=e[l];let u;o&&Ve(o,u=sn(l))?!r||!r.includes(u)?s[u]=c:(a||(a={}))[u]=c:wr(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,i=!0)}if(r){const l=Le(s),c=a||Je;for(let u=0;u<r.length;u++){const d=r[u];s[d]=gi(o,l,d,c[d],t,!Ve(c,d))}}return i}function gi(t,e,s,n,o,r){const i=t[s];if(i!=null){const a=Ve(i,"default");if(a&&n===void 0){const l=i.default;if(i.type!==Function&&!i.skipFactory&&Ee(l)){const{propsDefaults:c}=o;if(s in c)n=c[s];else{const u=So(o);n=c[s]=l.call(null,e),u()}}else n=l;o.ce&&o.ce._setProp(s,n)}i[0]&&(r&&!a?n=!1:i[1]&&(n===""||n===Bn(s))&&(n=!0))}return n}const Ip=new WeakMap;function pu(t,e,s=!1){const n=s?Ip:e.propsCache,o=n.get(t);if(o)return o;const r=t.props,i={},a=[];let l=!1;if(!Ee(t)){const u=d=>{l=!0;const[p,m]=pu(d,e,!0);ft(i,p),m&&a.push(...m)};!s&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!l)return Ke(t)&&n.set(t,As),As;if(Se(r))for(let u=0;u<r.length;u++){rt(r[u])||Z("props must be strings when using array syntax.",r[u]);const d=sn(r[u]);Ua(d)&&(i[d]=Je)}else if(r){Ke(r)||Z("invalid props options",r);for(const u in r){const d=sn(u);if(Ua(d)){const p=r[u],m=i[d]=Se(p)||Ee(p)?{type:p}:ft({},p),g=m.type;let y=!1,S=!0;if(Se(g))for(let E=0;E<g.length;++E){const I=g[E],R=Ee(I)&&I.name;if(R==="Boolean"){y=!0;break}else R==="String"&&(S=!1)}else y=Ee(g)&&g.name==="Boolean";m[0]=y,m[1]=S,(y||Ve(m,"default"))&&a.push(d)}}}const c=[i,a];return Ke(t)&&n.set(t,c),c}function Ua(t){return t[0]!=="$"&&!Zs(t)?!0:(Z(`Invalid prop name: "${t}" is a reserved property.`),!1)}function Lp(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function hu(t,e,s){const n=Le(e),o=s.propsOptions[0],r=Object.keys(t).map(i=>sn(i));for(const i in o){let a=o[i];a!=null&&Op(i,n[i],a,yn(n),!r.includes(i))}}function Op(t,e,s,n,o){const{type:r,required:i,validator:a,skipCheck:l}=s;if(i&&o){Z('Missing required prop: "'+t+'"');return}if(!(e==null&&!i)){if(r!=null&&r!==!0&&!l){let c=!1;const u=Se(r)?r:[r],d=[];for(let p=0;p<u.length&&!c;p++){const{valid:m,expectedType:g}=Np(e,u[p]);d.push(g||""),c=m}if(!c){Z($p(t,e,d));return}}a&&!a(e,n)&&Z('Invalid prop: custom validator check failed for prop "'+t+'".')}}const Dp=Nn("String,Number,Boolean,Function,Symbol,BigInt");function Np(t,e){let s;const n=Lp(e);if(n==="null")s=t===null;else if(Dp(n)){const o=typeof t;s=o===n.toLowerCase(),!s&&o==="object"&&(s=t instanceof e)}else n==="Object"?s=Ke(t):n==="Array"?s=Se(t):s=t instanceof e;return{valid:s,expectedType:n}}function $p(t,e,s){if(s.length===0)return`Prop type [] for prop "${t}" won't match anything. Did you mean to use type Array instead?`;let n=`Invalid prop: type check failed for prop "${t}". Expected ${s.map(mr).join(" | ")}`;const o=s[0],r=ki(e),i=Fa(e,o),a=Fa(e,r);return s.length===1&&ja(o)&&!Gp(o,r)&&(n+=` with value ${i}`),n+=`, got ${r} `,ja(r)&&(n+=`with value ${a}.`),n}function Fa(t,e){return e==="String"?`"${t}"`:e==="Number"?`${Number(t)}`:`${t}`}function ja(t){return["string","number","boolean"].some(s=>t.toLowerCase()===s)}function Gp(...t){return t.some(e=>e.toLowerCase()==="boolean")}const ji=t=>t==="_"||t==="_ctx"||t==="$stable",Bi=t=>Se(t)?t.map(tn):[tn(t)],Hp=(t,e,s)=>{if(e._n)return e;const n=Bc((...o)=>(At&&!(s===null&&$t)&&!(s&&s.root!==At.root)&&Z(`Slot "${t}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),Bi(e(...o))),s);return n._c=!1,n},mu=(t,e,s)=>{const n=t._ctx;for(const o in t){if(ji(o))continue;const r=t[o];if(Ee(r))e[o]=Hp(o,r,n);else if(r!=null){Z(`Non-function value encountered for slot "${o}". Prefer function slots for better performance.`);const i=Bi(r);e[o]=()=>i}}},gu=(t,e)=>{bo(t.vnode)||Z("Non-function value encountered for default slot. Prefer function slots for better performance.");const s=Bi(e);t.slots.default=()=>s},_i=(t,e,s)=>{for(const n in e)(s||!ji(n))&&(t[n]=e[n])},Up=(t,e,s)=>{const n=t.slots=uu();if(t.vnode.shapeFlag&32){const o=e._;o?(_i(n,e,s),s&&Bo(n,"_",o,!0)):mu(e,n)}else e&&gu(t,e)},Fp=(t,e,s)=>{const{vnode:n,slots:o}=t;let r=!0,i=Je;if(n.shapeFlag&32){const a=e._;a?nn?(_i(o,e,s),mn(t,"set","$slots")):s&&a===1?r=!1:_i(o,e,s):(r=!e.$stable,mu(e,o)),i=e}else e&&(gu(t,e),i={default:1});if(r)for(const a in o)!ji(a)&&i[a]==null&&delete o[a]};let zs,Rn;function ws(t,e){t.appContext.config.performance&&Zo()&&Rn.mark(`vue-${e}-${t.uid}`),ep(t,e,Zo()?Rn.now():Date.now())}function Ss(t,e){if(t.appContext.config.performance&&Zo()){const s=`vue-${e}-${t.uid}`,n=s+":end",o=`<${Tr(t,t.type)}> ${e}`;Rn.mark(n),Rn.measure(o,s,n),Rn.clearMeasures(o),Rn.clearMarks(s),Rn.clearMarks(n)}tp(t,e,Zo()?Rn.now():Date.now())}function Zo(){return zs!==void 0||(typeof window<"u"&&window.performance?(zs=!0,Rn=window.performance):zs=!1),zs}function jp(){const t=[];if(t.length){const e=t.length>1;console.warn(`Feature flag${e?"s":""} ${t.join(", ")} ${e?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const Ot=sh;function Bp(t){return zp(t)}function zp(t,e){jp();const s=_o();s.__VUE__=!0,Hc(s.__VUE_DEVTOOLS_GLOBAL_HOOK__,s);const{insert:n,remove:o,patchProp:r,createElement:i,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:p,setScopeId:m=kt,insertStaticContent:g}=t,y=(_,b,L,q=null,A=null,U=null,Y=void 0,K=null,X=nn?!1:!!b.dynamicChildren)=>{if(_===b)return;_&&!os(_,b)&&(q=Xe(_),N(_,A,U,!0),_=null),b.patchFlag===-2&&(X=!1,b.dynamicChildren=null);const{type:W,ref:ce,shapeFlag:ie}=b;switch(W){case wo:S(_,b,L,q);break;case ht:E(_,b,L,q);break;case Ps:_==null?I(b,L,q,Y):R(_,b,L,Y);break;case et:be(_,b,L,q,A,U,Y,K,X);break;default:ie&1?x(_,b,L,q,A,U,Y,K,X):ie&6?P(_,b,L,q,A,U,Y,K,X):ie&64||ie&128?W.process(_,b,L,q,A,U,Y,K,X,it):Z("Invalid VNode type:",W,`(${typeof W})`)}ce!=null&&A?to(ce,_&&_.ref,U,b||_,!b):ce==null&&_&&_.ref!=null&&to(_.ref,null,U,_,!0)},S=(_,b,L,q)=>{if(_==null)n(b.el=a(b.children),L,q);else{const A=b.el=_.el;b.children!==_.children&&c(A,b.children)}},E=(_,b,L,q)=>{_==null?n(b.el=l(b.children||""),L,q):b.el=_.el},I=(_,b,L,q)=>{[_.el,_.anchor]=g(_.children,b,L,q,_.el,_.anchor)},R=(_,b,L,q)=>{if(b.children!==_.children){const A=p(_.anchor);T(_),[b.el,b.anchor]=g(b.children,L,A,q)}else b.el=_.el,b.anchor=_.anchor},M=({el:_,anchor:b},L,q)=>{let A;for(;_&&_!==b;)A=p(_),n(_,L,q),_=A;n(b,L,q)},T=({el:_,anchor:b})=>{let L;for(;_&&_!==b;)L=p(_),o(_),_=L;o(b)},x=(_,b,L,q,A,U,Y,K,X)=>{b.type==="svg"?Y="svg":b.type==="math"&&(Y="mathml"),_==null?j(b,L,q,A,U,Y,K,X):J(_,b,A,U,Y,K,X)},j=(_,b,L,q,A,U,Y,K)=>{let X,W;const{props:ce,shapeFlag:ie,transition:he,dirs:ge}=_;if(X=_.el=i(_.type,U,ce&&ce.is,ce),ie&8?u(X,_.children):ie&16&&G(_.children,X,null,q,A,Ur(_,U),Y,K),ge&&Yn(_,null,q,"created"),V(X,_,_.scopeId,Y,q),ce){for(const Ne in ce)Ne!=="value"&&!Zs(Ne)&&r(X,Ne,null,ce[Ne],U,q);"value"in ce&&r(X,"value",null,ce.value,U),(W=ce.onVnodeBeforeMount)&&dn(W,q,_)}Bo(X,"__vnode",_,!0),Bo(X,"__vueParentComponent",q,!0),ge&&Yn(_,null,q,"beforeMount");const Oe=Vp(A,he);Oe&&he.beforeEnter(X),n(X,b,L),((W=ce&&ce.onVnodeMounted)||Oe||ge)&&Ot(()=>{W&&dn(W,q,_),Oe&&he.enter(X),ge&&Yn(_,null,q,"mounted")},A)},V=(_,b,L,q,A)=>{if(L&&m(_,L),q)for(let U=0;U<q.length;U++)m(_,q[U]);if(A){let U=A.subTree;if(U.patchFlag>0&&U.patchFlag&2048&&(U=zi(U.children)||U),b===U||Su(U.type)&&(U.ssContent===b||U.ssFallback===b)){const Y=A.vnode;V(_,Y,Y.scopeId,Y.slotScopeIds,A.parent)}}},G=(_,b,L,q,A,U,Y,K,X=0)=>{for(let W=X;W<_.length;W++){const ce=_[W]=K?Fn(_[W]):tn(_[W]);y(null,ce,b,L,q,A,U,Y,K)}},J=(_,b,L,q,A,U,Y)=>{const K=b.el=_.el;K.__vnode=b;let{patchFlag:X,dynamicChildren:W,dirs:ce}=b;X|=_.patchFlag&16;const ie=_.props||Je,he=b.props||Je;let ge;if(L&&Jn(L,!1),(ge=he.onVnodeBeforeUpdate)&&dn(ge,L,b,_),ce&&Yn(b,_,L,"beforeUpdate"),L&&Jn(L,!0),nn&&(X=0,Y=!1,W=null),(ie.innerHTML&&he.innerHTML==null||ie.textContent&&he.textContent==null)&&u(K,""),W?(Q(_.dynamicChildren,W,K,L,q,Ur(b,A),U),Qo(_,b)):Y||qe(_,b,K,null,L,q,Ur(b,A),U,!1),X>0){if(X&16)z(K,ie,he,L,A);else if(X&2&&ie.class!==he.class&&r(K,"class",null,he.class,A),X&4&&r(K,"style",ie.style,he.style,A),X&8){const Oe=b.dynamicProps;for(let Ne=0;Ne<Oe.length;Ne++){const Be=Oe[Ne],Pe=ie[Be],Ue=he[Be];(Ue!==Pe||Be==="value")&&r(K,Be,Pe,Ue,A,L)}}X&1&&_.children!==b.children&&u(K,b.children)}else!Y&&W==null&&z(K,ie,he,L,A);((ge=he.onVnodeUpdated)||ce)&&Ot(()=>{ge&&dn(ge,L,b,_),ce&&Yn(b,_,L,"updated")},q)},Q=(_,b,L,q,A,U,Y)=>{for(let K=0;K<b.length;K++){const X=_[K],W=b[K],ce=X.el&&(X.type===et||!os(X,W)||X.shapeFlag&198)?d(X.el):L;y(X,W,ce,null,q,A,U,Y,!0)}},z=(_,b,L,q,A)=>{if(b!==L){if(b!==Je)for(const U in b)!Zs(U)&&!(U in L)&&r(_,U,b[U],null,A,q);for(const U in L){if(Zs(U))continue;const Y=L[U],K=b[U];Y!==K&&U!=="value"&&r(_,U,K,Y,A,q)}"value"in L&&r(_,"value",b.value,L.value,A)}},be=(_,b,L,q,A,U,Y,K,X)=>{const W=b.el=_?_.el:a(""),ce=b.anchor=_?_.anchor:a("");let{patchFlag:ie,dynamicChildren:he,slotScopeIds:ge}=b;(nn||ie&2048)&&(ie=0,X=!1,he=null),ge&&(K=K?K.concat(ge):ge),_==null?(n(W,L,q),n(ce,L,q),G(b.children||[],L,ce,A,U,Y,K,X)):ie>0&&ie&64&&he&&_.dynamicChildren?(Q(_.dynamicChildren,he,L,A,U,Y,K),Qo(_,b)):qe(_,b,L,ce,A,U,Y,K,X)},P=(_,b,L,q,A,U,Y,K,X)=>{b.slotScopeIds=K,_==null?b.shapeFlag&512?A.ctx.activate(b,L,q,Y,X):de(b,L,q,A,U,Y,X):Te(_,b,X)},de=(_,b,L,q,A,U,Y)=>{const K=_.component=dh(_,q,A);if(K.type.__hmrId&&Vf(K),Io(_),ws(K,"mount"),bo(_)&&(K.ctx.renderer=it),ws(K,"init"),ph(K,!1,Y),Ss(K,"init"),nn&&(_.el=null),K.asyncDep){if(A&&A.registerDep(K,oe,Y),!_.el){const X=K.subTree=ct(ht);E(null,X,b,L),_.placeholder=X.el}}else oe(K,_,b,L,A,U,Y);Lo(),Ss(K,"mount")},Te=(_,b,L)=>{const q=b.component=_.component;if(th(_,b,L))if(q.asyncDep&&!q.asyncResolved){Io(b),fe(q,b,L),Lo();return}else q.next=b,q.update();else b.el=_.el,q.vnode=b},oe=(_,b,L,q,A,U,Y)=>{const K=()=>{if(_.isMounted){let{next:ie,bu:he,u:ge,parent:Oe,vnode:Ne}=_;{const st=_u(_);if(st){ie&&(ie.el=Ne.el,fe(_,ie,Y)),st.asyncDep.then(()=>{_.isUnmounted||K()});return}}let Be=ie,Pe;Io(ie||_.vnode),Jn(_,!1),ie?(ie.el=Ne.el,fe(_,ie,Y)):ie=Ne,he&&js(he),(Pe=ie.props&&ie.props.onVnodeBeforeUpdate)&&dn(Pe,Oe,ie,Ne),Jn(_,!0),ws(_,"render");const Ue=za(_);Ss(_,"render");const pe=_.subTree;_.subTree=Ue,ws(_,"patch"),y(pe,Ue,d(pe.el),Xe(pe),_,A,U),Ss(_,"patch"),ie.el=Ue.el,Be===null&&nh(_,Ue.el),ge&&Ot(ge,A),(Pe=ie.props&&ie.props.onVnodeUpdated)&&Ot(()=>dn(Pe,Oe,ie,Ne),A),Uc(_),Lo()}else{let ie;const{el:he,props:ge}=b,{bm:Oe,m:Ne,parent:Be,root:Pe,type:Ue}=_,pe=no(b);Jn(_,!1),Oe&&js(Oe),!pe&&(ie=ge&&ge.onVnodeBeforeMount)&&dn(ie,Be,b),Jn(_,!0);{Pe.ce&&Pe.ce._def.shadowRoot!==!1&&Pe.ce._injectChildStyle(Ue),ws(_,"render");const st=_.subTree=za(_);Ss(_,"render"),ws(_,"patch"),y(null,st,L,q,_,A,U),Ss(_,"patch"),b.el=st.el}if(Ne&&Ot(Ne,A),!pe&&(ie=ge&&ge.onVnodeMounted)){const st=b;Ot(()=>dn(ie,Be,st),A)}(b.shapeFlag&256||Be&&no(Be.vnode)&&Be.vnode.shapeFlag&256)&&_.a&&Ot(_.a,A),_.isMounted=!0,Jf(_),b=L=q=null}};_.scope.on();const X=_.effect=new gc(K);_.scope.off();const W=_.update=X.run.bind(X),ce=_.job=X.runIfDirty.bind(X);ce.i=_,ce.id=_.uid,X.scheduler=()=>vr(ce),Jn(_,!0),X.onTrack=_.rtc?ie=>js(_.rtc,ie):void 0,X.onTrigger=_.rtg?ie=>js(_.rtg,ie):void 0,W()},fe=(_,b,L)=>{b.component=_;const q=_.vnode.props;_.vnode=b,_.next=null,Pp(_,b.props,q,L),Fp(_,b.children,L),ln(),Aa(_),cn()},qe=(_,b,L,q,A,U,Y,K,X=!1)=>{const W=_&&_.children,ce=_?_.shapeFlag:0,ie=b.children,{patchFlag:he,shapeFlag:ge}=b;if(he>0){if(he&128){k(W,ie,L,q,A,U,Y,K,X);return}else if(he&256){le(W,ie,L,q,A,U,Y,K,X);return}}ge&8?(ce&16&&He(W,A,U),ie!==W&&u(L,ie)):ce&16?ge&16?k(W,ie,L,q,A,U,Y,K,X):He(W,A,U,!0):(ce&8&&u(L,""),ge&16&&G(ie,L,q,A,U,Y,K,X))},le=(_,b,L,q,A,U,Y,K,X)=>{_=_||As,b=b||As;const W=_.length,ce=b.length,ie=Math.min(W,ce);let he;for(he=0;he<ie;he++){const ge=b[he]=X?Fn(b[he]):tn(b[he]);y(_[he],ge,L,null,A,U,Y,K,X)}W>ce?He(_,A,U,!0,!1,ie):G(b,L,q,A,U,Y,K,X,ie)},k=(_,b,L,q,A,U,Y,K,X)=>{let W=0;const ce=b.length;let ie=_.length-1,he=ce-1;for(;W<=ie&&W<=he;){const ge=_[W],Oe=b[W]=X?Fn(b[W]):tn(b[W]);if(os(ge,Oe))y(ge,Oe,L,null,A,U,Y,K,X);else break;W++}for(;W<=ie&&W<=he;){const ge=_[ie],Oe=b[he]=X?Fn(b[he]):tn(b[he]);if(os(ge,Oe))y(ge,Oe,L,null,A,U,Y,K,X);else break;ie--,he--}if(W>ie){if(W<=he){const ge=he+1,Oe=ge<ce?b[ge].el:q;for(;W<=he;)y(null,b[W]=X?Fn(b[W]):tn(b[W]),L,Oe,A,U,Y,K,X),W++}}else if(W>he)for(;W<=ie;)N(_[W],A,U,!0),W++;else{const ge=W,Oe=W,Ne=new Map;for(W=Oe;W<=he;W++){const at=b[W]=X?Fn(b[W]):tn(b[W]);at.key!=null&&(Ne.has(at.key)&&Z("Duplicate keys found during update:",JSON.stringify(at.key),"Make sure keys are unique."),Ne.set(at.key,W))}let Be,Pe=0;const Ue=he-Oe+1;let pe=!1,st=0;const Mt=new Array(Ue);for(W=0;W<Ue;W++)Mt[W]=0;for(W=ge;W<=ie;W++){const at=_[W];if(Pe>=Ue){N(at,A,U,!0);continue}let Ut;if(at.key!=null)Ut=Ne.get(at.key);else for(Be=Oe;Be<=he;Be++)if(Mt[Be-Oe]===0&&os(at,b[Be])){Ut=Be;break}Ut===void 0?N(at,A,U,!0):(Mt[Ut-Oe]=W+1,Ut>=st?st=Ut:pe=!0,y(at,b[Ut],L,null,A,U,Y,K,X),Pe++)}const Wt=pe?Wp(Mt):As;for(Be=Wt.length-1,W=Ue-1;W>=0;W--){const at=Oe+W,Ut=b[at],gs=b[at+1],Kn=at+1<ce?gs.el||gs.placeholder:q;Mt[W]===0?y(null,Ut,L,Kn,A,U,Y,K,X):pe&&(Be<0||W!==Wt[Be]?ue(Ut,L,Kn,2):Be--)}}},ue=(_,b,L,q,A=null)=>{const{el:U,type:Y,transition:K,children:X,shapeFlag:W}=_;if(W&6){ue(_.component.subTree,b,L,q);return}if(W&128){_.suspense.move(b,L,q);return}if(W&64){Y.move(_,b,L,it);return}if(Y===et){n(U,b,L);for(let ie=0;ie<X.length;ie++)ue(X[ie],b,L,q);n(_.anchor,b,L);return}if(Y===Ps){M(_,b,L);return}if(q!==2&&W&1&&K)if(q===0)K.beforeEnter(U),n(U,b,L),Ot(()=>K.enter(U),A);else{const{leave:ie,delayLeave:he,afterLeave:ge}=K,Oe=()=>{_.ctx.isUnmounted?o(U):n(U,b,L)},Ne=()=>{U._isLeaving&&U[kn](!0),ie(U,()=>{Oe(),ge&&ge()})};he?he(U,Oe,Ne):Ne()}else n(U,b,L)},N=(_,b,L,q=!1,A=!1)=>{const{type:U,props:Y,ref:K,children:X,dynamicChildren:W,shapeFlag:ce,patchFlag:ie,dirs:he,cacheIndex:ge}=_;if(ie===-2&&(A=!1),K!=null&&(ln(),to(K,null,L,_,!0),cn()),ge!=null&&(b.renderCache[ge]=void 0),ce&256){b.ctx.deactivate(_);return}const Oe=ce&1&&he,Ne=!no(_);let Be;if(Ne&&(Be=Y&&Y.onVnodeBeforeUnmount)&&dn(Be,b,_),ce&6)ze(_.component,L,q);else{if(ce&128){_.suspense.unmount(L,q);return}Oe&&Yn(_,null,b,"beforeUnmount"),ce&64?_.type.remove(_,b,L,it,q):W&&!W.hasOnce&&(U!==et||ie>0&&ie&64)?He(W,b,L,!1,!0):(U===et&&ie&384||!A&&ce&16)&&He(X,b,L),q&&ae(_)}(Ne&&(Be=Y&&Y.onVnodeUnmounted)||Oe)&&Ot(()=>{Be&&dn(Be,b,_),Oe&&Yn(_,null,b,"unmounted")},L)},ae=_=>{const{type:b,el:L,anchor:q,transition:A}=_;if(b===et){_.patchFlag>0&&_.patchFlag&2048&&A&&!A.persisted?_.children.forEach(Y=>{Y.type===ht?o(Y.el):ae(Y)}):me(L,q);return}if(b===Ps){T(_);return}const U=()=>{o(L),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(_.shapeFlag&1&&A&&!A.persisted){const{leave:Y,delayLeave:K}=A,X=()=>Y(L,U);K?K(_.el,U,X):X()}else U()},me=(_,b)=>{let L;for(;_!==b;)L=p(_),o(_),_=L;o(b)},ze=(_,b,L)=>{_.type.__hmrId&&Wf(_);const{bum:q,scope:A,job:U,subTree:Y,um:K,m:X,a:W}=_;Ba(X),Ba(W),q&&js(q),A.stop(),U&&(U.flags|=8,N(Y,_,b,L)),K&&Ot(K,b),Ot(()=>{_.isUnmounted=!0},b),Qf(_)},He=(_,b,L,q=!1,A=!1,U=0)=>{for(let Y=U;Y<_.length;Y++)N(_[Y],b,L,q,A)},Xe=_=>{if(_.shapeFlag&6)return Xe(_.component.subTree);if(_.shapeFlag&128)return _.suspense.next();const b=p(_.anchor||_.el),L=b&&b[Wc];return L?p(L):b};let je=!1;const tt=(_,b,L)=>{_==null?b._vnode&&N(b._vnode,null,null,!0):y(b._vnode||null,_,b,null,null,null,L),b._vnode=_,je||(je=!0,Aa(),Nc(),je=!1)},it={p:y,um:N,m:ue,r:ae,mt:de,mc:G,pc:qe,pbc:Q,n:Xe,o:t};return{render:tt,hydrate:void 0,createApp:xp(tt)}}function Ur({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Jn({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Vp(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Qo(t,e,s=!1){const n=t.children,o=e.children;if(Se(n)&&Se(o))for(let r=0;r<n.length;r++){const i=n[r];let a=o[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=o[r]=Fn(o[r]),a.el=i.el),!s&&a.patchFlag!==-2&&Qo(i,a)),a.type===wo&&a.patchFlag!==-1&&(a.el=i.el),a.type===ht&&!a.el&&(a.el=i.el),a.el&&(a.el.__vnode=a)}}function Wp(t){const e=t.slice(),s=[0];let n,o,r,i,a;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(o=s[s.length-1],t[o]<c){e[n]=o,s.push(n);continue}for(r=0,i=s.length-1;r<i;)a=r+i>>1,t[s[a]]<c?r=a+1:i=a;c<t[s[r]]&&(r>0&&(e[n]=s[r-1]),s[r]=n)}}for(r=s.length,i=s[r-1];r-- >0;)s[r]=i,i=e[i];return s}function _u(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_u(e)}function Ba(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const qp=Symbol.for("v-scx"),Kp=()=>{{const t=No(qp);return t||Z("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),t}};function ut(t,e,s){return Ee(e)||Z("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),yu(t,e,s)}function yu(t,e,s=Je){const{immediate:n,deep:o,flush:r,once:i}=s;e||(n!==void 0&&Z('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),o!==void 0&&Z('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'),i!==void 0&&Z('watch() "once" option is only respected when using the watch(source, callback, options?) signature.'));const a=ft({},s);a.onWarn=Z;const l=e&&n||!e&&r!=="post";let c;if(uo){if(r==="sync"){const m=Kp();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=kt,m.resume=kt,m.pause=kt,m}}const u=At;a.call=(m,g,y)=>un(m,u,g,y);let d=!1;r==="post"?a.scheduler=m=>{Ot(m,u&&u.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(m,g)=>{g?m():vr(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,u&&(m.id=u.uid,m.i=u))};const p=Nf(t,e,a);return uo&&(c?c.push(p):l&&p()),p}function Xp(t,e,s){const n=this.proxy,o=rt(t)?t.includes(".")?vu(n,t):()=>n[t]:t.bind(n,n);let r;Ee(e)?r=e:(r=e.handler,s=e);const i=So(this),a=yu(o,r.bind(n),s);return i(),a}function vu(t,e){const s=e.split(".");return()=>{let n=t;for(let o=0;o<s.length&&n;o++)n=n[s[o]];return n}}const Yp=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${sn(e)}Modifiers`]||t[`${Bn(e)}Modifiers`];function Jp(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||Je;{const{emitsOptions:u,propsOptions:[d]}=t;if(u)if(!(e in u))(!d||!(ns(sn(e))in d))&&Z(`Component emitted event "${e}" but it is neither declared in the emits option nor as an "${ns(sn(e))}" prop.`);else{const p=u[e];Ee(p)&&(p(...s)||Z(`Invalid event arguments: event validation failed for event "${e}".`))}}let o=s;const r=e.startsWith("update:"),i=r&&Yp(n,e.slice(7));i&&(i.trim&&(o=s.map(u=>rt(u)?u.trim():u)),i.number&&(o=s.map(Vd))),np(t,e,o);{const u=e.toLowerCase();u!==e&&n[ns(u)]&&Z(`Event "${u}" is emitted in component ${Tr(t,t.type)} but the handler is registered for "${e}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${Bn(e)}" instead of "${e}".`)}let a,l=n[a=ns(e)]||n[a=ns(sn(e))];!l&&r&&(l=n[a=ns(Bn(e))]),l&&un(l,t,6,o);const c=n[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,un(c,t,6,o)}}const Zp=new WeakMap;function bu(t,e,s=!1){const n=s?Zp:e.emitsCache,o=n.get(t);if(o!==void 0)return o;const r=t.emits;let i={},a=!1;if(!Ee(t)){const l=c=>{const u=bu(c,e,!0);u&&(a=!0,ft(i,u))};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Ke(t)&&n.set(t,null),null):(Se(r)?r.forEach(l=>i[l]=null):ft(i,r),Ke(t)&&n.set(t,i),i)}function wr(t,e){return!t||!go(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ve(t,e[0].toLowerCase()+e.slice(1))||Ve(t,Bn(e))||Ve(t,e))}let yi=!1;function er(){yi=!0}function za(t){const{type:e,vnode:s,proxy:n,withProxy:o,propsOptions:[r],slots:i,attrs:a,emit:l,render:c,renderCache:u,props:d,data:p,setupState:m,ctx:g,inheritAttrs:y}=t,S=Xo(t);let E,I;yi=!1;try{if(s.shapeFlag&4){const T=o||n,x=m.__isScriptSetup?new Proxy(T,{get(j,V,G){return Z(`Property '${String(V)}' was accessed via 'this'. Avoid using 'this' in templates.`),Reflect.get(j,V,G)}}):T;E=tn(c.call(x,T,u,yn(d),m,p,g)),I=a}else{const T=e;a===d&&er(),E=tn(T.length>1?T(yn(d),{get attrs(){return er(),yn(a)},slots:i,emit:l}):T(yn(d),null)),I=e.props?a:Qp(a)}}catch(T){so.length=0,yo(T,t,1),E=ct(ht)}let R=E,M;if(E.patchFlag>0&&E.patchFlag&2048&&([R,M]=wu(E)),I&&y!==!1){const T=Object.keys(I),{shapeFlag:x}=R;if(T.length){if(x&7)r&&T.some(jo)&&(I=eh(I,r)),R=Mn(R,I,!1,!0);else if(!yi&&R.type!==ht){const j=Object.keys(a),V=[],G=[];for(let J=0,Q=j.length;J<Q;J++){const z=j[J];go(z)?jo(z)||V.push(z[2].toLowerCase()+z.slice(3)):G.push(z)}G.length&&Z(`Extraneous non-props attributes (${G.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text or teleport root nodes.`),V.length&&Z(`Extraneous non-emits event listeners (${V.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return s.dirs&&(Va(R)||Z("Runtime directive used on component with non-element root node. The directives will not function as intended."),R=Mn(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(s.dirs):s.dirs),s.transition&&(Va(R)||Z("Component inside <Transition> renders non-element root node that cannot be animated."),lo(R,s.transition)),M?M(R):E=R,Xo(S),E}const wu=t=>{const e=t.children,s=t.dynamicChildren,n=zi(e,!1);if(n){if(n.patchFlag>0&&n.patchFlag&2048)return wu(n)}else return[t,void 0];const o=e.indexOf(n),r=s?s.indexOf(n):-1,i=a=>{e[o]=a,s&&(r>-1?s[r]=a:a.patchFlag>0&&(t.dynamicChildren=[...s,a]))};return[tn(n),i]};function zi(t,e=!0){let s;for(let n=0;n<t.length;n++){const o=t[n];if($s(o)){if(o.type!==ht||o.children==="v-if"){if(s)return;if(s=o,e&&s.patchFlag>0&&s.patchFlag&2048)return zi(s.children)}}else return}return s}const Qp=t=>{let e;for(const s in t)(s==="class"||s==="style"||go(s))&&((e||(e={}))[s]=t[s]);return e},eh=(t,e)=>{const s={};for(const n in t)(!jo(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s},Va=t=>t.shapeFlag&7||t.type===ht;function th(t,e,s){const{props:n,children:o,component:r}=t,{props:i,children:a,patchFlag:l}=e,c=r.emitsOptions;if((o||a)&&nn||e.dirs||e.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return n?Wa(n,i,c):!!i;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const p=u[d];if(i[p]!==n[p]&&!wr(c,p))return!0}}}else return(o||a)&&(!a||!a.$stable)?!0:n===i?!1:n?i?Wa(n,i,c):!0:!!i;return!1}function Wa(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const r=n[o];if(e[r]!==t[r]&&!wr(s,r))return!0}return!1}function nh({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const Su=t=>t.__isSuspense;function sh(t,e){e&&e.pendingBranch?Se(t)?e.effects.push(...t):e.effects.push(t):$i(t)}const et=Symbol.for("v-fgt"),wo=Symbol.for("v-txt"),ht=Symbol.for("v-cmt"),Ps=Symbol.for("v-stc"),so=[];let Vt=null;function $(t=!1){so.push(Vt=t?null:[])}function oh(){so.pop(),Vt=so[so.length-1]||null}let co=1;function tr(t,e=!1){co+=t,t<0&&Vt&&e&&(Vt.hasOnce=!0)}function Mu(t){return t.dynamicChildren=co>0?Vt||As:null,oh(),co>0&&Vt&&Vt.push(t),t}function B(t,e,s,n,o,r){return Mu(h(t,e,s,n,o,r,!0))}function Bt(t,e,s,n,o){return Mu(ct(t,e,s,n,o,!0))}function $s(t){return t?t.__v_isVNode===!0:!1}function os(t,e){if(e.shapeFlag&6&&t.component){const s=Oo.get(e.type);if(s&&s.has(t.component))return t.shapeFlag&=-257,e.shapeFlag&=-513,!1}return t.type===e.type&&t.key===e.key}const rh=(...t)=>ih(...t),Tu=({key:t})=>t??null,$o=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?rt(t)||mt(t)||Ee(t)?{i:$t,r:t,k:e,f:!!s}:t:null);function h(t,e=null,s=null,n=0,o=null,r=t===et?0:1,i=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Tu(e),ref:e&&$o(e),scopeId:jc,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:$t};return a?(Vi(l,s),r&128&&t.normalize(l)):s&&(l.shapeFlag|=rt(s)?8:16),l.key!==l.key&&Z("VNode created with invalid key (NaN). VNode type:",l.type),co>0&&!i&&Vt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Vt.push(l),l}const ct=rh;function ih(t,e=null,s=null,n=0,o=null,r=!1){if((!t||t===gp)&&(t||Z(`Invalid vnode type when creating vnode: ${t}.`),t=ht),$s(t)){const a=Mn(t,e,!0);return s&&Vi(a,s),co>0&&!r&&Vt&&(a.shapeFlag&6?Vt[Vt.indexOf(t)]=a:Vt.push(a)),a.patchFlag=-2,a}if(ku(t)&&(t=t.__vccOpts),e){e=ah(e);let{class:a,style:l}=e;a&&!rt(a)&&(e.class=nt(a)),Ke(l)&&(zo(l)&&!Se(l)&&(l=ft({},l)),e.style=Xt(l))}const i=rt(t)?1:Su(t)?128:qc(t)?64:Ke(t)?4:Ee(t)?2:0;return i&4&&zo(t)&&(t=Le(t),Z("Vue received a Component that was made a reactive object. This can lead to unnecessary performance overhead and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,t)),h(t,e,s,n,o,i,r,!0)}function ah(t){return t?zo(t)||du(t)?ft({},t):t:null}function Mn(t,e,s=!1,n=!1){const{props:o,ref:r,patchFlag:i,children:a,transition:l}=t,c=e?lh(o||{},e):o,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&Tu(c),ref:e&&e.ref?s&&r?Se(r)?r.concat($o(e)):[r,$o(e)]:$o(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:i===-1&&Se(a)?a.map(Cu):a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==et?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Mn(t.ssContent),ssFallback:t.ssFallback&&Mn(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&lo(u,l.clone(u)),u}function Cu(t){const e=Mn(t);return Se(t.children)&&(e.children=t.children.map(Cu)),e}function zn(t=" ",e=0){return ct(wo,null,t,e)}function nr(t,e){const s=ct(Ps,null,t);return s.staticCount=e,s}function we(t="",e=!1){return e?($(),Bt(ht,null,t)):ct(ht,null,t)}function tn(t){return t==null||typeof t=="boolean"?ct(ht):Se(t)?ct(et,null,t.slice()):$s(t)?Fn(t):ct(wo,null,String(t))}function Fn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Mn(t)}function Vi(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Se(e))s=16;else if(typeof e=="object")if(n&65){const o=e.default;o&&(o._c&&(o._d=!1),Vi(t,o()),o._c&&(o._d=!0));return}else{s=32;const o=e._;!o&&!du(e)?e._ctx=$t:o===3&&$t&&($t.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ee(e)?(e={default:e,_ctx:$t},s=32):(e=String(e),n&64?(s=16,e=[zn(e)]):s=8);t.children=e,t.shapeFlag|=s}function lh(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const o in n)if(o==="class")e.class!==n.class&&(e.class=nt([e.class,n.class]));else if(o==="style")e.style=Xt([e.style,n.style]);else if(go(o)){const r=e[o],i=n[o];i&&r!==i&&!(Se(r)&&r.includes(i))&&(e[o]=r?[].concat(r,i):i)}else o!==""&&(e[o]=n[o])}return e}function dn(t,e,s,n=null){un(t,e,7,[s,n])}const ch=lu();let uh=0;function dh(t,e,s){const n=t.type,o=(e?e.appContext:t.appContext)||ch,r={uid:uh++,vnode:t,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new af(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pu(n,o),emitsOptions:bu(n,o),emit:null,emitted:null,propsDefaults:Je,inheritAttrs:n.inheritAttrs,ctx:Je,data:Je,props:Je,attrs:Je,slots:Je,refs:Je,setupState:Je,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx=_p(r),r.root=e?e.root:r,r.emit=Jp.bind(null,r),t.ce&&t.ce(r),r}let At=null;const Sr=()=>At||$t;let sr,vi;{const t=_o(),e=(s,n)=>{let o;return(o=t[s])||(o=t[s]=[]),o.push(n),r=>{o.length>1?o.forEach(i=>i(r)):o[0](r)}};sr=e("__VUE_INSTANCE_SETTERS__",s=>At=s),vi=e("__VUE_SSR_SETTERS__",s=>uo=s)}const So=t=>{const e=At;return sr(t),t.scope.on(),()=>{t.scope.off(),sr(e)}},qa=()=>{At&&At.scope.off(),sr(null)},fh=Nn("slot,component");function bi(t,{isNativeTag:e}){(fh(t)||e(t))&&Z("Do not use built-in or reserved HTML elements as component id: "+t)}function Eu(t){return t.vnode.shapeFlag&4}let uo=!1;function ph(t,e=!1,s=!1){e&&vi(e);const{props:n,children:o}=t.vnode,r=Eu(t);kp(t,n,r,e),Up(t,o,s||e);const i=r?hh(t,e):void 0;return e&&vi(!1),i}function hh(t,e){var s;const n=t.type;{if(n.name&&bi(n.name,t.appContext.config),n.components){const r=Object.keys(n.components);for(let i=0;i<r.length;i++)bi(r[i],t.appContext.config)}if(n.directives){const r=Object.keys(n.directives);for(let i=0;i<r.length;i++)zc(r[i])}n.compilerOptions&&mh()&&Z('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,ru),yp(t);const{setup:o}=n;if(o){ln();const r=t.setupContext=o.length>1?yh(t):null,i=So(t),a=Hs(o,t,0,[yn(t.props),r]),l=Ai(a);if(cn(),i(),(l||t.sp)&&!no(t)&&nu(t),l){if(a.then(qa,qa),e)return a.then(c=>{Ka(t,c,e)}).catch(c=>{yo(c,t,0)});if(t.asyncDep=a,!t.suspense){const c=(s=n.name)!=null?s:"Anonymous";Z(`Component <${c}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else Ka(t,a,e)}else xu(t,e)}function Ka(t,e,s){Ee(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ke(e)?($s(e)&&Z("setup() should not return VNodes directly - return a render function instead."),t.devtoolsRawSetupState=e,t.setupState=Ic(e),vp(t)):e!==void 0&&Z(`setup() should return an object. Received: ${e===null?"null":typeof e}`),xu(t,s)}const mh=()=>!0;function xu(t,e,s){const n=t.type;t.render||(t.render=n.render||kt);{const o=So(t);ln();try{wp(t)}finally{cn(),o()}}!n.render&&t.render===kt&&!e&&(n.template?Z('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):Z("Component is missing template or render function: ",n))}const gh={get(t,e){return er(),Ct(t,"get",""),t[e]},set(){return Z("setupContext.attrs is readonly."),!1},deleteProperty(){return Z("setupContext.attrs is readonly."),!1}};function _h(t){return new Proxy(t.slots,{get(e,s){return Ct(t,"get","$slots"),e[s]}})}function yh(t){const e=s=>{if(t.exposed&&Z("expose() should be called only once per setup()."),s!=null){let n=typeof s;n==="object"&&(Se(s)?n="array":mt(s)&&(n="ref")),n!=="object"&&Z(`expose() should be passed a plain object, received ${n}.`)}t.exposed=s||{}};{let s,n;return Object.freeze({get attrs(){return s||(s=new Proxy(t.attrs,gh))},get slots(){return n||(n=_h(t))},get emit(){return(o,...r)=>t.emit(o,...r)},expose:e})}}function Mr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ic(Af(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in ds)return ds[s](t)},has(e,s){return s in e||s in ds}})):t.proxy}const vh=/(?:^|[-_])\w/g,bh=t=>t.replace(vh,e=>e.toUpperCase()).replace(/[-_]/g,"");function Au(t,e=!0){return Ee(t)?t.displayName||t.name:t.name||e&&t.__name}function Tr(t,e,s=!1){let n=Au(e);if(!n&&e.__file){const o=e.__file.match(/([^/\\]+)\.\w+$/);o&&(n=o[1])}if(!n&&t&&t.parent){const o=r=>{for(const i in r)if(r[i]===e)return i};n=o(t.components||t.parent.type.components)||o(t.appContext.components)}return n?bh(n):s?"App":"Anonymous"}function ku(t){return Ee(t)&&"__vccOpts"in t}const Ce=(t,e)=>{const s=Of(t,e,uo);{const n=Sr();n&&n.appContext.config.warnRecursiveComputed&&(s._warnRecursive=!0)}return s};function wh(t,e,s){try{tr(-1);const n=arguments.length;return n===2?Ke(e)&&!Se(e)?$s(e)?ct(t,null,[e]):ct(t,e):ct(t,null,e):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&$s(s)&&(s=[s]),ct(t,e,s))}finally{tr(1)}}function Sh(){if(typeof window>"u")return;const t={style:"color:#3ba776"},e={style:"color:#1677ff"},s={style:"color:#f5222d"},n={style:"color:#eb2f96"},o={__vue_custom_formatter:!0,header(d){if(!Ke(d))return null;if(d.__isVue)return["div",t,"VueInstance"];if(mt(d)){ln();const p=d.value;return cn(),["div",{},["span",t,u(d)],"<",a(p),">"]}else{if(ls(d))return["div",{},["span",t,Gt(d)?"ShallowReactive":"Reactive"],"<",a(d),`>${Sn(d)?" (readonly)":""}`];if(Sn(d))return["div",{},["span",t,Gt(d)?"ShallowReadonly":"Readonly"],"<",a(d),">"]}return null},hasBody(d){return d&&d.__isVue},body(d){if(d&&d.__isVue)return["div",{},...r(d.$)]}};function r(d){const p=[];d.type.props&&d.props&&p.push(i("props",Le(d.props))),d.setupState!==Je&&p.push(i("setup",d.setupState)),d.data!==Je&&p.push(i("data",Le(d.data)));const m=l(d,"computed");m&&p.push(i("computed",m));const g=l(d,"inject");return g&&p.push(i("injected",g)),p.push(["div",{},["span",{style:n.style+";opacity:0.66"},"$ (internal): "],["object",{object:d}]]),p}function i(d,p){return p=ft({},p),Object.keys(p).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},d],["div",{style:"padding-left:1.25em"},...Object.keys(p).map(m=>["div",{},["span",n,m+": "],a(p[m],!1)])]]:["span",{}]}function a(d,p=!0){return typeof d=="number"?["span",e,d]:typeof d=="string"?["span",s,JSON.stringify(d)]:typeof d=="boolean"?["span",n,d]:Ke(d)?["object",{object:p?Le(d):d}]:["span",s,String(d)]}function l(d,p){const m=d.type;if(Ee(m))return;const g={};for(const y in d.ctx)c(m,y,p)&&(g[y]=d.ctx[y]);return g}function c(d,p,m){const g=d[m];if(Se(g)&&g.includes(p)||Ke(g)&&p in g||d.extends&&c(d.extends,p,m)||d.mixins&&d.mixins.some(y=>c(y,p,m)))return!0}function u(d){return Gt(d)?"ShallowRef":d.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(o):window.devtoolsFormatters=[o]}const Xa="3.5.22",bn=Z;/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let wi;const Ya=typeof window<"u"&&window.trustedTypes;if(Ya)try{wi=Ya.createPolicy("vue",{createHTML:t=>t})}catch(t){bn(`Error creating trusted types policy: ${t}`)}const Ru=wi?t=>wi.createHTML(t):t=>t,Mh="http://www.w3.org/2000/svg",Th="http://www.w3.org/1998/Math/MathML",An=typeof document<"u"?document:null,Ja=An&&An.createElement("template"),Ch={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const o=e==="svg"?An.createElementNS(Mh,t):e==="mathml"?An.createElementNS(Th,t):s?An.createElement(t,{is:s}):An.createElement(t);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>An.createTextNode(t),createComment:t=>An.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>An.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,o,r){const i=s?s.previousSibling:e.lastChild;if(o&&(o===r||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),s),!(o===r||!(o=o.nextSibling)););else{Ja.innerHTML=Ru(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const a=Ja.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,s)}return[i?i.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Gn="transition",Vs="animation",fo=Symbol("_vtc"),Pu={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Eh=ft({},Jc,Pu),xh=t=>(t.displayName="Transition",t.props=Eh,t),Ah=xh((t,{slots:e})=>wh(ip,kh(t),e)),Zn=(t,e=[])=>{Se(t)?t.forEach(s=>s(...e)):t&&t(...e)},Za=t=>t?Se(t)?t.some(e=>e.length>1):t.length>1:!1;function kh(t){const e={};for(const z in t)z in Pu||(e[z]=t[z]);if(t.css===!1)return e;const{name:s="v",type:n,duration:o,enterFromClass:r=`${s}-enter-from`,enterActiveClass:i=`${s}-enter-active`,enterToClass:a=`${s}-enter-to`,appearFromClass:l=r,appearActiveClass:c=i,appearToClass:u=a,leaveFromClass:d=`${s}-leave-from`,leaveActiveClass:p=`${s}-leave-active`,leaveToClass:m=`${s}-leave-to`}=t,g=Rh(o),y=g&&g[0],S=g&&g[1],{onBeforeEnter:E,onEnter:I,onEnterCancelled:R,onLeave:M,onLeaveCancelled:T,onBeforeAppear:x=E,onAppear:j=I,onAppearCancelled:V=R}=e,G=(z,be,P,de)=>{z._enterCancelled=de,Qn(z,be?u:a),Qn(z,be?c:i),P&&P()},J=(z,be)=>{z._isLeaving=!1,Qn(z,d),Qn(z,m),Qn(z,p),be&&be()},Q=z=>(be,P)=>{const de=z?j:I,Te=()=>G(be,z,P);Zn(de,[be,Te]),Qa(()=>{Qn(be,z?l:r),xn(be,z?u:a),Za(de)||el(be,n,y,Te)})};return ft(e,{onBeforeEnter(z){Zn(E,[z]),xn(z,r),xn(z,i)},onBeforeAppear(z){Zn(x,[z]),xn(z,l),xn(z,c)},onEnter:Q(!1),onAppear:Q(!0),onLeave(z,be){z._isLeaving=!0;const P=()=>J(z,be);xn(z,d),z._enterCancelled?(xn(z,p),sl(z)):(sl(z),xn(z,p)),Qa(()=>{z._isLeaving&&(Qn(z,d),xn(z,m),Za(M)||el(z,n,S,P))}),Zn(M,[z,P])},onEnterCancelled(z){G(z,!1,void 0,!0),Zn(R,[z])},onAppearCancelled(z){G(z,!0,void 0,!0),Zn(V,[z])},onLeaveCancelled(z){J(z),Zn(T,[z])}})}function Rh(t){if(t==null)return null;if(Ke(t))return[Fr(t.enter),Fr(t.leave)];{const e=Fr(t);return[e,e]}}function Fr(t){const e=Wd(t);return Ff(e,"<transition> explicit duration"),e}function xn(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[fo]||(t[fo]=new Set)).add(e)}function Qn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const s=t[fo];s&&(s.delete(e),s.size||(t[fo]=void 0))}function Qa(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Ph=0;function el(t,e,s,n){const o=t._endId=++Ph,r=()=>{o===t._endId&&n()};if(s!=null)return setTimeout(r,s);const{type:i,timeout:a,propCount:l}=Ih(t,e);if(!i)return n();const c=i+"end";let u=0;const d=()=>{t.removeEventListener(c,p),r()},p=m=>{m.target===t&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),t.addEventListener(c,p)}function Ih(t,e){const s=window.getComputedStyle(t),n=g=>(s[g]||"").split(", "),o=n(`${Gn}Delay`),r=n(`${Gn}Duration`),i=tl(o,r),a=n(`${Vs}Delay`),l=n(`${Vs}Duration`),c=tl(a,l);let u=null,d=0,p=0;e===Gn?i>0&&(u=Gn,d=i,p=r.length):e===Vs?c>0&&(u=Vs,d=c,p=l.length):(d=Math.max(i,c),u=d>0?i>c?Gn:Vs:null,p=u?u===Gn?r.length:l.length:0);const m=u===Gn&&/\b(?:transform|all)(?:,|$)/.test(n(`${Gn}Property`).toString());return{type:u,timeout:d,propCount:p,hasTransform:m}}function tl(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((s,n)=>nl(s)+nl(t[n])))}function nl(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function sl(t){return(t?t.ownerDocument:document).body.offsetHeight}function Lh(t,e,s){const n=t[fo];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const or=Symbol("_vod"),Iu=Symbol("_vsh"),Lu={name:"show",beforeMount(t,{value:e},{transition:s}){t[or]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):Ws(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:n}){!e!=!s&&(n?e?(n.beforeEnter(t),Ws(t,!0),n.enter(t)):n.leave(t,()=>{Ws(t,!1)}):Ws(t,e))},beforeUnmount(t,{value:e}){Ws(t,e)}};function Ws(t,e){t.style.display=e?t[or]:"none",t[Iu]=!e}const Ou=Symbol("CSS_VAR_TEXT");function Zt(t){const e=Sr();if(!e){bn("useCssVars is called without current active component instance.");return}const s=e.ut=(o=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(r=>rr(r,o))};e.getCssVars=()=>t(e.proxy);const n=()=>{const o=t(e.proxy);e.ce?rr(e.ce,o):Si(e.subTree,o),s(o)};ou(()=>{$i(n)}),ot(()=>{ut(n,kt,{flush:"post"});const o=new MutationObserver(n);o.observe(e.subTree.el.parentNode,{childList:!0}),Ui(()=>o.disconnect())})}function Si(t,e){if(t.shapeFlag&128){const s=t.suspense;t=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{Si(s.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)rr(t.el,e);else if(t.type===et)t.children.forEach(s=>Si(s,e));else if(t.type===Ps){let{el:s,anchor:n}=t;for(;s&&(rr(s,e),s!==n);)s=s.nextSibling}}function rr(t,e){if(t.nodeType===1){const s=t.style;let n="";for(const o in e){const r=rf(e[o]);s.setProperty(`--${o}`,r),n+=`--${o}: ${r};`}s[Ou]=n}}const Oh=/(?:^|;)\s*display\s*:/;function Dh(t,e,s){const n=t.style,o=rt(s);let r=!1;if(s&&!o){if(e)if(rt(e))for(const i of e.split(";")){const a=i.slice(0,i.indexOf(":")).trim();s[a]==null&&Go(n,a,"")}else for(const i in e)s[i]==null&&Go(n,i,"");for(const i in s)i==="display"&&(r=!0),Go(n,i,s[i])}else if(o){if(e!==s){const i=n[Ou];i&&(s+=";"+i),n.cssText=s,r=Oh.test(s)}}else e&&t.removeAttribute("style");or in t&&(t[or]=r?n.display:"",t[Iu]&&(n.display="none"))}const Nh=/[^\\];\s*$/,ol=/\s*!important$/;function Go(t,e,s){if(Se(s))s.forEach(n=>Go(t,e,n));else if(s==null&&(s=""),Nh.test(s)&&bn(`Unexpected semicolon at the end of '${e}' style value: '${s}'`),e.startsWith("--"))t.setProperty(e,s);else{const n=$h(t,e);ol.test(s)?t.setProperty(Bn(n),s.replace(ol,""),"important"):t[n]=s}}const rl=["Webkit","Moz","ms"],jr={};function $h(t,e){const s=jr[e];if(s)return s;let n=sn(e);if(n!=="filter"&&n in t)return jr[e]=n;n=mr(n);for(let o=0;o<rl.length;o++){const r=rl[o]+n;if(r in t)return jr[e]=r}return e}const il="http://www.w3.org/1999/xlink";function al(t,e,s,n,o,r=of(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(il,e.slice(6,e.length)):t.setAttributeNS(il,e,s):s==null||r&&!pc(s)?t.removeAttribute(e):t.setAttribute(e,r?"":qn(s)?String(s):s)}function ll(t,e,s,n,o){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?Ru(s):s);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?t.getAttribute("value")||"":t.value,l=s==null?t.type==="checkbox"?"on":"":String(s);(a!==l||!("_value"in t))&&(t.value=l),s==null&&t.removeAttribute(e),t._value=s;return}let i=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=pc(s):s==null&&a==="string"?(s="",i=!0):a==="number"&&(s=0,i=!0)}try{t[e]=s}catch(a){i||bn(`Failed setting prop "${e}" on <${r.toLowerCase()}>: value ${s} is invalid.`,a)}i&&t.removeAttribute(o||e)}function Gh(t,e,s,n){t.addEventListener(e,s,n)}function Hh(t,e,s,n){t.removeEventListener(e,s,n)}const cl=Symbol("_vei");function Uh(t,e,s,n,o=null){const r=t[cl]||(t[cl]={}),i=r[e];if(n&&i)i.value=dl(n,e);else{const[a,l]=Fh(e);if(n){const c=r[e]=zh(dl(n,e),o);Gh(t,a,c,l)}else i&&(Hh(t,a,i,l),r[e]=void 0)}}const ul=/(?:Once|Passive|Capture)$/;function Fh(t){let e;if(ul.test(t)){e={};let n;for(;n=t.match(ul);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Bn(t.slice(2)),e]}let Br=0;const jh=Promise.resolve(),Bh=()=>Br||(jh.then(()=>Br=0),Br=Date.now());function zh(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;un(Vh(n,s.value),e,5,[n])};return s.value=t,s.attached=Bh(),s}function dl(t,e){return Ee(t)||Se(t)?t:(bn(`Wrong type passed as event handler to ${e} - did you forget @ or : in front of your prop?
Expected function or array of functions, received type ${typeof t}.`),kt)}function Vh(t,e){if(Se(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>o=>!o._stopped&&n&&n(o))}else return e}const fl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Wh=(t,e,s,n,o,r)=>{const i=o==="svg";e==="class"?Lh(t,n,i):e==="style"?Dh(t,s,n):go(e)?jo(e)||Uh(t,e,s,n,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):qh(t,e,n,i))?(ll(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&al(t,e,n,i,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!rt(n))?ll(t,sn(e),n,r,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),al(t,e,n,i))};function qh(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&fl(e)&&Ee(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const o=t.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return fl(e)&&rt(s)?!1:e in t}const Kh=["ctrl","shift","alt","meta"],Xh={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Kh.some(s=>t[`${s}Key`]&&!e.includes(s))},Ln=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=(o,...r)=>{for(let i=0;i<e.length;i++){const a=Xh[e[i]];if(a&&a(o,e))return}return t(o,...r)})},Yh=ft({patchProp:Wh},Ch);let pl;function Jh(){return pl||(pl=Bp(Yh))}const hl=(...t)=>{const e=Jh().createApp(...t);Qh(e),em(e);const{mount:s}=e;return e.mount=n=>{const o=tm(n);if(!o)return;const r=e._component;!Ee(r)&&!r.render&&!r.template&&(r.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const i=s(o,!1,Zh(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},e};function Zh(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Qh(t){Object.defineProperty(t.config,"isNativeTag",{value:e=>ef(e)||tf(e)||nf(e),writable:!1})}function em(t){{const e=t.config.isCustomElement;Object.defineProperty(t.config,"isCustomElement",{get(){return e},set(){bn("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const s=t.config.compilerOptions,n='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-sfc';Object.defineProperty(t.config,"compilerOptions",{get(){return bn(n),s},set(){bn(n)}})}}function tm(t){if(rt(t)){const e=document.querySelector(t);return e||bn(`Failed to mount app: mount target selector "${t}" returned null.`),e}return window.ShadowRoot&&t instanceof window.ShadowRoot&&t.mode==="closed"&&bn('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),t}/**
* vue v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function nm(){Sh()}nm();const Ho={maxRetries:3,retryDelay:1e3,timeout:1e4};let zr=null;const Is={enabled:!0,maxCacheSize:50*1024*1024,cachePrefix:"mgpic_",version:"1.0.0",loadInterval:50,batchSize:3};class sm{constructor(){this.cache=new Map,this.totalSize=0}isSupported(){return"caches"in window}getCacheName(){return`${Is.cachePrefix}${Is.version}`}async isCached(e){if(!this.isSupported())return!1;try{return await(await caches.open(this.getCacheName())).match(e)!==void 0}catch(s){return f(":",s.message),!1}}async cacheResource(e,s){if(!this.isSupported())return!1;try{const n=await caches.open(this.getCacheName());if(await n.match(e))return f(`: ${e}`),!0;await n.put(e,s.clone());const r=s.headers.get("content-length");return r&&(this.totalSize+=parseInt(r)),f(`: ${e}`),!0}catch(n){return f(":",n.message),!1}}async getCachedResource(e){if(!this.isSupported())return null;try{return await(await caches.open(this.getCacheName())).match(e)}catch(s){return f(":",s.message),null}}async cleanupCache(){if(this.isSupported())try{const e=await caches.keys(),s=this.getCacheName();for(const n of e)n.startsWith(Is.cachePrefix)&&n!==s&&(await caches.delete(n),f(`: ${n}`))}catch(e){f(":",e.message)}}}const Yt=new sm;let ko=null;function om(){return ko||(f("R2 URL"),ko="https://pub-6f9181bda40946ea92b5e87fe84e27d4.r2.dev",ko)}function H(t){let e=t;t.startsWith("/assets/")?e=t.slice(7):t.startsWith("@assets/")&&(e=t.slice(8));const s=om(),n=e.startsWith("/")?e.slice(1):e;return`${s}/${n}`}async function Du(t,e={}){if(Yt.isSupported()){const o=await Yt.getCachedResource(t);if(o)return f(` Cache Storage : ${t}`),o}const{maxRetries:s=Ho.maxRetries,retryDelay:n=Ho.retryDelay}=e;for(let o=1;o<=s;o++)try{f(` (${o}/${s}): ${t}`);const r=new AbortController,i=setTimeout(()=>r.abort(),Ho.timeout),a=await fetch(t,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:r.signal,...e});if(clearTimeout(i),a.ok)return Yt.isSupported()&&await Yt.cacheResource(t,a),f(`: ${t}`),a;throw new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(r){if(f(` (${o}/${s}): ${t}`,r.message),o===s)throw f(`: ${t}`,r.message),r;const i=n*o;f(` ${i}ms ...`),await new Promise(a=>setTimeout(a,i))}}async function rm(t=["high","medium"]){try{if(zr){f("");const r=ml(zr,t);return f(` ${r.length}  (: ${t.join(", ")})`),r}const e=H("asset-list.json");f(` R2 CDN : ${e}`);const s=await Du(e);if(!s.ok)throw new Error(`: HTTP ${s.status}`);const n=await s.json();zr=n,f("");const o=ml(n,t);return f(` ${o.length}  (: ${t.join(", ")})`),o}catch(e){return f(":",e.message),["logo.glb","frontend_resource/start_game.webp","frontend_resource/copper_warehouse.webp","frontend_resource/game_wiki.webp","frontend_resource/Tutorial.webp","frontend_resource/gacha.webp"]}}function ml(t,e){const s=[];for(const n of e)if(t.categories&&t.categories[n]){const o=t.categories[n].resources||[];s.push(...o.map(r=>r.path))}return s}async function ir(t=null,e=["high","medium"]){f("..."),await Yt.cleanupCache();const s=await rm(e),n=Is.batchSize,o=Is.loadInterval,r=s.length;let i=0;t&&t(0,r,0);for(let a=0;a<s.length;a+=n){const l=s.slice(a,a+n);f(` ${Math.floor(a/n)+1}/${Math.ceil(s.length/n)}: ${l.length} `);const c=l.map(async(S,E)=>{const I=H(S);try{if(await Yt.isCached(I))return f(`Cache Storage: ${S}`),{success:!0,path:S,cached:!0,source:"cache"};const M=new AbortController,T=setTimeout(()=>M.abort(),Ho.timeout),x=await fetch(I,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:M.signal});if(clearTimeout(T),x.ok){const j=x.headers.get("x-cache")||x.headers.get("cf-cache-status")||x.type==="basic"&&!x.redirected;return Yt.isSupported()&&await Yt.cacheResource(I,x),f(`: ${S}${j?" ()":""}`),{success:!0,path:S,cached:!1,fromBrowserCache:!!j}}else throw new Error(`HTTP ${x.status}: ${x.statusText}`)}catch(R){return f(`: ${S}`,R.message),{success:!1,path:S,error:R.message}}}),u=await Promise.all(c);i+=l.length;const d=Math.round(i/r*100);t&&t(i,r,d);const p=u.filter(S=>S.success).length,m=u.filter(S=>S.cached).length,g=u.filter(S=>S.fromBrowserCache).length,y=u.filter(S=>!S.success).length;f(`:  ${p}, Cache Storage ${m},  ${g},  ${y}`),a+n<s.length&&(f(` ${o}ms ...`),await new Promise(S=>setTimeout(S,o)))}f(""),t&&t(r,r,100)}async function gl(){if(!Yt.isSupported())return{supported:!1,message:"API"};try{const e=await(await caches.open(Yt.getCacheName())).keys();return{supported:!0,cacheName:Yt.getCacheName(),resourceCount:e.length,totalSize:Yt.totalSize,maxSize:Is.maxCacheSize}}catch(t){return{supported:!0,error:t.message}}}function po(t,e){return H(`copper/${t.toLowerCase()}/${e}/${e}.glb`)}function ho(t){return H(`enemy/${t}/${t}.glb`)}function Mi(t){return H(`structure/${t}/${t}.glb`)}function _l(t){return H(t)}const St=(t,e)=>{const s=t.__vccOpts||t;for(const[n,o]of e)s[n]=o;return s},im={__name:"Hall",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["startGame","openWarehouse","openTutorial","openEncyclopedia","toggle-music"],setup(t,{expose:e,emit:s}){e();const n=s,o=t;function r(){n("startGame")}function i(){n("openWarehouse")}function a(){n("openTutorial")}function l(){n("openEncyclopedia")}const c=F(H("@assets/frontend_resource/start_game.webp")),u=F(H("@assets/frontend_resource/copper_warehouse.webp")),d=F(H("@assets/frontend_resource/game_wiki.webp")),p=F(H("@assets/frontend_resource/Tutorial.webp")),m=F(H("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),g=F(!1),y=F(null),S=H("@assets/frontend_resource/hall.mp3");ot(()=>{setTimeout(()=>{g.value=!0,f("HallUI")},100),o.musicOn&&!o.paused&&y.value&&setTimeout(()=>{if(y.value.readyState>=2)y.value.play().then(()=>{f("[Hall] ")}).catch(R=>{f("[Hall] :",R)});else{const R=()=>{y.value.play().then(()=>{f("[Hall] ")}).catch(M=>{f("[Hall] :",M)}),y.value.removeEventListener("canplay",R)};y.value.addEventListener("canplay",R,{once:!0})}},200)}),ut(()=>o.musicOn,I=>{if(y.value)if(I&&!o.paused)if(y.value.readyState>=2)y.value.play().catch(R=>{f("[Hall] :",R)});else{const R=()=>{y.value.play().catch(M=>{f("[Hall] :",M)}),y.value.removeEventListener("canplay",R)};y.value.addEventListener("canplay",R)}else y.value.pause()}),ut(()=>o.paused,I=>{if(y.value){if(I)y.value.pause(),f("[Hall] ");else if(o.musicOn){if(y.value.readyState>=2)y.value.play().catch(R=>{f("[Hall] :",R)});else{const R=()=>{y.value.play().catch(M=>{f("[Hall] :",M)}),y.value.removeEventListener("canplay",R)};y.value.addEventListener("canplay",R)}f("[Hall] ")}}}),wt(()=>{y.value&&y.value.pause()});const E={emit:n,props:o,startGame:r,openWarehouse:i,openTutorial:a,openEncyclopedia:l,bgStart:c,bgWarehouse:u,bgWiki:d,bgTutorial:p,bgHall:m,imagesLoaded:g,audioRef:y,musicUrl:S,get log(){return f},ref:F,onMounted:ot,onBeforeUnmount:wt,watch:ut,get getAssetUrl(){return H}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},am={class:"hall-container"},lm=["src"];function cm(t,e,s,n,o,r){return $(),B("div",am,[h("div",{class:"hall-bg",style:Xt({backgroundImage:`url('${n.bgHall}')`})},null,4),h("div",{class:nt(["menu",{"menu--loaded":n.imagesLoaded}])},[h("button",{class:"tile tile--start",style:Xt({backgroundImage:`url('${n.bgStart}')`}),onClick:n.startGame},[...e[0]||(e[0]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--bottom"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Begin Adventure")],-1)])],4),h("button",{class:"tile tile--warehouse",style:Xt({backgroundImage:`url('${n.bgWarehouse}')`}),onClick:n.openWarehouse},[...e[1]||(e[1]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--top"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Character Collection")],-1)])],4),h("button",{class:"tile tile--wiki",style:Xt({backgroundImage:`url('${n.bgWiki}')`}),onClick:n.openEncyclopedia},[...e[2]||(e[2]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--bottom"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Encyclopedia")],-1)])],4),h("button",{class:"tile tile--tutorial",style:Xt({backgroundImage:`url('${n.bgTutorial}')`}),onClick:n.openTutorial},[...e[3]||(e[3]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--top"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Tutorial")],-1)])],4)],2),h("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,lm)])}const um=St(im,[["render",cm],["__scopeId","data-v-7603db95"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/Hall.vue"]]),On={HeartCrystalDust:{name:"",icon:H("resource/heart_crystal_dust.webp")},RecallGear:{name:"",icon:H("resource/recall_gear.webp")},ResonantCrystal:{name:"",icon:H("resource/resonant_star_crystal/resonant_star_crystal.webp")},RefinedCopper:{name:"",icon:H("resource/refined_copper_ingot/refined_copper_ingot.webp")},SpiritalSpark:{name:"",icon:H("resource/spiritual_spark.webp")}};function ar(t){var e;if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Resource"){const s=t.item_type[1];return((e=On[s])==null?void 0:e.name)||s}else if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Equipment")return"";return""}function Nu(t){var e;return((e=On[t])==null?void 0:e.name)||t}function dm(t){var e;return((e=On[t])==null?void 0:e.icon)||""}const fm="modulepreload",pm=function(t,e){return new URL(t,e).href},yl={},$u=function(e,s,n){let o=Promise.resolve();if(s&&s.length>0){const i=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(s.map(c=>{if(c=pm(c,n),c in yl)return;yl[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(!!n)for(let g=i.length-1;g>=0;g--){const y=i[g];if(y.href===c&&(!u||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":fm,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((g,y)=>{m.addEventListener("load",g),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return o.then(i=>{for(const a of i||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})};function hm(t){return{all:t=t||new Map,on:function(e,s){var n=t.get(e);n?n.push(s):t.set(e,[s])},off:function(e,s){var n=t.get(e);n&&(s?n.splice(n.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var n=t.get(e);n&&n.slice().map(function(o){o(s)}),(n=t.get("*"))&&n.slice().map(function(o){o(e,s)})}}}const Wi=hm(),Tt={UPDATE_RESOURCES:"update:resources",RESOURCES_UPDATED:"resources:updated",COPPER_ID_ADDED:"copper:id:added",START_MENU_PAUSE:"menu:pause",START_MENU_RESUME:"menu:resume",START_MENU_STARTED:"menu:started",CONTROL_MODE_CHANGED:"control:mode:changed",GAME_STARTED:"game:started",GAME_ENDED:"game:ended"},In=(t,e)=>{Wi.emit(t,e)},Vn=(t,e)=>{Wi.on(t,e)},ps=(t,e)=>{Wi.off(t,e)};class mm{constructor(){this.queue=[],this.isProcessing=!1,this.handlers=new Map,this.sceneContext=null}setSceneContext(e){this.sceneContext=e}registerHandler(e,s){this.handlers.set(e,s)}enqueue(e){["handle_on_click_copper","on_game_start"].includes(e.type_msg)&&f("[MessageQueue] :",e.type_msg),this.queue.push(e),this.isProcessing||this.processNext()}async processNext(){if(this.queue.length===0){this.isProcessing=!1;return}this.isProcessing=!0;const e=50;let s=0;for(;this.queue.length>0&&s<e;){const n=this.queue.shift();s++;try{const{type_msg:o,content:r}=n,i=this.handlers.get(o);if(i){const a=JSON.parse(r),l=i(a,this.sceneContext||{});l&&typeof l.then=="function"&&await l}else f("[MessageQueue] :",o),f("[MessageQueue] :",Array.from(this.handlers.keys()))}catch(o){f("[MessageQueue] :",o),f("[MessageQueue] :",o.message),f("[MessageQueue] :",o.stack)}}this.queue.length>0?requestAnimationFrame(()=>this.processNext()):this.isProcessing=!1}}const ke=new mm;function Ro(t,e){return t.find(s=>s.id===e)}function vl(t){return new Promise(e=>setTimeout(e,t))}function Gu(){f("[MessageQueue] ..."),ke.registerHandler("handle_on_click_copper",async(r,i)=>{var u,d;const{copper:a,resources:l,has_attack_targets:c}=r;f(`[Handler] : ${((u=a.copper.copper_info)==null?void 0:u.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.copper.attribute.health}, =${a.can_move}, =${a.can_attack}, =${a.can_summon}, =${a.can_build}, =${c}`),f(`[Handler] : ${(d=a.copper)==null?void 0:d.copper_type}`),i.highlightSelectedCopper&&i.highlightSelectedCopper(a.id),i.onShowCopperInfo&&i.onShowCopperInfo(a,l,c)}),ke.registerHandler("handle_on_click_enemy",async(r,i)=>{var m,g;const{enemy:a,resources:l,has_attack_targets:c}=r,u=a.owned||!1;f(`[Handler] ${u?"":""}: ${((m=a.enemy_base)==null?void 0:m.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.enemy_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${c}`);const p={id:a.id,now_health:a.now_health,can_move:u?a.can_move:!1,can_attack:u?a.can_attack:!1,can_summon:!1,position:a.position,isEnemy:!u,isOwnedEnemy:u,copper:{copper_info:{name:((g=a.enemy_base)==null?void 0:g.name)||(u?"":"")},attribute:{health:a.enemy_base.health,attack:a.enemy_base.attack,defense:a.enemy_base.defense,speed:a.enemy_base.speed}}};i.highlightSelectedCopper&&i.highlightSelectedCopper(a.id),i.onShowCopperInfo&&i.onShowCopperInfo(p,l,c)}),ke.registerHandler("handle_on_click_structure",async(r,i)=>{var d;const{structure:a,resources:l}=r,u=a.owned||!1?"":"";f(`[Handler] ${u}: ${((d=a.structure_base)==null?void 0:d.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.structure_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${a.structure_base.has_storage}`),i.highlightSelectedCopper&&i.highlightSelectedCopper(a.id),i.onShowStructureInfo&&i.onShowStructureInfo(a,l)}),ke.registerHandler("set_copper",async(r,i)=>{const{id:a,position:l,copper:c}=r;window.__ACTUAL_COPPER_IDS__||(window.__ACTUAL_COPPER_IDS__=[]),window.__ACTUAL_COPPER_IDS__.push(c.id),In(Tt.COPPER_ID_ADDED,c.id),i.onSetCopper&&await i.onSetCopper(a,l,c)}),ke.registerHandler("set_enemy",async(r,i)=>{const{id:a,position:l,enemy:c}=r;i.onSetEnemy&&i.onSetEnemy(a,l,c),c.owned&&In(Tt.UPDATE_RESOURCES)}),ke.registerHandler("set_material",async(r,i)=>{const{id:a,position:l,material:c}=r;i.onSetMaterial&&await i.onSetMaterial(a,l,c)}),ke.registerHandler("set_structure",async(r,i)=>{const{id:a,position:l,structure:c}=r;i.onSetStructure&&await i.onSetStructure(a,l,c),c.owned&&In(Tt.UPDATE_RESOURCES)}),ke.registerHandler("remove_unit",async(r,i)=>{const{id:a}=r,l=Ro(i.models||[],a),c=l&&l.type==="enemy"&&!l.isOwned,u=c?l.position:null;if(f(`[Handler] remove_unit: ID=${a}, type=${l==null?void 0:l.type}, isOwned=${l==null?void 0:l.isOwned}, isEnemyDeath=${c}, position=${JSON.stringify(u)}`),l&&l.object){l.object.traverse(m=>{m.material&&(Array.isArray(m.material)?m.material=m.material.map(g=>g.clone()):m.material=m.material.clone())});const d=500,p=performance.now();if(await new Promise(m=>{function g(){const y=performance.now()-p,S=Math.min(y/d,1);l.object&&l.object.traverse(E=>{E.material&&(Array.isArray(E.material)?E.material.forEach(I=>{I.transparent=!0,I.opacity=1-S}):(E.material.transparent=!0,E.material.opacity=1-S))}),S<1?requestAnimationFrame(g):m()}g()}),i.scene&&i.scene.remove(l.object),l.object.traverse(m=>{m.geometry&&m.geometry.dispose(),m.material&&(Array.isArray(m.material)?m.material.forEach(g=>{g.map&&g.map.dispose(),g.lightMap&&g.lightMap.dispose(),g.bumpMap&&g.bumpMap.dispose(),g.normalMap&&g.normalMap.dispose(),g.specularMap&&g.specularMap.dispose(),g.envMap&&g.envMap.dispose(),g.alphaMap&&g.alphaMap.dispose(),g.aoMap&&g.aoMap.dispose(),g.displacementMap&&g.displacementMap.dispose(),g.emissiveMap&&g.emissiveMap.dispose(),g.metalnessMap&&g.metalnessMap.dispose(),g.roughnessMap&&g.roughnessMap.dispose(),g.dispose()}):(m.material.map&&m.material.map.dispose(),m.material.lightMap&&m.material.lightMap.dispose(),m.material.bumpMap&&m.material.bumpMap.dispose(),m.material.normalMap&&m.material.normalMap.dispose(),m.material.specularMap&&m.material.specularMap.dispose(),m.material.envMap&&m.material.envMap.dispose(),m.material.alphaMap&&m.material.alphaMap.dispose(),m.material.aoMap&&m.material.aoMap.dispose(),m.material.displacementMap&&m.material.displacementMap.dispose(),m.material.emissiveMap&&m.material.emissiveMap.dispose(),m.material.metalnessMap&&m.material.metalnessMap.dispose(),m.material.roughnessMap&&m.material.roughnessMap.dispose(),m.material.dispose()))}),i.models){const m=i.models.indexOf(l);m>-1&&i.models.splice(m,1)}i.onClearState&&i.onClearState(a),i.onRemoveHealthBar&&i.onRemoveHealthBar(a),l.type==="copper"&&i.onRemoveCopper&&i.onRemoveCopper(a)}if(c&&u){f("[Handler] ...");const d=p=>{f("[Handler] :",p),i.onShowResourceGain&&Object.keys(p).length>0&&(f("[Handler] :",u,p),i.onShowResourceGain(u,p))};Vn(Tt.RESOURCES_UPDATED,d),In(Tt.UPDATE_RESOURCES),setTimeout(()=>{ps(Tt.RESOURCES_UPDATED,d)},1e3)}}),ke.registerHandler("change_direction",async(r,i)=>{const{id:a,direction:l}=r,c=Ro(i.models||[],a);if(c&&c.object){let u=0;switch(l){case"PositiveY":u=0;break;case"PositiveX":u=Math.PI/2;break;case"NegativeY":u=Math.PI;break;case"NegativeX":u=-Math.PI/2;break}let d=c.object.rotation.y;d=Math.atan2(Math.sin(d),Math.cos(d));let p=u-d;p>Math.PI?p-=2*Math.PI:p<-Math.PI&&(p+=2*Math.PI);const m=300,g=performance.now();await new Promise(y=>{function S(){const E=performance.now()-g,I=Math.min(E/m,1),R=1-Math.pow(1-I,2);c.object&&(c.object.rotation.y=d+p*R),I<1?requestAnimationFrame(S):(c.object&&(c.object.rotation.y=u),y())}S()})}}),ke.registerHandler("move_to",async(r,i)=>{const{id:a,to:l}=r,c=Ro(i.models||[],a);if(c&&c.object&&i.gridCellSize){const[u,d]=l,p=u,m=d,g=c.object.position.y;c.position=[u,d],i.onMoveStart&&i.onMoveStart(a,c),i.animateModelMove&&await new Promise(y=>{i.animateModelMove(c,{x:p,y:g,z:m},y)}),i.onMoveComplete&&i.onMoveComplete(a)}}),ke.registerHandler("display_can_move",(r,i)=>{const{id:a,can_move:l}=r,c=l==="true"||l===!0;i.onDisplayCanMove&&i.onDisplayCanMove(a,c)}),ke.registerHandler("display_can_attack",(r,i)=>{const{id:a,can_attack:l}=r,c=l==="true"||l===!0;i.onDisplayCanAttack&&i.onDisplayCanAttack(a,c)}),ke.registerHandler("display_can_summon",(r,i)=>{const{id:a,can_summon:l}=r,c=l==="true"||l===!0;f(`[Handler] display_can_summon id=${a}, can_summon=${c}`),i.onDisplayCanSummon&&i.onDisplayCanSummon(a,c)}),ke.registerHandler("update_health",(r,i)=>{const{id:a,now_health:l,max_health:c}=r;i.onUpdateHealth&&i.onUpdateHealth(a,l,c)}),ke.registerHandler("clear_state",(r,i)=>{const{id:a}=r;i.onClearState&&i.onClearState(a)}),ke.registerHandler("animate_move",async(r,i)=>{const{id:a}=r,l=Ro(i.models||[],a);if(!l){f(`[Handler] animate_move:  ID=${a}`);return}if(window.disableAutoFocus){f(`[Handler] animate_move:  ID=${a}`);return}const c=i.followEnemies!==void 0?i.followEnemies:!1;if(l.type==="enemy"&&!c){f(`[Handler] animate_move:  ID=${a}  context.followEnemies = true `);return}if(i.camera&&i.focusOnModel){const u=i.focusOnModel(l.object,i.camera,i.controls);i.focusState&&(i.focusState.focusPosition=u.focusPosition,i.focusState.focusTarget=u.focusTarget,i.focusState.lerpFactor=u.lerpFactor,f(`[Handler] animate_move:  ID=${a} (${l.name})`)),await vl(1e3)}}),ke.registerHandler("animate_reset",async(r,i)=>{if(f("[Handler] animate_reset"),i.camera&&i.controls){const a={x:0,y:2,z:5},l={x:0,y:0,z:0};i.focusState&&(i.focusState.focusPosition=a,i.focusState.focusTarget=l,i.focusState.lerpFactor=.08),await vl(1e3)}}),ke.registerHandler("put_map_block",(r,i)=>{const{position:a}=r;i.onPutMapBlock&&i.onPutMapBlock(a)}),ke.registerHandler("put_room_blocks",async(r,i)=>{const{room_position:a,size:l}=r,[c,u]=a;if(f(`[Handler]  : [${c}, ${u}], ${l}x${l}`),!i.onPutMapBlock){f("[Handler]  context.onPutMapBlock ");return}f("[Handler]  context.onPutMapBlock ...");const d=32,p=l*l;let m=0;for(let g=0;g<l;g++)for(let y=0;y<l;y++){const S=[c+g,u+y];i.onPutMapBlock(S),m++,m%d===0&&await new Promise(E=>requestAnimationFrame(E))}f(`[Handler]  : ${p}`)}),ke.registerHandler("put_resource_marker",(r,i)=>{const{position:a}=r;i.onPutResourceMarker&&i.onPutResourceMarker(a)}),ke.registerHandler("clear_resource_marker",(r,i)=>{const{position:a}=r;i.onClearResourceMarker&&i.onClearResourceMarker(a)});let t=0,e=0,s=0;ke.registerHandler("set_move_block",(r,i)=>{const{position:a}=r;t++,i.onSetMoveBlock&&i.onSetMoveBlock(a)}),ke.registerHandler("set_attack_block",(r,i)=>{const{position:a}=r;e++,i.onSetAttackBlock&&i.onSetAttackBlock(a),(e===1||e%10===0)&&f(`[Handler]  ${e} `)}),ke.registerHandler("set_can_summon_blocks",(r,i)=>{const{position:a}=r;s++,i.onSetCanSummonBlock&&i.onSetCanSummonBlock(a),(s===1||s%10===0)&&f(`[Handler]  ${s} `)});let n=0,o=Date.now();ke.registerHandler("clear_block",(r,i)=>{const{position:a}=r;i.onClearBlock&&i.onClearBlock(a),n++;const l=Date.now();l-o>500&&(n>1&&f(`[Handler]   ${n} `),n=0,t>0&&(f(`[Handler]  ${t} `),t=0),e>0&&(f(`[Handler]  ${e} `),e=0),s>0&&(f(`[Handler]  ${s} `),s=0)),o=l}),ke.registerHandler("attack_complete",(r,i)=>{const{id:a}=r;i.onAttackComplete&&i.onAttackComplete(a)}),ke.registerHandler("on_game_round_pass",(r,i)=>{}),ke.registerHandler("craft_success",(r,i)=>{i.onCraftResult&&i.onCraftResult(!0,r.message||"")}),ke.registerHandler("craft_failed",(r,i)=>{i.onCraftResult&&i.onCraftResult(!1,r.message||"")}),ke.registerHandler("cannot_pick_up_item",(r,i)=>{f("[Handler] :",r.message||r)}),ke.registerHandler("equipment_slot_full",(r,i)=>{f("[Handler] :",r.message||r)}),ke.registerHandler("inventory_full",(r,i)=>{f("[Handler] :",r.message||r)}),ke.registerHandler("resource_not_enough",(r,i)=>{let a="";if(r.missing&&Array.isArray(r.missing)&&r.missing.length>0){const l={HeartCrystalDust:"",RecallGear:"",SpiritalSpark:"",RefinedCopper:"",ResonantCrystal:""};a=`: ${r.missing.map(u=>{const d=l[u.type]||u.type,p=u.needed-u.current;return`${d} ( ${p})`}).join("")}`}f("[Handler] :",a),i.onResourceNotEnough&&i.onResourceNotEnough(a)}),ke.registerHandler("summon_failed",(r,i)=>{f("[Handler] :",r.message||r),i.onSummonFailed&&i.onSummonFailed(r.message||"")}),ke.registerHandler("summon_expired",(r,i)=>{const{id:a,message:l}=r;f(`[Handler] : ID=${a}, ${l}`)}),ke.registerHandler("get_summon_menu",(r,i)=>{const{contents:a}=r;f("[Handler] :",a),i.onShowSummonMenu&&i.onShowSummonMenu(a)}),ke.registerHandler("get_structure_menu",(r,i)=>{const{contents:a}=r;if(!a||a.length===0){f("[Handler]  ");return}const l=a.filter(c=>c.name!=="");f("[Handler] ",l.length,""),i.onShowStructureMenu&&i.onShowStructureMenu(l)}),ke.registerHandler("drill_resource_generate",(r,i)=>{const{position:a,resource_type:l,amount:c}=r;f(`[Handler] : =${JSON.stringify(a)}, =${l}, =${c}`);const u={[l]:parseInt(c)};i.onShowResourceGain&&i.onShowResourceGain(a,u),In(Tt.UPDATE_RESOURCES)}),ke.registerHandler("game_over",(r,i)=>{f("[Handler] "),i.onGameOver&&i.onGameOver()}),ke.registerHandler("success",(r,i)=>{f("[Handler] "),i.onGameSuccess&&i.onGameSuccess()})}const gm=Object.freeze(Object.defineProperty({__proto__:null,messageQueue:ke,registerAllHandlers:Gu},Symbol.toStringTag,{value:"Module"}));Gu();let Ge=null,Cn=null;Cn=(async()=>{try{return Ge=await $u(()=>import("./main-z7kB-zOn.js"),[],import.meta.url),f("[Glue] main.js "),Ge}catch(t){return f("[Glue] main.js :",t.message),null}})();async function bl(){return await Cn,Ge!=null&&Ge.global_gacha?JSON.parse(Ge.global_gacha()):{type:"error",content:""}}async function Wn(){return await Cn,Ge!=null&&Ge.global_get_resource?JSON.parse(Ge.global_get_resource()):{}}async function wl(){return await Cn,Ge!=null&&Ge.global_craft?JSON.parse(Ge.global_craft()):{type:"error",content:""}}async function Es(){return await Cn,Ge!=null&&Ge.global_get_copper_list?JSON.parse(Ge.global_get_copper_list()):[]}async function Sl(t){return await Cn,Ge!=null&&Ge.global_upgrade_copper?JSON.parse(Ge.global_upgrade_copper(t)):{type:"error",content:""}}async function lr(t){await Cn,Ge!=null&&Ge.global_info_subscribe?(Ge.global_info_subscribe(e=>{const s=JSON.parse(e);t(s),ke.enqueue(s)}),f("[Glue] global_info_subscribe ")):f("[Glue] global_info_subscribe ")}async function Ml(t){await Cn,Ge!=null&&Ge.global_import_save&&Ge.global_import_save(t)}async function Tl(){return await Cn,Ge!=null&&Ge.global_export_save?JSON.parse(Ge.global_export_save()):{type:"error",content:""}}async function xe(t){await Cn,Ge!=null&&Ge.eventloop?Ge.eventloop(t):f("[Glue] eventloop ")}const _m={__name:"DrawScreen",emits:["draw"],setup(t,{expose:e,emit:s}){e();const n=s,o=F(!1),r=F(!0),i=F(!1),a=F(""),l=F(""),c=F(""),u=F({left:0,top:0,width:0,height:0}),d=F(!1),p=F(!1),m=F(!1),g=F("");function y(M){g.value=M||"",m.value=!0,setTimeout(()=>{m.value=!1},1800)}async function S(){try{const T=await Wn(),x=Number((T==null?void 0:T.SpiritalSpark)??0);r.value=x>=10}catch{r.value=!1}}function E(){i.value=!1,d.value=!1,p.value=!1}function I(){if(o.value)return;if(S(),!r.value){y("");return}o.value=!0,f("[DrawScreen] runDrawSequence start");const M=document.querySelector(".draw-card");if(M){M.classList.add("is-shaking"),setTimeout(()=>M.classList.remove("is-shaking"),500);const T=M.getBoundingClientRect();u.value={left:Math.round(T.left),top:Math.round(T.top),width:Math.round(T.width),height:Math.round(T.height)}}setTimeout(async()=>{i.value=!0,d.value=!1,p.value=!0;try{const T=await bl();if(T&&T.type==="success"&&T.copper&&T.copper.copper_info){const x=T.copper.copper_info;a.value=x.name||"",l.value="",c.value=H(x.icon_url||""),f("[DrawScreen] tempImage resolved:",c.value),await vn(),setTimeout(()=>{p.value=!1,setTimeout(()=>{d.value=!0},350)},450),n("draw",{name:x.name,image:x.icon_url||""}),S()}else T&&T.type==="error"&&(i.value=!1,d.value=!1,p.value=!1,y(T.content||""),n("draw",{error:!0}),S())}catch{i.value=!1,d.value=!1,p.value=!1,y(""),n("draw",{error:!0}),S()}finally{setTimeout(()=>{o.value=!1},800)}},600)}const R={emit:n,isDrawing:o,canDraw:r,showTempCard:i,tempName:a,tempIcon:l,tempImage:c,tempRect:u,infoVisible:d,cardFlipped:p,toastVisible:m,toastText:g,showToast:y,refreshCanDraw:S,onCloseResult:E,runDrawSequence:I,get log(){return f},ref:F,nextTick:vn,get getAssetUrl(){return H},get gacha(){return bl},get get_resource(){return Wn}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},ym={class:"draw-screen"},vm={class:"draw-screen__body"},bm={class:"draw-card"},wm={class:"card-face card-back"},Sm=["src"],Mm={class:"card-face card-front"},Tm=["src"],Cm={key:1,class:"card-icon"},Em=["src"],xm={class:"draw-cost"},Am=["src"],km=["disabled","title"],Rm={key:0,class:"toast"};function Pm(t,e,s,n,o,r){return $(),B("div",ym,[h("div",vm,[h("div",bm,[n.showTempCard?($(),B("div",{key:0,class:"draw-temp",onClick:n.onCloseResult},[e[3]||(e[3]=h("div",{class:"dim-backdrop"},null,-1)),h("div",{class:"temp-stack",style:Xt({left:n.tempRect.left+"px",top:n.tempRect.top+"px",width:n.tempRect.width+"px",height:n.tempRect.height+"px"}),onClick:e[2]||(e[2]=Ln(()=>{},["stop"]))},[h("div",{class:nt(["card",{flipped:n.cardFlipped}]),onClick:e[0]||(e[0]=Ln(i=>n.cardFlipped=!n.cardFlipped,["stop"]))},[h("div",wm,[h("img",{src:n.getAssetUrl("frontend_resource/gacha.webp"),alt:"back"},null,8,Sm)]),h("div",Mm,[n.tempImage?($(),B("img",{key:0,src:n.tempImage,alt:"copper",class:"card-front-img"},null,8,Tm)):($(),B("div",Cm,te(n.tempIcon||""),1))])],2),h("div",{class:nt(["card-name-below",{show:n.infoVisible}]),onClick:e[1]||(e[1]=Ln(()=>{},["stop"]))},te(n.tempName),3)],4)])):we("",!0),h("img",{class:"draw-card__img",src:n.getAssetUrl("frontend_resource/gacha.webp"),alt:"card"},null,8,Em)]),h("div",xm,[h("img",{class:"draw-cost__icon",src:n.getAssetUrl("resource/spiritual_spark.webp"),alt:"cost"},null,8,Am),e[4]||(e[4]=h("span",{class:"draw-cost__times"},"X 10",-1))]),h("button",{class:"draw-action",disabled:n.isDrawing||!n.canDraw,title:n.canDraw?"":"",onClick:n.runDrawSequence},"  ",8,km),n.toastVisible?($(),B("div",Rm,te(n.toastText),1)):we("",!0)])])}const Im=St(_m,[["render",Pm],["__scopeId","data-v-0c4022d9"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/DrawScreen.vue"]]);function Cl(t,e){if(e===od)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===ei||e===Ql){let s=t.getIndex();if(s===null){const i=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)i.push(l);t.setIndex(i),s=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const n=s.count-2,o=[];if(e===ei)for(let i=1;i<=n;i++)o.push(s.getX(0)),o.push(s.getX(i)),o.push(s.getX(i+1));else for(let i=0;i<n;i++)i%2===0?(o.push(s.getX(i)),o.push(s.getX(i+1)),o.push(s.getX(i+2))):(o.push(s.getX(i+2)),o.push(s.getX(i+1)),o.push(s.getX(i)));o.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=t.clone();return r.setIndex(o),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class hs extends ec{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(s){return new $m(s)}),this.register(function(s){return new Gm(s)}),this.register(function(s){return new qm(s)}),this.register(function(s){return new Km(s)}),this.register(function(s){return new Xm(s)}),this.register(function(s){return new Um(s)}),this.register(function(s){return new Fm(s)}),this.register(function(s){return new jm(s)}),this.register(function(s){return new Bm(s)}),this.register(function(s){return new Nm(s)}),this.register(function(s){return new zm(s)}),this.register(function(s){return new Hm(s)}),this.register(function(s){return new Wm(s)}),this.register(function(s){return new Vm(s)}),this.register(function(s){return new Om(s)}),this.register(function(s){return new Ym(s)}),this.register(function(s){return new Jm(s)})}load(e,s,n,o){const r=this;let i;if(this.resourcePath!=="")i=this.resourcePath;else if(this.path!==""){const c=Ys.extractUrlBase(e);i=Ys.resolveURL(c,this.path)}else i=Ys.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){o?o(c):console.error(c),r.manager.itemError(e),r.manager.itemEnd(e)},l=new Uo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{r.parse(c,i,function(u){s(u),r.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,s,n,o){let r;const i={},a={},l=new TextDecoder;if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===Hu){try{i[Fe.KHR_BINARY_GLTF]=new Zm(e)}catch(d){o&&o(d);return}r=JSON.parse(i[Fe.KHR_BINARY_GLTF].content)}else r=JSON.parse(l.decode(e));else r=e;if(r.asset===void 0||r.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new dg(r,{path:s||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,i[d.name]=!0}if(r.extensionsUsed)for(let u=0;u<r.extensionsUsed.length;++u){const d=r.extensionsUsed[u],p=r.extensionsRequired||[];switch(d){case Fe.KHR_MATERIALS_UNLIT:i[d]=new Dm;break;case Fe.KHR_DRACO_MESH_COMPRESSION:i[d]=new Qm(r,this.dracoLoader);break;case Fe.KHR_TEXTURE_TRANSFORM:i[d]=new eg;break;case Fe.KHR_MESH_QUANTIZATION:i[d]=new tg;break;default:p.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(i),c.setPlugins(a),c.parse(n,o)}parseAsync(e,s){const n=this;return new Promise(function(o,r){n.parse(e,s,o,r)})}}function Lm(){let t={};return{get:function(e){return t[e]},add:function(e,s){t[e]=s},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const Fe={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Om{constructor(e){this.parser=e,this.name=Fe.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,s=this.parser.json.nodes||[];for(let n=0,o=s.length;n<o;n++){const r=s[n];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const s=this.parser,n="light:"+e;let o=s.cache.get(n);if(o)return o;const r=s.json,l=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const u=new rn(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],wn);const d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new _n(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Ts(u),c.distance=d;break;case"spot":c=new rd(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),pn(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=s.createUniqueName(l.name||"light_"+e),o=Promise.resolve(c),s.cache.add(n,o),o}getDependency(e,s){if(e==="light")return this._loadLight(s)}createNodeAttachment(e){const s=this,n=this.parser,r=n.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(s.cache,a,l)})}}class Dm{constructor(){this.name=Fe.KHR_MATERIALS_UNLIT}getMaterialType(){return bt}extendParams(e,s,n){const o=[];e.color=new rn(1,1,1),e.opacity=1;const r=s.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const i=r.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],wn),e.opacity=i[3]}r.baseColorTexture!==void 0&&o.push(n.assignTexture(e,"map",r.baseColorTexture,Pt))}return Promise.all(o)}}class Nm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=o.extensions[this.name].emissiveStrength;return r!==void 0&&(s.emissiveIntensity=r),Promise.resolve()}}class $m{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];if(i.clearcoatFactor!==void 0&&(s.clearcoat=i.clearcoatFactor),i.clearcoatTexture!==void 0&&r.push(n.assignTexture(s,"clearcoatMap",i.clearcoatTexture)),i.clearcoatRoughnessFactor!==void 0&&(s.clearcoatRoughness=i.clearcoatRoughnessFactor),i.clearcoatRoughnessTexture!==void 0&&r.push(n.assignTexture(s,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),i.clearcoatNormalTexture!==void 0&&(r.push(n.assignTexture(s,"clearcoatNormalMap",i.clearcoatNormalTexture)),i.clearcoatNormalTexture.scale!==void 0)){const a=i.clearcoatNormalTexture.scale;s.clearcoatNormalScale=new Lt(a,a)}return Promise.all(r)}}class Gm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=o.extensions[this.name];return s.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Hm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];return i.iridescenceFactor!==void 0&&(s.iridescence=i.iridescenceFactor),i.iridescenceTexture!==void 0&&r.push(n.assignTexture(s,"iridescenceMap",i.iridescenceTexture)),i.iridescenceIor!==void 0&&(s.iridescenceIOR=i.iridescenceIor),s.iridescenceThicknessRange===void 0&&(s.iridescenceThicknessRange=[100,400]),i.iridescenceThicknessMinimum!==void 0&&(s.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),i.iridescenceThicknessMaximum!==void 0&&(s.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),i.iridescenceThicknessTexture!==void 0&&r.push(n.assignTexture(s,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(r)}}class Um{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[];s.sheenColor=new rn(0,0,0),s.sheenRoughness=0,s.sheen=1;const i=o.extensions[this.name];if(i.sheenColorFactor!==void 0){const a=i.sheenColorFactor;s.sheenColor.setRGB(a[0],a[1],a[2],wn)}return i.sheenRoughnessFactor!==void 0&&(s.sheenRoughness=i.sheenRoughnessFactor),i.sheenColorTexture!==void 0&&r.push(n.assignTexture(s,"sheenColorMap",i.sheenColorTexture,Pt)),i.sheenRoughnessTexture!==void 0&&r.push(n.assignTexture(s,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(r)}}class Fm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];return i.transmissionFactor!==void 0&&(s.transmission=i.transmissionFactor),i.transmissionTexture!==void 0&&r.push(n.assignTexture(s,"transmissionMap",i.transmissionTexture)),Promise.all(r)}}class jm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];s.thickness=i.thicknessFactor!==void 0?i.thicknessFactor:0,i.thicknessTexture!==void 0&&r.push(n.assignTexture(s,"thicknessMap",i.thicknessTexture)),s.attenuationDistance=i.attenuationDistance||1/0;const a=i.attenuationColor||[1,1,1];return s.attenuationColor=new rn().setRGB(a[0],a[1],a[2],wn),Promise.all(r)}}class Bm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=o.extensions[this.name];return s.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class zm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];s.specularIntensity=i.specularFactor!==void 0?i.specularFactor:1,i.specularTexture!==void 0&&r.push(n.assignTexture(s,"specularIntensityMap",i.specularTexture));const a=i.specularColorFactor||[1,1,1];return s.specularColor=new rn().setRGB(a[0],a[1],a[2],wn),i.specularColorTexture!==void 0&&r.push(n.assignTexture(s,"specularColorMap",i.specularColorTexture,Pt)),Promise.all(r)}}class Vm{constructor(e){this.parser=e,this.name=Fe.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];return s.bumpScale=i.bumpFactor!==void 0?i.bumpFactor:1,i.bumpTexture!==void 0&&r.push(n.assignTexture(s,"bumpMap",i.bumpTexture)),Promise.all(r)}}class Wm{constructor(e){this.parser=e,this.name=Fe.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Tn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const r=[],i=o.extensions[this.name];return i.anisotropyStrength!==void 0&&(s.anisotropy=i.anisotropyStrength),i.anisotropyRotation!==void 0&&(s.anisotropyRotation=i.anisotropyRotation),i.anisotropyTexture!==void 0&&r.push(n.assignTexture(s,"anisotropyMap",i.anisotropyTexture)),Promise.all(r)}}class qm{constructor(e){this.parser=e,this.name=Fe.KHR_TEXTURE_BASISU}loadTexture(e){const s=this.parser,n=s.json,o=n.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const r=o.extensions[this.name],i=s.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return s.loadTextureImage(e,r.source,i)}}class Km{constructor(e){this.parser=e,this.name=Fe.EXT_TEXTURE_WEBP}loadTexture(e){const s=this.name,n=this.parser,o=n.json,r=o.textures[e];if(!r.extensions||!r.extensions[s])return null;const i=r.extensions[s],a=o.images[i.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return n.loadTextureImage(e,i.source,l)}}class Xm{constructor(e){this.parser=e,this.name=Fe.EXT_TEXTURE_AVIF}loadTexture(e){const s=this.name,n=this.parser,o=n.json,r=o.textures[e];if(!r.extensions||!r.extensions[s])return null;const i=r.extensions[s],a=o.images[i.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return n.loadTextureImage(e,i.source,l)}}class Ym{constructor(e){this.name=Fe.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const s=this.parser.json,n=s.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const o=n.extensions[this.name],r=this.parser.getDependency("buffer",o.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(a){const l=o.byteOffset||0,c=o.byteLength||0,u=o.count,d=o.byteStride,p=new Uint8Array(a,l,c);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(u,d,p,o.mode,o.filter).then(function(m){return m.buffer}):i.ready.then(function(){const m=new ArrayBuffer(u*d);return i.decodeGltfBuffer(new Uint8Array(m),u,d,p,o.mode,o.filter),m})})}else return null}}class Jm{constructor(e){this.name=Fe.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const s=this.parser.json,n=s.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const o=s.meshes[n.mesh];for(const c of o.primitives)if(c.mode!==Kt.TRIANGLES&&c.mode!==Kt.TRIANGLE_STRIP&&c.mode!==Kt.TRIANGLE_FAN&&c.mode!==void 0)return null;const i=n.extensions[this.name].attributes,a=[],l={};for(const c in i)a.push(this.parser.getDependency("accessor",i[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],p=c[0].count,m=[];for(const g of d){const y=new rs,S=new Re,E=new Os,I=new Re(1,1,1),R=new tc(g.geometry,g.material,p);for(let M=0;M<p;M++)l.TRANSLATION&&S.fromBufferAttribute(l.TRANSLATION,M),l.ROTATION&&E.fromBufferAttribute(l.ROTATION,M),l.SCALE&&I.fromBufferAttribute(l.SCALE,M),R.setMatrixAt(M,y.compose(S,E,I));for(const M in l)if(M==="_COLOR_0"){const T=l[M];R.instanceColor=new id(T.array,T.itemSize,T.normalized)}else M!=="TRANSLATION"&&M!=="ROTATION"&&M!=="SCALE"&&g.geometry.setAttribute(M,l[M]);nc.prototype.copy.call(R,g),this.parser.assignFinalMaterial(R),m.push(R)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const Hu="glTF",qs=12,El={JSON:1313821514,BIN:5130562};class Zm{constructor(e){this.name=Fe.KHR_BINARY_GLTF,this.content=null,this.body=null;const s=new DataView(e,0,qs),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==Hu)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-qs,r=new DataView(e,qs);let i=0;for(;i<o;){const a=r.getUint32(i,!0);i+=4;const l=r.getUint32(i,!0);if(i+=4,l===El.JSON){const c=new Uint8Array(e,qs+i,a);this.content=n.decode(c)}else if(l===El.BIN){const c=qs+i;this.body=e.slice(c,c+a)}i+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Qm{constructor(e,s){if(!s)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Fe.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=s,this.dracoLoader.preload()}decodePrimitive(e,s){const n=this.json,o=this.dracoLoader,r=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,a={},l={},c={};for(const u in i){const d=Ti[u]||u.toLowerCase();a[d]=i[u]}for(const u in e.attributes){const d=Ti[u]||u.toLowerCase();if(i[u]!==void 0){const p=n.accessors[e.attributes[u]],m=Ls[p.componentType];c[d]=m.name,l[d]=p.normalized===!0}}return s.getDependency("bufferView",r).then(function(u){return new Promise(function(d,p){o.decodeDracoFile(u,function(m){for(const g in m.attributes){const y=m.attributes[g],S=l[g];S!==void 0&&(y.normalized=S)}d(m)},a,c,wn,p)})})}}class eg{constructor(){this.name=Fe.KHR_TEXTURE_TRANSFORM}extendTexture(e,s){return(s.texCoord===void 0||s.texCoord===e.channel)&&s.offset===void 0&&s.rotation===void 0&&s.scale===void 0||(e=e.clone(),s.texCoord!==void 0&&(e.channel=s.texCoord),s.offset!==void 0&&e.offset.fromArray(s.offset),s.rotation!==void 0&&(e.rotation=s.rotation),s.scale!==void 0&&e.repeat.fromArray(s.scale),e.needsUpdate=!0),e}}class tg{constructor(){this.name=Fe.KHR_MESH_QUANTIZATION}}class Uu extends kd{constructor(e,s,n,o){super(e,s,n,o)}copySampleValue_(e){const s=this.resultBuffer,n=this.sampleValues,o=this.valueSize,r=e*o*3+o;for(let i=0;i!==o;i++)s[i]=n[r+i];return s}interpolate_(e,s,n,o){const r=this.resultBuffer,i=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=o-s,d=(n-s)/u,p=d*d,m=p*d,g=e*c,y=g-c,S=-2*m+3*p,E=m-p,I=1-S,R=E-p+d;for(let M=0;M!==a;M++){const T=i[y+M+a],x=i[y+M+l]*u,j=i[g+M+a],V=i[g+M]*u;r[M]=I*T+R*x+S*j+E*V}return r}}const ng=new Os;class sg extends Uu{interpolate_(e,s,n,o){const r=super.interpolate_(e,s,n,o);return ng.fromArray(r).normalize().toArray(r),r}}const Kt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ls={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},xl={9728:oc,9729:ti,9984:dd,9985:ud,9986:cd,9987:sc},Al={33071:pd,33648:fd,10497:Dn},Vr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ti={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Hn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},og={CUBICSPLINE:void 0,LINEAR:ac,STEP:Ed},Wr={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function rg(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new vt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ad})),t.DefaultMaterial}function es(t,e,s){for(const n in s.extensions)t[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=s.extensions[n])}function pn(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ig(t,e,s){let n=!1,o=!1,r=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(o=!0),d.COLOR_0!==void 0&&(r=!0),n&&o&&r)break}if(!n&&!o&&!r)return Promise.resolve(t);const i=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(n){const p=d.POSITION!==void 0?s.getDependency("accessor",d.POSITION):t.attributes.position;i.push(p)}if(o){const p=d.NORMAL!==void 0?s.getDependency("accessor",d.NORMAL):t.attributes.normal;a.push(p)}if(r){const p=d.COLOR_0!==void 0?s.getDependency("accessor",d.COLOR_0):t.attributes.color;l.push(p)}}return Promise.all([Promise.all(i),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],p=c[2];return n&&(t.morphAttributes.position=u),o&&(t.morphAttributes.normal=d),r&&(t.morphAttributes.color=p),t.morphTargetsRelative=!0,t})}function ag(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let s=0,n=e.weights.length;s<n;s++)t.morphTargetInfluences[s]=e.weights[s];if(e.extras&&Array.isArray(e.extras.targetNames)){const s=e.extras.targetNames;if(t.morphTargetInfluences.length===s.length){t.morphTargetDictionary={};for(let n=0,o=s.length;n<o;n++)t.morphTargetDictionary[s[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function lg(t){let e;const s=t.extensions&&t.extensions[Fe.KHR_DRACO_MESH_COMPRESSION];if(s?e="draco:"+s.bufferView+":"+s.indices+":"+qr(s.attributes):e=t.indices+":"+qr(t.attributes)+":"+t.mode,t.targets!==void 0)for(let n=0,o=t.targets.length;n<o;n++)e+=":"+qr(t.targets[n]);return e}function qr(t){let e="";const s=Object.keys(t).sort();for(let n=0,o=s.length;n<o;n++)e+=s[n]+":"+t[s[n]]+";";return e}function Ci(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function cg(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":t.search(/\.ktx2($|\?)/i)>0||t.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const ug=new rs;class dg{constructor(e={},s={}){this.json=e,this.extensions={},this.plugins={},this.options=s,this.cache=new Lm,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,o=-1,r=!1,i=-1;if(typeof navigator<"u"){const a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);o=n&&l?parseInt(l[1],10):-1,r=a.indexOf("Firefox")>-1,i=r?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&o<17||r&&i<98?this.textureLoader=new Ds(this.options.manager):this.textureLoader=new ad(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Uo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,s){const n=this,o=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(i){return i._markDefs&&i._markDefs()}),Promise.all(this._invokeAll(function(i){return i.beforeRoot&&i.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(i){const a={scene:i[0][o.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:o.asset,parser:n,userData:{}};return es(r,a,o),pn(a,o),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(s)}_markDefs(){const e=this.json.nodes||[],s=this.json.skins||[],n=this.json.meshes||[];for(let o=0,r=s.length;o<r;o++){const i=s[o].joints;for(let a=0,l=i.length;a<l;a++)e[i[a]].isBone=!0}for(let o=0,r=e.length;o<r;o++){const i=e[o];i.mesh!==void 0&&(this._addNodeRef(this.meshCache,i.mesh),i.skin!==void 0&&(n[i.mesh].isSkinnedMesh=!0)),i.camera!==void 0&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,s){s!==void 0&&(e.refs[s]===void 0&&(e.refs[s]=e.uses[s]=0),e.refs[s]++)}_getNodeRef(e,s,n){if(e.refs[s]<=1)return n;const o=n.clone(),r=(i,a)=>{const l=this.associations.get(i);l!=null&&this.associations.set(a,l);for(const[c,u]of i.children.entries())r(u,a.children[c])};return r(n,o),o.name+="_instance_"+e.uses[s]++,o}_invokeOne(e){const s=Object.values(this.plugins);s.push(this);for(let n=0;n<s.length;n++){const o=e(s[n]);if(o)return o}return null}_invokeAll(e){const s=Object.values(this.plugins);s.unshift(this);const n=[];for(let o=0;o<s.length;o++){const r=e(s[o]);r&&n.push(r)}return n}getDependency(e,s){const n=e+":"+s;let o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(s);break;case"node":o=this._invokeOne(function(r){return r.loadNode&&r.loadNode(s)});break;case"mesh":o=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(s)});break;case"accessor":o=this.loadAccessor(s);break;case"bufferView":o=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(s)});break;case"buffer":o=this.loadBuffer(s);break;case"material":o=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(s)});break;case"texture":o=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(s)});break;case"skin":o=this.loadSkin(s);break;case"animation":o=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(s)});break;case"camera":o=this.loadCamera(s);break;default:if(o=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,s)}),!o)throw new Error("Unknown type: "+e);break}this.cache.add(n,o)}return o}getDependencies(e){let s=this.cache.get(e);if(!s){const n=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];s=Promise.all(o.map(function(r,i){return n.getDependency(e,i)})),this.cache.add(e,s)}return s}loadBuffer(e){const s=this.json.buffers[e],n=this.fileLoader;if(s.type&&s.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+s.type+" buffer type is not supported.");if(s.uri===void 0&&e===0)return Promise.resolve(this.extensions[Fe.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(r,i){n.load(Ys.resolveURL(s.uri,o.path),r,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+s.uri+'".'))})})}loadBufferView(e){const s=this.json.bufferViews[e];return this.getDependency("buffer",s.buffer).then(function(n){const o=s.byteLength||0,r=s.byteOffset||0;return n.slice(r,r+o)})}loadAccessor(e){const s=this,n=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0){const i=Vr[o.type],a=Ls[o.componentType],l=o.normalized===!0,c=new a(o.count*i);return Promise.resolve(new Js(c,i,l))}const r=[];return o.bufferView!==void 0?r.push(this.getDependency("bufferView",o.bufferView)):r.push(null),o.sparse!==void 0&&(r.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(r).then(function(i){const a=i[0],l=Vr[o.type],c=Ls[o.componentType],u=c.BYTES_PER_ELEMENT,d=u*l,p=o.byteOffset||0,m=o.bufferView!==void 0?n.bufferViews[o.bufferView].byteStride:void 0,g=o.normalized===!0;let y,S;if(m&&m!==d){const E=Math.floor(p/m),I="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+E+":"+o.count;let R=s.cache.get(I);R||(y=new c(a,E*m,o.count*m/u),R=new ld(y,m/u),s.cache.add(I,R)),S=new xd(R,l,p%m/u,g)}else a===null?y=new c(o.count*l):y=new c(a,p,o.count*l),S=new Js(y,l,g);if(o.sparse!==void 0){const E=Vr.SCALAR,I=Ls[o.sparse.indices.componentType],R=o.sparse.indices.byteOffset||0,M=o.sparse.values.byteOffset||0,T=new I(i[1],R,o.sparse.count*E),x=new c(i[2],M,o.sparse.count*l);a!==null&&(S=new Js(S.array.slice(),S.itemSize,S.normalized)),S.normalized=!1;for(let j=0,V=T.length;j<V;j++){const G=T[j];if(S.setX(G,x[j*l]),l>=2&&S.setY(G,x[j*l+1]),l>=3&&S.setZ(G,x[j*l+2]),l>=4&&S.setW(G,x[j*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}S.normalized=g}return S})}loadTexture(e){const s=this.json,n=this.options,r=s.textures[e].source,i=s.images[r];let a=this.textureLoader;if(i.uri){const l=n.manager.getHandler(i.uri);l!==null&&(a=l)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,s,n){const o=this,r=this.json,i=r.textures[e],a=r.images[s],l=(a.uri||a.bufferView)+":"+i.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(s,n).then(function(u){u.flipY=!1,u.name=i.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const p=(r.samplers||{})[i.sampler]||{};return u.magFilter=xl[p.magFilter]||ti,u.minFilter=xl[p.minFilter]||sc,u.wrapS=Al[p.wrapS]||Dn,u.wrapT=Al[p.wrapT]||Dn,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==oc&&u.minFilter!==ti,o.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,s){const n=this,o=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const i=o.images[e],a=self.URL||self.webkitURL;let l=i.uri||"",c=!1;if(i.bufferView!==void 0)l=n.getDependency("bufferView",i.bufferView).then(function(d){c=!0;const p=new Blob([d],{type:i.mimeType});return l=a.createObjectURL(p),l});else if(i.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(p,m){let g=p;s.isImageBitmapLoader===!0&&(g=function(y){const S=new ya(y);S.needsUpdate=!0,p(S)}),s.load(Ys.resolveURL(d,r.path),g,void 0,m)})}).then(function(d){return c===!0&&a.revokeObjectURL(l),pn(d,i),d.userData.mimeType=i.mimeType||cg(i.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,s,n,o){const r=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(i=i.clone(),i.channel=n.texCoord),r.extensions[Fe.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[Fe.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=r.associations.get(i);i=r.extensions[Fe.KHR_TEXTURE_TRANSFORM].extendTexture(i,a),r.associations.set(i,l)}}return o!==void 0&&(i.colorSpace=o),e[s]=i,i})}assignFinalMaterial(e){const s=e.geometry;let n=e.material;const o=s.attributes.tangent===void 0,r=s.attributes.color!==void 0,i=s.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new hd,Pr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new md,Pr.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(o||r||i){let a="ClonedMaterial:"+n.uuid+":";o&&(a+="derivative-tangents:"),r&&(a+="vertex-colors:"),i&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),r&&(l.vertexColors=!0),i&&(l.flatShading=!0),o&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return vt}loadMaterial(e){const s=this,n=this.json,o=this.extensions,r=n.materials[e];let i;const a={},l=r.extensions||{},c=[];if(l[Fe.KHR_MATERIALS_UNLIT]){const d=o[Fe.KHR_MATERIALS_UNLIT];i=d.getMaterialType(),c.push(d.extendParams(a,r,s))}else{const d=r.pbrMetallicRoughness||{};if(a.color=new rn(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const p=d.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],wn),a.opacity=p[3]}d.baseColorTexture!==void 0&&c.push(s.assignTexture(a,"map",d.baseColorTexture,Pt)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(s.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(s.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),i=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}r.doubleSided===!0&&(a.side=zt);const u=r.alphaMode||Wr.OPAQUE;if(u===Wr.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Wr.MASK&&(a.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&i!==bt&&(c.push(s.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new Lt(1,1),r.normalTexture.scale!==void 0)){const d=r.normalTexture.scale;a.normalScale.set(d,d)}if(r.occlusionTexture!==void 0&&i!==bt&&(c.push(s.assignTexture(a,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&i!==bt){const d=r.emissiveFactor;a.emissive=new rn().setRGB(d[0],d[1],d[2],wn)}return r.emissiveTexture!==void 0&&i!==bt&&c.push(s.assignTexture(a,"emissiveMap",r.emissiveTexture,Pt)),Promise.all(c).then(function(){const d=new i(a);return r.name&&(d.name=r.name),pn(d,r),s.associations.set(d,{materials:e}),r.extensions&&es(o,d,r),d})}createUniqueName(e){const s=gd.sanitizeNodeName(e||"");return s in this.nodeNamesUsed?s+"_"+ ++this.nodeNamesUsed[s]:(this.nodeNamesUsed[s]=0,s)}loadGeometries(e){const s=this,n=this.extensions,o=this.primitiveCache;function r(a){return n[Fe.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,s).then(function(l){return kl(l,a,s)})}const i=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=lg(c),d=o[u];if(d)i.push(d.promise);else{let p;c.extensions&&c.extensions[Fe.KHR_DRACO_MESH_COMPRESSION]?p=r(c):p=kl(new rc,c,s),o[u]={primitive:c,promise:p},i.push(p)}}return Promise.all(i)}loadMesh(e){const s=this,n=this.json,o=this.extensions,r=n.meshes[e],i=r.primitives,a=[];for(let l=0,c=i.length;l<c;l++){const u=i[l].material===void 0?rg(this.cache):this.getDependency("material",i[l].material);a.push(u)}return a.push(s.loadGeometries(i)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let m=0,g=u.length;m<g;m++){const y=u[m],S=i[m];let E;const I=c[m];if(S.mode===Kt.TRIANGLES||S.mode===Kt.TRIANGLE_STRIP||S.mode===Kt.TRIANGLE_FAN||S.mode===void 0)E=r.isSkinnedMesh===!0?new _d(y,I):new lt(y,I),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),S.mode===Kt.TRIANGLE_STRIP?E.geometry=Cl(E.geometry,Ql):S.mode===Kt.TRIANGLE_FAN&&(E.geometry=Cl(E.geometry,ei));else if(S.mode===Kt.LINES)E=new yd(y,I);else if(S.mode===Kt.LINE_STRIP)E=new vd(y,I);else if(S.mode===Kt.LINE_LOOP)E=new bd(y,I);else if(S.mode===Kt.POINTS)E=new wd(y,I);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(E.geometry.morphAttributes).length>0&&ag(E,r),E.name=s.createUniqueName(r.name||"mesh_"+e),pn(E,r),S.extensions&&es(o,E,S),s.assignFinalMaterial(E),d.push(E)}for(let m=0,g=d.length;m<g;m++)s.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return r.extensions&&es(o,d[0],r),d[0];const p=new en;r.extensions&&es(o,p,r),s.associations.set(p,{meshes:e});for(let m=0,g=d.length;m<g;m++)p.add(d[m]);return p})}loadCamera(e){let s;const n=this.json.cameras[e],o=n[n.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?s=new mo(ic.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):n.type==="orthographic"&&(s=new Sd(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),n.name&&(s.name=this.createUniqueName(n.name)),pn(s,n),Promise.resolve(s)}loadSkin(e){const s=this.json.skins[e],n=[];for(let o=0,r=s.joints.length;o<r;o++)n.push(this._loadNodeShallow(s.joints[o]));return s.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",s.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(o){const r=o.pop(),i=o,a=[],l=[];for(let c=0,u=i.length;c<u;c++){const d=i[c];if(d){a.push(d);const p=new rs;r!==null&&p.fromArray(r.array,c*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[c])}return new Md(a,l)})}loadAnimation(e){const s=this.json,n=this,o=s.animations[e],r=o.name?o.name:"animation_"+e,i=[],a=[],l=[],c=[],u=[];for(let d=0,p=o.channels.length;d<p;d++){const m=o.channels[d],g=o.samplers[m.sampler],y=m.target,S=y.node,E=o.parameters!==void 0?o.parameters[g.input]:g.input,I=o.parameters!==void 0?o.parameters[g.output]:g.output;y.node!==void 0&&(i.push(this.getDependency("node",S)),a.push(this.getDependency("accessor",E)),l.push(this.getDependency("accessor",I)),c.push(g),u.push(y))}return Promise.all([Promise.all(i),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const p=d[0],m=d[1],g=d[2],y=d[3],S=d[4],E=[];for(let R=0,M=p.length;R<M;R++){const T=p[R],x=m[R],j=g[R],V=y[R],G=S[R];if(T===void 0)continue;T.updateMatrix&&T.updateMatrix();const J=n._createAnimationTracks(T,x,j,V,G);if(J)for(let Q=0;Q<J.length;Q++)E.push(J[Q])}const I=new Td(r,void 0,E);return pn(I,o),I})}createNodeMesh(e){const s=this.json,n=this,o=s.nodes[e];return o.mesh===void 0?null:n.getDependency("mesh",o.mesh).then(function(r){const i=n._getNodeRef(n.meshCache,o.mesh,r);return o.weights!==void 0&&i.traverse(function(a){if(a.isMesh)for(let l=0,c=o.weights.length;l<c;l++)a.morphTargetInfluences[l]=o.weights[l]}),i})}loadNode(e){const s=this.json,n=this,o=s.nodes[e],r=n._loadNodeShallow(e),i=[],a=o.children||[];for(let c=0,u=a.length;c<u;c++)i.push(n.getDependency("node",a[c]));const l=o.skin===void 0?Promise.resolve(null):n.getDependency("skin",o.skin);return Promise.all([r,Promise.all(i),l]).then(function(c){const u=c[0],d=c[1],p=c[2];p!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(p,ug)});for(let m=0,g=d.length;m<g;m++)u.add(d[m]);return u})}_loadNodeShallow(e){const s=this.json,n=this.extensions,o=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=s.nodes[e],i=r.name?o.createUniqueName(r.name):"",a=[],l=o._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),r.camera!==void 0&&a.push(o.getDependency("camera",r.camera).then(function(c){return o._getNodeRef(o.cameraCache,r.camera,c)})),o._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(r.isBone===!0?u=new Cd:c.length>1?u=new en:c.length===1?u=c[0]:u=new nc,u!==c[0])for(let d=0,p=c.length;d<p;d++)u.add(c[d]);if(r.name&&(u.userData.name=r.name,u.name=i),pn(u,r),r.extensions&&es(n,u,r),r.matrix!==void 0){const d=new rs;d.fromArray(r.matrix),u.applyMatrix4(d)}else r.translation!==void 0&&u.position.fromArray(r.translation),r.rotation!==void 0&&u.quaternion.fromArray(r.rotation),r.scale!==void 0&&u.scale.fromArray(r.scale);if(!o.associations.has(u))o.associations.set(u,{});else if(r.mesh!==void 0&&o.meshCache.refs[r.mesh]>1){const d=o.associations.get(u);o.associations.set(u,{...d})}return o.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const s=this.extensions,n=this.json.scenes[e],o=this,r=new en;n.name&&(r.name=o.createUniqueName(n.name)),pn(r,n),n.extensions&&es(s,r,n);const i=n.nodes||[],a=[];for(let l=0,c=i.length;l<c;l++)a.push(o.getDependency("node",i[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)r.add(l[u]);const c=u=>{const d=new Map;for(const[p,m]of o.associations)(p instanceof Pr||p instanceof ya)&&d.set(p,m);return u.traverse(p=>{const m=o.associations.get(p);m!=null&&d.set(p,m)}),d};return o.associations=c(r),r})}_createAnimationTracks(e,s,n,o,r){const i=[],a=e.name?e.name:e.uuid,l=[];Hn[r.path]===Hn.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a);let c;switch(Hn[r.path]){case Hn.weights:c=ba;break;case Hn.rotation:c=wa;break;case Hn.translation:case Hn.scale:c=va;break;default:switch(n.itemSize){case 1:c=ba;break;case 2:case 3:default:c=va;break}break}const u=o.interpolation!==void 0?og[o.interpolation]:ac,d=this._getArrayFromAccessor(n);for(let p=0,m=l.length;p<m;p++){const g=new c(l[p]+"."+Hn[r.path],s.array,d,u);o.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),i.push(g)}return i}_getArrayFromAccessor(e){let s=e.array;if(e.normalized){const n=Ci(s.constructor),o=new Float32Array(s.length);for(let r=0,i=s.length;r<i;r++)o[r]=s[r]*n;s=o}return s}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const o=this instanceof wa?sg:Uu;return new o(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function fg(t,e,s){const n=e.attributes,o=new Dt;if(n.POSITION!==void 0){const a=s.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(o.set(new Re(l[0],l[1],l[2]),new Re(c[0],c[1],c[2])),a.normalized){const u=Ci(Ls[a.componentType]);o.min.multiplyScalar(u),o.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const a=new Re,l=new Re;for(let c=0,u=r.length;c<u;c++){const d=r[c];if(d.POSITION!==void 0){const p=s.json.accessors[d.POSITION],m=p.min,g=p.max;if(m!==void 0&&g!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),p.normalized){const y=Ci(Ls[p.componentType]);l.multiplyScalar(y)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(a)}t.boundingBox=o;const i=new Rd;o.getCenter(i.center),i.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=i}function kl(t,e,s){const n=e.attributes,o=[];function r(i,a){return s.getDependency("accessor",i).then(function(l){t.setAttribute(a,l)})}for(const i in n){const a=Ti[i]||i.toLowerCase();a in t.attributes||o.push(r(n[i],a))}if(e.indices!==void 0&&!t.index){const i=s.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});o.push(i)}return ni.workingColorSpace!==wn&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${ni.workingColorSpace}" not supported.`),pn(t,e),fg(t,e,s),Promise.all(o).then(function(){return e.targets!==void 0?ig(t,e.targets,s):t})}const Kr=new WeakMap;class ms extends ec{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,s,n,o){const r=new Uo(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,i=>{this.parse(i,s,o)},n,o)}parse(e,s,n=()=>{}){this.decodeDracoFile(e,s,null,null,Pt,n).catch(n)}decodeDracoFile(e,s,n,o,r=wn,i=()=>{}){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:r};return this.decodeGeometry(e,a).then(s).catch(i)}decodeGeometry(e,s){const n=JSON.stringify(s);if(Kr.has(e)){const l=Kr.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const r=this.workerNextTaskID++,i=e.byteLength,a=this._getWorker(r,i).then(l=>(o=l,new Promise((c,u)=>{o._callbacks[r]={resolve:c,reject:u},o.postMessage({type:"decode",id:r,taskConfig:s,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{o&&r&&this._releaseTask(o,r)}),Kr.set(e,{key:n,promise:a}),a}_createGeometry(e){const s=new rc;e.index&&s.setIndex(new Js(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n],r=o.name,i=o.array,a=o.itemSize,l=new Js(i,a);r==="color"&&(this._assignVertexColorSpace(l,o.vertexColorSpace),l.normalized=!(i instanceof Float32Array)),s.setAttribute(r,l)}return s}_assignVertexColorSpace(e,s){if(s!==Pt)return;const n=new rn;for(let o=0,r=e.count;o<r;o++)n.fromBufferAttribute(e,o),ni.colorSpaceToWorking(n,Pt),e.setXYZ(o,n.r,n.g,n.b)}_loadLibrary(e,s){const n=new Uo(this.manager);return n.setPath(this.decoderPath),n.setResponseType(s),n.setWithCredentials(this.withCredentials),new Promise((o,r)=>{n.load(e,o,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",s=[];return e?s.push(this._loadLibrary("draco_decoder.js","text")):(s.push(this._loadLibrary("draco_wasm_wrapper.js","text")),s.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(s).then(n=>{const o=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const r=pg.toString(),i=["/* draco decoder */",o,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,s){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const o=new Worker(this.workerSourceURL);o._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:this.decoderConfig}),o.onmessage=function(r){const i=r.data;switch(i.type){case"decode":o._callbacks[i.id].resolve(i);break;case"error":o._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,r){return o._taskLoad>r._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=s,n._taskLoad+=s,n})}_releaseTask(e,s){e._taskLoad-=e._taskCosts[s],delete e._callbacks[s],delete e._taskCosts[s]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function pg(){let t,e;onmessage=function(i){const a=i.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(u){t.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const d=u.draco,p=new d.Decoder;try{const m=s(d,p,new Int8Array(l),c),g=m.attributes.map(y=>y.array.buffer);m.index&&g.push(m.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:m},g)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}finally{d.destroy(p)}});break}};function s(i,a,l,c){const u=c.attributeIDs,d=c.attributeTypes;let p,m;const g=a.GetEncodedGeometryType(l);if(g===i.TRIANGULAR_MESH)p=new i.Mesh,m=a.DecodeArrayToMesh(l,l.byteLength,p);else if(g===i.POINT_CLOUD)p=new i.PointCloud,m=a.DecodeArrayToPointCloud(l,l.byteLength,p);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||p.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const y={index:null,attributes:[]};for(const S in u){const E=self[d[S]];let I,R;if(c.useUniqueIDs)R=u[S],I=a.GetAttributeByUniqueId(p,R);else{if(R=a.GetAttributeId(p,i[u[S]]),R===-1)continue;I=a.GetAttribute(p,R)}const M=o(i,a,p,S,E,I);S==="color"&&(M.vertexColorSpace=c.vertexColorSpace),y.attributes.push(M)}return g===i.TRIANGULAR_MESH&&(y.index=n(i,a,p)),i.destroy(p),y}function n(i,a,l){const u=l.num_faces()*3,d=u*4,p=i._malloc(d);a.GetTrianglesUInt32Array(l,d,p);const m=new Uint32Array(i.HEAPF32.buffer,p,u).slice();return i._free(p),{array:m,itemSize:1}}function o(i,a,l,c,u,d){const p=d.num_components(),g=l.num_points()*p,y=g*u.BYTES_PER_ELEMENT,S=r(i,u),E=i._malloc(y);a.GetAttributeDataArrayForAllPoints(l,d,S,y,E);const I=new u(i.HEAPF32.buffer,E,g).slice();return i._free(E),{name:c,array:I,itemSize:p}}function r(i,a){switch(a){case Float32Array:return i.DT_FLOAT32;case Int8Array:return i.DT_INT8;case Int16Array:return i.DT_INT16;case Int32Array:return i.DT_INT32;case Uint8Array:return i.DT_UINT8;case Uint16Array:return i.DT_UINT16;case Uint32Array:return i.DT_UINT32}}}class hg{constructor(){this.gltfCache=new Map,this.modelPool=new Map,this.instancedMeshes=new Map,this.gltfLoader=null,this.dracoLoader=null,this.maxCacheSize=50,this.maxInstancesPerModel=1e3,this.preloadStatus=new Map,this.preloadQueue=[],this.initLoaders()}initLoaders(){this.gltfLoader||(this.gltfLoader=new hs,this.gltfLoader.setCrossOrigin("anonymous"),this.dracoLoader=new ms,this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setCrossOrigin("anonymous"),this.gltfLoader.setDRACOLoader(this.dracoLoader),f("[ModelCache] GLTFDraco"))}async loadModel(e,s=!0){if(s&&this.modelPool.has(e)){const r=this.modelPool.get(e);return f(`[ModelCache] : ${e}`),r.clone(!0)}let n;if(this.gltfCache.has(e))f(`[ModelCache] GLTF: ${e}`),n=this.gltfCache.get(e);else try{const i=await(await Du(e)).arrayBuffer();f(`[ModelCache] GLTF: ${e}`),n=await new Promise((a,l)=>{this.gltfLoader.parse(i,"",c=>a(c),c=>l(c))}),this.cacheGLTF(e,n)}catch(r){throw f(`[ModelCache] : ${e}`,r),r}const o=n.scene.clone(!0);return s&&this.addToModelPool(e,o),o}async createInstancedMesh(e,s=100){if(this.instancedMeshes.has(e))return f(`[ModelCache] : ${e}`),this.instancedMeshes.get(e);const n=await this.loadModel(e,!0),o=[];if(n.traverse(l=>{l.isMesh&&o.push(l)}),o.length===0)throw new Error(`[ModelCache] : ${e}`);const r=o[0],i=new tc(r.geometry,r.material,s),a=new rs;for(let l=0;l<s;l++)a.setPosition(0,-1e3,0),i.setMatrixAt(l,a);return i.instanceMatrix.needsUpdate=!0,this.instancedMeshes.set(e,i),f(`[ModelCache] : ${e}, : ${s}`),i}updateInstancedMeshInstance(e,s,n,o,r){const i=this.instancedMeshes.get(e);if(!i){f(`[ModelCache] : ${e}`);return}if(s>=i.count){f(`[ModelCache] : ${s}/${i.count}`);return}const a=new rs;a.compose(n,new Os().setFromEuler(o),r),i.setMatrixAt(s,a),i.instanceMatrix.needsUpdate=!0}hideInstancedMeshInstance(e,s){const n=this.instancedMeshes.get(e);if(!n)return;const o=new rs;o.setPosition(0,-1e3,0),n.setMatrixAt(s,o),n.instanceMatrix.needsUpdate=!0}cacheGLTF(e,s){if(this.gltfCache.size>=this.maxCacheSize){const n=this.gltfCache.keys().next().value;this.gltfCache.delete(n),f(`[ModelCache] GLTF: ${n}`)}this.gltfCache.set(e,s),f(`[ModelCache] GLTF: ${e}`)}addToModelPool(e,s){if(this.modelPool.size>=this.maxCacheSize){const n=this.modelPool.keys().next().value,o=this.modelPool.get(n);this.disposeModel(o),this.modelPool.delete(n),f(`[ModelCache] : ${n}`)}this.modelPool.set(e,s),f(`[ModelCache] : ${e}`)}async preloadModels(e,s=null){f(`[ModelCache]  ${e.length} `);const n=e.length;let o=0;const r=e.filter(a=>{const l=this.preloadStatus.get(a);return!l||l==="failed"});f(`[ModelCache]  ${r.length} `);const i=3;for(let a=0;a<r.length;a+=i){const c=r.slice(a,a+i).map(async u=>{try{this.preloadStatus.set(u,"loading"),await this.loadModel(u,!0),this.preloadStatus.set(u,"loaded"),o++,s&&s(o,n,Math.round(o/n*100)),f(`[ModelCache] : ${u} (${o}/${n})`)}catch(d){f(`[ModelCache] : ${u}`,d),this.preloadStatus.set(u,"failed"),o++,s&&s(o,n,Math.round(o/n*100))}});await Promise.all(c),a+i<r.length&&await new Promise(u=>setTimeout(u,100))}f(`[ModelCache] : ${o}/${n} `)}isPreloaded(e){return this.preloadStatus.get(e)==="loaded"}getPreloadStatus(){const e={total:this.preloadStatus.size,loaded:0,loading:0,failed:0};for(const s of this.preloadStatus.values())e[s]++;return e}disposeModel(e){e&&e.traverse(s=>{s.isMesh&&(s.geometry&&s.geometry.dispose(),s.material&&(Array.isArray(s.material)?s.material.forEach(n=>{n.map&&n.map.dispose(),n.dispose&&n.dispose()}):(s.material.map&&s.material.map.dispose(),s.material.dispose&&s.material.dispose())))})}clearCache(){f("[ModelCache] ..."),this.modelPool.forEach(e=>{this.disposeModel(e)}),this.modelPool.clear(),this.instancedMeshes.forEach(e=>{this.disposeModel(e)}),this.instancedMeshes.clear(),this.gltfCache.clear(),this.preloadStatus.clear(),f("[ModelCache] ")}getCacheStatus(){return{gltfCacheSize:this.gltfCache.size,modelPoolSize:this.modelPool.size,instancedMeshesSize:this.instancedMeshes.size,preloadStatus:this.getPreloadStatus(),maxCacheSize:this.maxCacheSize,maxInstancesPerModel:this.maxInstancesPerModel,gltfLoaderInitialized:!!this.gltfLoader,dracoLoaderInitialized:!!this.dracoLoader}}updateConfig(e){e.maxCacheSize!==void 0&&(this.maxCacheSize=Math.max(10,e.maxCacheSize)),e.maxInstancesPerModel!==void 0&&(this.maxInstancesPerModel=Math.max(10,e.maxInstancesPerModel)),f("[ModelCache] :",this.getCacheStatus())}}const xt=new hg,mg={__name:"PuppetModelView",props:{puppet:{type:Object,default:null}},setup(t,{expose:e}){e();const s=t,n=F(null),o=F(!1);let r=null,i=null,a=null,l=0,c=null,u=null,d=new Id,p=null,m=null,g=0,y=!1;window.__GLTF_MEMORY_CACHE__||(window.__GLTF_MEMORY_CACHE__=new Map,f("[PuppetModelView] Initialized global GLTF memory cache"));const S=window.__GLTF_MEMORY_CACHE__;function E(){if(y)return;const x=n.value;if(!x){f("[PuppetModelView] Container not ready for Three.js initialization");return}f("[PuppetModelView] Initializing Three.js..."),i=new ur,a=new mo(45,1,.1,1e3),a.position.set(0,1,3),r=new dr({antialias:!0,alpha:!0}),r.setPixelRatio(window.devicePixelRatio||1),r.outputColorSpace=Pt,m=new ms,m.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),m.setCrossOrigin("anonymous"),f("[PuppetModelView] Draco loader initialized:",!!m),x.innerHTML="",x.appendChild(r.domElement);const j=new fr(16777215,1.2),V=new _n(16777215,1.5);V.position.set(3,5,2);const G=new _n(16777215,.8);G.position.set(-2,3,4);const J=new Ts(16777215,1,10);J.position.set(0,2,3),i.add(j,V,G,J);const Q=()=>{if(!x||!r)return;let be=x.clientWidth,P=x.clientHeight;if(!be||!P){const de=x.getBoundingClientRect();if(be=de.width||200,P=de.height||200,!de.width||!de.height){requestAnimationFrame(Q);return}}r.setSize(be,P,!0),a.aspect=be/Math.max(1,P),a.updateProjectionMatrix()};Q(),p=new ResizeObserver(Q),p.observe(x),requestAnimationFrame(()=>{Q(),requestAnimationFrame(()=>{Q(),requestAnimationFrame(Q)})});const z=()=>{if(!r||!i||!a)return;l=requestAnimationFrame(z);const be=d.getDelta();u&&u.update(be),c&&(c.rotation.y+=be*.6),r.render(i,a)};z(),y=!0,f("[PuppetModelView] Three.js initialized successfully, container size:",x.clientWidth,"x",x.clientHeight)}function I(){u&&(u.stopAllAction(),u=null),c&&(i.remove(c),c.traverse(x=>{x.isMesh&&(x.geometry&&x.geometry.dispose(),Array.isArray(x.material)?x.material.forEach(j=>{j.map&&j.map.dispose(),j&&j.dispose&&j.dispose()}):x.material&&(x.material.map&&x.material.map.dispose(),x.material.dispose&&x.material.dispose()))}),c=null)}function R(x){const j=new Dt().setFromObject(x),V=new Re,G=new Re;j.getSize(V),j.getCenter(G),x.position.sub(G),x.position.add(new Re(0,0,0)),x.scale.multiplyScalar(.8);const Q=r==null?void 0:r.domElement,z=Q?Q.clientWidth||Q.width:200,be=Q?Q.clientHeight||Q.height:200,P=Math.max(1e-6,z/Math.max(1,be)),de=a.fov*(Math.PI/180),Te=2*Math.atan(Math.tan(de/2)*P),oe=1.05,fe=V.y/2/Math.tan(de/2),qe=V.x/2/Math.tan(Te/2),le=oe*Math.max(fe,qe,.1);a.position.set(0,0,le),a.lookAt(0,0,0)}async function M(x){var G;if(!x)return;f("[PuppetModelView] Loading puppet:",x.name),o.value=!0,E(),I();const j=++g;f("[PuppetModelView] ");let V=x.modelUrl||"";if(f("[PuppetModelView] Original modelUrl:",V),f("[PuppetModelView] Puppet image:",x.image),f("[PuppetModelView] Puppet name:",x.name),f("[PuppetModelView] Puppet data:",x),!V||V.trim()===""){f("[PuppetModelView] No model URL found");return}f("[PuppetModelView] Final Model URL:",V);try{f("[PuppetModelView] Starting to load:",V),f("[PuppetModelView] Cache status:",xt.getCacheStatus());const J=await xt.loadModel(V);if(f("[PuppetModelView] Model loaded from cache manager:",J),j!==g){f("[PuppetModelView] Ignoring outdated load result for:",x.name),gltf&&gltf.scene&&gltf.scene.traverse(Q=>{Q.isMesh&&(Q.geometry&&Q.geometry.dispose(),Array.isArray(Q.material)?Q.material.forEach(z=>{z.map&&z.map.dispose(),z.dispose&&z.dispose()}):Q.material&&(Q.material.map&&Q.material.map.dispose(),Q.material.dispose&&Q.material.dispose()))});return}if(f("[PuppetModelView] Applying model for:",x.name),!i){f("[PuppetModelView] Scene not ready, initializing..."),E();let Q=0;for(;!i&&Q<40;)await new Promise(z=>setTimeout(z,50)),Q++;if(!i){f("[PuppetModelView] Scene initialization timeout");return}}if(c=J,!c){f("[PuppetModelView] No model instance received");return}i.add(c),R(c),f("[PuppetModelView] Model loaded successfully:",x.name,"Scene children:",i.children.length),o.value=!1}catch(J){if(f("[PuppetModelView] Load failed:",J),f("[PuppetModelView] Failed URL:",V),f("[PuppetModelView] Puppet data:",x),typeof(J==null?void 0:J.message)=="string"&&J.message.includes("DRACOLoader")){f("[PuppetModelView] Retrying without Draco decoder...");try{const Q=new hs;Q.setCrossOrigin("anonymous");const z=await Q.loadAsync(V);if(j===g&&(c=z.scene||((G=z.scenes)==null?void 0:G[0]),c)){i.add(c),z.animations&&z.animations.length&&(u=new Pd(c),u.clipAction(z.animations[0]).play()),R(c),f("[PuppetModelView] Model loaded successfully without Draco:",x.name);return}}catch(Q){f("[PuppetModelView] Fallback load also failed:",Q)}}if(j===g){const Q=new hn(1,1,1),z=new vt({color:8947967});c=new lt(Q,z),i.add(c),R(c)}o.value=!1}}ut(()=>s.puppet,async x=>{await vn(),M(x)},{immediate:!1}),ot(()=>{f("[PuppetModelView] Component mounted"),vn(()=>{n.value&&(E(),s.puppet&&setTimeout(()=>{M(s.puppet)},0))})}),wt(()=>{if(f("[PuppetModelView] Cleaning up..."),cancelAnimationFrame(l),I(),p&&n.value)try{p.unobserve(n.value)}catch{}const x=i,j=r;r=null,i=null,a=null,y=!1,g=0;const V=()=>{if(f("[PuppetModelView] Starting deferred cleanup..."),x&&x.traverse(G=>{if(G.isMesh)try{if(G.geometry&&G.geometry.dispose(),Array.isArray(G.material))G.material.forEach(J=>{try{J.map&&J.map.dispose(),J.dispose&&J.dispose()}catch{}});else if(G.material)try{G.material.map&&G.material.map.dispose(),G.material.dispose&&G.material.dispose()}catch{}}catch{}}),j)try{j.dispose(),j.forceContextLoss&&j.forceContextLoss()}catch{}f("[PuppetModelView] Deferred cleanup completed")};typeof window<"u"&&window.requestIdleCallback?window.requestIdleCallback(V,{timeout:1e3}):setTimeout(V,100),f("[PuppetModelView] Quick cleanup completed, heavy cleanup deferred")});const T={props:s,mountEl:n,isLoading:o,get renderer(){return r},set renderer(x){r=x},get scene(){return i},set scene(x){i=x},get camera(){return a},set camera(x){a=x},get animationId(){return l},set animationId(x){l=x},get currentModel(){return c},set currentModel(x){c=x},get currentMixer(){return u},set currentMixer(x){u=x},get clock(){return d},set clock(x){d=x},get resizeObserver(){return p},set resizeObserver(x){p=x},get dracoLoader(){return m},set dracoLoader(x){m=x},get loadSequence(){return g},set loadSequence(x){g=x},get isInitialized(){return y},set isInitialized(x){y=x},gltfMemoryCache:S,initThreeIfNeeded:E,clearCurrentModel:I,fitCameraToObject:R,loadPuppetModel:M,get log(){return f},ref:F,watch:ut,onMounted:ot,onBeforeUnmount:wt,nextTick:vn,get THREE(){return Ns},get GLTFLoader(){return hs},get DRACOLoader(){return ms},get modelCache(){return xt}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}},gg={class:"model-wrapper"},_g={ref:"mountEl",class:"model-canvas"},yg={key:0,class:"model-loading"};function vg(t,e,s,n,o,r){return $(),B("div",gg,[h("div",_g,null,512),n.isLoading?($(),B("div",yg,[...e[0]||(e[0]=[h("div",{class:"loading-spinner"},null,-1)])])):we("",!0)])}const bg=St(mg,[["render",vg],["__scopeId","data-v-c3e07470"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/PuppetModelView.vue"]]),wg={__name:"Warehouse",props:{musicOn:{type:Boolean,default:!0}},setup(t,{expose:e}){Zt(le=>({"58eda787-warehouseBgSrc":Te,"58eda787-panel5Src":de,"58eda787-panel2Src":z,"58eda787-panel3Src":be,"58eda787-panel4Src":P}));const s=t,n=["SpiritalSpark","RecallGear","ResonantCrystal","RefinedCopper","HeartCrystalDust"];function o(le){return n.map(k=>({icon:On[k].icon,name:On[k].name,value:Number((le==null?void 0:le[k])??0)}))}const r={IronWall:"",Arcanist:"",CraftsMan:"",Mechanic:"",Resonator:""};function i(le){const k=Number(le??1);return k===1?5:k===2?10:k===3?20:k===4?30:0}function a(le){return(le||[]).map((k,ue)=>{var U,Y,K,X,W,ce;const N=(k==null?void 0:k.copper_info)||{},ae=(N==null?void 0:N.skill)||{},me=(k==null?void 0:k.equipment_slot)||{},ze=(me==null?void 0:me.slot1)||null,He=(me==null?void 0:me.slot2)||null,Xe=(k==null?void 0:k.attribute)||{},je=((U=ze==null?void 0:ze.equipment_base)==null?void 0:U.attribute)||{},tt=((Y=He==null?void 0:He.equipment_base)==null?void 0:Y.attribute)||{},it=Number(je.attack||0)+Number(tt.attack||0),Ht=Number(je.defense||0)+Number(tt.defense||0),_=Number(je.dodge||0)+Number(tt.dodge||0),b=k==null?void 0:k.copper_type,L=(k==null?void 0:k.level)??1,q=(N==null?void 0:N.model_url)||"",A=q?H(q):"";return{id:Number((k==null?void 0:k.id)??ue+1),name:(N==null?void 0:N.name)??"",level:L,suffix:(k==null?void 0:k.suffix)??0,image:H((N==null?void 0:N.icon_url)||""),modelUrl:A,quantity:1,description:(N==null?void 0:N.description)||"",stats:{level:`${L}/5`,health:Number(Xe.health||0),live_left:Number((k==null?void 0:k.live_left)??0),attack:{base:Number(Xe.attack||0),bonus:it},defense:{base:Number(Xe.defense||0),bonus:Ht},dodge:{base:Number(Xe.dodge||0),bonus:_},class:r[b]||""},equipment:[ze?{name:((K=ze.equipment_base)==null?void 0:K.name)||"",icon:H(((X=ze.equipment_base)==null?void 0:X.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},me!=null&&me.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:He?{name:((W=He.equipment_base)==null?void 0:W.name)||"",icon:H(((ce=He.equipment_base)==null?void 0:ce.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}],skill:{name:(ae==null?void 0:ae.name)||"",cooldown:(ae==null?void 0:ae.cool_down)!=null?`${ae.cool_down}`:"",effect:(ae==null?void 0:ae.description)||"",icon:H((ae==null?void 0:ae.resource_url)||"")},upgradeCost:i(L)}})}function l(le,k,ue=[]){if(!le||typeof le!="object")return null;if(Object.prototype.hasOwnProperty.call(le,k))return[...ue,k];if(Array.isArray(le)){for(let N=0;N<le.length;N++){const ae=l(le[N],k,[...ue,N]);if(ae)return ae}return null}for(const N of Object.keys(le)){const ae=l(le[N],k,[...ue,N]);if(ae)return ae}return null}function c(le,k){return k.reduce((ue,N)=>ue!=null?ue[N]:void 0,le)}const u=F([]);async function d(){try{const le=await Wn();le&&(u.value=o(le))}catch(le){console.error("[Warehouse] :",le),u.value=o({})}}ot(()=>{d(),Vn(Tt.UPDATE_RESOURCES,d)});function p(le){let k=le;if(typeof le=="string")try{k=JSON.parse(le)}catch{}k&&k.type_msg&&(k.type_msg==="upgrade_cost_error"?alert(k.content||""):f("[GlobalInfo]",k))}ot(()=>{try{lr(p)}catch{}s.musicOn&&oe.value&&setTimeout(()=>{if(oe.value.readyState>=2)oe.value.play().then(()=>{f("[Warehouse] ")}).catch(k=>{f("[Warehouse] :",k)});else{const k=()=>{oe.value.play().then(()=>{f("[Warehouse] ")}).catch(ue=>{f("[Warehouse] :",ue)}),oe.value.removeEventListener("canplay",k)};oe.value.addEventListener("canplay",k,{once:!0})}},200)}),ut(()=>s.musicOn,le=>{if(oe.value)if(le)if(oe.value.readyState>=2)oe.value.play().catch(k=>{f("[Warehouse] :",k)});else{const k=()=>{oe.value.play().catch(ue=>{f("[Warehouse] :",ue)}),oe.value.removeEventListener("canplay",k)};oe.value.addEventListener("canplay",k)}else oe.value.pause()}),wt(()=>{oe.value&&oe.value.pause(),ps(Tt.UPDATE_RESOURCES,d)});const m=F([]);ot(async()=>{try{const le=await Es();let k=le&&Array.isArray(le.coppers)?le.coppers:[];if(!Array.isArray(k)){const ue=l(le,"coppers");if(f("[Warehouse] copper key path:",ue),ue){const N=c(le,ue);f("[Warehouse] copper found by path:",N),Array.isArray(N)&&(k=N)}!Array.isArray(k)&&le&&le.entries&&f("[Warehouse] copper entries sample:",le.entries)}Array.isArray(k)||f("[Warehouse] copper list not array"),m.value=a(k),Array.isArray(m.value)&&m.value.length>0&&(g.value=m.value[0]),!g.value&&Array.isArray(m.value)&&m.value.length>0&&(g.value=m.value[0])}catch{m.value=[]}});const g=F(null),y=F([]),S=F(null),E=F(null),I=F(null);function R(le,k){le&&(y.value[k]=le)}async function M(le,k){g.value=le,await vn();const ue=y.value[k];if(ue&&typeof ue.scrollIntoView=="function"&&ue.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),S.value=k,E.value)try{E.value.scrollTo({top:0,behavior:"smooth"})}catch{E.value.scrollTop=0}setTimeout(()=>{S.value===k&&(S.value=null)},320)}const T=F(!1);function x(){T.value=!0}function j(){T.value=!1}function V(){const le=Math.max(0,u.value.length-1),k=u.value;if(!k[le]||k[le].value<10){alert("");return}k[le].value-=10;const ue=m.value,N=Math.floor(Math.random()*ue.length),ae=ue[N];ae.quantity=(ae.quantity||0)+1,g.value=ae,drawResult.value={name:ae.name,image:ae.image}}function G(){return T.value?(T.value=!1,!0):!1}e({handleBack:G});async function J(le){try{await d();const k=await Es(),ue=Array.isArray(k==null?void 0:k.coppers)?k.coppers:[];m.value=a(ue)}catch{}}async function Q(){if(!g.value)return;if(Number(g.value.level||0)>=5){alert("");return}const le=g.value.id,k=await Sl(le);if(!k||k.type!=="success"){alert(k&&k.content?k.content:"");return}try{await d();const ue=await Es(),N=Array.isArray(ue==null?void 0:ue.coppers)?ue.coppers:[];m.value=a(N);const ae=m.value.find(me=>me.id===le);ae&&(g.value=ae)}catch{}}const z=`url('${H("@assets/ui/panel2.png")}')`,be=`url('${H("@assets/ui/panel3.png")}')`,P=`url('${H("@assets/ui/panel4.png")}')`,de=`url('${H("@assets/ui/panel5.png")}')`,Te=`url('${H("@assets/frontend_resource/Gemini_Generated_Image_e03q5oe03q5oe03q.png")}')`,oe=F(null),qe={props:s,ORDERED_RESOURCE_KEYS:n,mapResources:o,TYPE_MAP:r,getUpgradeCostByLevel:i,mapPuppets:a,findKeyPath:l,getByPath:c,resources:u,updateResources:d,handleGlobalInfo:p,puppets:m,selectedPuppet:g,puppetItemRefs:y,highlightedIndex:S,detailWrap:E,hoveredIndex:I,setPuppetItemRef:R,selectPuppet:M,showDrawScreen:T,drawMore:x,closeDrawScreen:j,drawTen:V,handleBack:G,onGachaResult:J,upgradeSelected:Q,panel2Src:z,panel3Src:be,panel4Src:P,panel5Src:de,warehouseBgSrc:Te,audioRef:oe,musicUrl:"/assets/warehouse.mp3",get log(){return f},ref:F,onMounted:ot,onBeforeUnmount:wt,watch:ut,nextTick:vn,get getAssetUrl(){return H},get RESOURCE_META(){return On},DrawScreen:Im,PuppetModelView:bg,get get_resource(){return Wn},get get_copper_list(){return Es},get upgrade_copper(){return Sl},get info_subscribe(){return lr},get onEvent(){return Vn},get offEvent(){return ps},get EventTypes(){return Tt}};return Object.defineProperty(qe,"__isScriptSetup",{enumerable:!1,value:!0}),qe}},Sg={class:"warehouse"},Mg={class:"warehouse__resources"},Tg={class:"resource-icon"},Cg=["src","alt"],Eg={class:"resource-value"},xg={class:"resource-tooltip"},Ag={key:0,class:"warehouse__main"},kg={class:"warehouse__sidebar"},Rg={class:"puppet-list"},Pg=["onClick","onMouseenter"],Ig={class:"puppet-card__quantity"},Lg={class:"puppet-card__image"},Og=["src","alt"],Dg={class:"puppet-card__info"},Ng={class:"puppet-card__name"},$g={class:"puppet-card__level"},Gg={class:"warehouse__detail",ref:"detailWrap"},Hg={class:"puppet-detail__header"},Ug={class:"puppet-detail__name"},Fg={class:"puppet-detail__content"},jg={class:"puppet-detail__row"},Bg={class:"puppet-detail__model"},zg={class:"puppet-detail__description"},Vg={class:"puppet-detail__row"},Wg={class:"puppet-detail__stats"},qg={class:"stats-section"},Kg={class:"stat-item"},Xg={class:"stat-value"},Yg={class:"stat-item"},Jg={class:"stat-value"},Zg={class:"stat-item"},Qg={class:"stat-value"},e_={class:"stat-item"},t_={class:"stat-value"},n_={class:"stat-item"},s_={class:"stat-value"},o_={class:"stat-item"},r_={class:"stat-value"},i_={class:"stat-item"},a_={class:"stat-value"},l_={class:"equipment-section"},c_={class:"equipment-slots"},u_=["src","alt"],d_=["src"],f_=["src"],p_={key:3,class:"equipment-icon"},h_={key:0,class:"skill-section"},m_={class:"skill-info"},g_={class:"skill-text"},__={class:"skill-name"},y_={class:"skill-cooldown"},v_={class:"skill-effect"},b_={class:"skill-icon"},w_=["src","alt"],S_={key:1},M_={class:"puppet-detail__upgrade"},T_={class:"upgrade-cost"},C_=["src"],E_={class:"cost-amount"},x_=["disabled"],A_=["src"],k_={class:"warehouse__placeholder",key:"placeholder"},R_=["src"];function P_(t,e,s,n,o,r){return $(),B("div",Sg,[h("div",Mg,[($(!0),B(et,null,Jt(n.resources,i=>($(),B("div",{class:"resource-item",key:i.name},[h("div",Tg,[h("img",{src:i.icon,alt:i.name},null,8,Cg)]),h("div",Eg,te(i.value),1),h("div",xg,te(i.name),1)]))),128))]),n.showDrawScreen?we("",!0):($(),B("div",Ag,[h("div",kg,[e[2]||(e[2]=h("div",{class:"warehouse__title"},"",-1)),h("div",Rg,[($(!0),B(et,null,Jt(n.puppets,(i,a)=>{var l;return $(),B("div",{class:nt(["puppet-card",{"puppet-card--selected":((l=n.selectedPuppet)==null?void 0:l.id)===i.id,"puppet-card--pulse":n.highlightedIndex===a,"puppet-card--hover":n.hoveredIndex===a}]),key:i.id,ref_for:!0,ref:c=>n.setPuppetItemRef(c,a),onClick:c=>n.selectPuppet(i,a),onMouseenter:c=>n.hoveredIndex=a,onMouseleave:e[0]||(e[0]=c=>n.hoveredIndex=null)},[h("div",Ig,te(i.level),1),h("div",Lg,[h("img",{src:i.image,alt:i.name},null,8,Og)]),h("div",Dg,[h("div",Ng,te(i.name)+te(i.suffix),1),h("div",$g,te(i.level)+"",1)])],42,Pg)}),128)),h("div",{class:"puppet-card puppet-card--add",onClick:n.drawMore},[...e[1]||(e[1]=[h("div",{class:"puppet-card__add-icon"},"+",-1),h("div",{class:"puppet-card__add-text"},"",-1)])])])]),h("div",Gg,[ct(Ah,{name:"fade-slide",mode:"out-in"},{default:Bc(()=>{var i,a,l,c;return[n.selectedPuppet?($(),B("div",{class:"puppet-detail",key:((i=n.selectedPuppet)==null?void 0:i.id)||"none"},[h("div",Hg,[h("h2",Ug,te(n.selectedPuppet.name),1)]),h("div",Fg,[h("div",jg,[h("div",Bg,[ct(n.PuppetModelView,{puppet:n.selectedPuppet},null,8,["puppet"])]),h("div",zg,te(n.selectedPuppet.description),1)]),h("div",Vg,[h("div",Wg,[h("div",qg,[h("div",Kg,[e[3]||(e[3]=h("span",{class:"stat-label"},":",-1)),h("span",Xg,te(n.selectedPuppet.stats.health),1)]),h("div",Yg,[e[4]||(e[4]=h("span",{class:"stat-label"},":",-1)),h("span",Jg,te(n.selectedPuppet.stats.level),1)]),h("div",Zg,[e[5]||(e[5]=h("span",{class:"stat-label"},":",-1)),h("span",Qg,te(n.selectedPuppet.stats.live_left),1)]),h("div",e_,[e[6]||(e[6]=h("span",{class:"stat-label"},":",-1)),h("span",t_,te(n.selectedPuppet.stats.attack.base),1)]),h("div",n_,[e[7]||(e[7]=h("span",{class:"stat-label"},":",-1)),h("span",s_,te(n.selectedPuppet.stats.defense.base),1)]),h("div",o_,[e[8]||(e[8]=h("span",{class:"stat-label"},":",-1)),h("span",r_,te(n.selectedPuppet.stats.dodge.base)+"% ",1)]),h("div",i_,[e[9]||(e[9]=h("span",{class:"stat-label"},":",-1)),h("span",a_,te(n.selectedPuppet.stats.class),1)])])]),h("div",l_,[e[10]||(e[10]=h("h4",{class:"section-title"},"",-1)),h("div",c_,[($(!0),B(et,null,Jt(n.selectedPuppet.equipment,(u,d)=>($(),B("div",{key:d,class:nt(["equipment-slot",{"equipment-slot--empty":!u.equipped&&!u.locked,"equipment-slot--locked":u.locked}])},[u.equipped&&u.icon&&(u.icon.startsWith("/")||u.icon.startsWith("http"))?($(),B("img",{key:0,src:u.icon,alt:u.name,class:"equipment-icon"},null,8,u_)):u.locked?($(),B("img",{key:1,src:n.getAssetUrl("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,d_)):u.icon===""?($(),B("img",{key:2,src:n.getAssetUrl("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,f_)):($(),B("span",p_,te(u.icon),1))],2))),128))])])]),((l=(a=n.selectedPuppet)==null?void 0:a.stats)==null?void 0:l.class)!==""?($(),B("div",h_,[e[11]||(e[11]=h("h4",{class:"section-title"},"",-1)),h("div",m_,[h("div",g_,[h("div",__,te(n.selectedPuppet.skill.name),1),h("div",y_," : "+te(n.selectedPuppet.skill.cooldown),1),h("div",v_,te(n.selectedPuppet.skill.effect),1)]),h("div",b_,[n.selectedPuppet.skill.icon&&(n.selectedPuppet.skill.icon.startsWith("/")||n.selectedPuppet.skill.icon.startsWith("http"))?($(),B("img",{key:0,src:n.selectedPuppet.skill.icon,alt:n.selectedPuppet.skill.name,class:"skill-icon-img"},null,8,w_)):($(),B("span",S_,te(n.selectedPuppet.skill.icon),1))])])])):we("",!0)]),h("div",M_,[h("div",T_,[n.selectedPuppet.level<5?($(),B("img",{key:0,src:n.RESOURCE_META.SpiritalSpark.icon,alt:"",class:"cost-icon-img"},null,8,C_)):we("",!0),h("span",E_,te(n.selectedPuppet.level>=5?"":"X "+n.selectedPuppet.upgradeCost),1)]),h("button",{class:"upgrade-btn",onClick:n.upgradeSelected,disabled:((c=n.selectedPuppet)==null?void 0:c.level)>=5},[h("img",{src:n.getAssetUrl("@assets/ui/upgrade.png"),class:"upgrade-icon",alt:""},null,8,A_)],8,x_)])])):($(),B("div",k_,[...e[12]||(e[12]=[h("p",null,"",-1)])]))]}),_:1})],512)])),n.showDrawScreen?($(),Bt(n.DrawScreen,{key:1,onDraw:n.onGachaResult})):we("",!0),h("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,R_)])}const I_=St(wg,[["render",P_],["__scopeId","data-v-58eda787"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/Warehouse.vue"]]),L_={__name:"TopLeftPanel",props:{musicOn:{type:Boolean,default:!0}},emits:["back","open-settings","toggle-music"],setup(t,{expose:e,emit:s}){e();const o={emit:s};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}},O_={class:"panel",style:{left:"24px",right:"auto"}},D_=["title"],N_={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$_={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G_={class:"sr-only"};function H_(t,e,s,n,o,r){return $(),B("div",O_,[h("button",{class:"btn",onClick:e[0]||(e[0]=i=>t.$emit("back")),title:""},[...e[3]||(e[3]=[h("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{d:"M15 18L9 12L15 6",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),h("span",{class:"sr-only"},"",-1)])]),h("button",{class:"btn",onClick:e[1]||(e[1]=i=>t.$emit("toggle-music")),title:s.musicOn?"":""},[s.musicOn?($(),B("svg",N_,[...e[4]||(e[4]=[h("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),h("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1)])])):($(),B("svg",$_,[...e[5]||(e[5]=[h("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),h("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("line",{x1:"2",y1:"2",x2:"22",y2:"22",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),h("span",G_,te(s.musicOn?"":""),1)],8,D_),h("button",{class:"btn",onClick:e[2]||(e[2]=i=>t.$emit("open-settings")),title:""},[...e[6]||(e[6]=[h("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{d:"M12 15.5C13.933 15.5 15.5 13.933 15.5 12C15.5 10.067 13.933 8.5 12 8.5C10.067 8.5 8.5 10.067 8.5 12C8.5 13.933 10.067 15.5 12 15.5Z",stroke:"#ffffff","stroke-width":"2"}),h("path",{d:"M19.4 15A7.964 7.964 0 0 0 20 12C20 11.49 19.95 10.99 19.86 10.5L22 8.5L20 5.5L17.34 6.07C16.78 5.58 16.14 5.18 15.44 4.9L15 2H9L8.56 4.9C7.86 5.18 7.22 5.58 6.66 6.07L4 5.5L2 8.5L4.14 10.5C4.05 10.99 4 11.49 4 12C4 12.51 4.05 13.01 4.14 13.5L2 15.5L4 18.5L6.66 17.93C7.22 18.42 7.86 18.82 8.56 19.1L9 22H15L15.44 19.1C16.14 18.82 16.78 18.42 17.34 17.93L20 18.5L22 15.5L19.86 13.5C19.95 13.01 20 12.51 20 12",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),h("span",{class:"sr-only"},"",-1)])])])}const U_=St(L_,[["render",H_],["__scopeId","data-v-fb6ccffd"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/TopLeftPanel.vue"]]),F_=["automatic_loading_gun","charging_coil","heart_source_mineral_drill","mirro_light_refraction_tower","repair_workshop","resonance_alarm_bell","rivet_barrier","steam_mining_car","storm_anvil"];function j_(){const t=[],e=[{type:"arcanist",name:"bubble"},{type:"craftsman",name:"coil"},{type:"iron_wall",name:"bell"},{type:"mechanic",name:"gyro"},{type:"resonator",name:"clawster"}];for(const n of e){const o=po(n.type,n.name);t.push(o)}const s=["goblin","guard","demon"];for(const n of s){const o=ho(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function B_(){const t=[],e=[{type:"arcanist",name:"glimmer"},{type:"arcanist",name:"spark"},{type:"craftsman",name:"artifex"},{type:"craftsman",name:"wrench"},{type:"iron_wall",name:"chief"},{type:"iron_wall",name:"rocky"},{type:"mechanic",name:"karin"},{type:"mechanic",name:"tricky"},{type:"resonator",name:"diggs"},{type:"resonator",name:"hive"}];for(const n of e){const o=po(n.type,n.name);t.push(o)}const s=["assassin","boxer","cruiser","devourer","glutton"];for(const n of s){const o=ho(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function z_(){const t=[],e=[{type:"arcanist",name:"syrup"},{type:"arcanist",name:"turner"},{type:"craftsman",name:"drillbit"},{type:"craftsman",name:"quickhand"},{type:"iron_wall",name:"tumble"},{type:"iron_wall",name:"wesley"},{type:"mechanic",name:"pendulum"},{type:"mechanic",name:"yoyo"},{type:"resonator",name:"melody"},{type:"resonator",name:"murmur"}];for(const n of e){const o=po(n.type,n.name);t.push(o)}const s=["horn","mirror","scout","shatra","variant"];for(const n of s){const o=ho(n);t.push(o)}for(const n of F_){const o=Mi(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function V_(t=["high","medium"]){const e=[];for(const n of t)switch(n){case"high":e.push(...j_());break;case"medium":e.push(...B_());break;case"low":e.push(...z_());break}const s=[...new Set(e)];return f(`[ModelPreloadConfig]  ${t.join(", ")}  ${s.length} URL`),s}class W_{constructor(){this.isPreloading=!1,this.preloadProgress=0,this.preloadCallbacks=[]}async startPreload(e=["high","medium"],s=null){if(this.isPreloading){f("[ModelPreloadManager] ");return}this.isPreloading=!0,this.preloadProgress=0;try{const n=V_(e);f(`[ModelPreloadManager]  ${n.length}  (: ${e.join(", ")})`),s&&this.preloadCallbacks.push(s),await xt.preloadModels(n,(o,r,i)=>{this.preloadProgress=i,this.notifyProgress(o,r,i)}),f("[ModelPreloadManager] ")}catch(n){f("[ModelPreloadManager] :",n)}finally{this.isPreloading=!1,this.preloadCallbacks=[]}}notifyProgress(e,s,n){this.preloadCallbacks.forEach(o=>{try{o(e,s,n)}catch(r){f("[ModelPreloadManager] :",r)}})}getStatus(){return{isPreloading:this.isPreloading,progress:this.preloadProgress,cacheStatus:xt.getCacheStatus()}}isModelPreloaded(e){return xt.isPreloaded(e)}async preloadModel(e){try{await xt.loadModel(e,!0),f(`[ModelPreloadManager] : ${e}`)}catch(s){f(`[ModelPreloadManager] : ${e}`,s)}}async preloadModels(e){const s=e.map(n=>this.preloadModel(n));await Promise.all(s),f(`[ModelPreloadManager] : ${e.length} `)}}const Xr=new W_,Fu="mgpic_game_settings",Rl={controlMode:"touchpad",mouseSensitivity:.002};function Gs(){try{const t=localStorage.getItem(Fu);if(t){const e=JSON.parse(t);return{...Rl,...e}}}catch(t){console.error("[GameSettings] :",t)}return{...Rl}}function q_(t){try{return localStorage.setItem(Fu,JSON.stringify(t)),!0}catch(e){return console.error("[GameSettings] :",e),!1}}function Yr(t){return Gs()[t]}function cr(t,e){const s=Gs();return s[t]=e,q_(s)}const K_={__name:"StartMenu",props:{visible:{type:Boolean,default:!0}},emits:["started"],setup(t,{expose:e,emit:s}){e(),Zt(P=>({"00070bd8-panel5Src":E}));const n=t,o=F(null);let r=null,i=null,a=null,l=null,c=null,u=1.2;const d=F(!1),p=F(!1),m=F(!1),g=F("touchpad"),y=F(!1),S=F(H("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),E=`url('${H("@assets/ui/panel4.png")}')`,I=s;ut(()=>n.visible,P=>{P&&r&&c?x():P||T()});function R(){if(l=requestAnimationFrame(R),c){const P=Date.now()*.001;c.position.y=Math.sin(P*.8)*.1,c.rotation.y=Math.sin(P*.6)*.1;const de=u+Math.sin(P*1.2)*.04;c.scale.setScalar(de)}a&&a.render(r,i)}function M(){!a||!i||(i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight))}function T(){l&&(cancelAnimationFrame(l),l=null),a&&a.setAnimationLoop(null)}function x(){l||R()}function j(){try{T()}catch{}try{window.removeEventListener("resize",M)}catch{}try{r&&(r.traverse(P=>{if(P.isMesh){P.geometry&&P.geometry.dispose&&P.geometry.dispose();const de=P.material;Array.isArray(de)?de.forEach(Te=>Te&&Te.dispose&&Te.dispose()):de&&de.dispose&&de.dispose()}}),r.clear())}catch{}try{if(a){a.clear(!0,!0,!0),a.dispose();const P=a.getContext&&a.getContext(),de=P&&P.getExtension&&P.getExtension("WEBGL_lose_context");de&&de.loseContext&&de.loseContext()}}catch{}r=null,i=null,a=null,c=null}async function V(P=null){try{window.getAssetUrl=H,window.precacheAllResources=ir,window.getCacheStatus=gl}catch{}if(!r||!a){f("[StartMenu] Scene or renderer not initialized in onMounted");return}if(P&&P(0,100,20),!r.children.some(oe=>oe.isLight)){const oe=new fr(4210752,.4);r.add(oe);const fe=new _n(16777215,12.5);fe.position.set(-5,-2,1),r.add(fe)}P&&P(0,100,50);const Te=H("logo.glb");try{P&&P(0,100,60),f("[StartMenu] Logo...");const oe=await xt.loadModel(Te,!0);P&&P(0,100,80),oe.position.set(0,0,0),r.add(oe);const qe=new Dt().setFromObject(oe).getCenter(new Re);oe.position.set(-qe.x,-qe.y,-qe.z-.3);try{oe.scale.setScalar(u)}catch{}c=oe,P&&P(0,100,80),f("[StartMenu] Logo ...");try{await Xr.startPreload(["high","medium"],(le,k,ue)=>{const N=80+ue*.15;P&&P(0,100,Math.round(N)),f(`[StartMenu] : ${le}/${k} (${ue}%)`)}),f("[StartMenu] ")}catch(le){f("[StartMenu] :",le)}P&&P(0,100,100),d.value=!0,f("[StartMenu] "),p.value=!0}catch(oe){f("[StartMenu] 3D",oe);const fe=new hn(1,1,1),qe=new bt({color:16096779}),le=new lt(fe,qe);r.add(le),c=le,f("[StartMenu] ...");try{await Xr.startPreload(["high","medium"],(k,ue,N)=>{const ae=80+N*.15;P&&P(0,100,Math.round(ae)),f(`[StartMenu] : ${k}/${ue} (${N}%)`)}),f("[StartMenu] ")}catch(k){f("[StartMenu] :",k)}P&&P(0,100,100),d.value=!0,f("[StartMenu] "),p.value=!0}window.__START_MENU_PAUSE__=()=>T(),window.__START_MENU_RESUME__=()=>x()}function G(){I("started"),T()}function J(){const P=Gs();g.value=P.controlMode,m.value=!0}function Q(){m.value=!1}function z(P){g.value=P,cr("controlMode",P),window.updateControlMode&&window.updateControlMode(P),f(`[StartMenu] : ${P}`)}ot(()=>{var P;p.value=!1,d.value=!1,y.value=typeof window<"u"&&(window.navigator.userAgent.toLowerCase().includes("electron")||((P=window.process)==null?void 0:P.type)==="renderer"||!!(window.require&&window.process&&window.process.versions&&window.process.versions.electron)),f("[StartMenu] ..."),f("[StartMenu] Electron :",y.value),!r&&o.value?(r=new ur,r.background=null,i=new mo(50,window.innerWidth/window.innerHeight,.1,1e3),i.position.set(-3.655,.2,-.006),i.rotation.set(-1.618275,-1.538307,-1.6183,"XYZ"),a=new dr({antialias:!0,alpha:!0,canvas:o.value}),a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(window.devicePixelRatio),a.setClearColor(0,0),window.addEventListener("resize",M),R(),f("[StartMenu] ")):r&&!c?f("[StartMenu] "):c&&(f("[StartMenu] Logo"),p.value=!0,d.value=!0),window.__INIT_THREE_SCENE__=async de=>{if(r&&c){f("[StartMenu] Logo"),p.value=!0,d.value=!0;return}f("[StartMenu] 3D..."),await V(de)}}),wt(()=>{j()});const be={props:n,canvasRef:o,get scene(){return r},set scene(P){r=P},get camera(){return i},set camera(P){i=P},get renderer(){return a},set renderer(P){a=P},get animationId(){return l},set animationId(P){l=P},get logoObject(){return c},set logoObject(P){c=P},get baseScale(){return u},set baseScale(P){u=P},isReady:d,showButtons:p,showSettings:m,controlMode:g,isElectron:y,startBg:S,panel5Src:E,emit:I,renderLoop:R,handleResize:M,pause:T,resume:x,destroyScene:j,initScene:V,onStart:G,onOpenSettings:J,onCloseSettings:Q,setControlMode:z,get log(){return f},onMounted:ot,onBeforeUnmount:wt,ref:F,watch:ut,get THREE(){return Ns},get getAssetUrl(){return H},get precacheAllResources(){return ir},get getCacheStatus(){return gl},get modelPreloadManager(){return Xr},get modelCache(){return xt},get getSettings(){return Gs},get updateSetting(){return cr}};return Object.defineProperty(be,"__isScriptSetup",{enumerable:!1,value:!0}),be}},X_={class:"startmenu"},Y_={key:0,class:"download-banner"},J_={ref:"canvasRef",class:"startmenu__canvas"},Z_={key:1,class:"settings-local"},Q_={class:"settings-local__card"},ey={class:"settings-local__content"},ty={class:"settings-local__row"},ny={class:"setting-options"};function sy(t,e,s,n,o,r){return $(),B("div",X_,[n.isElectron?we("",!0):($(),B("div",Y_,[...e[2]||(e[2]=[h("span",{class:"download-banner__text"},"  ",-1),h("a",{href:"https://github.com/MGPIC-2025/Cross/releases",target:"_blank",rel:"noopener noreferrer",class:"download-banner__link"},"  ",-1)])])),h("div",{class:"startmenu__bg",style:Xt({backgroundImage:`url('${n.startBg}')`})},null,4),h("canvas",J_,null,512),Vc(h("div",{class:nt(["startmenu-ui",{"fade-in":n.showButtons}])},[h("button",{id:"start-btn",class:"startmenu-btn","aria-label":"",onClick:n.onStart},"  "),h("button",{id:"settings-btn",class:"startmenu-btn","aria-label":"",onClick:n.onOpenSettings},"  ")],2),[[Lu,n.showButtons]]),n.showSettings?($(),B("div",Z_,[h("div",Q_,[h("div",{class:"settings-local__header"},[e[3]||(e[3]=h("div",{class:"settings-local__title"},"",-1)),h("button",{class:"settings-local__close",onClick:n.onCloseSettings,"aria-label":""},"  ")]),h("div",ey,[h("div",ty,[e[6]||(e[6]=h("div",{class:"setting-label"},"",-1)),h("div",ny,[h("button",{class:nt(["option-btn",{active:n.controlMode==="touchpad"}]),onClick:e[0]||(e[0]=i=>n.setControlMode("touchpad"))},[...e[4]||(e[4]=[h("span",{class:"option-title"},"",-1),h("span",{class:"option-desc"},"",-1)])],2),h("button",{class:nt(["option-btn",{active:n.controlMode==="mouse"}]),onClick:e[1]||(e[1]=i=>n.setControlMode("mouse"))},[...e[5]||(e[5]=[h("span",{class:"option-title"},"",-1),h("span",{class:"option-desc"},"",-1)])],2)])])])])])):we("",!0)])}const oy=St(K_,[["render",sy],["__scopeId","data-v-00070bd8"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/StartMenu.vue"]]),Pl={type:"change"},qi={type:"start"},ju={type:"end"},Po=new Od,Il=new lc,ry=Math.cos(70*ic.DEG2RAD),yt=new Re,Ft=2*Math.PI,Qe={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Jr=1e-6;class Ll extends Ld{constructor(e,s=null){super(e,s),this.state=Qe.NONE,this.target=new Re,this.cursor=new Re,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:xs.ROTATE,MIDDLE:xs.DOLLY,RIGHT:xs.PAN},this.touches={ONE:Cs.ROTATE,TWO:Cs.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Re,this._lastQuaternion=new Os,this._lastTargetPosition=new Re,this._quat=new Os().setFromUnitVectors(e.up,new Re(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Sa,this._sphericalDelta=new Sa,this._scale=1,this._panOffset=new Re,this._rotateStart=new Lt,this._rotateEnd=new Lt,this._rotateDelta=new Lt,this._panStart=new Lt,this._panEnd=new Lt,this._panDelta=new Lt,this._dollyStart=new Lt,this._dollyEnd=new Lt,this._dollyDelta=new Lt,this._dollyDirection=new Re,this._mouse=new Lt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ay.bind(this),this._onPointerDown=iy.bind(this),this._onPointerUp=ly.bind(this),this._onContextMenu=my.bind(this),this._onMouseWheel=dy.bind(this),this._onKeyDown=fy.bind(this),this._onTouchStart=py.bind(this),this._onTouchMove=hy.bind(this),this._onMouseDown=cy.bind(this),this._onMouseMove=uy.bind(this),this._interceptControlDown=gy.bind(this),this._interceptControlUp=_y.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Pl),this.update(),this.state=Qe.NONE}update(e=null){const s=this.object.position;yt.copy(s).sub(this.target),yt.applyQuaternion(this._quat),this._spherical.setFromVector3(yt),this.autoRotate&&this.state===Qe.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(n)&&isFinite(o)&&(n<-Math.PI?n+=Ft:n>Math.PI&&(n-=Ft),o<-Math.PI?o+=Ft:o>Math.PI&&(o-=Ft),n<=o?this._spherical.theta=Math.max(n,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+o)/2?Math.max(n,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const i=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=i!=this._spherical.radius}if(yt.setFromSpherical(this._spherical),yt.applyQuaternion(this._quatInverse),s.copy(this.target).add(yt),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let i=null;if(this.object.isPerspectiveCamera){const a=yt.length();i=this._clampDistance(a*this._scale);const l=a-i;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),r=!!l}else if(this.object.isOrthographicCamera){const a=new Re(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=l!==this.object.zoom;const c=new Re(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),i=yt.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;i!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(i).add(this.object.position):(Po.origin.copy(this.object.position),Po.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Po.direction))<ry?this.object.lookAt(this.target):(Il.setFromNormalAndCoplanarPoint(this.object.up,this.target),Po.intersectPlane(Il,this.target))))}else if(this.object.isOrthographicCamera){const i=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),i!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,r||this._lastPosition.distanceToSquared(this.object.position)>Jr||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Jr||this._lastTargetPosition.distanceToSquared(this.target)>Jr?(this.dispatchEvent(Pl),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Ft/60*this.autoRotateSpeed*e:Ft/60/60*this.autoRotateSpeed}_getZoomScale(e){const s=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,s){yt.setFromMatrixColumn(s,0),yt.multiplyScalar(-e),this._panOffset.add(yt)}_panUp(e,s){this.screenSpacePanning===!0?yt.setFromMatrixColumn(s,1):(yt.setFromMatrixColumn(s,0),yt.crossVectors(this.object.up,yt)),yt.multiplyScalar(e),this._panOffset.add(yt)}_pan(e,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const o=this.object.position;yt.copy(o).sub(this.target);let r=yt.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*r/n.clientHeight,this.object.matrix),this._panUp(2*s*r/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),o=e-n.left,r=s-n.top,i=n.width,a=n.height;this._mouse.x=o/i*2-1,this._mouse.y=-(r/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Ft*this._rotateDelta.x/s.clientHeight),this._rotateUp(Ft*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let s=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Ft*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Ft*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Ft*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Ft*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._rotateStart.set(n,o)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panStart.set(n,o)}}_handleTouchStartDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,r=Math.sqrt(n*n+o*o);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),o=.5*(e.pageX+n.x),r=.5*(e.pageY+n.y);this._rotateEnd.set(o,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Ft*this._rotateDelta.x/s.clientHeight),this._rotateUp(Ft*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panEnd.set(n,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,r=Math.sqrt(n*n+o*o);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const i=(e.pageX+s.x)*.5,a=(e.pageY+s.y)*.5;this._updateZoomParameters(i,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(e){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId)return!0;return!1}_trackPointer(e){let s=this._pointerPositions[e.pointerId];s===void 0&&(s=new Lt,this._pointerPositions[e.pointerId]=s),s.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const s=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(e){const s=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function iy(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function ay(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function ly(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(ju),this.state=Qe.NONE;break;case 1:const e=this._pointers[0],s=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:s.x,pageY:s.y});break}}function cy(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case xs.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=Qe.DOLLY;break;case xs.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Qe.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Qe.ROTATE}break;case xs.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Qe.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Qe.PAN}break;default:this.state=Qe.NONE}this.state!==Qe.NONE&&this.dispatchEvent(qi)}function uy(t){switch(this.state){case Qe.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case Qe.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case Qe.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function dy(t){this.enabled===!1||this.enableZoom===!1||this.state!==Qe.NONE||(t.preventDefault(),this.dispatchEvent(qi),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(ju))}function fy(t){this.enabled!==!1&&this._handleKeyDown(t)}function py(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case Cs.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=Qe.TOUCH_ROTATE;break;case Cs.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=Qe.TOUCH_PAN;break;default:this.state=Qe.NONE}break;case 2:switch(this.touches.TWO){case Cs.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=Qe.TOUCH_DOLLY_PAN;break;case Cs.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=Qe.TOUCH_DOLLY_ROTATE;break;default:this.state=Qe.NONE}break;default:this.state=Qe.NONE}this.state!==Qe.NONE&&this.dispatchEvent(qi)}function hy(t){switch(this._trackPointer(t),this.state){case Qe.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case Qe.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case Qe.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case Qe.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=Qe.NONE}}function my(t){this.enabled!==!1&&t.preventDefault()}function gy(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function _y(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const yy={__name:"StartGame",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["confirm","close"],setup(t,{expose:e,emit:s}){e(),Zt(N=>({"7da17356-panel1Src":P,"7da17356-panel3Src":Te,"7da17356-panel9Src":le,"7da17356-panel10Src":k,"7da17356-panel6Src":oe,"7da17356-panel8Src":qe,"7da17356-panel2Src":de,"7da17356-panel7Src":fe}));const n=s,o=t,r=F(!0),i=F(""),a=F([]),l=F(new Set),c=F(null),u=F(null),d=H("@assets/frontend_resource/startgame.mp3");let p,m,g,y,S;const E=new Map,I=Ce(()=>l.value.size===3),R=Ce(()=>a.value.filter(N=>l.value.has(N.id)));function M(){if(!c.value)return;p=new ur,p.background=new rn(1710618),m=new mo(45,c.value.clientWidth/c.value.clientHeight,.1,100),m.position.set(0,3,8),g=new dr({antialias:!0}),g.setSize(c.value.clientWidth,c.value.clientHeight),g.setPixelRatio(window.devicePixelRatio),c.value.appendChild(g.domElement),y=new Ll(m,g.domElement),y.enableDamping=!0,y.dampingFactor=.05,y.target.set(0,1,0);const N=new fr(16777215,.5);p.add(N);const ae=new _n(16777215,1);ae.position.set(0,5,10),p.add(ae);const me=new _n(11193599,.4);me.position.set(-5,3,5),p.add(me);const ze=new _n(16764074,.4);ze.position.set(5,3,5),p.add(ze);const He=new _n(16777215,.3);He.position.set(0,5,-5),p.add(He);const Xe=new oo(20,20),je=new vt({color:2763306,side:zt}),tt=new lt(Xe,je);tt.rotation.x=-Math.PI/2,tt.position.y=0,p.add(tt),S=new hs;const it=new ms;it.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),S.setDRACOLoader(it),T(),window.addEventListener("resize",x)}function T(){requestAnimationFrame(T),y&&y.update(),g&&p&&m&&g.render(p,m)}function x(){!c.value||!m||!g||(m.aspect=c.value.clientWidth/c.value.clientHeight,m.updateProjectionMatrix(),g.setSize(c.value.clientWidth,c.value.clientHeight))}function j(N){const ae=l.value;if(ae.has(N))ae.delete(N);else{if(ae.size>=3)return;ae.add(N)}l.value=new Set(ae)}async function V(N,ae){if(!p||!S)return;let me=N.modelUrl;f(`[StartGame] model_url: ${N.name}, URL: ${me}`);try{const ze=await xt.loadModel(me,!0);f(`[StartGame] : ${N.name}`);const Xe=new Dt().setFromObject(ze).getSize(new Re),je=new en;je.add(ze);const tt=2.5,it=-(R.value.length-1)*tt/2;je.position.set(it+ae*tt,0,0),je.scale.set(1,1,1),je.rotation.y=-Math.PI/2;const Ht=new Dt().setFromObject(je);je.position.y=-Ht.min.y,p.add(je),E.set(N.id,je),f(`[StartGame] : ${N.name}`)}catch(ze){f(`[StartGame] : ${N.name}`,ze),G(N,ae)}}function G(N,ae){if(!p)return;const me=new hn(.8,.8,.8),ze=new vt({color:4491519}),He=new lt(me,ze),Xe=2.5,je=-(R.value.length-1)*Xe/2;He.position.set(je+ae*Xe,.8,0),He.rotation.y=-Math.PI/2,p.add(He),E.set(N.id,He)}function J(){p&&(E.forEach(N=>{p.remove(N),N.geometry&&N.geometry.dispose(),N.material&&(Array.isArray(N.material)?N.material.forEach(ae=>ae.dispose()):N.material.dispose())}),E.clear(),R.value.forEach((N,ae)=>{V(N,ae)}))}async function Q(){r.value=!0,i.value="";try{const N=await Es(),ae=Array.isArray(N==null?void 0:N.coppers)?N.coppers:[];a.value=(ae||[]).map((me,ze)=>{var Xe,je,tt,it,Ht,_;const He=(Xe=me==null?void 0:me.copper_info)==null?void 0:Xe.model_url;return f(`[StartGame] Copper ${((je=me==null?void 0:me.copper_info)==null?void 0:je.name)||ze+1}: model_url=${He}`),{id:Number((me==null?void 0:me.id)??ze+1),name:((tt=me==null?void 0:me.copper_info)==null?void 0:tt.name)||`#${ze+1}`,icon:H(((it=me==null?void 0:me.copper_info)==null?void 0:it.icon_url)||""),level:Number((me==null?void 0:me.level)??1),copperType:(me==null?void 0:me.copper_type)||"Arcanist",modelName:((_=(Ht=me==null?void 0:me.copper_info)==null?void 0:Ht.name)==null?void 0:_.toLowerCase())||"",modelUrl:He?H(He):""}})}catch(N){f("[StartGame] ",N),i.value=""}finally{r.value=!1}}async function z(){if(l.value.size!==3)return;const N=Array.from(l.value).map(ae=>String(ae));window.__ACTUAL_COPPER_IDS__=N,f("[StartGame] ID:",N),n("confirm",{ids:N})}function be(){n("close")}ut(R,()=>{J()},{deep:!0}),ot(()=>{Q(),setTimeout(()=>{M()},100),o.musicOn&&!o.paused&&u.value&&setTimeout(()=>{if(u.value.readyState>=2)u.value.play().then(()=>{f("[StartGame] ")}).catch(ae=>{f("[StartGame] :",ae)});else{const ae=()=>{u.value.play().then(()=>{f("[StartGame] ")}).catch(me=>{f("[StartGame] :",me)}),u.value.removeEventListener("canplay",ae)};u.value.addEventListener("canplay",ae,{once:!0})}},200)}),ut(()=>o.musicOn,N=>{if(u.value)if(N&&!o.paused)if(u.value.readyState>=2)u.value.play().catch(ae=>{f("[StartGame] :",ae)});else{const ae=()=>{u.value.play().catch(me=>{f("[StartGame] :",me)}),u.value.removeEventListener("canplay",ae)};u.value.addEventListener("canplay",ae)}else u.value.pause()}),ut(()=>o.paused,N=>{if(u.value){if(N)u.value.pause(),f("[StartGame] ");else if(o.musicOn){if(u.value.readyState>=2)u.value.play().catch(ae=>{f("[StartGame] :",ae)});else{const ae=()=>{u.value.play().catch(me=>{f("[StartGame] :",me)}),u.value.removeEventListener("canplay",ae)};u.value.addEventListener("canplay",ae)}f("[StartGame] ")}}}),wt(()=>{window.removeEventListener("resize",x),u.value&&u.value.pause(),E.forEach(N=>{p&&p.remove(N)}),E.clear(),g&&g.dispose(),y&&y.dispose()});const P=`url('${H("@assets/ui/panel1.png")}')`,de=`url('${H("@assets/ui/panel2.png")}')`,Te=`url('${H("@assets/ui/panel3.png")}')`,oe=`url('${H("@assets/ui/panel6.png")}')`,fe=`url('${H("@assets/ui/panel7.png")}')`,qe=`url('${H("@assets/ui/panel8.png")}')`,le=`url('${H("@assets/ui/panel9.png")}')`,k=`url('${H("@assets/ui/panel10.png")}')`,ue={emit:n,props:o,loading:r,error:i,copperList:a,selectedIds:l,previewContainer:c,audioRef:u,musicUrl:d,get scene(){return p},set scene(N){p=N},get camera(){return m},set camera(N){m=N},get renderer(){return g},set renderer(N){g=N},get controls(){return y},set controls(N){y=N},get gltfLoader(){return S},set gltfLoader(N){S=N},loadedModels:E,canConfirm:I,selectedCoppers:R,init3DScene:M,animate3D:T,onWindowResize:x,toggleSelect:j,loadCopperModel:V,createPlaceholderCube:G,updateModels:J,loadCoppers:Q,startGame:z,close:be,panel1Src:P,panel2Src:de,panel3Src:Te,panel6Src:oe,panel7Src:fe,panel8Src:qe,panel9Src:le,panel10Src:k,get log(){return f},ref:F,onMounted:ot,onBeforeUnmount:wt,computed:Ce,watch:ut,get get_copper_list(){return Es},get eventloop(){return xe},get getAssetUrl(){return H},get modelCache(){return xt},get THREE(){return Ns},get OrbitControls(){return Ll},get GLTFLoader(){return hs},get DRACOLoader(){return ms}};return Object.defineProperty(ue,"__isScriptSetup",{enumerable:!1,value:!0}),ue}},vy={class:"startgame-modal"},by={class:"card"},wy={class:"card__header"},Sy=["src"],My={class:"card__body"},Ty={class:"card__content"},Cy={key:0,class:"loading"},Ey={key:1,class:"error"},xy={key:2,class:"list"},Ay=["onClick"],ky={class:"item__img"},Ry=["src","alt"],Py={class:"item__meta"},Iy={class:"item__name"},Ly={class:"item__level"},Oy={class:"preview"},Dy={ref:"previewContainer",class:"preview__scene"},Ny={class:"preview__info"},$y={key:0,class:"preview__empty"},Gy={key:1,class:"preview__names"},Hy={class:"preview__name-number"},Uy={class:"preview__name-text"},Fy={class:"card__footer"},jy=["disabled"],By=["src"];function zy(t,e,s,n,o,r){return $(),B("div",vy,[h("div",by,[h("div",wy,[e[0]||(e[0]=h("div",{class:"card__title"},"",-1)),h("button",{class:"card__close",onClick:n.close,"aria-label":""},[h("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,Sy)])]),h("div",My,[h("div",Ty,[n.loading?($(),B("div",Cy,"...")):n.error?($(),B("div",Ey,te(n.error),1)):($(),B("div",xy,[($(!0),B(et,null,Jt(n.copperList,i=>($(),B("div",{key:i.id,class:nt(["item",{"item--selected":n.selectedIds.has(i.id)}]),onClick:a=>n.toggleSelect(i.id)},[h("div",ky,[h("img",{src:i.icon,alt:i.name},null,8,Ry)]),h("div",Py,[h("div",Iy,te(i.name),1),h("div",Ly,"Lv. "+te(i.level),1)])],10,Ay))),128))])),e[1]||(e[1]=h("div",{class:"hint"},"3",-1))]),h("div",Oy,[e[2]||(e[2]=h("div",{class:"preview__title"},"",-1)),h("div",Dy,null,512),h("div",Ny,[n.selectedCoppers.length===0?($(),B("div",$y,"  ")):($(),B("div",Gy,[($(!0),B(et,null,Jt(n.selectedCoppers,(i,a)=>($(),B("div",{key:i.id,class:"preview__name"},[h("span",Hy,te(a+1),1),h("span",Uy,te(i.name),1)]))),128))]))])])]),h("div",Fy,[h("button",{class:"btn btn--primary",disabled:!n.canConfirm,onClick:n.startGame},"  ",8,jy),h("button",{class:"btn",onClick:n.close},"")])]),h("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,By)])}const Vy=St(yy,[["render",zy],["__scopeId","data-v-7da17356"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/StartGame.vue"]]),Wy={:"spark",:"syrup",:"bubble",:"glimmer",:"turner",:"wrench",:"artifex",:"coil",:"drillbit",:"quickhand",:"rocky",:"wesley",:"bell",:"tumble",:"chief",:"gyro",:"tricky",:"pendulum",:"yoyo",:"karin",:"murmur",:"melody",:"clawster",:"diggs",:"hive"},qy={IronWall:"iron_wall",Arcanist:"arcanist",Mechanic:"mechanic",Resonator:"resonator",CraftsMan:"craftsman"};function Ol(t){return Wy[t]||t.toLowerCase()}function Dl(t){return qy[t]||t.toLowerCase()}const Ky={:"rivet_barrier",:"gear_arrow_tower",:"heart_source_mineral_drill",:"steam_mining_car",:"charging_coil",:"repair_workshop",:"mirro_light_refraction_tower",:"resonance_alarm_bell",:"storm_anvil",:"automatic_loading_gun"};function Nl(t){return Ky[t]||t.toLowerCase().replace(/\s+/g,"_")}function $l(t,e){const s=new Map;function n(c,u,d){if(s.has(c)){const T=s.get(c);T.maxHp=d,o(c,u,d);return}const p=1,m=.1,g=new oo(p,m),y=new bt({color:4456448,side:zt,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),S=new lt(g,y),E=new oo(p,m),I=new bt({color:r(u,d),side:zt,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),R=new lt(E,I);R.position.z=.001;const M=new en;M.add(S),M.add(R),M.renderOrder=999,S.renderOrder=999,R.renderOrder=1e3,t.add(M),s.set(c,{bar:R,background:S,container:M,maxHp:d}),o(c,u,d)}function o(c,u,d){const p=s.get(c);if(!p)return;const{bar:m}=p,g=Math.max(0,Math.min(1,u/d));m.scale.x=g,m.position.x=-(1-g)*.5,m.material.color.setHex(r(u,d))}function r(c,u){const d=c/u;return d>.6?65280:d>.3?16776960:16711680}function i(c){const u=s.get(c);if(!u)return;const{bar:d,background:p,container:m}=u;d.geometry.dispose(),d.material.dispose(),p.geometry.dispose(),p.material.dispose(),t.remove(m),s.delete(c)}function a(c){s.forEach((u,d)=>{const p=c.find(m=>m.id===d);if(p&&p.object){const{container:m}=u,g=p.object.position.clone();g.y+=1.5,m.position.copy(g),m.lookAt(e.position)}})}function l(){s.forEach((c,u)=>{i(u)}),s.clear()}return{healthBars:s,createOrUpdateHealthBar:n,updateHealthBarValue:o,removeHealthBar:i,updateHealthBarsPosition:a,dispose:l}}const Xy={url:H("@assets/ui/skybox.jpg"),radius:1e3,segments:32,hemisphere:!1},Yy={ambient:{color:16777215,intensity:.5},mainDirectional:{color:16777215,intensity:1.2,position:{x:0,y:20,z:5},castShadow:!0},topLight:{color:16777215,intensity:.8,position:{x:0,y:30,z:0}},hemisphere:{skyColor:16777215,groundColor:4473924,intensity:.6,position:{x:0,y:20,z:0}}};function Gl(){return{...Xy}}const Jy={fov:60,near:.1,far:2e3,position:{x:0,y:5,z:10}},Zy={antialias:!0},Qy={decoderPath:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},ev={moveSpeed:.2,rotationSpeed:.003,focusLerpFactor:.08},tv={enabled:!0,units:[{id:1,name:"1",color:4491519,position:{x:.5,y:.4,z:.5},size:.8},{id:2,name:"2",color:16729156,position:{x:4.5,y:.4,z:4.5},size:.8}]},nv={enabled:!0,materialType:"standard",basic:{color:4868682,opacity:.8},standard:{color:5921386,roughness:.3,metalness:.7,opacity:.8},texture:{url:null,repeat:{x:1,y:1}},size:.95,height:.05,yOffset:-.02},sv={enabled:!1,size:100,materialType:"standard",texture:{url:null,repeat:{x:10,y:10},wrapS:"RepeatWrapping",wrapT:"RepeatWrapping"},color:{value:2763306},standard:{color:3815994,roughness:.8,metalness:.1,normalMap:null,normalScale:{x:1,y:1},roughnessMap:null,aoMap:null},position:{x:0,y:0,z:0},rotation:{x:-Math.PI/2,y:0,z:0}};function Hl(){return{...Yy}}function ov(){return{...Jy}}function rv(){return{...Zy}}function iv(){return{...Qy}}function Zr(){return{...ev}}function av(){return{...tv}}function lv(){return{...sv}}function Ei(){return{...nv}}function Ul(t){const e={move:[],attack:[],summon:[]},s=Ei();function n(d={}){var m;const p={...s,...d};if(!p.enabled)return new bt({transparent:!0,opacity:0});if(p.materialType==="texture"&&p.texture.url){const y=new Ds().load(p.texture.url);return y.colorSpace=Pt,y.wrapS=Dn,y.wrapT=Dn,y.repeat.set(p.texture.repeat.x,p.texture.repeat.y),new vt({map:y,side:zt,transparent:!0,opacity:((m=p.standard)==null?void 0:m.opacity)||1})}else return p.materialType==="standard"?new vt({color:p.standard.color,roughness:p.standard.roughness,metalness:p.standard.metalness,side:zt,transparent:!0,opacity:p.standard.opacity}):new bt({color:p.basic.color,side:zt,transparent:!0,opacity:p.basic.opacity})}const o={move:{color:4521796,opacity:.6},attack:{color:16729156,opacity:.6},summon:{color:16776960,opacity:.6}};function r(d,p="move"){const[m,g]=d,y=o[p]||o.move,S=s.size||.9,E=s.height||.08,I=new oo(S,S),R=new bt({color:y.color,side:zt,transparent:!0,opacity:y.opacity}),M=new lt(I,R);return M.rotation.x=-Math.PI/2,M.position.set(m,E,g),M.userData={position:d,type:p},t.add(M),e[p].push(M),M}function i(d){const[p,m]=d;let g=!1;return Object.keys(e).forEach(y=>{const S=e[y].findIndex(E=>{const I=E.userData.position;return I[0]===p&&I[1]===m});if(S!==-1){const E=e[y][S];t.remove(E),E.geometry.dispose(),E.material.dispose(),e[y].splice(S,1),g=!0}}),g}function a(d){e[d]&&(e[d].forEach(p=>{t.remove(p),p.geometry.dispose(),p.material.dispose()}),e[d]=[])}function l(){Object.keys(e).forEach(d=>{a(d)})}function c(d,p){var y;const[m,g]=d;return(y=e[p])==null?void 0:y.some(S=>{const E=S.userData.position;return E[0]===m&&E[1]===g})}function u(){l()}return{indicators:e,createIndicator:r,createCellMaterial:n,clearIndicatorAt:i,clearIndicators:a,clearAllIndicators:l,hasIndicatorAt:c,dispose:u}}function cv(){const t={geometries:[],materials:[],meshes:[],maxSize:10},e={geometries:[],materials:[],meshes:[],maxSize:10};function s(a){let l;if(t.meshes.length>0)l=t.meshes.pop(),l.geometry.dispose(),l.geometry=new Fo(.05,.05,a,8),l.material.opacity=.9;else{const c=new Fo(.05,.05,a,8),u=new bt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5});l=new lt(c,u)}return l}function n(a){t.meshes.length<t.maxSize?t.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function o(){let a;if(e.meshes.length>0)a=e.meshes.pop(),a.scale.set(1,1,1),a.material.opacity=.8;else{const l=new si(.2,.4,32),c=new bt({color:16711680,side:zt,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5});a=new lt(l,c),a.rotation.x=-Math.PI/2}return a}function r(a){e.meshes.length<e.maxSize?e.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function i(){t.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),t.meshes=[],t.geometries=[],t.materials=[],e.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),e.meshes=[],e.geometries=[],e.materials=[]}return{getAttackRay:s,recycleAttackRay:n,getExplosionRing:o,recycleExplosionRing:r,dispose:i}}function Fl(t){const e=cv();function s(r,i){const a=new Re(r[0],.5,r[1]),l=new Re(i[0],.5,i[1]),c=a.distanceTo(l),u=e.getAttackRay(c),d=new Re().addVectors(a,l).multiplyScalar(.5);u.position.copy(d);const p=new Re().subVectors(l,a).normalize(),m=new Os;m.setFromUnitVectors(new Re(0,1,0),p),u.quaternion.copy(m),t.add(u);let g=.9;const y=()=>{g-=.05,u.material.opacity=g,g<=0?(t.remove(u),e.recycleAttackRay(u)):requestAnimationFrame(y)};setTimeout(y,300);const S=e.getExplosionRing();S.position.set(i[0],.1,i[1]),t.add(S);let E=1,I=.8;const R=()=>{E+=.1,I-=.08,S.scale.set(E,E,1),S.material.opacity=I,I<=0?(t.remove(S),e.recycleExplosionRing(S)):requestAnimationFrame(R)};R()}function n(r,i){const a=Object.entries(i).filter(([M,T])=>T>0).map(([M,T])=>{const x=Nu(M);return`+${T} ${x}`});if(a.length===0)return;const l=a.join(`
`),c=document.createElement("canvas"),u=c.getContext("2d");c.width=512,c.height=256,u.fillStyle="rgba(0, 0, 0, 0)",u.fillRect(0,0,c.width,c.height),u.font="bold 48px Arial",u.fillStyle="#ffff00",u.strokeStyle="#000000",u.lineWidth=4,u.textAlign="center",u.textBaseline="middle";const d=l.split(`
`),p=60,m=c.height/2-(d.length-1)*p/2;d.forEach((M,T)=>{const x=m+T*p;u.strokeText(M,c.width/2,x),u.fillText(M,c.width/2,x)});const g=new Dd(c),y=new Nd({map:g,transparent:!0,opacity:1}),S=new $d(y);S.scale.set(2,1,1),S.position.set(r[0],1.5,r[1]),t.add(S);let E=1.5,I=1;const R=()=>{E+=.02,I-=.01,S.position.y=E,S.material.opacity=I,I<=0?(t.remove(S),S.material.map.dispose(),S.material.dispose()):requestAnimationFrame(R)};R()}function o(){e.dispose()}return{createAttackEffect:s,createResourceGainEffect:n,dispose:o}}const uv={gameScene:H("@assets/frontend_resource/gamescene.mp3")},dv={move:H("@assets/frontend_resource/move.mp3"),moveEnemy:H("@assets/frontend_resource/move_enemy.mp3"),attack:H("@assets/frontend_resource/attack.mp3"),attackEnemy:H("@assets/frontend_resource/attack_enemy.mp3"),meHurt:H("@assets/frontend_resource/me_hurt.mp3"),enemyHurt:H("@assets/frontend_resource/enemy_hurt.mp3")};function jl(t){return uv[t]||""}function ts(t){return dv[t]||""}let dt=null;function fv(t,e,s={}){const{radius:n=1e3,segments:o=32,hemisphere:r=!1}=s;dt&&(t.remove(dt),dt.geometry&&dt.geometry.dispose(),dt.material&&(dt.material.map&&dt.material.map.dispose(),dt.material.dispose()),dt=null),new Ds().load(e,a=>{a.colorSpace=Pt;const l=r?new oi(n,o,o,0,Math.PI*2,0,Math.PI/2):new oi(n,o,o),c=new bt({map:a,side:Hd,depthWrite:!1});dt=new lt(l,c),dt.position.set(0,0,0),t.add(dt),f(`[SceneUtils] ${r?"":""}${n}`)},void 0,a=>{f("[SceneUtils] ",a),t.background=new rn(2236962)})}function Bl(t,e){if(!e||!e.url){t.background=new rn(2236962);return}fv(t,e.url,{radius:e.radius||1e3,segments:e.segments||32,hemisphere:e.hemisphere||!1})}function zl(t,e){const s=new fr(e.ambient.color,e.ambient.intensity);t.add(s);const n=new _n(e.mainDirectional.color,e.mainDirectional.intensity);n.position.set(e.mainDirectional.position.x,e.mainDirectional.position.y,e.mainDirectional.position.z),n.castShadow=e.mainDirectional.castShadow,t.add(n);const o=new _n(e.topLight.color,e.topLight.intensity);o.position.set(e.topLight.position.x,e.topLight.position.y,e.topLight.position.z),t.add(o);const r=new Gd(e.hemisphere.skyColor,e.hemisphere.groundColor,e.hemisphere.intensity);r.position.set(e.hemisphere.position.x,e.hemisphere.position.y,e.hemisphere.position.z),t.add(r)}function Vl(t={}){const e={...ov(),...t},s=window.innerWidth/window.innerHeight,n=new mo(e.fov,s,e.near,e.far);return n.position.set(e.position.x,e.position.y,e.position.z),n}function Wl(t,e={}){const s={...rv(),...e},n=e.width||window.innerWidth,o=e.height||window.innerHeight,r=new dr({antialias:s.antialias});return r.setSize(n,o),r.setPixelRatio(window.devicePixelRatio),t.appendChild(r.domElement),r}function ql(t=null){const e=iv(),s=t||e.decoderPath,n=new hs,o=new ms;return o.setDecoderPath(s),n.setDRACOLoader(o),n}function Kl(t,e){const s=av();s.enabled&&(s.units.forEach(n=>{const o=new hn(n.size,n.size,n.size),r=new vt({color:n.color}),i=new lt(o,r);i.position.set(n.position.x,n.position.y,n.position.z),t.add(i),e.push({id:n.id,object:i,name:n.name,type:"test"})}),f("[SceneUtils] :",e.map(n=>`ID=${n.id}`)))}function Xl(t,e={}){const s={...lv(),...e};if(!s.enabled)return null;const n=new oo(s.size,s.size);let o;if(s.materialType==="texture"&&s.texture.url){const a=new Ds().load(s.texture.url);a.colorSpace=Pt,a.wrapS=Ns[s.texture.wrapS]||Dn,a.wrapT=Ns[s.texture.wrapT]||Dn,a.repeat.set(s.texture.repeat.x,s.texture.repeat.y),o=new vt({map:a,side:zt})}else if(s.materialType==="color")o=new bt({color:s.color.value,side:zt});else{const i={color:s.standard.color,roughness:s.standard.roughness,metalness:s.standard.metalness,side:zt},a=new Ds;if(s.standard.normalMap){const l=a.load(s.standard.normalMap);l.colorSpace=Pt,i.normalMap=l,i.normalScale=new Lt(s.standard.normalScale.x,s.standard.normalScale.y)}if(s.standard.roughnessMap){const l=a.load(s.standard.roughnessMap);l.colorSpace=Pt,i.roughnessMap=l}if(s.standard.aoMap){const l=a.load(s.standard.aoMap);l.colorSpace=Pt,i.aoMap=l}o=new vt(i)}const r=new lt(n,o);return r.position.set(s.position.x,s.position.y,s.position.z),r.rotation.set(s.rotation.x,s.rotation.y,s.rotation.z),r.renderOrder=-200,t.add(r),f(`[SceneUtils] ${s.materialType}${s.size}`),r}function Yl(t){dt&&t&&(t.remove(dt),dt.geometry&&dt.geometry.dispose(),dt.material&&(dt.material.map&&dt.material.map.dispose(),dt.material.dispose()),dt=null)}const pv={__name:"DiamondPanel",props:{copperInfo:{type:Object,required:!0},inventoryItems:{type:Array,default:()=>[]},inventoryCapacity:{type:Number,default:5}},emits:["inventory-click"],setup(t,{expose:e,emit:s}){e(),Zt(M=>({"7c3070e2-namePanelSrc":m,"7c3070e2-borderBlueSrc":n,"7c3070e2-borderGreenSrc":o,"7c3070e2-borderOrangeRedSrc":r}));const n=`url('${H("ui/border-blue.png")}')`,o=`url('${H("ui/border-green.png")}')`,r=`url('${H("ui/border-orange-red.png")}')`,i=t,a=s,l=Ce(()=>{var M;return(((M=i.copperInfo)==null?void 0:M.name)||"").trim()}),c=Ce(()=>{var M,T;return((M=i.copperInfo)==null?void 0:M.isOwnedEnemy)===!0||((T=i.copperInfo)==null?void 0:T.isEnemy)===!0}),u=Ce(()=>c.value&&l.value!==""),d=Ce(()=>{var T;const M=(T=i.copperInfo)==null?void 0:T.position;return!Array.isArray(M)||M.length<2?"--":`${M[0]},${M[1]}`}),p=Ce(()=>c.value===!0),m=`url('${H("@assets/ui/panel4.png")}')`,g=F({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0});async function y(){try{const M=await Wn();M&&Object.keys(g.value).forEach(T=>{g.value[T]=M[T]||0})}catch(M){console.error("[DiamondPanel] :",M)}}const S=Ce(()=>Object.values(g.value).filter(M=>M>0).length);function E(){p.value||a("inventory-click")}const I=F(null);ot(async()=>{if(y(),Vn(Tt.UPDATE_RESOURCES,y),!I.value)return;function M(x){return new Promise((j,V)=>{const G=new Image;G.onload=()=>j(G),G.onerror=()=>V(),G.src=x})}function T(x,j){I.value&&I.value.style.setProperty(x,String(j))}try{const[x,j,V]=await Promise.all([M(H("ui/border-blue.png")),M(H("ui/border-green.png")),M(H("ui/border-orange-red.png"))]),G=Math.max(3,Math.round(x.naturalHeight/4)),J=Math.max(3,Math.round(j.naturalHeight/4)),Q=Math.max(3,Math.round(V.naturalHeight/4));T("--border-blue-slice",G),T("--border-green-slice",J),T("--border-orange-red-slice",Q)}catch{T("--border-blue-slice","8"),T("--border-green-slice","8"),T("--border-orange-red-slice","8")}});const R={borderBlueSrc:n,borderGreenSrc:o,borderOrangeRedSrc:r,props:i,emit:a,copperName:l,isEnemyUnit:c,shouldShowCopperName:u,positionText:d,isInventoryDisabled:p,namePanelSrc:m,resources:g,updateResources:y,globalResourceCount:S,handleInventoryClick:E,diamondPanelRef:I,ref:F,computed:Ce,onMounted:ot,onBeforeUnmount:wt,get getAssetUrl(){return H},get get_resource(){return Wn},get onEvent(){return Vn},get offEvent(){return ps},get EventTypes(){return Tt}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},hv={ref:"diamondPanelRef",class:"diamond-panel"},mv={key:0,class:"diamond-name"},gv={class:"diamond-row diamond-row--top"},_v=["title","aria-disabled"],yv={class:"diamond border-orange-red"},vv={class:"diamond-content"},bv={class:"diamond-text"},wv={class:"diamond-value"},Sv={class:"diamond-row diamond-row--bottom"},Mv={class:"diamond border-orange-red"},Tv={class:"diamond-content"},Cv={class:"diamond-text"},Ev={class:"diamond-value"},xv={class:"diamond border-green"},Av={class:"diamond-content"},kv={class:"diamond-text"},Rv={class:"diamond-value"},Pv={class:"diamond border-blue"},Iv={class:"diamond-content"},Lv={class:"diamond-text"},Ov={class:"diamond-value"};function Dv(t,e,s,n,o,r){return $(),B("div",hv,[n.shouldShowCopperName?($(),B("div",mv,te(n.copperName),1)):we("",!0),h("div",gv,[h("div",{class:nt(["diamond","border-blue",{"diamond--disabled":n.isInventoryDisabled}]),onClick:n.handleInventoryClick,title:n.isInventoryDisabled?"":"","aria-disabled":n.isInventoryDisabled?"true":"false"},[...e[0]||(e[0]=[h("div",{class:"diamond-content"},[h("div",{class:"diamond-text"},[h("div",{class:"diamond-label"},"")])],-1)])],10,_v),h("div",yv,[h("div",vv,[h("div",bv,[e[1]||(e[1]=h("div",{class:"diamond-label"},"",-1)),h("div",wv,te(n.positionText),1)])])])]),h("div",Sv,[h("div",Mv,[h("div",Tv,[h("div",Cv,[e[2]||(e[2]=h("div",{class:"diamond-label"},"",-1)),h("div",Ev,te(s.copperInfo.attack),1)])])]),h("div",xv,[h("div",Av,[h("div",kv,[e[3]||(e[3]=h("div",{class:"diamond-label"},"",-1)),h("div",Rv,te(s.copperInfo.defense),1)])])]),h("div",Pv,[h("div",Iv,[h("div",Lv,[e[4]||(e[4]=h("div",{class:"diamond-label"},"",-1)),h("div",Ov,te(s.copperInfo.speed),1)])])])])],512)}const Nv=St(pv,[["render",Dv],["__scopeId","data-v-7c3070e2"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/DiamondPanel.vue"]]),$v={__name:"InventoryModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},equipment:{type:Array,default:()=>[]}},emits:["close"],setup(t,{expose:e,emit:s}){e();const n=t,o=Ce(()=>n.equipment||[]),r=s;function i(){r("close")}const a={props:n,equipmentItems:o,emit:r,close:i,computed:Ce,get getAssetUrl(){return H}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}},Gv={class:"minecraft-inventory"},Hv={class:"inventory-layout"},Uv={class:"inventory-section"},Fv={class:"equipment-header-mc"},jv={class:"copper-name"},Bv={class:"inventory-grid"},zv={class:"slot-icon"},Vv=["src","alt"],Wv=["src"],qv=["src"],Kv={key:3,class:"equipment-icon"},Xv={class:"slot-tooltip"},Yv={class:"tooltip-name"};function Jv(t,e,s,n,o,r){return s.visible?($(),B("div",{key:0,class:"inventory-modal",onClick:Ln(n.close,["self"])},[h("div",Gv,[h("div",Hv,[h("div",Uv,[h("div",Fv,[h("h4",null,[h("span",jv,te(s.copperName),1),e[0]||(e[0]=zn("  ",-1))])]),h("div",Bv,[($(),B(et,null,Jt(2,(i,a)=>{var l,c,u,d,p,m,g,y,S,E;return h("div",{key:a,class:nt(["inv-slot",{"has-item":a<n.equipmentItems.length&&((l=n.equipmentItems[a])==null?void 0:l.equipped),"slot-locked":(c=n.equipmentItems[a])==null?void 0:c.locked}])},[a<n.equipmentItems.length?($(),B(et,{key:0},[h("div",zv,[(u=n.equipmentItems[a])!=null&&u.equipped&&((d=n.equipmentItems[a])!=null&&d.icon)&&n.equipmentItems[a].icon!==""&&(n.equipmentItems[a].icon.startsWith("/")||n.equipmentItems[a].icon.startsWith("http")||n.equipmentItems[a].icon.includes("."))?($(),B("img",{key:0,src:n.equipmentItems[a].icon,alt:((p=n.equipmentItems[a])==null?void 0:p.name)||"",class:"equipment-icon"},null,8,Vv)):(m=n.equipmentItems[a])!=null&&m.locked?($(),B("img",{key:1,src:n.getAssetUrl("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,Wv)):((g=n.equipmentItems[a])==null?void 0:g.icon)===""?($(),B("img",{key:2,src:n.getAssetUrl("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,qv)):($(),B("span",Kv,te(((y=n.equipmentItems[a])==null?void 0:y.icon)||""),1))]),h("div",Xv,[h("div",Yv,te(((S=n.equipmentItems[a])==null?void 0:S.name)||((E=n.equipmentItems[a])!=null&&E.locked?"":"")),1)])],64)):we("",!0)],2)}),64))])])])])])):we("",!0)}const Zv=St($v,[["render",Jv],["__scopeId","data-v-691681c6"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/InventoryModal.vue"]]),Qv={__name:"HealthBar",props:{hp:{type:Number,default:0},maxHp:{type:Number,default:100}},setup(t,{expose:e}){e(),Zt(u=>({"8139fe94-bloodBorderMiddleSrc":r,"8139fe94-bloodBarSrc":i}));const s=t,n=H("ui/blood-border-left.png"),o=H("ui/blood-border-right.png"),r=`url('${H("ui/blood-border-middle.png")}')`,i=`url('${H("ui/blood-bar.png")}')`,a=Ce(()=>{if(!s.maxHp||s.maxHp===0)return 0;const d=Math.max(0,Math.min(s.hp,s.maxHp))/s.maxHp*100;return Math.max(0,Math.min(100,d))}),l=Ce(()=>{const u=Math.max(0,Math.min(s.hp,s.maxHp)),d=s.maxHp||100;return`${Math.round(u)}/${Math.round(d)}`}),c={props:s,bloodBorderLeftSrc:n,bloodBorderRightSrc:o,bloodBorderMiddleSrc:r,bloodBarSrc:i,hpPercentage:a,hpText:l,computed:Ce,get getAssetUrl(){return H}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}},eb={class:"health-bar","aria-label":"Health Bar"},tb={class:"health-bar__border"},nb={class:"health-bar__border-left"},sb=["src"],ob={class:"health-bar__border-right"},rb=["src"],ib={class:"health-bar__text"};function ab(t,e,s,n,o,r){return $(),B("div",eb,[h("div",tb,[h("div",nb,[h("img",{src:n.bloodBorderLeftSrc,alt:""},null,8,sb)]),e[0]||(e[0]=h("div",{class:"health-bar__border-middle"},null,-1)),h("div",ob,[h("img",{src:n.bloodBorderRightSrc,alt:""},null,8,rb)]),h("div",{class:"health-bar__fill",style:Xt({width:`calc(${n.hpPercentage}% + 20px)`})},null,4),h("div",ib,te(n.hpText),1)])])}const lb=St(Qv,[["render",ab],["__scopeId","data-v-8139fe94"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/HealthBar.vue"]]),cb={__name:"TriPanel",props:{copperType:{type:String,default:""},canMove:{type:Boolean,default:!0},canAttack:{type:Boolean,default:!0},canSummon:{type:Boolean,default:!1}},emits:["move","wait","attack","summon","build"],setup(t,{expose:e,emit:s}){e();const n=t,o=s,r=Ce(()=>n.copperType==="CraftsMan"?"build":n.copperType==="Resonator"?"summon":"attack"),i=Ce(()=>r.value==="build"?n.canSummon?"":"":r.value==="summon"?n.canSummon?"":"":n.canAttack?"":""),a=Ce(()=>r.value==="build"||r.value==="summon"?!n.canSummon:!n.canAttack),l=H("ui/your-image.png"),c=H("ui/boot.png"),u=H("ui/mushroom.png"),d=H("ui/sword.png"),p=H("@assets/ui/summon.png"),m=H("@assets/ui/build.png");function g(){n.canMove&&o("move")}function y(){o("wait")}function S(){if(r.value==="build"){if(!n.canSummon)return;o("build")}else if(r.value==="summon"){if(!n.canSummon)return;o("summon")}else{if(!n.canAttack)return;o("attack")}}const E={props:n,emit:o,rightButtonType:r,rightButtonTitle:i,rightButtonLocked:a,hexSrc:l,moveIconSrc:c,waitIconSrc:u,attackIconSrc:d,summonIconSrc:p,buildIconSrc:m,onMove:g,onWait:y,onRightButton:S,computed:Ce,get getAssetUrl(){return H}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},ub={class:"tri-panel"},db={class:"diamond","aria-label":""},fb=["src"],pb=["src"],hb=["title"],mb=["src"],gb=["src"],_b=["title"],yb=["src"],vb=["src","alt"];function bb(t,e,s,n,o,r){return $(),B("div",ub,[h("div",db,[h("div",{class:"hex top",title:"",onClick:n.onWait},[h("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,fb),h("img",{class:"hex-icon",src:n.moveIconSrc,alt:""},null,8,pb)]),h("div",{class:nt(["hex left",{"is-locked":s.canMove===!1}]),title:s.canMove?"":"",onClick:n.onMove},[h("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,mb),h("img",{class:"hex-icon",src:n.waitIconSrc,alt:""},null,8,gb)],10,hb),h("div",{class:nt(["hex right",{"is-locked":n.rightButtonLocked}]),title:n.rightButtonTitle,onClick:n.onRightButton},[h("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,yb),h("img",{class:"hex-icon",src:n.rightButtonType==="build"?n.buildIconSrc:n.rightButtonType==="summon"?n.summonIconSrc:n.attackIconSrc,alt:n.rightButtonType==="build"?"":n.rightButtonType==="summon"?"":""},null,8,vb)],10,_b)])])}const wb=St(cb,[["render",bb],["__scopeId","data-v-d9064d28"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/TriPanel.vue"]]),Sb={__name:"BuildModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},structureList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","build"],setup(t,{expose:e,emit:s}){e(),Zt(I=>({"db5e67f3-panel11Src":p,"db5e67f3-panel5Src":y,"db5e67f3-panel8Src":g,"db5e67f3-panel7Src":m,"db5e67f3-panel12Src":S}));const n=t,o=s,r=F(null),i=Ce(()=>[...n.structureList].sort((I,R)=>{const M=T=>{var j;const x=((j=T.cost)==null?void 0:j.cost)||T.cost;return!Array.isArray(x)||x.length===0?0:Array.isArray(x[0])?x[0][1]:x[0].count};return M(I)-M(R)}));function a(I){r.value=I}function l(){if(!r.value){f("[BuildModal] ");return}f("[BuildModal] :",r.value.name),o("build",r.value.name),c()}function c(){r.value=null,o("close")}function u(I){return{:"",:"",:"",:""}[I]||""}function d(I){if(!I)return"";const R=I.cost||I;return!Array.isArray(R)||R.length===0?"":R.map(M=>{var T;if(Array.isArray(M)){const x=M[0],j=M[1];return`${((T=On[x])==null?void 0:T.name)||x} x${j}`}return`${ar(M)} x${M.count}`}).join(", ")}const p=`url('${H("@assets/ui/panel11.png")}')`,m=`url('${H("@assets/ui/panel7.png")}')`,g=`url('${H("@assets/ui/panel8.png")}')`,y=`url('${H("@assets/ui/panel5.png")}')`,S=`url('${H("@assets/ui/panel12.png")}')`,E={props:n,emit:o,selectedStructure:r,sortedStructures:i,selectStructure:a,handleConfirm:l,handleClose:c,getStructureTypeLabel:u,formatCost:d,panel11Src:p,panel7Src:m,panel8Src:g,panel5Src:y,panel12Src:S,ref:F,computed:Ce,get getAssetUrl(){return H},get getItemName(){return ar},get RESOURCE_META(){return On},get log(){return f}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},Mb={class:"modal-header"},Tb=["src"],Cb={class:"modal-info"},Eb={class:"info-text"},xb={class:"copper-name"},Ab={class:"modal-body"},kb={class:"structure-list"},Rb=["onClick"],Pb={class:"structure-header"},Ib={class:"structure-name-row"},Lb={class:"structure-name"},Ob={class:"structure-type"},Db={class:"structure-stats"},Nb={class:"stat"},$b={class:"stat-value"},Gb={class:"stat"},Hb={class:"stat-value"},Ub={class:"stat"},Fb={class:"stat-value"},jb={class:"stat"},Bb={class:"stat-value"},zb={class:"structure-cost"},Vb={class:"cost-value"},Wb={class:"structure-desc"},qb={key:0,class:"selected-badge"},Kb={class:"modal-footer"},Xb=["disabled"];function Yb(t,e,s,n,o,r){return $(),Bt(Xc,{to:"body"},[s.visible?($(),B("div",{key:0,class:"modal-overlay",onClick:Ln(n.handleClose,["self"])},[h("div",{class:"build-modal",onClick:e[0]||(e[0]=Ln(()=>{},["stop"]))},[h("div",Mb,[e[1]||(e[1]=h("h2",{class:"modal-title"}," ",-1)),h("button",{class:"close-btn",onClick:n.handleClose,title:""},[h("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,Tb)])]),h("div",Cb,[h("p",Eb,[h("span",xb,te(s.copperName),1),e[2]||(e[2]=zn("  ",-1))]),e[3]||(e[3]=h("p",{class:"tip-text"},"   ",-1))]),h("div",Ab,[h("div",kb,[($(!0),B(et,null,Jt(n.sortedStructures,i=>{var a,l,c;return $(),B("div",{key:i.name,class:nt(["structure-card",{selected:((a=n.selectedStructure)==null?void 0:a.name)===i.name}]),onClick:u=>n.selectStructure(i)},[h("div",Pb,[h("div",Ib,[h("span",Lb,te(i.name),1)]),h("span",Ob,te(n.getStructureTypeLabel(i.name)),1)]),h("div",Db,[h("div",Nb,[e[4]||(e[4]=h("span",{class:"stat-label"},"",-1)),h("span",$b,te(i.health),1)]),h("div",Gb,[e[5]||(e[5]=h("span",{class:"stat-label"},"",-1)),h("span",Hb,te(((l=i.attribute)==null?void 0:l.attack)||""),1)]),h("div",Ub,[e[6]||(e[6]=h("span",{class:"stat-label"},"",-1)),h("span",Fb,te(i.has_storage?"":""),1)]),h("div",jb,[e[7]||(e[7]=h("span",{class:"stat-label"},"",-1)),h("span",Bb,te(i.attack_range||""),1)])]),h("div",zb,[e[8]||(e[8]=h("span",{class:"cost-label"}," ",-1)),h("span",Vb,te(n.formatCost(i.cost)),1)]),h("div",Wb,te(i.description),1),((c=n.selectedStructure)==null?void 0:c.name)===i.name?($(),B("div",qb,"  ")):we("",!0)],10,Rb)}),128))])]),h("div",Kb,[h("button",{class:"btn btn-cancel",onClick:n.handleClose},""),h("button",{class:"btn btn-confirm",disabled:!n.selectedStructure,onClick:n.handleConfirm},"  ",8,Xb)])])])):we("",!0)])}const Jb=St(Sb,[["render",Yb],["__scopeId","data-v-db5e67f3"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/BuildModal.vue"]]),Zb={__name:"ActionPanel",props:{copper:{type:Object,default:null},resources:{type:Array,default:()=>[]},hasAttackTargets:{type:Boolean,default:!0},onSelectCopper:{type:Function,default:null}},emits:["close","action","selectCopper"],setup(t,{expose:e,emit:s}){Zt(k=>({"fce84ec9-swordImgSrc":r.value,"fce84ec9-redPanelBg":i.value,"fce84ec9-bootImgSrc":a.value,"fce84ec9-greenPanelBg":l.value,"fce84ec9-summonImgSrc":u.value,"fce84ec9-buildImgSrc":c.value}));const n=t,o=s,r=Ce(()=>`url('${H("ui/sword.png")}')`),i=Ce(()=>`url('${H("ui/red.png")}')`),a=Ce(()=>`url('${H("ui/boot.png")}')`),l=Ce(()=>`url('${H("ui/green.png")}')`),c=Ce(()=>`url('${H("@assets/ui/build.png")}')`),u=Ce(()=>`url('${H("@assets/ui/summon.png")}')`),d=H("@assets/ui/close.png"),p=F("full"),m=F(null),g=F(!1),y=F(!1),S=F([]),E=Ce(()=>{var ue,N,ae,me,ze,He,Xe,je,tt,it,Ht,_,b,L,q,A,U,Y,K,X,W,ce,ie,he,ge,Oe,Ne,Be,Pe,Ue,pe,st,Mt,Wt,at;if(!n.copper)return null;const k=((N=(ue=n.copper.copper)==null?void 0:ue.copper_info)==null?void 0:N.name)||((me=(ae=n.copper.enemy)==null?void 0:ae.enemy_base)==null?void 0:me.name)||((ze=n.copper.enemy_base)==null?void 0:ze.name)||n.copper.name||` #${n.copper.id}`;return{id:n.copper.id,name:k,level:((He=n.copper.copper)==null?void 0:He.level)??((Xe=n.copper.enemy)==null?void 0:Xe.level)??((je=n.copper.enemy_base)==null?void 0:je.level)??1,hp:n.copper.now_health,maxHp:((it=(tt=n.copper.copper)==null?void 0:tt.attribute)==null?void 0:it.health)??((_=(Ht=n.copper.enemy)==null?void 0:Ht.enemy_base)==null?void 0:_.health)??((b=n.copper.enemy_base)==null?void 0:b.health)??100,attack:((q=(L=n.copper.copper)==null?void 0:L.attribute)==null?void 0:q.attack)??((U=(A=n.copper.enemy)==null?void 0:A.enemy_base)==null?void 0:U.attack)??((Y=n.copper.enemy_base)==null?void 0:Y.attack)??0,defense:((X=(K=n.copper.copper)==null?void 0:K.attribute)==null?void 0:X.defense)??((ce=(W=n.copper.enemy)==null?void 0:W.enemy_base)==null?void 0:ce.defense)??((ie=n.copper.enemy_base)==null?void 0:ie.defense)??0,speed:((ge=(he=n.copper.copper)==null?void 0:he.attribute)==null?void 0:ge.speed)??((Ne=(Oe=n.copper.enemy)==null?void 0:Oe.enemy_base)==null?void 0:Ne.speed)??((Be=n.copper.enemy_base)==null?void 0:Be.speed)??0,canMove:n.copper.can_move,canAttack:n.copper.can_attack,canSummon:n.copper.can_summon,position:Array.isArray(n.copper.position)&&n.copper.position.length>=2?n.copper.position:Array.isArray((Pe=n.copper.enemy)==null?void 0:Pe.position)&&n.copper.enemy.position.length>=2?n.copper.enemy.position:Array.isArray((Ue=n.copper.enemy_base)==null?void 0:Ue.position)&&n.copper.enemy_base.position.length>=2?n.copper.enemy_base.position:[0,0],inventoryCapacity:((pe=n.copper.inventory)==null?void 0:pe.capacity)||0,copperType:((st=n.copper.copper)==null?void 0:st.copper_type)||((Wt=(Mt=n.copper.enemy)==null?void 0:Mt.enemy_base)==null?void 0:Wt.enemy_type)||((at=n.copper.enemy_base)==null?void 0:at.enemy_type)||"",isOwnedEnemy:n.copper.isOwnedEnemy===!0,isEnemy:n.copper.isEnemy===!0}}),I=Ce(()=>{var ae,me,ze,He,Xe;if(!n.copper)return[];const k=((ae=n.copper.copper)==null?void 0:ae.equipment_slot)||{},ue=(k==null?void 0:k.slot1)||null,N=(k==null?void 0:k.slot2)||null;return[ue?{name:((me=ue.equipment_base)==null?void 0:me.name)||"",icon:H(((ze=ue.equipment_base)==null?void 0:ze.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},k!=null&&k.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:N?{name:((He=N.equipment_base)==null?void 0:He.name)||"",icon:H(((Xe=N.equipment_base)==null?void 0:Xe.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}]});ut(()=>{var k;return(k=n.copper)==null?void 0:k.id},(k,ue)=>{k!==ue&&(p.value="full",m.value=null,g.value=!1,y.value=!1)});async function R(){if(!E.value.canMove)return;f("[ActionPanel] ");const k=n.copper.isOwnedEnemy===!0,ue=k?"on_enemy_move_start":"on_move_start";f(`[ActionPanel] : ${k?"":""}, : ${ue}`);const N=JSON.stringify({type:ue,content:{id:String(E.value.id)}});await xe(N),p.value="minimized",m.value="moving",o("action",{type:"moveStart",copperId:E.value.id})}async function M(){if(f("[ActionPanel] ",{canAttack:E.value.canAttack,copperId:E.value.id,name:E.value.name}),!E.value.canAttack){f("[ActionPanel] : ");return}f("[ActionPanel] ");const k=n.copper.isOwnedEnemy===!0,ue=k?"on_enemy_attack_start":"on_attack_start";f(`[ActionPanel] : ${k?"":""}, : ${ue}`);const N=JSON.stringify({type:ue,content:{id:String(E.value.id)}});await xe(N),p.value="minimized",m.value="attacking",o("action",{type:"attackStart",copperId:E.value.id})}async function T(){if(f("[ActionPanel] ",{canSummon:E.value.canSummon,copperId:E.value.id,name:E.value.name}),!E.value.canSummon){f("[ActionPanel] : ");return}f("[ActionPanel] ");const k=JSON.stringify({type:"on_summon_start",content:{id:String(E.value.id)}});await xe(k),p.value="minimized",m.value="summoning",o("action",{type:"summonStart",copperId:E.value.id})}async function x(){if(f("[ActionPanel] ",{copperId:E.value.id,name:E.value.name}),!E.value.canSummon){f("[ActionPanel] : /");return}o("action",{type:"buildRequest",copperId:E.value.id})}function j(k){f("[ActionPanel] ",(k==null?void 0:k.length)||0,""),S.value=k||[],y.value=!0}async function V(k){f("[ActionPanel] :",k),y.value=!1;const ue=JSON.stringify({type:"on_structure_build_start",content:{id:String(E.value.id),name:k}});await xe(ue),p.value="minimized",m.value="building",o("action",{type:"buildStart",copperId:E.value.id,structureName:k})}function G(){f("[ActionPanel] "),g.value=!0}async function J(k){f(`[ActionPanel] : index=${k}`);const ue=JSON.stringify({type:"on_copper_pick_up",content:{id:String(E.value.id),index:String(k)}});await xe(ue),await be()}async function Q(){f("[ActionPanel] ");const k=JSON.stringify({type:"on_copper_craft",content:{id:String(E.value.id)}});await xe(k),await be()}async function z(){await Q()}async function be(){const ue=n.copper.isOwnedEnemy===!0?"on_click_enemy":"on_click_copper",N=JSON.stringify({type:ue,content:{id:String(E.value.id)}});await xe(N)}function P(){f("[ActionPanel] "),o("action",{type:"wait",copperId:E.value.id})}function de(){p.value="full",m.value=null,g.value=!1,o("close")}function Te(){g.value=!1}function oe(){p.value="full",m.value=null,o("action",{type:"cancel",copperId:E.value.id})}function fe(){oe(),de()}async function qe(k){n.onSelectCopper?await n.onSelectCopper(k):o("selectCopper",k)}e({cancelAction:oe,handleSelectCopper:qe,showBuildMenu:j});const le={props:n,emit:o,swordImgSrc:r,redPanelBg:i,bootImgSrc:a,greenPanelBg:l,buildImgSrc:c,summonImgSrc:u,closeIconSrc:d,panelMode:p,actionMode:m,showInventory:g,showBuildModal:y,structureList:S,copperInfo:E,equipmentData:I,handleMove:R,handleAttack:M,handleSummon:T,handleBuild:x,showBuildMenu:j,handleBuildConfirm:V,handleInventory:G,handlePickup:J,handleCraft:Q,handleInventoryCraft:z,refreshCopperState:be,handleWait:P,close:de,handleCloseInventory:Te,cancelAction:oe,handleMinimizedClose:fe,handleSelectCopper:qe,get log(){return f},ref:F,computed:Ce,watch:ut,get eventloop(){return xe},get getItemName(){return ar},get getAssetUrl(){return H},DiamondPanel:Nv,InventoryModal:Zv,HealthBar:lb,TriPanel:wb,BuildModal:Jb};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}},Qb={key:0,class:"copper-panel-parent"},ew={key:0,class:"minimized-content"},tw=["src"],nw={class:"minimized-info"},sw={class:"minimized-name"},ow={class:"minimized-action"},rw=["src"],iw={class:"panel-content"},aw={key:0,class:"resources"},lw={class:"resources-list"},cw=["onClick"],uw={class:"resource-name"},dw={class:"resource-count"},fw={key:2,class:"enemy-info-tip"};function pw(t,e,s,n,o,r){var i,a,l,c,u,d,p,m;return $(),B(et,null,[s.copper?($(),B("div",Qb,[ct(n.DiamondPanel,{"copper-info":n.copperInfo,"inventory-items":[],"inventory-capacity":5,onInventoryClick:n.handleInventory},null,8,["copper-info"]),ct(n.HealthBar,{hp:((i=n.copperInfo)==null?void 0:i.hp)||0,"max-hp":((a=n.copperInfo)==null?void 0:a.maxHp)||100},null,8,["hp","max-hp"]),n.panelMode==="minimized"||s.resources&&s.resources.length>0&&n.panelMode==="full"?($(),B("div",{key:0,class:nt(["copper-panel",{"copper-panel--minimized":n.panelMode==="minimized","copper-panel--min-attack":n.panelMode==="minimized"&&n.actionMode==="attacking","copper-panel--min-move":n.panelMode==="minimized"&&n.actionMode==="moving","copper-panel--min-summon":n.panelMode==="minimized"&&n.actionMode==="summoning","copper-panel--min-build":n.panelMode==="minimized"&&n.actionMode==="building"}]),onClick:e[0]||(e[0]=Ln(()=>{},["stop"]))},[n.panelMode==="minimized"?($(),B("div",ew,[h("button",{class:"minimized-close",type:"button",onClick:n.handleMinimizedClose,title:""},[h("img",{src:n.closeIconSrc,alt:""},null,8,tw)]),h("div",nw,[h("span",sw,te(n.copperInfo.name),1),h("span",ow,te(n.actionMode==="moving"?"...":n.actionMode==="attacking"?"...":n.actionMode==="summoning"?"...":n.actionMode==="building"?"...":""),1)])])):($(),B(et,{key:1},[h("button",{class:"close-btn",onClick:n.close,title:""},[h("img",{src:n.closeIconSrc,alt:""},null,8,rw)]),h("div",iw,[s.resources&&s.resources.length>0?($(),B("div",aw,[e[3]||(e[3]=h("div",{class:"resources-header"}," ",-1)),h("div",lw,[($(!0),B(et,null,Jt(s.resources,(g,y)=>($(),B("div",{key:y,class:"resource-item",onClick:S=>n.handlePickup(y),title:""},[h("span",uw,te(n.getItemName(g)),1),h("span",dw,"x"+te(g.count||1),1),e[2]||(e[2]=h("span",{class:"resource-pickup"},"",-1))],8,cw))),128))])])):we("",!0)])],64))],2)):we("",!0),n.props.copper.isEnemy?we("",!0):($(),Bt(n.TriPanel,{key:1,"copper-type":(l=n.copperInfo)==null?void 0:l.copperType,"can-move":((c=n.copperInfo)==null?void 0:c.canMove)!==!1,"can-attack":((u=n.copperInfo)==null?void 0:u.canAttack)!==!1,"can-summon":((d=n.copperInfo)==null?void 0:d.canSummon)!==!1,onMove:n.handleMove,onWait:n.handleWait,onAttack:n.handleAttack,onSummon:n.handleSummon,onBuild:n.handleBuild},null,8,["copper-type","can-move","can-attack","can-summon"])),n.props.copper.isEnemy?($(),B("div",fw,[...e[4]||(e[4]=[h("span",null," ",-1)])])):we("",!0)])):we("",!0),ct(n.InventoryModal,{visible:n.showInventory,"copper-name":((p=n.copperInfo)==null?void 0:p.name)||"",equipment:n.equipmentData,onClose:n.handleCloseInventory,onCraft:n.handleInventoryCraft},null,8,["visible","copper-name","equipment"]),ct(n.BuildModal,{visible:n.showBuildModal,"copper-name":((m=n.copperInfo)==null?void 0:m.name)||"","structure-list":n.structureList,onClose:e[1]||(e[1]=g=>n.showBuildModal=!1),onBuild:n.handleBuildConfirm},null,8,["visible","copper-name","structure-list"])],64)}const hw=St(Zb,[["render",pw],["__scopeId","data-v-fce84ec9"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanel.vue"]]),mw={__name:"TurnSystem",props:{currentCopperId:{type:Number,default:null},copperList:{type:Array,default:()=>[]},roundNumber:{type:Number,default:1},isEnemyMoving:{type:Boolean,default:!1}},emits:["nextCopper","endRound","selectCopper"],setup(t,{expose:e,emit:s}){e(),Zt(M=>({"403c6abe-ribbonLeftSrc":l,"403c6abe-ribbonRightSrc":u,"403c6abe-ribbonMiddleSrc":c,"403c6abe-panelSrc":d,"403c6abe-round1Src":p,"403c6abe-currentCupperSrc":m,"403c6abe-btnSrc":g}));const n=t,o=s,r=F(null),i=H("ui/choice.png"),a=H("ui/choice-active.png"),l=`url('${H("ui/ribbon-left.png")}')`,c=`url('${H("ui/ribbon-middle.png")}')`,u=`url('${H("ui/ribbon-right.png")}')`,d=`url('${H("ui/panel.png")}')`,p=`url('${H("ui/round1.png")}')`,m=`url('${H("ui/currentcupper.png")}')`,g=`url('${H("ui/btn.png")}')`,y=Ce(()=>{if(!n.currentCopperId)return null;const M=n.copperList.find(T=>T.id===n.currentCopperId);return M?{id:M.id,name:M.name||` #${M.id}`,level:M.level??0,isSummon:M.type==="summon"}:null});function S(){o("nextCopper")}async function E(){const M=JSON.stringify({type:"on_game_round_pass"});await xe(M),o("endRound")}function I(M){o("selectCopper",M)}ot(async()=>{if(!r.value)return;function M(x){return new Promise((j,V)=>{const G=new Image;G.onload=()=>j(G),G.onerror=J=>{f(":",x,J),V(J)},G.src=x})}function T(x,j){r.value&&(r.value.style.setProperty(x,String(j)),f(` CSS  ${x} = ${j}`))}try{const[x,j,V]=await Promise.all([M(H("ui/panel.png")),M(H("ui/btn.png")),M(H("ui/currentcupper.png"))]),G=Math.max(4,Math.round(x.naturalHeight/4)),J=Math.max(3,Math.round(j.naturalHeight/3)),Q=Math.max(3,Math.round(V.naturalHeight/4));f(":",{panelSlice:G,btnSlice:J,currentSlice:Q,currentImgSize:`${V.naturalWidth}x${V.naturalHeight}`}),T("--panel-slice",G),T("--btn-slice",J),T("--current-slice",Q),setTimeout(()=>{const z=getComputedStyle(r.value);f("CSS :",{"--current-slice":z.getPropertyValue("--current-slice"),"--panel-slice":z.getPropertyValue("--panel-slice"),"--btn-slice":z.getPropertyValue("--btn-slice")})},100)}catch(x){f(":",x),T("--panel-slice","8"),T("--btn-slice","11"),T("--current-slice","8")}});const R={props:n,emit:o,turnSystemRef:r,choiceImgSrc:i,choiceActiveImgSrc:a,ribbonLeftSrc:l,ribbonMiddleSrc:c,ribbonRightSrc:u,panelSrc:d,round1Src:p,currentCupperSrc:m,btnSrc:g,currentCopperInfo:y,handleNextCopper:S,handleEndRound:E,handleSelectCopper:I,get log(){return f},computed:Ce,onMounted:ot,ref:F,get eventloop(){return xe},get getAssetUrl(){return H}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},gw={ref:"turnSystemRef",class:"turn-system"},_w={class:"panel"},yw={class:"panel-inner"},vw={class:"section section-header"},bw=["aria-label"],ww={class:"section section-body"},Sw={class:"current-doll",role:"status","aria-live":"polite"},Mw={key:0},Tw={class:"section section-choices",role:"group","aria-label":"Character Queue"},Cw=["aria-pressed","data-copper-id","title","onClick"],Ew=["alt","src","data-default-src","data-selected-src"],xw={class:"actions"},Aw=["disabled"],kw=["disabled"];function Rw(t,e,s,n,o,r){return $(),B("div",gw,[e[0]||(e[0]=h("div",{class:"ribbon","aria-hidden":"true"},[h("div",{class:"ribbon-cap left"}),h("div",{class:"ribbon-fill"},"CONTROL"),h("div",{class:"ribbon-cap right"})],-1)),h("div",_w,[h("div",yw,[h("section",vw,[h("div",{class:"round-header",role:"img","aria-label":`Round ${s.roundNumber}`}," Round "+te(s.roundNumber),9,bw)]),h("section",ww,[h("div",Sw,[h("span",null,te(n.currentCopperInfo?`${n.currentCopperInfo.name||` #${s.currentCopperId}`}`:""),1),n.currentCopperInfo&&!n.currentCopperInfo.isSummon?($(),B("span",Mw," Lv."+te(n.currentCopperInfo.level??0)+" ",1)):we("",!0)])]),h("section",Tw,[($(!0),B(et,null,Jt(s.copperList,i=>($(),B("button",{key:i.id,class:"choice",type:"button","aria-pressed":String(i.id===s.currentCopperId),"data-copper-id":i.id,title:i.name||` #${i.id}`,onClick:a=>n.handleSelectCopper(i.id)},[h("img",{alt:i.name||`Character ${i.id}`,src:i.id===s.currentCopperId?n.choiceActiveImgSrc:n.choiceImgSrc,"data-default-src":n.choiceImgSrc,"data-selected-src":n.choiceActiveImgSrc},null,8,Ew)],8,Cw))),128))])])]),h("div",xw,[h("button",{class:"btn btn-primary",onClick:n.handleNextCopper,disabled:!s.currentCopperId||s.isEnemyMoving},"  ",8,Aw),h("button",{class:"btn btn-secondary",onClick:n.handleEndRound,disabled:s.isEnemyMoving},"  ",8,kw)])],512)}const Pw=St(mw,[["render",Rw],["__scopeId","data-v-403c6abe"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/TurnSystem.vue"]]),Iw={__name:"SummonModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},enemyList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","summon"],setup(t,{expose:e,emit:s}){e(),Zt(m=>({"f4bd8aaf-panel6Src":n}));const n=`url('${H("@assets/ui/panel6.png")}')`,o=t,r=s,i=F(null),a=Ce(()=>[...o.enemyList].sort((m,g)=>m.level-g.level));function l(m){i.value=m}function c(){if(!i.value){f("[SummonModal] ");return}f("[SummonModal] :",i.value.name),r("summon",i.value.name),u()}function u(){i.value=null,r("close")}function d(m){return{goblin:"",cruiser:"",scout:"",boxer:"",horn:"",assassin:"",devourer:"",mirror:"",guard:"",demon:"",variant:"",shatra:"BOSS",glutton:"BOSS"}[m]||m}const p={panel6Src:n,props:o,emit:r,selectedEnemy:i,sortedEnemies:a,selectEnemy:l,handleConfirm:c,handleClose:u,getEnemyTypeLabel:d,ref:F,computed:Ce,get getAssetUrl(){return H},get log(){return f}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},Lw={class:"modal-info"},Ow={class:"info-text"},Dw={class:"copper-name"},Nw={class:"cost-text"},$w=["src"],Gw={class:"modal-body"},Hw={class:"enemy-list"},Uw=["onClick"],Fw={class:"enemy-header"},jw={class:"enemy-name-row"},Bw={class:"enemy-name"},zw={class:"enemy-level"},Vw={class:"enemy-type"},Ww={class:"enemy-stats"},qw={class:"stat"},Kw={class:"stat-value"},Xw={class:"stat"},Yw={class:"stat-value"},Jw={class:"stat"},Zw={class:"stat-value"},Qw={class:"stat"},eS={class:"stat-value"},tS={class:"stat"},nS={class:"stat-value"},sS={class:"enemy-desc"},oS={key:0,class:"selected-badge"},rS={class:"modal-footer"},iS=["disabled"];function aS(t,e,s,n,o,r){return $(),Bt(Xc,{to:"body"},[s.visible?($(),B("div",{key:0,class:"modal-overlay",onClick:Ln(n.handleClose,["self"])},[h("div",{class:"summon-modal",onClick:e[0]||(e[0]=Ln(()=>{},["stop"]))},[h("div",{class:"modal-header"},[e[1]||(e[1]=h("h2",{class:"modal-title"}," ",-1)),h("button",{class:"close-btn",onClick:n.handleClose,title:""},"")]),h("div",Lw,[h("p",Ow,[h("span",Dw,te(s.copperName),1),e[2]||(e[2]=zn("  ",-1))]),h("p",Nw,[h("img",{class:"cost-icon",src:n.getAssetUrl("resource/spiritual_spark.webp"),alt:""},null,8,$w),e[3]||(e[3]=zn(" ",-1)),e[4]||(e[4]=h("strong",null,"1 ",-1))])]),h("div",Gw,[h("div",Hw,[($(!0),B(et,null,Jt(n.sortedEnemies,i=>{var a,l;return $(),B("div",{key:i.name,class:nt(["enemy-card",{selected:((a=n.selectedEnemy)==null?void 0:a.name)===i.name}]),onClick:c=>n.selectEnemy(i)},[h("div",Fw,[h("div",jw,[h("span",Bw,te(i.name),1),h("span",zw,"Lv."+te(i.level),1)]),h("span",Vw,te(n.getEnemyTypeLabel(i.enemy_type)),1)]),h("div",Ww,[h("div",qw,[e[5]||(e[5]=h("span",{class:"stat-label"},"",-1)),h("span",Kw,te(i.health),1)]),h("div",Xw,[e[6]||(e[6]=h("span",{class:"stat-label"},"",-1)),h("span",Yw,te(i.attack),1)]),h("div",Jw,[e[7]||(e[7]=h("span",{class:"stat-label"},"",-1)),h("span",Zw,te(i.defense),1)]),h("div",Qw,[e[8]||(e[8]=h("span",{class:"stat-label"},"",-1)),h("span",eS,te(i.attack_range),1)]),h("div",tS,[e[9]||(e[9]=h("span",{class:"stat-label"},"",-1)),h("span",nS,te(i.move_range),1)])]),h("div",sS,te(i.description),1),((l=n.selectedEnemy)==null?void 0:l.name)===i.name?($(),B("div",oS,"   ")):we("",!0)],10,Uw)}),128))])]),h("div",rS,[h("button",{class:"btn btn-cancel",onClick:n.handleClose},""),h("button",{class:"btn btn-confirm",disabled:!n.selectedEnemy,onClick:n.handleConfirm},"  ",8,iS)])])])):we("",!0)])}const lS=St(Iw,[["render",aS],["__scopeId","data-v-f4bd8aaf"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ActionPanelParts/SummonModal.vue"]]),cS={__name:"StructurePanel",props:{structure:{type:Object,required:!0},resources:{type:Array,default:()=>[]},actionMode:{type:String,default:null}},emits:["close","action","cancel"],setup(t,{expose:e,emit:s}){e(),Zt(j=>({"76912848-panel11Src":S}));const n=t,o=s,r=Ce(()=>{var j;return((j=n.structure.structure_base)==null?void 0:j.name)||""}),i=Ce(()=>n.structure.owned||!1),a=Ce(()=>{var j;return((j=n.structure.structure_base)==null?void 0:j.has_storage)||!1}),l=Ce(()=>n.structure.storage||null),c=Ce(()=>n.structure.can_move||!1),u=Ce(()=>n.structure.can_attack||!1),d=Ce(()=>n.structure.now_health||0),p=Ce(()=>{var j;return((j=n.structure.structure_base)==null?void 0:j.health)||100}),m=Ce(()=>p.value===0?0:Math.max(0,Math.min(100,d.value/p.value*100))),g=Ce(()=>{const j=m.value;return j>60?"#4ade80":j>30?"#facc15":"#ef4444"}),y=H("@assets/ui/panel.png"),S=`url('${H("@assets/ui/panel11.png")}')`,E=Ce(()=>n.actionMode!==null),I=Ce(()=>n.actionMode==="move"?"...":n.actionMode==="attack"?"...":n.actionMode==="extract"?"...":n.actionMode==="transfer"?"...":"");function R(j){f(`[StructurePanel] : ${j}`),o("action",{type:j})}function M(){f("[StructurePanel] "),o("cancel")}function T(){o("close")}const x={props:n,emit:o,structureName:r,isOwned:i,hasStorage:a,storage:l,canMove:c,canAttack:u,nowHealth:d,maxHealth:p,healthPercent:m,healthColor:g,panelSrc:y,panel11Src:S,isInActionMode:E,actionModeText:I,handleAction:R,handleCancel:M,handleClose:T,get log(){return f},ref:F,computed:Ce,watch:ut,nextTick:vn,get getAssetUrl(){return H},get getItemName(){return ar}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},uS={key:0,class:"minimized-content"},dS={class:"minimized-info"},fS={class:"minimized-name"},pS={class:"minimized-action"},hS={key:1},mS={class:"structure-panel__header"},gS={class:"structure-panel__title"},_S={class:"structure-panel__body"},yS={class:"structure-panel__health"},vS={class:"structure-panel__health-bar"},bS={class:"structure-panel__health-text"},wS={key:0,class:"structure-panel__storage"},SS={class:"structure-panel__storage-content"},MS={key:0,class:"structure-panel__storage-item"},TS={class:"structure-panel__storage-name"},CS={class:"structure-panel__storage-count"},ES={key:1,class:"structure-panel__storage-empty"},xS={key:1,class:"structure-panel__ground-resources"},AS={class:"structure-panel__ground-list"},kS={class:"structure-panel__resource-name"},RS={class:"structure-panel__resource-count"},PS={key:2,class:"structure-panel__actions"};function IS(t,e,s,n,o,r){return $(),B("div",{class:nt(["structure-panel",{"structure-panel--minimized":n.isInActionMode}])},[n.isInActionMode?($(),B("div",uS,[h("div",dS,[h("span",fS,te(n.structureName),1),h("span",pS,te(n.actionModeText),1)]),h("div",{class:"minimized-actions"},[h("button",{class:"mini-btn mini-btn--cancel",onClick:n.handleCancel,title:""},"  ")])])):($(),B("div",hS,[h("div",mS,[h("div",gS,[zn(te(n.structureName)+" ",1),h("span",{class:nt(["structure-panel__badge",{"structure-panel__badge--owned":n.isOwned}])},te(n.isOwned?"":""),3)]),h("button",{class:"structure-panel__close",onClick:n.handleClose,"aria-label":""},"  ")]),h("div",_S,[h("div",yS,[e[4]||(e[4]=h("div",{class:"structure-panel__health-label"},"",-1)),h("div",vS,[h("div",{class:"structure-panel__health-fill",style:Xt({width:n.healthPercent+"%",backgroundColor:n.healthColor})},null,4)]),h("div",bS,te(Math.ceil(n.nowHealth))+" / "+te(Math.ceil(n.maxHealth)),1)]),n.hasStorage?($(),B("div",wS,[e[5]||(e[5]=h("div",{class:"structure-panel__storage-label"},"",-1)),h("div",SS,[n.storage?($(),B("div",MS,[h("span",TS,te(n.getItemName(n.storage)),1),h("span",CS,"x"+te(n.storage.count||0),1)])):($(),B("div",ES,""))])])):we("",!0),s.resources&&s.resources.length>0?($(),B("div",xS,[e[6]||(e[6]=h("div",{class:"structure-panel__ground-label"},"",-1)),h("div",AS,[($(!0),B(et,null,Jt(s.resources,(i,a)=>($(),B("div",{key:a,class:"structure-panel__ground-item"},[h("span",kS,te(i.name||""),1),h("span",RS,"x"+te(i.count||0),1)]))),128))])])):we("",!0),n.isOwned?($(),B("div",PS,[n.canMove?($(),B("button",{key:0,class:"structure-panel__action-btn structure-panel__action-btn--move",onClick:e[0]||(e[0]=i=>n.handleAction("move"))},"  ")):we("",!0),n.canAttack?($(),B("button",{key:1,class:"structure-panel__action-btn structure-panel__action-btn--attack",onClick:e[1]||(e[1]=i=>n.handleAction("attack"))},"  ")):we("",!0),n.hasStorage&&n.storage?($(),B("button",{key:2,class:"structure-panel__action-btn structure-panel__action-btn--transfer",onClick:e[2]||(e[2]=i=>n.handleAction("transfer"))},"  ")):we("",!0),n.hasStorage?($(),B("button",{key:3,class:"structure-panel__action-btn structure-panel__action-btn--extract",onClick:e[3]||(e[3]=i=>n.handleAction("extract"))},"  ")):we("",!0)])):we("",!0)])]))],2)}const LS=St(cS,[["render",IS],["__scopeId","data-v-76912848"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/StructurePanel.vue"]]),OS={__name:"ResourcePanel",setup(t,{expose:e}){Zt(p=>({"e44a1df5-panel5Src":n}));const s=H("@assets/ui/panel5.png"),n=`url('${s}')`,o=F({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0}),r=["HeartCrystalDust","RecallGear","ResonantCrystal","RefinedCopper"],i=F(!1),a=F({visible:!1,success:!0,text:""});function l(p,m=!0,g=1500){a.value={visible:!0,success:m,text:p},window.clearTimeout(l._timer),l._timer=window.setTimeout(()=>{a.value.visible=!1},g)}async function c(){if(!i.value){i.value=!0;try{const p=await wl();In(Tt.UPDATE_RESOURCES),(p==null?void 0:p.type)==="error"?(console.warn("[ResourcePanel] :",(p==null?void 0:p.content)||p),l("",!1)):(console.log("[ResourcePanel] :",p),l("",!0))}catch(p){console.error("[ResourcePanel] :",p),l("",!1)}finally{i.value=!1}}}async function u(){try{const p=await Wn();if(p){const m={},g={};return Object.keys(o.value).forEach(y=>{const S=o.value[y],E=p[y]||0;g[y]=E;const I=E-S;I>0&&(m[y]=I)}),o.value=g,In(Tt.RESOURCES_UPDATED,m),m}}catch(p){console.error("[ResourcePanel] :",p)}return{}}ot(()=>{u(),Vn(Tt.UPDATE_RESOURCES,u)}),wt(()=>{ps(Tt.UPDATE_RESOURCES,u)}),e({updateResources:u});const d={buildIconSrc:s,panel5Src:n,resources:o,recipeItems:r,isCrafting:i,toast:a,showToast:l,handleCraft:c,updateResources:u,ref:F,onMounted:ot,onBeforeUnmount:wt,get get_resource(){return Wn},get craft(){return wl},get getResourceIcon(){return dm},get getResourceName(){return Nu},get RESOURCE_META(){return On},get onEvent(){return Vn},get offEvent(){return ps},get emitEvent(){return In},get EventTypes(){return Tt},get getAssetUrl(){return H}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}},DS={class:"resource-panel"},NS={class:"resource-list"},$S={class:"resource-layout"},GS={class:"row row-top"},HS=["title"],US=["src","alt"],FS={class:"resource-count"},jS={class:"resource-tooltip"},BS=["title"],zS=["src","alt"],VS={class:"resource-count"},WS={class:"resource-tooltip"},qS={class:"row row-middle"},KS=["title"],XS=["src","alt"],YS={class:"resource-count"},JS={class:"resource-tooltip"},ZS={class:"row row-bottom"},QS=["title"],e0=["src","alt"],t0={class:"resource-count"},n0={class:"resource-tooltip"},s0=["title"],o0=["src","alt"],r0={class:"resource-count"},i0={class:"resource-tooltip"},a0={class:"crafting-section"},l0={class:"crafting-grid"},c0=["src"],u0={class:"craft-count"},d0={class:"craft-arrow-group"},f0=["src","alt"],p0={class:"craft-result"},h0={class:"recipe-display"},m0=["src"],g0={class:"craft-count"};function _0(t,e,s,n,o,r){var i;return $(),B("div",DS,[e[0]||(e[0]=h("div",{class:"resource-header"},[h("span",{class:"header-text"},"")],-1)),h("div",NS,[h("div",$S,[h("div",GS,[h("div",{class:"resource-slot small",title:n.getResourceName("RecallGear")},[n.getResourceIcon("RecallGear")?($(),B("img",{key:0,src:n.getResourceIcon("RecallGear"),alt:n.getResourceName("RecallGear"),class:"resource-icon"},null,8,US)):we("",!0),h("div",FS,te(n.resources.RecallGear||0),1),h("div",jS,te(n.getResourceName("RecallGear")),1)],8,HS),h("div",{class:"resource-slot small",title:n.getResourceName("HeartCrystalDust")},[n.getResourceIcon("HeartCrystalDust")?($(),B("img",{key:0,src:n.getResourceIcon("HeartCrystalDust"),alt:n.getResourceName("HeartCrystalDust"),class:"resource-icon"},null,8,zS)):we("",!0),h("div",VS,te(n.resources.HeartCrystalDust||0),1),h("div",WS,te(n.getResourceName("HeartCrystalDust")),1)],8,BS)]),h("div",qS,[h("div",{class:"resource-slot large",title:n.getResourceName("SpiritalSpark")},[n.getResourceIcon("SpiritalSpark")?($(),B("img",{key:0,src:n.getResourceIcon("SpiritalSpark"),alt:n.getResourceName("SpiritalSpark"),class:"resource-icon"},null,8,XS)):we("",!0),h("div",YS,te(n.resources.SpiritalSpark||0),1),h("div",JS,te(n.getResourceName("SpiritalSpark")),1)],8,KS)]),h("div",ZS,[h("div",{class:"resource-slot small",title:n.getResourceName("ResonantCrystal")},[n.getResourceIcon("ResonantCrystal")?($(),B("img",{key:0,src:n.getResourceIcon("ResonantCrystal"),alt:n.getResourceName("ResonantCrystal"),class:"resource-icon"},null,8,e0)):we("",!0),h("div",t0,te(n.resources.ResonantCrystal||0),1),h("div",n0,te(n.getResourceName("ResonantCrystal")),1)],8,QS),h("div",{class:"resource-slot small",title:n.getResourceName("RefinedCopper")},[n.getResourceIcon("RefinedCopper")?($(),B("img",{key:0,src:n.getResourceIcon("RefinedCopper"),alt:n.getResourceName("RefinedCopper"),class:"resource-icon"},null,8,o0)):we("",!0),h("div",r0,te(n.resources.RefinedCopper||0),1),h("div",i0,te(n.getResourceName("RefinedCopper")),1)],8,s0)])])]),h("div",a0,[h("div",l0,[($(),B(et,null,Jt(n.recipeItems,(a,l)=>{var c;return h("div",{class:"craft-slot",key:l},[(c=n.RESOURCE_META[a])!=null&&c.icon?($(),B("img",{key:0,src:n.RESOURCE_META[a].icon,class:"craft-icon"},null,8,c0)):we("",!0),h("div",u0,te(n.resources[a]||0),1)])}),64))]),h("div",d0,[h("img",{class:nt(["craft-arrow-img",{disabled:n.isCrafting}]),src:n.getAssetUrl("@assets/ui/upgrade.png"),alt:n.isCrafting?"":"",onClick:n.handleCraft},null,10,f0),n.toast.visible?($(),B("div",{key:0,class:nt(["craft-toast",{success:n.toast.success,error:!n.toast.success}])},te(n.toast.text),3)):we("",!0)]),h("div",p0,[h("div",h0,[(i=n.RESOURCE_META.SpiritalSpark)!=null&&i.icon?($(),B("img",{key:0,src:n.RESOURCE_META.SpiritalSpark.icon,class:"recipe-icon"},null,8,m0)):we("",!0),h("div",g0,te(n.resources.SpiritalSpark||0),1)])])])])}const y0=St(OS,[["render",_0],["__scopeId","data-v-e44a1df5"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/ResourcePanel.vue"]]),v0={__name:"GameScene",props:{isGameMode:{type:Boolean,default:!1},musicOn:{type:Boolean,default:!0}},emits:["back"],setup(t,{expose:e,emit:s}){e(),Zt(w=>({"76eb1444-panel7Src":ma,"76eb1444-panel8Src":ga}));const n=t,o=F(null),r=s,i=F(null),a=jl("gameScene"),l=F(null),c=F(null),u=F(null),d=F(null),p=F(null),m=F(null),g=ts("move"),y=ts("moveEnemy"),S=ts("attack"),E=ts("attackEnemy"),I=ts("meHurt"),R=ts("enemyHurt");let M,T,x,j,V=[];const G=Zr();let J={focusPosition:null,focusTarget:null,lerpFactor:G.focusLerpFactor},Q=null,z=new Lt,be=null,P=null,de=null,Te=null;const oe=new Map,fe={w:!1,a:!1,s:!1,d:!1,shift:!1,space:!1},qe=Zr(),le=qe.moveSpeed,k=qe.rotationSpeed,ue=F(Yr("controlMode")||"touchpad"),N=F(Yr("mouseSensitivity")||.002);window.updateControlMode=w=>{ue.value=w,f(`[GameScene] : ${w}`)},window.updateMouseSensitivity=w=>{N.value=w};function ae(w){const O=w.key.toLowerCase();O==="w"||O==="a"||O==="s"||O==="d"?fe[O]=!0:O==="shift"?fe.shift=!0:O===" "?(fe.space=!0,w.preventDefault()):O==="escape"&&document.pointerLockElement&&document.exitPointerLock()}function me(w){const O=w.key.toLowerCase();O==="w"||O==="a"||O==="s"||O==="d"?fe[O]=!1:O==="shift"?fe.shift=!1:O===" "&&(fe.space=!1)}let ze=!1,He=0,Xe=0,je=0,tt=0,it=!1;function Ht(w){w.button===0&&(ue.value==="mouse"&&o.value&&o.value.requestPointerLock(),ze=!0,He=w.clientX,Xe=w.clientY)}function _(){ze=!1}function b(w){if(ue.value==="touchpad"){if(!ze)return;const O=w.clientX-He,se=w.clientY-Xe;tt-=O*N.value,je-=se*N.value,He=w.clientX,Xe=w.clientY}else if(ue.value==="mouse"&&it){const O=w.movementX||0,se=w.movementY||0;tt-=O*N.value,je-=se*N.value}je=Math.max(-Math.PI/2,Math.min(Math.PI/2,je)),T.rotation.order="YXZ",T.rotation.y=tt,T.rotation.x=je}function L(){it=document.pointerLockElement===o.value,f(it?"[GameScene] ":"[GameScene] ")}function q(){f("[GameScene] ")}const A=F(null),U=F([]),Y=F(null),K=F(!1),X=F([]),W=F([]),ce=F(null),ie=F(null),he=F(!1),ge=F(null),Oe=F([]),Ne=F(null),Be=F(1),Pe=F([]),Ue=F(-1),pe=F(null),st=F(!1),Mt=F(new Set),Wt=F(!1),at=new Map,Ut=F(!1),gs=F(!1),Kn=F(!1),Mo=F(!1),zu=Ce(()=>{if(Pe.value.length===0||Ue.value<0||Ue.value>=Pe.value.length)return null;const w=Pe.value[Ue.value];return w?w.id:null});ot(async()=>{var O;f("[GameScene] "),Ki(),f("[GameScene] "),Zi(),f("[GameScene] ");const{messageQueue:w}=await $u(async()=>{const{messageQueue:se}=await Promise.resolve().then(()=>gm);return{messageQueue:se}},void 0,import.meta.url);if((O=w.sceneContext)!=null&&O.setTestMode&&w.sceneContext.setTestMode("eventloop"),window.__ACTUAL_COPPER_IDS__){const se=window.__ACTUAL_COPPER_IDS__;f("[GameScene] ID:",se);const ne=JSON.stringify({type:"on_game_start",content:{ids:se}});xe(ne).catch(Me=>{f("[GameScene] ",Me)}),delete window.__ACTUAL_COPPER_IDS__}else f("[GameScene] ID");window.addEventListener("keydown",ae),window.addEventListener("keyup",me),window.addEventListener("mousedown",Ht),window.addEventListener("mouseup",_),window.addEventListener("mousemove",b),document.addEventListener("pointerlockchange",L),document.addEventListener("pointerlockerror",q),Er(),window.setCameraFocus=(se=8,ne=6)=>{window.cameraFocusDistance=se,window.cameraFocusHeight=ne,f(`[GameScene] : =${se}, =${ne}`)},window.resetCamera=()=>{T.position.set(0,10,15),T.lookAt(0,0,0),tt=T.rotation.y,je=T.rotation.x,J.focusPosition=null,J.focusTarget=null,f("[GameScene] ")},window.toggleAutoFocus=()=>{window.disableAutoFocus=!window.disableAutoFocus,f(`[GameScene] ${window.disableAutoFocus?"":""}`),window.disableAutoFocus&&(J.focusPosition=null,J.focusTarget=null)},n.musicOn&&i.value&&setTimeout(()=>{if(i.value.readyState>=2)i.value.play().then(()=>{f("[GameScene] ")}).catch(ne=>{f("[GameScene] :",ne)});else{const ne=()=>{i.value.play().then(()=>{f("[GameScene] ")}).catch(Me=>{f("[GameScene] :",Me)}),i.value.removeEventListener("canplay",ne)};i.value.addEventListener("canplay",ne,{once:!0})}},200)}),ut(()=>n.musicOn,w=>{if(i.value)if(w)if(i.value.readyState>=2)i.value.play().catch(O=>{f("[GameScene] :",O)});else{const O=()=>{i.value.play().catch(se=>{f("[GameScene] :",se)}),i.value.removeEventListener("canplay",O)};i.value.addEventListener("canplay",O)}else i.value.pause()}),wt(()=>{window.removeEventListener("resize",Cr),window.removeEventListener("click",xr),window.removeEventListener("keydown",ae),window.removeEventListener("keyup",me),window.removeEventListener("mousedown",Ht),window.removeEventListener("mouseup",_),window.removeEventListener("mousemove",b),document.removeEventListener("pointerlockchange",L),document.removeEventListener("pointerlockerror",q),document.pointerLockElement&&document.exitPointerLock(),i.value&&i.value.pause(),P&&P.dispose(),de&&de.dispose(),Te&&Te.dispose(),M&&Yl(M),x&&x.dispose()});function Ki(){M=new ur;const w=Gl();Bl(M,w),T=Vl(),Q=new Ma,x=Wl(o.value),j=null;const O=Hl();zl(M,O),Xl(M),be=ql(),n.isGameMode&&window.addEventListener("click",xr),Kl(M,V),P=$l(M,T),de=Ul(M),Te=Fl(M),f("[GameScene] "),f('[GameScene] - /(ID=1,2)""'),f("[GameScene] - EventLoop"),window.addEventListener("resize",Cr)}async function Xi(w,O,se,ne=1){const Me=po(w,O);try{const v=await xt.loadModel(Me,!0);f(`[GameScene] : ${O}`);const C=v.clone(!0);C.traverse(ye=>{ye.material&&(Array.isArray(ye.material)?ye.material=ye.material.map(ve=>ve.clone()):ye.material=ye.material.clone())});const ee=new Dt().setFromObject(C).getSize(new Re),re=new en;re.add(C),re.position.set(se[0],0,se[1]),re.scale.set(ne,ne,ne),re.rotation.y=0;const _e=new Dt().setFromObject(re);return re.position.y=-_e.min.y,f(`[GameScene] : ${O}, URL: ${Me}`),re}catch(v){return f(`[GameScene] : ${O}`,v),null}}async function Yi(w,O,se=1,ne="model"){try{const Me=await xt.loadModel(w,!0);f(`[GameScene] : ${ne}, url=${w}`);const v=Me.clone(!0);v.traverse(re=>{re.material&&(Array.isArray(re.material)?re.material=re.material.map(_e=>_e.clone()):re.material=re.material.clone())});const D=new Dt().setFromObject(v).getSize(new Re),ee=new en;return ee.add(v),ee.position.set(O[0],0,O[1]),ee.scale.set(se,se,se),ee}catch(Me){return f(`[GameScene] : ${ne}, url=${w}, error=${Me}`),null}}async function Ji(w,O,se=1){const ne=ho(w);try{const Me=await xt.loadModel(ne,!0);f(`[GameScene] : ${w}`);const v=Me.clone(!0);v.traverse(ye=>{ye.material&&(Array.isArray(ye.material)?ye.material=ye.material.map(ve=>ve.clone()):ye.material=ye.material.clone())});const D=new Dt().setFromObject(v).getSize(new Re),ee=new en;ee.add(v),ee.position.set(O[0],0,O[1]),ee.scale.set(se,se,se),ee.rotation.y=0;const re=new Dt().setFromObject(ee);ee.position.y=-re.min.y;const _e=new Ts(16729156,2.5,12);return _e.position.set(0,D.y*se*.8,0),ee.add(_e),f(`[GameScene] : ${w}, URL: ${ne}`),ee}catch(Me){return f(`[GameScene] : ${w}`,Me),null}}let _s=null;function Zi(){const w=new Map,O=new Map,se=new Map;function ne(v,C,D){const ee=V.find(ve=>ve.id===v);if(!ee||!ee.object)return;let re,_e;C==="move"?(re=65280,_e=.8):C==="attack"?(re=16711680,_e=1):C==="summon"?(re=16776960,_e=1.2):(re=16777215,_e=1),w.has(v)||w.set(v,{});const ye=w.get(v);if(ye[C]&&(M.remove(ye[C]),ye[C].geometry.dispose(),ye[C].material.dispose(),delete ye[C]),D){const ve=new si(_e-.1,_e,32),Ie=new bt({color:re,side:zt,transparent:!0,opacity:.6}),De=new lt(ve,Ie);De.rotation.x=-Math.PI/2,De.position.set(ee.object.position.x,.1,ee.object.position.z),M.add(De),ye[C]=De}}const Me=v=>{if(V.forEach(C=>{C.object&&(C.object.scale.set(1,1,1),C.object.traverse(D=>{var ee;D.material&&((ee=D.material.emissive)==null||ee.setHex(0),D.material.emissiveIntensity!==void 0&&(D.material.emissiveIntensity=0))}))}),v!==null){const C=V.find(D=>D.id===v);if(C){C.object.scale.set(1.1,1.1,1.1),C.object.traverse(ee=>{ee.material&&ee.material.emissive&&(ee.material.emissive.setHex(16755200),ee.material.emissiveIntensity=.5)});const D=C.type==="summon"?"":C.type==="copper"?"":"";f(`[GameScene] ${D}: ${C.name} (ID=${v})`)}}};_s=(v,C)=>{const D=V.find(pt=>pt.id===v);if(!D)return;const ee=new Map;D.object.traverse(pt=>{pt.material&&pt.material.emissive&&(ee.set(pt,{color:pt.material.emissive.getHex(),intensity:pt.material.emissiveIntensity||0}),pt.material.emissive.setHex(16711680),pt.material.emissiveIntensity=.8)}),setTimeout(()=>{ee.forEach((pt,Qt)=>{Qt.material&&Qt.material.emissive&&(Qt.material.emissive.setHex(pt.color),Qt.material.emissiveIntensity=pt.intensity)})},500);const re=new Re(D.object.position.x,.5,D.object.position.z),_e=new Re(C[0],.5,C[1]),ye=new Re().subVectors(_e,re),ve=ye.length(),Ie=new Re().addVectors(re,_e).multiplyScalar(.5),De=new Fo(.05,.05,ve,8),Ae=new bt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5}),$e=new lt(De,Ae);$e.position.copy(Ie),$e.quaternion.setFromUnitVectors(new Re(0,1,0),ye.normalize()),M.add($e);const We=new si(.2,.4,32),Ze=new bt({color:16711680,side:zt,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5}),Rt=new lt(We,Ze);Rt.rotation.x=-Math.PI/2,Rt.position.copy(_e),M.add(Rt);const Xn=performance.now(),gt=300;function _t(){const Qt=(performance.now()-Xn)/gt;if(Qt<1){const Fs=1-Qt;Ae&&(Ae.opacity=Fs),Ze&&(Ze.opacity=Fs),Rt.scale.set(1+Qt*2,1+Qt*2,1),requestAnimationFrame(_t)}else M.remove($e),M.remove(Rt),De.dispose(),Ae.dispose(),We.dispose(),Ze.dispose()}_t(),f(`[GameScene] : ID=${v}, =${re.x.toFixed(1)},${re.z.toFixed(1)}  [${C[0]},${C[1]}]`)},ke.setSceneContext({scene:M,camera:T,controls:j,models:V,gridCellSize:1,focusState:J,focusOnModel:Qi,onShowCopperInfo:(v,C,D)=>{var re,_e,ye,ve,Ie,De,Ae,$e,We,Ze,Rt;f(`[GameScene] onShowCopperInfo : type=${(re=v.copper)==null?void 0:re.copper_type}, can_build=${v.can_build}, can_summon=${v.can_summon}`),((_e=v.copper)==null?void 0:_e.copper_type)==="CraftsMan"&&v.id!==void 0&&at.set(v.id,v.can_build===!0);const ee=((ve=(ye=v.copper)==null?void 0:ye.copper_info)==null?void 0:ve.name)||v.name||((De=(Ie=v.enemy)==null?void 0:Ie.enemy_base)==null?void 0:De.name)||(($e=(Ae=v.enemy)==null?void 0:Ae.enemy_base)==null?void 0:$e.enemy_type)||((We=v.enemy_base)==null?void 0:We.name)||((Ze=v.enemy_base)==null?void 0:Ze.enemy_type)||` #${v.id}`;((Rt=v.copper)==null?void 0:Rt.copper_type)==="CraftsMan"?(f(`[GameScene]  can_build=${v.can_build}  can_summon`),A.value={...v,name:ee,can_summon:v.can_build===!0}):A.value={...v,name:ee},U.value=C||[],K.value=D||!1,f(`[GameScene] : ID=${A.value.id}, has_attack_targets=${K.value}, can_summon=${A.value.can_summon}`)},onShowStructureInfo:(v,C)=>{var D;ce.value=v,ie.value={structure:v,resources:C},f(`[GameScene] : ID=${v.id}, =${(D=v.structure_base)==null?void 0:D.name}, =${v.now_health}/${v.structure_base.health}`)},highlightSelectedCopper:Me,createAttackEffect:_s,onMoveStart:(v,C)=>{n.isGameMode&&st.value&&(C==null?void 0:C.type)==="enemy"&&!(C!=null&&C.isOwned)&&(f(`[GameScene]  ${v} `),Mt.value.add(v))},onMoveComplete:v=>{if(!n.isGameMode)return;const C=V.find(_e=>_e.id===v);if((C==null?void 0:C.type)==="structure"){f("[GameScene] "),pe.value=null,Wt.value=!1,setTimeout(async()=>{await vs(v)},300);return}if((C==null?void 0:C.type)==="enemy"&&!(C!=null&&C.isOwned)){st.value&&Mt.value.has(v)?(f(`[GameScene]  ${v} `),Mt.value.delete(v),Mt.value.size===0&&(f("[GameScene] "),st.value=!1)):f(`[GameScene]  ${v} `);return}const ee=Pe.value.some(_e=>_e.id===v),re=(C==null?void 0:C.type)==="summon"||(C==null?void 0:C.isOwned);!ee&&!re||(Wt.value=!1,f("[GameScene] "),pe.value=null,Y.value&&Y.value.cancelAction(),setTimeout(async()=>{(C==null?void 0:C.type)==="summon"?await Us(v,!1):await ys(v),setTimeout(()=>{if(U.value&&U.value.length>0){f("[GameScene] ");return}kr()},100)},300))},onCraftResult:(v,C)=>{f(`[GameScene] : ${v?"":""} - ${C}`),alert(C)},onResourceNotEnough:v=>{f(`[GameScene] : ${v}`),alert(` ${v}`),pe.value=null,Ne.value=null,he.value=!1,ge.value=null},onSummonFailed:v=>{f(`[GameScene] : ${v}`),alert(` ${v}`),pe.value=null,he.value=!1,ge.value=null},onShowSummonMenu:v=>{f("[GameScene] :",v),Oe.value=v||[]},onShowStructureMenu:v=>{var C;f("[GameScene] ",(v==null?void 0:v.length)||0,""),(C=Y.value)!=null&&C.showBuildMenu?Y.value.showBuildMenu(v||[]):f("[GameScene]  copperActionPanelRef.value.showBuildMenu ")},onRemoveCopper:v=>{const C=Pe.value.findIndex(D=>D.id===v);C>-1&&(f(`[GameScene] : ID=${v}`),Pe.value.splice(C,1),A.value&&A.value.id===v&&Ar(),Pe.value.length===0||Ue.value===C?Ue.value=-1:Ue.value>C?Ue.value-=1:Ue.value>=Pe.value.length&&(Ue.value=Pe.value.length-1))},onShowResourceGain:(v,C)=>{f("[GameScene] :",v,C),Te&&Object.keys(C).length>0&&Te.createResourceGainEffect(v,C)},onGameOver:()=>{f("[GameScene] "),Ut.value=!0},onGameSuccess:()=>{f("[GameScene] "),gs.value=!0},onAttackComplete:v=>{if(!n.isGameMode)return;const C=V.find(ee=>ee.id===v);if((C==null?void 0:C.type)==="structure"){f("[GameScene] "),pe.value=null,setTimeout(async()=>{await vs(v)},300);return}if(!Pe.value.some(ee=>ee.id===v)){f("[GameScene] ");return}f("[GameScene] "),pe.value=null,Y.value&&Y.value.cancelAction(),setTimeout(async()=>{(C==null?void 0:C.type)==="summon"?await Us(v,!1):await ys(v),setTimeout(()=>{if(U.value&&U.value.length>0){f("[GameScene] ");return}kr()},100)},300)},onSetMoveBlock:v=>{de&&de.createIndicator(v,"move"),f(`[GameScene] : =${v}`)},onSetAttackBlock:v=>{if(pe.value==="transferring"){X.value.push(v);const C=V.find(D=>{if(D.type==="copper"&&D.object){const ee=D.object.position;return Math.abs(ee.x-v[0])<.1&&Math.abs(ee.z-v[1])<.1}return!1});if(C){const D=Pe.value.find(re=>re.id===C.id);W.value.find(re=>re.id===C.id)||(W.value.push({id:C.id,name:C.name||(D?D.name:` #${C.id}`)||` #${C.id}`,position:v}),f(`[GameScene] : ${C.name||C.id} (ID=${C.id}), =${W.value.length}`))}else f(`[GameScene]  ${v} `)}else de&&de.createIndicator(v,"attack"),K.value=!0,f(`[GameScene] : ${v}`)},onSetCanSummonBlock:v=>{de&&de.createIndicator(v,"summon"),f(`[GameScene] : =${v}`)},onClearBlock:v=>{de&&de.clearIndicatorAt(v)},onSetCopper:async(v,C,D)=>{var Ae,$e,We,Ze,Rt,Xn;if(f(`[GameScene] : id=${D.id}, pos=${C}`),V.find(gt=>gt.id===D.id)){f(`[GameScene] ID=${D.id}`);return}if(((Ae=D.copper)==null?void 0:Ae.copper_type)==="CraftsMan"&&(at.set(D.id,D.can_build===!0),f(`[GameScene]  can_build : id=${D.id}, can_build=${D.can_build}`)),n.isGameMode){const gt={id:D.id,name:(($e=D.copper.copper_info)==null?void 0:$e.name)||` #${D.id}`,level:Number(((We=D.copper)==null?void 0:We.level)??0),turnDone:!1};Pe.value.find(_t=>_t.id===D.id)||(Pe.value.push(gt),f(`[GameScene] : ${gt.name}`))}const re=D.copper.copper_type||"Arcanist",_e=((Ze=D.copper.copper_info)==null?void 0:Ze.name)||"default",ye=(Rt=D.copper.copper_info)==null?void 0:Rt.model_url;let ve=1;switch(re){case"IronWall":ve=1.2;break;case"Arcanist":ve=1;break;case"Mechanic":ve=1.1;break;case"Resonator":ve=1;break;case"CraftsMan":ve=1;break;default:ve=1}let Ie;if(ye&&ye.includes("/enemy/")){const gt=H(ye);if(f(`[GameScene] URL: ${ye} -> ${gt}`),Ie=await Yi(gt,C,ve,_e),Ie){const pt=new Dt().setFromObject(Ie).getSize(new Re),Qt=new Dt().setFromObject(Ie);Ie.position.y=-Qt.min.y;const Fs=new Ts(4474111,2.5,12);Fs.position.set(0,pt.y*ve*.8,0),Ie.add(Fs)}}else{const gt=Ol(_e),_t=Dl(re);f(`[GameScene] : =${_e}, =${gt}, type=${re}, typeFolder=${_t}`),Ie=await Xi(_t,gt,C,ve)}if(!Ie){f(`[GameScene] : ${_e}`);const gt=new hn(.8,.8,.8);let _t=4491519;switch(re){case"IronWall":_t=8947848;break;case"Arcanist":_t=16729224;break;case"Mechanic":_t=4521864;break;case"Resonator":_t=16755268;break;case"CraftsMan":_t=4474111;break}const pt=new vt({color:_t});Ie=new lt(gt,pt),Ie.position.set(C[0],.4,C[1])}Ie.userData.modelId=D.id,M.add(Ie);const De={id:D.id,object:Ie,name:((Xn=D.copper.copper_info)==null?void 0:Xn.name)||`Copper_${D.id}`,type:"copper"};V.push(De),f(`[GameScene] : ${De.name} (ID=${D.id})`)},onSetEnemy:async(v,C,D)=>{var $e,We,Ze,Rt,Xn;const ee=D.id,re=D.owned||!1;if(f(`[GameScene] : id=${ee}, pos=${C}, owned=${re}`),V.find(gt=>gt.id===ee)){f(`[GameScene] ID=${ee}`);return}const ve=((($e=D.enemy_base)==null?void 0:$e.enemy_type)||"").toLowerCase()||"goblin";let Ie=1;switch(ve){case"demon":case"glutton":case"devourer":Ie=1.5;break;case"guard":case"horn":Ie=1.2;break;default:Ie=1}const De={id:ee,object:null,name:((We=D.enemy_base)==null?void 0:We.enemy_type)||`Enemy_${ee}`,type:re?"summon":"enemy",position:C,isOwned:re,isLoading:!0};V.push(De);let Ae=await Ji(ve,C,Ie);if(!Ae){f(`[GameScene] : ${ve}`);const gt=new hn(.8,.8,.8),_t=new vt({color:re?4474111:16711680});Ae=new lt(gt,_t),Ae.position.set(C[0],.4,C[1])}if(re&&Ae){const _t=new Dt().setFromObject(Ae).getSize(new Re),pt=new Ts(4474111,2.5,12);pt.position.set(0,_t.y*Ie*.8,0),Ae.add(pt),f(`[GameScene] : ${ve}`)}Ae.userData.modelId=ee,M.add(Ae),De.object=Ae,De.isLoading=!1,D.now_health!==void 0&&((Ze=D.enemy_base)==null?void 0:Ze.health)!==void 0&&P&&(P.createOrUpdateHealthBar(ee,D.now_health,D.enemy_base.health),f(`[GameScene] : ${ve} (${D.now_health}/${D.enemy_base.health})`)),re&&(Pe.value.push({id:ee,name:((Rt=D.enemy_base)==null?void 0:Rt.name)||ve,type:"summon",enemy:D}),f(`[GameScene] : ${ve} (ID=${ee})`)),f(`[GameScene] : ${((Xn=D.enemy_base)==null?void 0:Xn.enemy_type)||ee}, owned=${re}`)},onSetMaterial:async(v,C,D)=>{var Ie,De,Ae;if(f(`[GameScene] : id=${v}, pos=${C}, name=${(Ie=D.material_base)==null?void 0:Ie.name}`),V.find($e=>$e.id===v)){f(`[GameScene] ID=${v}`);return}const re=((De=D.material_base)==null?void 0:De.name)||"",_e=(Ae=D.material_base)==null?void 0:Ae.model_url;if(!_e){f("[GameScene] model_url");const $e=new hn(.5,.5,.5),We=new vt({color:16755200,metalness:.3,roughness:.7}),Ze=new lt($e,We);Ze.position.set(C[0],.25,C[1]),Ze.userData.modelId=v,M.add(Ze),V.push({id:v,object:Ze,name:re||`Material_${v}`,type:"material"});return}const ye=_l(_e);let ve=null;try{const $e=await xt.loadModel(ye,!0),We=new en;We.add($e),We.position.set(C[0],0,C[1]),We.scale.set(1,1,1),We.rotation.y=0;const Ze=new Dt().setFromObject(We);We.position.y=-Ze.min.y,ve=We,f(`[GameScene] : ${re}, URL: ${ye}`)}catch($e){f(`[GameScene] : ${re}`,$e);const We=new hn(.5,.5,.5),Ze=new vt({color:16755200,metalness:.3,roughness:.7});ve=new lt(We,Ze),ve.position.set(C[0],.25,C[1])}ve.userData.modelId=v,M.add(ve),V.push({id:v,object:ve,name:re||`Material_${v}`,type:"material"}),f(`[GameScene] : ${re}`)},onSetStructure:async(v,C,D)=>{var Ie,De;if(f(`[GameScene] : id=${v}, pos=${C}`),V.find(Ae=>Ae.id===v)){f(`[GameScene] ID=${v}`);return}const re=((Ie=D.structure_base)==null?void 0:Ie.name)||"",_e=Nl(re),ye=Mi(_e);let ve=null;try{const Ae=await xt.loadModel(ye,!0),$e=new en;$e.add(Ae),$e.position.set(C[0],0,C[1]),$e.scale.set(1,1,1),$e.rotation.y=0;const We=new Dt().setFromObject($e);$e.position.y=-We.min.y,ve=$e,f(`[GameScene] : ${re}, URL: ${ye}`)}catch(Ae){f(`[GameScene] : ${re}`,Ae);const $e=new hn(.9,1.2,.9),We=new vt({color:6710886,metalness:.5,roughness:.6});ve=new lt($e,We),ve.position.set(C[0],.6,C[1])}ve.userData.modelId=v,M.add(ve),V.push({id:v,object:ve,name:re||`Structure_${v}`,type:"structure"}),f(`[GameScene] : ${re}`),D.now_health!==void 0&&((De=D.structure_base)!=null&&De.health)&&P&&(P.createOrUpdateHealthBar(v,D.now_health,D.structure_base.health),f(`[GameScene] : ${re} (${D.now_health}/${D.structure_base.health})`))},onPutResourceMarker:v=>{const C=`${v[0]},${v[1]}`;if(se.has(C)){const We=se.get(C);M.remove(We),We.traverse(Ze=>{Ze.geometry&&Ze.geometry.dispose(),Ze.material&&(Array.isArray(Ze.material)?Ze.material.forEach(Rt=>Rt.dispose()):Ze.material.dispose())}),se.delete(C)}const D=new en,ee=new Fo(.15,.2,.25,8),re=new vt({color:16766720,emissive:16755200,emissiveIntensity:.6,metalness:.7,roughness:.3}),_e=new lt(ee,re);_e.position.y=.125,D.add(_e);const ye=new oi(.08,8,8),ve=new vt({color:16776960,emissive:16776960,emissiveIntensity:1}),Ie=new lt(ye,ve);Ie.position.y=.3,D.add(Ie);const De=v[0],Ae=v[1];D.position.set(De,.15,Ae);const $e=new Ts(16766720,1.5,3);$e.position.set(0,.3,0),D.add($e),M.add(D),se.set(C,D)},onClearResourceMarker:v=>{const C=`${v[0]},${v[1]}`;if(se.has(C)){const D=se.get(C);M.remove(D),D.traverse(ee=>{ee.geometry&&ee.geometry.dispose(),ee.material&&(Array.isArray(ee.material)?ee.material.forEach(re=>re.dispose()):ee.material.dispose())}),se.delete(C)}},onDisplayCanMove:(v,C)=>{f(`[GameScene] : id=${v}, show=${C}`),ne(v,"move",C),A.value&&A.value.id===v&&(A.value={...A.value,can_move:C},f(`[GameScene] selectedCopper.can_move=${C}`))},onDisplayCanAttack:(v,C)=>{f(`[GameScene] : id=${v}, show=${C}`),ne(v,"attack",C),A.value&&A.value.id===v&&(A.value={...A.value,can_attack:C},f(`[GameScene] selectedCopper.can_attack=${C}`))},onDisplayCanSummon:(v,C)=>{var _e;let D=C,ee=!1,re=!1;A.value&&A.value.id===v?(ee=((_e=A.value.copper)==null?void 0:_e.copper_type)==="CraftsMan",re=A.value.can_build===!0):at.has(v)&&(ee=!0,re=at.get(v)),ee&&(D=re,f(`[GameScene] : id=${v}, can_build=${D}`)),f(`[GameScene] /: id=${v}, show=${D}`),ne(v,"summon",D),A.value&&A.value.id===v&&(A.value={...A.value,can_summon:D},f(`[GameScene] selectedCopper.can_summon=${D}`))},onClearState:v=>{if(f(`[GameScene] : id=${v}`),w.has(v)){const C=w.get(v);C.move&&(M.remove(C.move),C.move.geometry.dispose(),C.move.material.dispose(),delete C.move),C.attack&&(M.remove(C.attack),C.attack.geometry.dispose(),C.attack.material.dispose(),delete C.attack),C.summon&&(M.remove(C.summon),C.summon.geometry.dispose(),C.summon.material.dispose(),delete C.summon),w.delete(v)}},onUpdateHealth:(v,C,D)=>{f(`[GameScene] : id=${v}, hp=${C}/${D}`);const ee=oe.get(v);if(ee!==void 0&&C<ee&&C>0){const re=V.find(_e=>_e.id===v);if(re){const _e=re.type==="copper",ye=_e?p.value:m.value;ye&&(ye.currentTime=0,ye.play().catch(ve=>{f(`[GameScene]  (${_e?"":""}):`,ve)}),f(`[GameScene] : ${_e?"":""} (ID=${v})`))}}oe.set(v,C),P&&P.createOrUpdateHealthBar(v,C,D)},onRemoveHealthBar:v=>{f(`[GameScene] : id=${v}`),P&&P.removeHealthBar(v),oe.delete(v)},onPutMapBlock:v=>{const C=`${v[0]},${v[1]}`;if(O.has(C)){const De=O.get(C);M.remove(De),De.geometry.dispose(),De.material&&(De.material.map&&De.material.map.dispose(),Array.isArray(De.material)?De.material.forEach(Ae=>{Ae.map&&Ae.map.dispose(),Ae.dispose()}):De.material.dispose())}const D=Ei();if(!D.enabled)return;const ee=D.size||.9,re=.05,_e=new hn(ee,re,ee);let ye;if(D.materialType==="texture"&&D.texture.url){const Ae=new Ds().load(D.texture.url);Ae.colorSpace=Pt,Ae.wrapS=Dn,Ae.wrapT=Dn,Ae.repeat.set(D.texture.repeat.x,D.texture.repeat.y);const $e=1;ye=new vt({map:Ae,transparent:!1,opacity:$e,depthTest:!0,depthWrite:!0})}else D.materialType==="standard"?ye=new vt({color:D.standard.color,roughness:D.standard.roughness,metalness:D.standard.metalness,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0}):ye=new bt({color:D.basic.color,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0});const ve=new lt(_e,ye);ve.renderOrder=-100;const Ie=D.yOffset||0;ve.position.set(v[0],re/2+Ie,v[1]),M.add(ve),O.set(C,ve)},animateModelMove:(v,C,D)=>{if(!v||!v.object)return;const ee=v.type==="enemy",re=ee?c.value:l.value;re&&(re.currentTime=0,re.play().catch(Ae=>{f(`[GameScene]  (${ee?"":""}):`,Ae)})),v.isMoving=!0;const _e=v.object.position.clone(),ye=new Re(C.x,C.y,C.z),ve=500,Ie=performance.now();function De(){if(!v||!v.object){D&&D();return}const Ae=performance.now()-Ie,$e=Math.min(Ae/ve,1),We=1-Math.pow(1-$e,2);v.object.position.lerpVectors(_e,ye,We),$e<1?requestAnimationFrame(De):(v.object.position.copy(ye),v.isMoving=!1,D&&D())}De()},setTestMode:v=>{f(`[GameScene] ${v==="backend"?"":"EventLoop"}`),V.forEach(C=>{C.type==="test"?C.object.visible=v==="backend":(C.type==="copper"||C.type==="enemy")&&(C.object.visible=v==="eventloop")}),f(`[GameScene] ${v==="backend"?"":""}${v==="eventloop"?"":""}EventLoop`)}}),f("[GameScene] ")}function Qi(w,O,se){const ne=new Re;w.getWorldPosition(ne);const Me=window.cameraFocusDistance||8,v=window.cameraFocusHeight||6,C=0,D=Me;return{focusPosition:new Re(ne.x+C,ne.y+v,ne.z+D).clone(),focusTarget:ne.clone(),lerpFactor:.1}}function Cr(){T.aspect=window.innerWidth/window.innerHeight,T.updateProjectionMatrix(),x.setSize(window.innerWidth,window.innerHeight)}function Er(){if(requestAnimationFrame(Er),fe.w||fe.a||fe.s||fe.d||fe.shift||fe.space){const w=new Re;fe.w&&(w.z-=1),fe.s&&(w.z+=1),fe.a&&(w.x-=1),fe.d&&(w.x+=1),fe.shift&&(w.y-=1),fe.space&&(w.y+=1),w.applyQuaternion(T.quaternion),w.y=fe.shift?-1:fe.space?1:0,T.position.add(w.multiplyScalar(le))}J.focusPosition&&J.focusTarget&&(T.position.lerp(J.focusPosition,J.lerpFactor),T.lookAt(J.focusTarget),tt=T.rotation.y,je=T.rotation.x,T.position.distanceTo(J.focusPosition)<.5&&(f("[GameScene] "),J.focusPosition=null,J.focusTarget=null)),P&&P.updateHealthBarsPosition(V),x.render(M,T)}function Vu(){r("back")}function xr(w){if(w.target.tagName!=="CANVAS")return;if(z.x=w.clientX/window.innerWidth*2-1,z.y=-(w.clientY/window.innerHeight)*2+1,Q.setFromCamera(z,T),pe.value==="moving"||pe.value==="attacking"||pe.value==="summoning"||pe.value==="building"||pe.value==="transferring"||pe.value==="structureMoving"||pe.value==="structureAttacking"||pe.value==="structureExtract"||pe.value==="structureTransfer"){ea(z);return}const O=V.filter(ne=>(ne.type==="copper"||ne.type==="summon"||ne.type==="enemy"||ne.type==="structure")&&ne.object).map(ne=>ne.object),se=Q.intersectObjects(O,!0);if(se.length>0){let ne=se[0].object;for(;ne.parent&&!ne.userData.modelId;)ne=ne.parent;const Me=ne.userData.modelId;if(Me!==void 0){const v=V.find(ee=>ee.id===Me),D={copper:"",summon:"",enemy:"",structure:""}[v==null?void 0:v.type]||"";f(`[GameScene] ${D}ID:`,Me),(v==null?void 0:v.type)==="summon"||(v==null?void 0:v.type)==="enemy"?Us(Me,(v==null?void 0:v.type)==="enemy"):(v==null?void 0:v.type)==="structure"?vs(Me):ys(Me)}}else A.value=null,ce.value=null}async function ea(w){const O=new lc(new Re(0,1,0),0),se=new Ma;if(se.setFromCamera(w,T),pe.value==="moving"&&Wt.value){f("[GameScene] ");return}const ne=new Re;if(se.ray.intersectPlane(O,ne),ne){const Me=Math.round(ne.x),v=Math.round(ne.z);f(`[GameScene] : (${Me}, ${v})`);const C={moving:"move",attacking:"attack",summoning:"summon",building:"summon",structureMoving:"move",structureAttacking:"attack",structureExtract:"attack",structureTransfer:"attack"}[pe.value];if(!de||!de.hasIndicatorAt([Me,v],C)){f(`[GameScene]  (${Me}, ${v}) `);return}pe.value==="moving"?await ta(Me,v):pe.value==="attacking"?await na(Me,v):pe.value==="summoning"?await sa(Me,v):pe.value==="building"?await oa(Me,v):pe.value==="structureMoving"?await ua(Me,v):pe.value==="structureAttacking"?await da(Me,v):pe.value==="structureExtract"?await fa(Me,v):pe.value==="structureTransfer"&&await pa(Me,v)}}async function ta(w,O){if(!A.value)return;if(Wt.value){f("[GameScene] ");return}const se=A.value.isOwnedEnemy===!0,ne=se?"on_enemy_move_apply":"on_move_apply";f(`[GameScene] : (${w}, ${O}), =${se?"":""}, =${ne}`);const Me=JSON.stringify({type:ne,content:{id:String(A.value.id),position:{x:String(w),y:String(O)}}});Wt.value=!0,await xe(Me)}async function na(w,O){if(!A.value)return;const se=A.value.isOwnedEnemy===!0,ne=se?"on_enemy_attack_apply":"on_attack_apply";f(`[GameScene] : (${w}, ${O}), =${se?"":""}, =${ne}`);const Me=A.value.id,v=V.find(D=>D.id===Me);if(v){const D=v.type==="enemy",ee=D?d.value:u.value;ee&&(ee.currentTime=0,ee.play().catch(re=>{f(`[GameScene]  (${D?"":""}):`,re)})),_s&&_s(Me,[w,O])}const C=JSON.stringify({type:ne,content:{id:String(A.value.id),position:{x:String(w),y:String(O)}}});await xe(C)}async function sa(w,O){if(!A.value)return;f(`[GameScene] : (${w}, ${O})`),ge.value=[w,O];const se=JSON.stringify({type:"on_get_summon_menu"});await xe(se),await new Promise(ne=>setTimeout(ne,100)),he.value=!0}async function oa(w,O){if(!A.value||!Ne.value)return;f(`[GameScene]  ${Ne.value} : (${w}, ${O})`);const se=A.value.id,ne=JSON.stringify({type:"on_structure_build_apply",content:{id:String(se),position:{x:String(w),y:String(O)},name:Ne.value}});await xe(ne),pe.value=null,Ne.value=null,Y.value&&Y.value.cancelAction(),await new Promise(Me=>setTimeout(Me,100)),f("[GameScene] "),await ys(se)}async function Wu(w){if(!A.value||!ge.value)return;const[O,se]=ge.value;f(`[GameScene]  ${w} : (${O}, ${se})`);try{const ne=JSON.stringify({type:"on_summon_apply",content:{id:String(A.value.id),position:{x:String(O),y:String(se)},name:w}});await xe(ne)}catch(ne){f("[GameScene] :",ne)}finally{he.value=!1,pe.value=null,ge.value=null,Y.value&&Y.value.cancelAction();try{const ne=JSON.stringify({type:"on_summon_end"});await xe(ne)}catch(ne){f("[GameScene] :",ne)}}}function qu(){he.value=!1,ge.value=null,pe.value=null;const w=JSON.stringify({type:"on_summon_end"});xe(w).catch(O=>{f("[GameScene] ",O)})}function ra(){if(f("[GameScene] "),pe.value==="structureMoving"){const w=JSON.stringify({type:"on_structure_move_end"});xe(w).catch(O=>{f("[GameScene] ",O)})}else if(pe.value==="structureAttacking"){const w=JSON.stringify({type:"on_structure_attack_end"});xe(w).catch(O=>{f("[GameScene] ",O)})}else if(pe.value==="structureExtract"){const w=JSON.stringify({type:"on_structure_extract_end"});xe(w).catch(O=>{f("[GameScene] ",O)})}else if(pe.value==="structureTransfer"){const w=JSON.stringify({type:"on_structure_transfer_end"});xe(w).catch(O=>{f("[GameScene] ",O)})}pe.value=null}function Ku(){ra(),ce.value=null,ie.value=null,f("[GameScene] ")}async function Xu(w){if(!ce.value)return;const O=ce.value.id;switch(f(`[GameScene] : ${w.type}, ID=${O}`),w.type){case"move":await ia(O);break;case"attack":await aa(O);break;case"transfer":await ca(O);break;case"extract":await la(O);break;default:f("[GameScene] :",w.type)}}async function ia(w){f(`[GameScene]  ${w} `);const O=JSON.stringify({type:"on_structure_move_start",content:{id:String(w)}});await xe(O),pe.value="structureMoving"}async function aa(w){f(`[GameScene]  ${w} `);const O=JSON.stringify({type:"on_structure_attack_start",content:{id:String(w)}});await xe(O),pe.value="structureAttacking"}async function la(w){f(`[GameScene]  ${w} `);const O=JSON.stringify({type:"on_structure_extract_start",content:{id:String(w)}});await xe(O),pe.value="structureExtract"}async function ca(w){f(`[GameScene]  ${w} `);const O=JSON.stringify({type:"on_structure_transfer_start",content:{id:String(w)}});await xe(O),pe.value="structureTransfer"}async function ua(w,O){if(!ce.value)return;f(`[GameScene]  ${ce.value.id}  (${w}, ${O})`);const se=JSON.stringify({type:"on_structure_move_apply",content:{id:String(ce.value.id),position:{x:String(w),y:String(O)}}});await xe(se),pe.value=null}async function da(w,O){if(!ce.value)return;f(`[GameScene]  ${ce.value.id}  (${w}, ${O})`);const se=JSON.stringify({type:"on_structure_attack_apply",content:{id:String(ce.value.id),position:{x:String(w),y:String(O)}}});await xe(se),pe.value=null}async function fa(w,O){if(!ce.value)return;f(`[GameScene]  ${ce.value.id}  (${w}, ${O}) `);const se=ce.value.id,ne=JSON.stringify({type:"on_structure_extract_apply",content:{id:String(se),position:{x:String(w),y:String(O)}}});await xe(ne),f("[GameScene] ");const Me=JSON.stringify({type:"on_structure_extract_end"});await xe(Me),await new Promise(v=>setTimeout(v,100)),f("[GameScene] "),pe.value=null,setTimeout(async()=>{f("[GameScene] "),await vs(se)},300)}async function pa(w,O){if(!ce.value)return;f(`[GameScene]  ${ce.value.id}  (${w}, ${O}) `);const se=ce.value.id,ne=JSON.stringify({type:"on_structure_transfer_apply",content:{id:String(se),position:{x:String(w),y:String(O)}}});await xe(ne),f("[GameScene] ");const Me=JSON.stringify({type:"on_structure_transfer_end"});await xe(Me),await new Promise(v=>setTimeout(v,100)),f("[GameScene] "),pe.value=null,setTimeout(async()=>{f("[GameScene] "),await vs(se)},300)}async function ys(w){const O=Pe.value.findIndex(ne=>ne.id===w);O!==-1&&(Ue.value=O),ce.value=null;const se=JSON.stringify({type:"on_click_copper",content:{id:String(w)}});await xe(se)}async function vs(w){f(`[GameScene] : ID=${w}`),A.value=null;const O=JSON.stringify({type:"on_click_structure",content:{id:String(w)}});await xe(O)}async function Us(w,O=!1){if(O)Ue.value=-1,Ar();else{const ne=Pe.value.findIndex(Me=>Me.id===w);ne!==-1&&(Ue.value=ne)}ce.value=null;const se=JSON.stringify({type:"on_click_enemy",content:{id:String(w)}});await xe(se)}function Ar(){A.value=null,U.value=[],pe.value=null}async function Yu(w){if(f("[GameScene] :",w),w.type==="moveStart")pe.value="moving";else if(w.type==="attackStart")pe.value="attacking";else if(w.type==="summonStart")pe.value="summoning";else if(w.type==="buildRequest"){f("[GameScene] ");const O=JSON.stringify({type:"on_get_structure_menu"});await xe(O)}else if(w.type==="buildStart")pe.value="building",Ne.value=w.structureName||null;else if(w.type==="transferring"||w.type==="transferStart")pe.value="transferring",X.value=[],W.value=[];else if(w.type==="transferComplete")pe.value=null,X.value=[],W.value=[];else if(w.type==="cancel"){const O=pe.value;if(O==="moving"){const se=JSON.stringify({type:"on_move_end"});xe(se).catch(ne=>{f("[GameScene] ",ne)})}else if(O==="attacking"){const se=JSON.stringify({type:"on_attack_end"});xe(se).catch(ne=>{f("[GameScene] ",ne)})}else if(O==="transferring"){const se=JSON.stringify({type:"on_transfer_end"});xe(se).catch(ne=>{f("[GameScene] ",ne)}),X.value=[],W.value=[]}else if(O==="summoning"){const se=JSON.stringify({type:"on_summon_end"});xe(se).catch(ne=>{f("[GameScene] ",ne)}),he.value=!1}else if(O==="building"){const se=JSON.stringify({type:"on_structure_build_end"});xe(se).catch(ne=>{f("[GameScene] ",ne)}),Ne.value=null,ge.value=null}pe.value=null}else w.type==="wait"&&(f("[GameScene] "),Rr())}function kr(){if(Pe.value.length!==0){if(A.value){const w=A.value.can_move,O=A.value.can_attack,se=A.value.can_summon;if(f(`[GameScene] : ID=${A.value.id}, can_move=${w}, can_attack=${O}, can_summon=${se}, hasAttackTargets=${K.value}`),w||O&&K.value||se){f("[GameScene] ");return}}f("[GameScene] "),Rr()}}async function Rr(){var se,ne,Me;if(Pe.value.length===0)return;A.value=null,pe.value=null,Ue.value;let w=0;const O=Pe.value.length;for(;w<O;){Ue.value=(Ue.value+1)%Pe.value.length;const v=Pe.value[Ue.value];f(`[GameScene] : ${v.name||v.id} ( ${w+1}/${O})`),await new Promise(_e=>{setTimeout(async()=>{const ye=V.find(Ie=>Ie.id===v.id);(ye==null?void 0:ye.type)==="summon"?await Us(v.id,!1):await ys(v.id),_e()},300)}),await new Promise(_e=>setTimeout(_e,200));const C=((se=A.value)==null?void 0:se.can_move)||!1,D=((ne=A.value)==null?void 0:ne.can_attack)||!1,ee=((Me=A.value)==null?void 0:Me.can_summon)||!1,re=C||D&&K.value||ee;if(f(`[GameScene]  ${v.name}: can_move=${C}, can_attack=${D}, can_summon=${ee}, hasTargets=${K.value}, valid=${re}`),A.value&&re){f(`[GameScene] : ${v.name||v.id}`);return}w++}f("[GameScene] "),A.value=null,n.isGameMode&&f('[GameScene] ""')}function Ju(){Be.value++,Ue.value=-1,A.value=null,pe.value=null,Pe.value.forEach(O=>O.turnDone=!1),f(`[GameScene]  ${Be.value}`);const w=V.filter(O=>O.type==="enemy"&&!O.isOwned);if(f(`[GameScene]  ${w.length} `),w.length===0)f("[GameScene] "),st.value=!1;else{st.value=!0,Mt.value.clear(),f("[GameScene] ");let O=setTimeout(()=>{st.value&&Mt.value.size>0&&(f("[GameScene] "),st.value=!1,Mt.value.clear())},3e3),se=setInterval(()=>{st.value||(clearTimeout(O),clearInterval(se))},100);setTimeout(()=>{st.value&&Mt.value.size===0&&(f("[GameScene] "),st.value=!1,clearTimeout(O),clearInterval(se))},1e3)}}async function Zu(){f("[GameScene] "),Ut.value=!1;const w=JSON.stringify({type:"on_game_over"});await xe(w).catch(O=>{f("[GameScene]  on_game_over ",O)}),r("back")}async function Qu(){f("[GameScene] game over"),gs.value=!1;const w=JSON.stringify({type:"on_game_over"});await xe(w).catch(O=>{f("[GameScene]  on_game_over ",O)}),ha()}function ha(){f("[GameScene] "),Kn.value=!0,setTimeout(()=>{f("[GameScene] "),Kn.value=!1,r("back")},5e3)}function ed(){f("[GameScene] "),Kn.value=!1,r("back")}function td(){f("[GameScene] "),Mo.value=!0}function nd(){f("[GameScene] "),Mo.value=!1}async function sd(){f("[GameScene]  game_over "),Mo.value=!1;const w=JSON.stringify({type:"on_game_over"});await xe(w).catch(O=>{f("[GameScene]  on_game_over ",O)}),r("back")}const ma=`url('${H("@assets/ui/panel7.png")}')`,ga=`url('${H("@assets/ui/panel8.png")}')`,_a={props:n,container:o,emit:r,audioRef:i,musicUrl:a,moveSoundRef:l,moveEnemySoundRef:c,attackSoundRef:u,attackEnemySoundRef:d,meHurtSoundRef:p,enemyHurtSoundRef:m,moveSoundUrl:g,moveEnemySoundUrl:y,attackSoundUrl:S,attackEnemySoundUrl:E,meHurtSoundUrl:I,enemyHurtSoundUrl:R,get scene(){return M},set scene(w){M=w},get camera(){return T},set camera(w){T=w},get renderer(){return x},set renderer(w){x=w},get controls(){return j},set controls(w){j=w},get models(){return V},set models(w){V=w},controlCfgForFocus:G,get focusState(){return J},set focusState(w){J=w},get raycaster(){return Q},set raycaster(w){Q=w},get mouse(){return z},set mouse(w){z=w},get gltfLoader(){return be},set gltfLoader(w){be=w},get healthBarsManager(){return P},set healthBarsManager(w){P=w},get indicatorsManager(){return de},set indicatorsManager(w){de=w},get effectsManager(){return Te},set effectsManager(w){Te=w},previousHealth:oe,keys:fe,controlCfg:qe,moveSpeed:le,rotationSpeed:k,controlMode:ue,mouseSensitivity:N,handleKeyDown:ae,handleKeyUp:me,get isMouseDown(){return ze},set isMouseDown(w){ze=w},get lastMouseX(){return He},set lastMouseX(w){He=w},get lastMouseY(){return Xe},set lastMouseY(w){Xe=w},get pitch(){return je},set pitch(w){je=w},get yaw(){return tt},set yaw(w){tt=w},get isPointerLocked(){return it},set isPointerLocked(w){it=w},handleMouseDown:Ht,handleMouseUp:_,handleMouseMove:b,handlePointerLockChange:L,handlePointerLockError:q,selectedCopper:A,selectedCopperResources:U,copperActionPanelRef:Y,hasAttackTargets:K,transferTargetPositions:X,transferTargets:W,selectedStructure:ce,selectedStructureData:ie,showSummonModal:he,summonPosition:ge,enemyList:Oe,currentBuildingName:Ne,currentRound:Be,playerCoppers:Pe,currentCopperIndex:Ue,currentActionMode:pe,isEnemyMoving:st,pendingEnemyMoves:Mt,isMoveLocked:Wt,copperCanBuildMap:at,showGameOverDialog:Ut,showGameSuccessDialog:gs,showCredits:Kn,showWithdrawDialog:Mo,currentCopperId:zu,initScene:Ki,loadGLTFModel:Xi,loadModelFromUrl:Yi,loadEnemyModel:Ji,get createAttackEffectFunc(){return _s},set createAttackEffectFunc(w){_s=w},setupMessageQueue:Zi,focusOnModelFunc:Qi,onWindowResize:Cr,animate:Er,goBack:Vu,onSceneClick:xr,handleFloorClick:ea,handleMoveApply:ta,handleAttackApply:na,handleSummonApply:sa,handleBuildApply:oa,handleSummonConfirm:Wu,handleCloseSummonModal:qu,handleStructurePanelCancel:ra,closeStructurePanel:Ku,handleStructureAction:Xu,handleStructureMoveStart:ia,handleStructureAttackStart:aa,handleStructureExtractStart:la,handleStructureTransferStart:ca,handleStructureMoveApply:ua,handleStructureAttackApply:da,handleStructureExtractApply:fa,handleStructureTransferApply:pa,handleClickCopper:ys,handleClickStructure:vs,handleClickEnemy:Us,closeCopperPanel:Ar,handleCopperAction:Yu,tryNextCopper:kr,nextCopper:Rr,endRound:Ju,handleGameOverConfirm:Zu,handleGameSuccessConfirm:Qu,showCreditsScreen:ha,skipCredits:ed,openWithdrawDialog:td,cancelWithdraw:nd,confirmWithdraw:sd,panel7Src:ma,panel8Src:ga,get log(){return f},ref:F,computed:Ce,onMounted:ot,onBeforeUnmount:wt,watch:ut,get THREE(){return Ns},get GLTFLoader(){return hs},get DRACOLoader(){return ms},get messageQueue(){return ke},get eventloop(){return xe},get getAssetUrl(){return H},get getCopperModelUrl(){return po},get getEnemyModelUrl(){return ho},get getStructureModelUrl(){return Mi},get getMaterialModelUrl(){return _l},get modelCache(){return xt},get getCopperEnglishName(){return Ol},get getCopperTypeFolder(){return Dl},get getStructureEnglishName(){return Nl},get getSetting(){return Yr},get onEvent(){return Vn},get offEvent(){return ps},get emitEvent(){return In},get EventTypes(){return Tt},get useHealthBars(){return $l},get useIndicators(){return Ul},get useEffects(){return Fl},get getControlConfig(){return Zr},get getSkyboxConfig(){return Gl},get getLightingConfig(){return Hl},get getGridCellMaterialConfig(){return Ei},get getMusicUrl(){return jl},get getSoundUrl(){return ts},get loadSkybox(){return Bl},get applyLighting(){return zl},get createCamera(){return Vl},get createRenderer(){return Wl},get createGLTFLoader(){return ql},get createTestUnits(){return Kl},get createFloor(){return Xl},get disposeSkybox(){return Yl},ActionPanel:hw,TurnSystem:Pw,SummonModal:lS,StructurePanel:LS,ResourcePanel:y0};return Object.defineProperty(_a,"__isScriptSetup",{enumerable:!1,value:!0}),_a}},b0={class:"game-scene"},w0={ref:"container",class:"scene-container"},S0={key:6,class:"info-panel"},M0={key:7,class:"game-over-overlay"},T0={key:8,class:"game-over-overlay"},C0={key:9,class:"credits-overlay"},E0={key:10,class:"game-over-overlay"},x0=["src"],A0=["src"],k0=["src"],R0=["src"],P0=["src"],I0=["src"],L0=["src"];function O0(t,e,s,n,o,r){var i,a,l,c;return $(),B("div",b0,[h("div",w0,null,512),s.isGameMode?($(),Bt(n.TurnSystem,{key:0,currentCopperId:n.currentCopperId,copperList:n.playerCoppers,roundNumber:n.currentRound,isEnemyMoving:n.isEnemyMoving,onNextCopper:n.nextCopper,onEndRound:n.endRound,onSelectCopper:n.handleClickCopper},null,8,["currentCopperId","copperList","roundNumber","isEnemyMoving"])):we("",!0),s.isGameMode?($(),B("button",{key:1,class:"withdraw-button",onClick:n.openWithdrawDialog},"  ")):we("",!0),s.isGameMode?($(),Bt(n.ResourcePanel,{key:2})):we("",!0),s.isGameMode&&n.selectedCopper?($(),Bt(n.ActionPanel,{key:3,ref:"copperActionPanelRef",copper:n.selectedCopper,resources:n.selectedCopperResources,hasAttackTargets:n.hasAttackTargets,transferTargets:n.transferTargets,onSelectCopper:n.handleClickCopper,onClose:n.closeCopperPanel,onAction:n.handleCopperAction},null,8,["copper","resources","hasAttackTargets","transferTargets"])):we("",!0),s.isGameMode?($(),Bt(n.SummonModal,{key:4,visible:n.showSummonModal,"copper-name":((l=(a=(i=n.selectedCopper)==null?void 0:i.copper)==null?void 0:a.copper_info)==null?void 0:l.name)||"","enemy-list":n.enemyList,position:n.summonPosition,onClose:n.handleCloseSummonModal,onSummon:n.handleSummonConfirm},null,8,["visible","copper-name","enemy-list","position"])):we("",!0),s.isGameMode&&n.selectedStructure?($(),Bt(n.StructurePanel,{key:5,structure:n.selectedStructure,resources:((c=n.selectedStructureData)==null?void 0:c.resources)||[],"action-mode":n.currentActionMode==="structureMoving"?"move":n.currentActionMode==="structureAttacking"?"attack":n.currentActionMode==="structureExtract"?"extract":n.currentActionMode==="structureTransfer"?"transfer":null,onClose:n.closeStructurePanel,onAction:n.handleStructureAction,onCancel:n.handleStructurePanelCancel},null,8,["structure","resources","action-mode"])):we("",!0),s.isGameMode?we("",!0):($(),B("div",S0,[...e[0]||(e[0]=[nr('<h3 data-v-76eb1444>3D</h3><p style="color:#ffd700;font-weight:600;" data-v-76eb1444> </p><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-76eb1444><p style="font-weight:600;" data-v-76eb1444> </p><p style="font-size:12px;" data-v-76eb1444>  = ID:1</p><p style="font-size:12px;" data-v-76eb1444>  = ID:2</p></div><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-76eb1444><p style="font-weight:600;" data-v-76eb1444> EventLoop</p><p style="font-size:12px;" data-v-76eb1444>1.   EventLoop</p><p style="font-size:12px;" data-v-76eb1444>2. &quot; &quot;</p><p style="font-size:12px;" data-v-76eb1444>3. 3</p><p style="font-size:11px;" data-v-76eb1444>  =IronWall  =Arcanist  =CraftsMan </p></div>',4)])])),n.showGameOverDialog?($(),B("div",M0,[h("div",{class:"game-over-dialog"},[e[1]||(e[1]=h("h2",{class:"game-over-title"},"",-1)),e[2]||(e[2]=h("p",{class:"game-over-message"},"",-1)),h("button",{class:"game-over-button",onClick:n.handleGameOverConfirm},"  ")])])):we("",!0),n.showGameSuccessDialog?($(),B("div",T0,[h("div",{class:"game-over-dialog success-dialog"},[e[3]||(e[3]=h("h2",{class:"success-title"},"  ",-1)),e[4]||(e[4]=h("p",{class:"game-over-message"},"",-1)),h("button",{class:"game-over-button success-button",onClick:n.handleGameSuccessConfirm},"  ")])])):we("",!0),n.showCredits?($(),B("div",C0,[h("div",{class:"credits-container"},[e[5]||(e[5]=nr('<h1 class="credits-title" data-v-76eb1444></h1><div class="credits-content" data-v-76eb1444><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>MGPIC Team</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>Backend Developer</p><p data-v-76eb1444>Frontend Developer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>3D Artist</p><p data-v-76eb1444>UI Designer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>Sound Designer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444></p></div></div>',2)),h("button",{class:"skip-credits-button",onClick:n.skipCredits},"")])])):we("",!0),n.showWithdrawDialog?($(),B("div",E0,[h("div",{class:"game-over-dialog"},[e[6]||(e[6]=h("h2",{class:"withdraw-title"},"",-1)),e[7]||(e[7]=h("p",{class:"game-over-message"},[zn(""),h("br"),zn("")],-1)),h("div",{class:"dialog-buttons"},[h("button",{class:"dialog-button cancel-button",onClick:n.cancelWithdraw},"  "),h("button",{class:"dialog-button confirm-button",onClick:n.confirmWithdraw},"  ")])])])):we("",!0),h("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,x0),h("audio",{ref:"moveSoundRef",src:n.moveSoundUrl,preload:"auto"},null,8,A0),h("audio",{ref:"moveEnemySoundRef",src:n.moveEnemySoundUrl,preload:"auto"},null,8,k0),h("audio",{ref:"attackSoundRef",src:n.attackSoundUrl,preload:"auto"},null,8,R0),h("audio",{ref:"attackEnemySoundRef",src:n.attackEnemySoundUrl,preload:"auto"},null,8,P0),h("audio",{ref:"meHurtSoundRef",src:n.meHurtSoundUrl,preload:"auto"},null,8,I0),h("audio",{ref:"enemyHurtSoundRef",src:n.enemyHurtSoundUrl,preload:"auto"},null,8,L0)])}const D0=St(v0,[["render",O0],["__scopeId","data-v-76eb1444"],["__file","D:/Project/MGPIC/MGPIC-2025/src/vue/GameScene.vue"]]),N0={__name:"App",setup(t,{expose:e}){e();const s=F(!1),n=F(null),o=F(!1),r=F(null),i=F([]),a=F(0),l=F(!0),c=F(!1),u=F("touchpad"),d=F(!1);let p=null;function m(){const P=!s.value;s.value=P,P?window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__():window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}function g(P){n.value!==P&&(i.value.push(n.value),n.value=P),window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__(),s.value=!0}function y(){l.value=!1,p&&clearTimeout(p),p=setTimeout(()=>{l.value||(f("[App] StartMenu"),d.value=!0)},5*60*1e3)}function S(){n.value=null,i.value=[],window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),s.value=!1}function E(P){f("[App] ID:",P.ids),S(),c.value=!0,f("[App] ")}function I(){c.value=!1}function R(){const P=Gs();u.value=P.controlMode,o.value=!0,s.value=!0}function M(){o.value=!1,n.value||(window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),s.value=!1)}function T(P){u.value=P,cr("controlMode",P),window.updateControlMode&&window.updateControlMode(P),f(`[App] : ${P}`)}function x(){if(o.value){M();return}if(n.value){if(n.value==="warehouse"&&r.value&&r.value.handleBack&&r.value.handleBack())return;const P=i.value.pop()??null;n.value=P,P||(s.value=!1);return}if(!l.value){p&&(clearTimeout(p),p=null),d.value&&(d.value=!1,f("[App] StartMenu")),l.value=!0,setTimeout(()=>{window.__INIT_THREE_SCENE__?window.__INIT_THREE_SCENE__().then(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}).catch(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}):window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()},100),s.value=!1;return}}const j=F(!0),V=F(null);function G(){j.value=!j.value,f("[App] :",j.value?"":"")}async function J(){try{f("[App] ...");const P=await Tl();if(P.type==="error"){f("[App] :",P.content),alert(": "+P.content);return}f("[App] ...");const de=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),Te=document.createElement("a");Te.href=URL.createObjectURL(de);const oe=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);Te.download=`mgpic-save-${oe}.json`,Te.click(),URL.revokeObjectURL(Te.href),f("[App] ")}catch(P){f("[App] :",P),alert("")}}function Q(){try{V.value&&V.value.click()}catch{}}async function z(P){try{const de=P.target&&P.target.files&&P.target.files[0];if(!de)return;f("[App] ...");const Te=new FileReader;Te.onload=async()=>{try{const oe=String(Te.result||"{}"),fe=JSON.parse(oe);f("[App] ..."),await Ml(oe),f("[App] "),alert("")}catch(oe){f("[App] :",oe),alert(": "+oe.message)}P.target.value=""},Te.onerror=()=>{f("[App] "),alert(""),P.target.value=""},Te.readAsText(de)}catch(de){f("[App] :",de),alert("")}}ot(()=>{lr(P=>{})}),wt(()=>{p&&(clearTimeout(p),p=null)});const be={isPaused:s,overlay:n,showSettingsOverlay:o,warehouseRef:r,overlayHistory:i,currentPuppetIndex:a,showStartMenu:l,showGameScene:c,controlMode:u,destroyStartMenu:d,get startMenuDestroyTimer(){return p},set startMenuDestroyTimer(P){p=P},togglePause:m,openOverlay:g,onStartMenuStarted:y,closeOverlay:S,handleGameStart:E,closeGameScene:I,openSettings:R,closeSettings:M,setControlMode:T,goBack:x,musicOn:j,fileInput:V,onToggleMusic:G,onDownloadSave:J,onUploadSave:Q,onFileChange:z,get log(){return f},ref:F,onMounted:ot,onBeforeUnmount:wt,nextTick:vn,Hall:um,Warehouse:I_,TopLeftPanel:U_,StartMenu:oy,StartGame:Vy,GameScene:D0,get getAssetUrl(){return H},get getSettings(){return Gs},get updateSetting(){return cr},get info_subscribe(){return lr},get export_save(){return Tl},get import_save(){return Ml}};return Object.defineProperty(be,"__isScriptSetup",{enumerable:!1,value:!0}),be}},$0={class:"stage"},G0={key:0,style:{position:"relative",width:"100%",height:"100%"}},H0={key:2,class:"modal"},U0={class:"modal-title"},F0={key:2,class:"overlay",style:{"z-index":"30000","align-items":"flex-start","justify-content":"flex-start",background:"rgba(0, 0, 0, 0.25)"}},j0={class:"settings"},B0={class:"settings__header"},z0=["src"],V0={class:"settings__content"},W0={class:"settings__section"},q0={class:"settings__control-options"};function K0(t,e,s,n,o,r){return $(),B("div",$0,[n.showGameScene?($(),Bt(n.GameScene,{key:0,isGameMode:!0,"music-on":n.musicOn,onBack:n.closeGameScene},null,8,["music-on"])):we("",!0),n.showGameScene?we("",!0):($(),B(et,{key:1},[n.destroyStartMenu?we("",!0):Vc(($(),Bt(n.StartMenu,{key:0,visible:n.showStartMenu,onStarted:n.onStartMenuStarted},null,8,["visible"])),[[Lu,n.showStartMenu]]),n.showStartMenu?we("",!0):($(),Bt(n.TopLeftPanel,{key:1,"music-on":n.musicOn,onBack:n.goBack,onOpenSettings:n.openSettings,onToggleMusic:n.onToggleMusic},null,8,["music-on"])),ct(n.Hall,{"music-on":n.musicOn,paused:n.overlay==="start"||n.overlay==="warehouse"||n.showGameScene,onStartGame:e[0]||(e[0]=i=>n.openOverlay("start")),onOpenWarehouse:e[1]||(e[1]=i=>n.openOverlay("warehouse")),onOpenTutorial:e[2]||(e[2]=i=>n.openOverlay("tutorial")),onOpenEncyclopedia:e[3]||(e[3]=i=>n.openOverlay("encyclopedia")),onToggleMusic:n.onToggleMusic},null,8,["music-on","paused"]),n.overlay?($(),B("div",{key:2,class:nt(["overlay",{"overlay--warehouse":n.overlay==="warehouse"}])},[n.overlay==="warehouse"?($(),B("div",G0,[ct(n.TopLeftPanel,{"music-on":n.musicOn,onBack:n.goBack,onOpenSettings:n.openSettings,onToggleMusic:n.onToggleMusic},null,8,["music-on"]),ct(n.Warehouse,{ref:"warehouseRef","music-on":n.musicOn},null,8,["music-on"])])):n.overlay==="start"?($(),Bt(n.StartGame,{key:1,"music-on":n.musicOn,paused:n.showGameScene,onClose:n.closeOverlay,onConfirm:n.handleGameStart},null,8,["music-on","paused"])):($(),B("div",H0,[h("h2",U0,te(n.overlay==="warehouse"?"  Copper Warehouse":n.overlay==="tutorial"?"  Tutorial":n.overlay==="encyclopedia"?"  Game Encyclopedia":"  Start Game"),1),e[6]||(e[6]=h("p",{class:"modal-body"},"",-1)),h("button",{class:"close-btn",onClick:n.closeOverlay},"")]))],2)):we("",!0)],64)),n.showSettingsOverlay?($(),B("div",F0,[h("div",j0,[h("div",B0,[e[7]||(e[7]=h("div",{class:"settings__title"},"",-1)),h("button",{class:"settings__close",onClick:n.closeSettings,"aria-label":""},[h("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,z0)])]),h("div",V0,[h("div",W0,[e[10]||(e[10]=h("div",{class:"settings__section-title"},"",-1)),h("div",q0,[h("button",{class:nt(["settings__control-btn",{active:n.controlMode==="touchpad"}]),onClick:e[4]||(e[4]=i=>n.setControlMode("touchpad"))},[...e[8]||(e[8]=[h("span",{class:"control-title"},"",-1),h("span",{class:"control-desc"},"",-1)])],2),h("button",{class:nt(["settings__control-btn",{active:n.controlMode==="mouse"}]),onClick:e[5]||(e[5]=i=>n.setControlMode("mouse"))},[...e[9]||(e[9]=[h("span",{class:"control-title"},"",-1),h("span",{class:"control-desc"},"",-1)])],2)])]),h("button",{class:"settings__item",onClick:n.onDownloadSave},[...e[11]||(e[11]=[nr('<span class="settings__icon" data-v-7a7a37b1><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7a7a37b1><path d="M12 3v12m0 0l-4-4m4 4l4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-7a7a37b1></path><path d="M4 19h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-7a7a37b1></path></svg></span><span class="settings__label" data-v-7a7a37b1></span>',2)])]),h("button",{class:"settings__item",onClick:n.onUploadSave},[...e[12]||(e[12]=[nr('<span class="settings__icon" data-v-7a7a37b1><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7a7a37b1><path d="M12 21V9m0 0l4 4m-4-4L8 13" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-7a7a37b1></path><path d="M4 5h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-7a7a37b1></path></svg></span><span class="settings__label" data-v-7a7a37b1></span>',2)])]),h("input",{ref:"fileInput",type:"file",accept:".json",onChange:n.onFileChange,style:{display:"none"}},null,544)])])])):we("",!0)])}const Jl=St(N0,[["render",K0],["__scopeId","data-v-7a7a37b1"],["__file","D:/Project/MGPIC/MGPIC-2025/src/App.vue"]]);function X0(){const t=navigator.userAgent;return/Safari/.test(t)&&!/Chrome/.test(t)&&!/Chromium/.test(t)}function Y0(){const t=document.getElementById("safari-warning"),e=document.getElementById("loading-screen");t.style.display="flex",e.style.display="none",document.getElementById("download-local").addEventListener("click",()=>{window.open("https://github.com/MGPIC-2025/Cross/releases","_blank")}),document.getElementById("continue-safari").addEventListener("click",()=>{t.style.display="none",e.style.display="flex",Bu()}),document.getElementById("download-chrome").addEventListener("click",()=>{window.open("https://www.google.com/chrome/","_blank")})}function Qr(t,e,s,n=""){const o=document.getElementById("progress-bar"),r=document.getElementById("progress-text"),i=document.querySelector(".loading-subtitle");o&&(o.style.width=s+"%"),r&&(t===0&&e===0?r.textContent=`${s}%`:r.textContent=`${t} / ${e} (${s}%)`),i&&n&&(i.textContent=n)}function Zl(){const t=document.getElementById("loading-screen");t&&(t.classList.add("fade-out"),setTimeout(()=>{t.style.display="none"},500))}async function Bu(){try{f("..."),await ir(Qr,["high"]),f(""),Qr(0,100,100,"..."),hl(Jl).mount("#app"),await new Promise(e=>setTimeout(e,200)),window.__INIT_THREE_SCENE__&&await window.__INIT_THREE_SCENE__((e,s,n)=>{Qr(0,0,n,`3D... ${n}%`)}),f(""),setTimeout(()=>{Zl()},300),setTimeout(async()=>{try{f("..."),await ir(null,["medium"]),f("")}catch(e){f(":",e)}},1e3)}catch(t){f(":",t),hl(Jl).mount("#app"),Zl()}}X0()?(f("Safari"),Y0()):(f("Safari"),Bu());
