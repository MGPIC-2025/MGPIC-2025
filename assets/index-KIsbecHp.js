import{T as Hu,a as Kr,b as Dl,L as Nl,c as zs,F as Oo,M as bn,V as Nt,C as gn,d as _n,S as Rn,e as Uu,P as vs,D as kn,f as ts,g as Pe,I as $l,Q as ks,h as Fu,O as Gl,i as ju,j as Bu,B as Ws,k as Vu,l as Hl,N as zu,m as Wu,n as qu,o as Xr,p as Ul,R as Yr,q as Ku,r as Xu,s as Yu,t as Er,u as Ju,v as Gt,w as Un,x as Pt,y as Zu,z as Fl,A as Qu,E as rt,G as ed,H as td,J as nd,K as sd,U as Jt,W as lo,X as jl,Y as od,Z as rd,_ as id,$ as ad,a0 as ld,a1 as Bl,a2 as cd,a3 as la,a4 as ca,a5 as ua,a6 as da,a7 as Jr,a8 as ud,a9 as dd,aa as kt,ab as fd,ac as pd,ad as Yt,ae as or,af as rr,ag as ir,ah as ar,ai as hd,aj as md,ak as Ss,al as bs,am as fa,an as gd,ao as Vl,ap as Lo,aq as Zr,ar as Do,as as _d,at as yd,au as vd,av as pa,aw as bd}from"./three-DX4CaU0L.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();const wd="debug";function f(...t){switch(wd){case"debug":console.log(...t);break}}/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function On(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const We=Object.freeze({}),Ms=Object.freeze([]),Ct=()=>{},zl=()=>!1,co=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),No=t=>t.startsWith("onUpdate:"),ct=Object.assign,bi=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Sd=Object.prototype.hasOwnProperty,Fe=(t,e)=>Sd.call(t,e),Se=Array.isArray,ns=t=>lr(t)==="[object Map]",Wl=t=>lr(t)==="[object Set]",xe=t=>typeof t=="function",tt=t=>typeof t=="string",zn=t=>typeof t=="symbol",Be=t=>t!==null&&typeof t=="object",wi=t=>(Be(t)||xe(t))&&xe(t.then)&&xe(t.catch),ql=Object.prototype.toString,lr=t=>ql.call(t),Si=t=>lr(t).slice(8,-1),Kl=t=>lr(t)==="[object Object]",Mi=t=>tt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,qs=On(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Md=On("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),cr=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},Td=/-\w/g,en=cr(t=>t.replace(Td,e=>e.slice(1).toUpperCase())),Cd=/\B([A-Z])/g,Fn=cr(t=>t.replace(Cd,"-$1").toLowerCase()),ur=cr(t=>t.charAt(0).toUpperCase()+t.slice(1)),Zn=cr(t=>t?`on${ur(t)}`:""),Hn=(t,e)=>!Object.is(t,e),$s=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},$o=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},Ed=t=>{const e=parseFloat(t);return isNaN(e)?t:e},xd=t=>{const e=tt(t)?Number(t):NaN;return isNaN(e)?t:e};let ha;const uo=()=>ha||(ha=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function zt(t){if(Se(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],o=tt(n)?Pd(n):zt(n);if(o)for(const i in o)e[i]=o[i]}return e}else if(tt(t)||Be(t))return t}const Ad=/;(?![^(]*\))/g,kd=/:([^]+)/,Rd=/\/\*[^]*?\*\//g;function Pd(t){const e={};return t.replace(Rd,"").split(Ad).forEach(s=>{if(s){const n=s.split(kd);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Qe(t){let e="";if(tt(t))e=t;else if(Se(t))for(let s=0;s<t.length;s++){const n=Qe(t[s]);n&&(e+=n+" ")}else if(Be(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const Id="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Od="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Ld="annotation,annotation-xml,maction,maligngroup,malignmark,math,menclose,merror,mfenced,mfrac,mfraction,mglyph,mi,mlabeledtr,mlongdiv,mmultiscripts,mn,mo,mover,mpadded,mphantom,mprescripts,mroot,mrow,ms,mscarries,mscarry,msgroup,msline,mspace,msqrt,msrow,mstack,mstyle,msub,msubsup,msup,mtable,mtd,mtext,mtr,munder,munderover,none,semantics",Dd=On(Id),Nd=On(Od),$d=On(Ld),Gd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hd=On(Gd);function Xl(t){return!!t||t===""}const Yl=t=>!!(t&&t.__v_isRef===!0),se=t=>tt(t)?t:t==null?"":Se(t)||Be(t)&&(t.toString===ql||!xe(t.toString))?Yl(t)?se(t.value):JSON.stringify(t,Jl,2):String(t),Jl=(t,e)=>Yl(e)?Jl(t,e.value):ns(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,o],i)=>(s[xr(n,i)+" =>"]=o,s),{})}:Wl(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>xr(s))}:zn(e)?xr(e):Be(e)&&!Se(e)&&!Kl(e)?String(e):e,xr=(t,e="")=>{var s;return zn(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};function Ud(t){return t==null?"initial":typeof t=="string"?t===""?" ":t:((typeof t!="number"||!Number.isFinite(t))&&console.warn("[Vue warn] Invalid value used for CSS binding. Expected a string or a finite number but received:",t),String(t))}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function nn(t,...e){console.warn(`[Vue warn] ${t}`,...e)}let $t;class Fd{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=$t,!e&&$t&&(this.index=($t.scopes||($t.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=$t;try{return $t=this,e()}finally{$t=s}}else nn("cannot run an inactive effect scope.")}on(){++this._on===1&&(this.prevScope=$t,$t=this)}off(){this._on>0&&--this._on===0&&($t=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function jd(){return $t}let ze;const Ar=new WeakSet;class Zl{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,$t&&$t.active&&$t.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ar.has(this)&&(Ar.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ec(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ma(this),tc(this);const e=ze,s=tn;ze=this,tn=!0;try{return this.fn()}finally{ze!==this&&nn("Active effect was not restored correctly - this is likely a Vue internal bug."),nc(this),ze=e,tn=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Ei(e);this.deps=this.depsTail=void 0,ma(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ar.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qr(this)&&this.run()}get dirty(){return Qr(this)}}let Ql=0,Ks,Xs;function ec(t,e=!1){if(t.flags|=8,e){t.next=Xs,Xs=t;return}t.next=Ks,Ks=t}function Ti(){Ql++}function Ci(){if(--Ql>0)return;if(Xs){let e=Xs;for(Xs=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;Ks;){let e=Ks;for(Ks=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function tc(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function nc(t){let e,s=t.depsTail,n=s;for(;n;){const o=n.prevDep;n.version===-1?(n===s&&(s=o),Ei(n),Bd(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}t.deps=e,t.depsTail=s}function Qr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(sc(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function sc(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Qs)||(t.globalVersion=Qs,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Qr(t))))return;t.flags|=2;const e=t.dep,s=ze,n=tn;ze=t,tn=!0;try{tc(t);const o=t.fn(t._value);(e.version===0||Hn(o,t._value))&&(t.flags|=128,t._value=o,e.version++)}catch(o){throw e.version++,o}finally{ze=s,tn=n,nc(t),t.flags&=-3}}function Ei(t,e=!1){const{dep:s,prevSub:n,nextSub:o}=t;if(n&&(n.nextSub=o,t.prevSub=void 0),o&&(o.prevSub=n,t.nextSub=void 0),s.subsHead===t&&(s.subsHead=o),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let i=s.computed.deps;i;i=i.nextDep)Ei(i,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function Bd(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let tn=!0;const oc=[];function sn(){oc.push(tn),tn=!1}function on(){const t=oc.pop();tn=t===void 0?!0:t}function ma(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=ze;ze=void 0;try{e()}finally{ze=s}}}let Qs=0;class Vd{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class xi{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0,this.subsHead=void 0}track(e){if(!ze||!tn||ze===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==ze)s=this.activeLink=new Vd(ze,this),ze.deps?(s.prevDep=ze.depsTail,ze.depsTail.nextDep=s,ze.depsTail=s):ze.deps=ze.depsTail=s,rc(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=ze.depsTail,s.nextDep=void 0,ze.depsTail.nextDep=s,ze.depsTail=s,ze.deps===s&&(ze.deps=n)}return ze.onTrack&&ze.onTrack(ct({effect:ze},e)),s}trigger(e){this.version++,Qs++,this.notify(e)}notify(e){Ti();try{for(let s=this.subsHead;s;s=s.nextSub)s.sub.onTrigger&&!(s.sub.flags&8)&&s.sub.onTrigger(ct({effect:s.sub},e));for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Ci()}}}function rc(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)rc(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subsHead===void 0&&(t.dep.subsHead=t),t.dep.subs=t}}const ei=new WeakMap,ss=Symbol("Object iterate"),ti=Symbol("Map keys iterate"),eo=Symbol("Array iterate");function bt(t,e,s){if(tn&&ze){let n=ei.get(t);n||ei.set(t,n=new Map);let o=n.get(s);o||(n.set(s,o=new xi),o.map=n,o.key=s),o.track({target:t,type:e,key:s})}}function dn(t,e,s,n,o,i){const r=ei.get(t);if(!r){Qs++;return}const a=l=>{l&&l.trigger({target:t,type:e,key:s,newValue:n,oldValue:o,oldTarget:i})};if(Ti(),e==="clear")r.forEach(a);else{const l=Se(t),c=l&&Mi(s);if(l&&s==="length"){const u=Number(n);r.forEach((d,h)=>{(h==="length"||h===eo||!zn(h)&&h>=u)&&a(d)})}else switch((s!==void 0||r.has(void 0))&&a(r.get(s)),c&&a(r.get(eo)),e){case"add":l?c&&a(r.get("length")):(a(r.get(ss)),ns(t)&&a(r.get(ti)));break;case"delete":l||(a(r.get(ss)),ns(t)&&a(r.get(ti)));break;case"set":ns(t)&&a(r.get(ss));break}}Ci()}function ms(t){const e=Ie(t);return e===t?e:(bt(e,"iterate",eo),Ot(t)?e:e.map(St))}function dr(t){return bt(t=Ie(t),"iterate",eo),t}const zd={__proto__:null,[Symbol.iterator](){return kr(this,Symbol.iterator,St)},concat(...t){return ms(this).concat(...t.map(e=>Se(e)?ms(e):e))},entries(){return kr(this,"entries",t=>(t[1]=St(t[1]),t))},every(t,e){return Sn(this,"every",t,e,void 0,arguments)},filter(t,e){return Sn(this,"filter",t,e,s=>s.map(St),arguments)},find(t,e){return Sn(this,"find",t,e,St,arguments)},findIndex(t,e){return Sn(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Sn(this,"findLast",t,e,St,arguments)},findLastIndex(t,e){return Sn(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Sn(this,"forEach",t,e,void 0,arguments)},includes(...t){return Rr(this,"includes",t)},indexOf(...t){return Rr(this,"indexOf",t)},join(t){return ms(this).join(t)},lastIndexOf(...t){return Rr(this,"lastIndexOf",t)},map(t,e){return Sn(this,"map",t,e,void 0,arguments)},pop(){return Gs(this,"pop")},push(...t){return Gs(this,"push",t)},reduce(t,...e){return ga(this,"reduce",t,e)},reduceRight(t,...e){return ga(this,"reduceRight",t,e)},shift(){return Gs(this,"shift")},some(t,e){return Sn(this,"some",t,e,void 0,arguments)},splice(...t){return Gs(this,"splice",t)},toReversed(){return ms(this).toReversed()},toSorted(t){return ms(this).toSorted(t)},toSpliced(...t){return ms(this).toSpliced(...t)},unshift(...t){return Gs(this,"unshift",t)},values(){return kr(this,"values",St)}};function kr(t,e,s){const n=dr(t),o=n[e]();return n!==t&&!Ot(t)&&(o._next=o.next,o.next=()=>{const i=o._next();return i.done||(i.value=s(i.value)),i}),o}const Wd=Array.prototype;function Sn(t,e,s,n,o,i){const r=dr(t),a=r!==t&&!Ot(t),l=r[e];if(l!==Wd[e]){const d=l.apply(t,i);return a?St(d):d}let c=s;r!==t&&(a?c=function(d,h){return s.call(this,St(d),h,t)}:s.length>2&&(c=function(d,h){return s.call(this,d,h,t)}));const u=l.call(r,c,n);return a&&o?o(u):u}function ga(t,e,s,n){const o=dr(t);let i=s;return o!==t&&(Ot(t)?s.length>3&&(i=function(r,a,l){return s.call(this,r,a,l,t)}):i=function(r,a,l){return s.call(this,r,St(a),l,t)}),o[e](i,...n)}function Rr(t,e,s){const n=Ie(t);bt(n,"iterate",eo);const o=n[e](...s);return(o===-1||o===!1)&&Go(s[0])?(s[0]=Ie(s[0]),n[e](...s)):o}function Gs(t,e,s=[]){sn(),Ti();const n=Ie(t)[e].apply(t,s);return Ci(),on(),n}const qd=On("__proto__,__v_isRef,__isVue"),ic=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(zn));function Kd(t){zn(t)||(t=String(t));const e=Ie(this);return bt(e,"has",t),e.hasOwnProperty(t)}class ac{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const o=this._isReadonly,i=this._isShallow;if(s==="__v_isReactive")return!o;if(s==="__v_isReadonly")return o;if(s==="__v_isShallow")return i;if(s==="__v_raw")return n===(o?i?pc:fc:i?dc:uc).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const r=Se(e);if(!o){let l;if(r&&(l=zd[s]))return l;if(s==="hasOwnProperty")return Kd}const a=Reflect.get(e,s,ft(e)?e:n);if((zn(s)?ic.has(s):qd(s))||(o||bt(e,"get",s),i))return a;if(ft(a)){const l=r&&Mi(s)?a:a.value;return o&&Be(l)?si(l):l}return Be(a)?o?si(a):Ai(a):a}}class lc extends ac{constructor(e=!1){super(!1,e)}set(e,s,n,o){let i=e[s];if(!this._isShallow){const l=yn(i);if(!Ot(n)&&!yn(n)&&(i=Ie(i),n=Ie(n)),!Se(e)&&ft(i)&&!ft(n))return l?(nn(`Set operation on key "${String(s)}" failed: target is readonly.`,e[s]),!0):(i.value=n,!0)}const r=Se(e)&&Mi(s)?Number(s)<e.length:Fe(e,s),a=Reflect.set(e,s,n,ft(e)?e:o);return e===Ie(o)&&(r?Hn(n,i)&&dn(e,"set",s,n,i):dn(e,"add",s,n)),a}deleteProperty(e,s){const n=Fe(e,s),o=e[s],i=Reflect.deleteProperty(e,s);return i&&n&&dn(e,"delete",s,void 0,o),i}has(e,s){const n=Reflect.has(e,s);return(!zn(s)||!ic.has(s))&&bt(e,"has",s),n}ownKeys(e){return bt(e,"iterate",Se(e)?"length":ss),Reflect.ownKeys(e)}}class cc extends ac{constructor(e=!1){super(!0,e)}set(e,s){return nn(`Set operation on key "${String(s)}" failed: target is readonly.`,e),!0}deleteProperty(e,s){return nn(`Delete operation on key "${String(s)}" failed: target is readonly.`,e),!0}}const Xd=new lc,Yd=new cc,Jd=new lc(!0),Zd=new cc(!0),ni=t=>t,_o=t=>Reflect.getPrototypeOf(t);function Qd(t,e,s){return function(...n){const o=this.__v_raw,i=Ie(o),r=ns(i),a=t==="entries"||t===Symbol.iterator&&r,l=t==="keys"&&r,c=o[t](...n),u=s?ni:e?Ho:St;return!e&&bt(i,"iterate",l?ti:ss),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function yo(t){return function(...e){{const s=e[0]?`on key "${e[0]}" `:"";nn(`${ur(t)} operation ${s}failed: target is readonly.`,Ie(this))}return t==="delete"?!1:t==="clear"?void 0:this}}function ef(t,e){const s={get(o){const i=this.__v_raw,r=Ie(i),a=Ie(o);t||(Hn(o,a)&&bt(r,"get",o),bt(r,"get",a));const{has:l}=_o(r),c=e?ni:t?Ho:St;if(l.call(r,o))return c(i.get(o));if(l.call(r,a))return c(i.get(a));i!==r&&i.get(o)},get size(){const o=this.__v_raw;return!t&&bt(Ie(o),"iterate",ss),o.size},has(o){const i=this.__v_raw,r=Ie(i),a=Ie(o);return t||(Hn(o,a)&&bt(r,"has",o),bt(r,"has",a)),o===a?i.has(o):i.has(o)||i.has(a)},forEach(o,i){const r=this,a=r.__v_raw,l=Ie(a),c=e?ni:t?Ho:St;return!t&&bt(l,"iterate",ss),a.forEach((u,d)=>o.call(i,c(u),c(d),r))}};return ct(s,t?{add:yo("add"),set:yo("set"),delete:yo("delete"),clear:yo("clear")}:{add(o){!e&&!Ot(o)&&!yn(o)&&(o=Ie(o));const i=Ie(this);return _o(i).has.call(i,o)||(i.add(o),dn(i,"add",o,o)),this},set(o,i){!e&&!Ot(i)&&!yn(i)&&(i=Ie(i));const r=Ie(this),{has:a,get:l}=_o(r);let c=a.call(r,o);c?_a(r,a,o):(o=Ie(o),c=a.call(r,o));const u=l.call(r,o);return r.set(o,i),c?Hn(i,u)&&dn(r,"set",o,i,u):dn(r,"add",o,i),this},delete(o){const i=Ie(this),{has:r,get:a}=_o(i);let l=r.call(i,o);l?_a(i,r,o):(o=Ie(o),l=r.call(i,o));const c=a?a.call(i,o):void 0,u=i.delete(o);return l&&dn(i,"delete",o,void 0,c),u},clear(){const o=Ie(this),i=o.size!==0,r=ns(o)?new Map(o):new Set(o),a=o.clear();return i&&dn(o,"clear",void 0,void 0,r),a}}),["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=Qd(o,t,e)}),s}function fr(t,e){const s=ef(t,e);return(n,o,i)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(Fe(s,o)&&o in n?s:n,o,i)}const tf={get:fr(!1,!1)},nf={get:fr(!1,!0)},sf={get:fr(!0,!1)},of={get:fr(!0,!0)};function _a(t,e,s){const n=Ie(s);if(n!==s&&e.call(t,n)){const o=Si(t);nn(`Reactive ${o} contains both the raw and reactive versions of the same object${o==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const uc=new WeakMap,dc=new WeakMap,fc=new WeakMap,pc=new WeakMap;function rf(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function af(t){return t.__v_skip||!Object.isExtensible(t)?0:rf(Si(t))}function Ai(t){return yn(t)?t:pr(t,!1,Xd,tf,uc)}function lf(t){return pr(t,!1,Jd,nf,dc)}function si(t){return pr(t,!0,Yd,sf,fc)}function pn(t){return pr(t,!0,Zd,of,pc)}function pr(t,e,s,n,o){if(!Be(t))return nn(`value cannot be made ${e?"readonly":"reactive"}: ${String(t)}`),t;if(t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=af(t);if(i===0)return t;const r=o.get(t);if(r)return r;const a=new Proxy(t,i===2?n:s);return o.set(t,a),a}function os(t){return yn(t)?os(t.__v_raw):!!(t&&t.__v_isReactive)}function yn(t){return!!(t&&t.__v_isReadonly)}function Ot(t){return!!(t&&t.__v_isShallow)}function Go(t){return t?!!t.__v_raw:!1}function Ie(t){const e=t&&t.__v_raw;return e?Ie(e):t}function cf(t){return!Fe(t,"__v_skip")&&Object.isExtensible(t)&&$o(t,"__v_skip",!0),t}const St=t=>Be(t)?Ai(t):t,Ho=t=>Be(t)?si(t):t;function ft(t){return t?t.__v_isRef===!0:!1}function U(t){return uf(t,!1)}function uf(t,e){return ft(t)?t:new df(t,e)}class df{constructor(e,s){this.dep=new xi,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:Ie(e),this._value=s?e:St(e),this.__v_isShallow=s}get value(){return this.dep.track({target:this,type:"get",key:"value"}),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||Ot(e)||yn(e);e=n?e:Ie(e),Hn(e,s)&&(this._rawValue=e,this._value=n?e:St(e),this.dep.trigger({target:this,type:"set",key:"value",newValue:e,oldValue:s}))}}function ff(t){return ft(t)?t.value:t}const pf={get:(t,e,s)=>e==="__v_raw"?t:ff(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const o=t[e];return ft(o)&&!ft(s)?(o.value=s,!0):Reflect.set(t,e,s,n)}};function hc(t){return os(t)?t:new Proxy(t,pf)}class hf{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new xi(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Qs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ze!==this)return ec(this,!0),!0}get value(){const e=this.dep.track({target:this,type:"get",key:"value"});return sc(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter?this.setter(e):nn("Write operation failed: computed value is readonly")}}function mf(t,e,s=!1){let n,o;xe(t)?n=t:(n=t.get,o=t.set);const i=new hf(n,o,s);return e&&!s&&(i.onTrack=e.onTrack,i.onTrigger=e.onTrigger),i}const vo={},Uo=new WeakMap;let Qn;function gf(t,e=!1,s=Qn){if(s){let n=Uo.get(s);n||Uo.set(s,n=[]),n.push(t)}else e||nn("onWatcherCleanup() was called when there was no active watcher to associate with.")}function _f(t,e,s=We){const{immediate:n,deep:o,once:i,scheduler:r,augmentJob:a,call:l}=s,c=T=>{(s.onWarn||nn)("Invalid watch source: ",T,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},u=T=>o?T:Ot(T)||o===!1||o===0?xn(T,1):xn(T);let d,h,m,_,v=!1,S=!1;if(ft(t)?(h=()=>t.value,v=Ot(t)):os(t)?(h=()=>u(t),v=!0):Se(t)?(S=!0,v=t.some(T=>os(T)||Ot(T)),h=()=>t.map(T=>{if(ft(T))return T.value;if(os(T))return u(T);if(xe(T))return l?l(T,2):T();c(T)})):xe(t)?e?h=l?()=>l(t,2):t:h=()=>{if(m){sn();try{m()}finally{on()}}const T=Qn;Qn=d;try{return l?l(t,3,[_]):t(_)}finally{Qn=T}}:(h=Ct,c(t)),e&&o){const T=h,C=o===!0?1/0:o;h=()=>xn(T(),C)}const x=jd(),I=()=>{d.stop(),x&&x.active&&bi(x.effects,d)};if(i&&e){const T=e;e=(...C)=>{T(...C),I()}}let R=S?new Array(t.length).fill(vo):vo;const E=T=>{if(!(!(d.flags&1)||!d.dirty&&!T))if(e){const C=d.run();if(o||v||(S?C.some((F,V)=>Hn(F,R[V])):Hn(C,R))){m&&m();const F=Qn;Qn=d;try{const V=[C,R===vo?void 0:S&&R[0]===vo?[]:R,_];R=C,l?l(e,3,V):e(...V)}finally{Qn=F}}}else d.run()};return a&&a(E),d=new Zl(h),d.scheduler=r?()=>r(E,!1):E,_=T=>gf(T,!1,d),m=d.onStop=()=>{const T=Uo.get(d);if(T){if(l)l(T,4);else for(const C of T)C();Uo.delete(d)}},d.onTrack=s.onTrack,d.onTrigger=s.onTrigger,e?n?E(!0):R=d.run():r?r(E.bind(null,!0),!0):d.run(),I.pause=d.pause.bind(d),I.resume=d.resume.bind(d),I.stop=I,I}function xn(t,e=1/0,s){if(e<=0||!Be(t)||t.__v_skip||(s=s||new Map,(s.get(t)||0)>=e))return t;if(s.set(t,e),e--,ft(t))xn(t.value,e,s);else if(Se(t))for(let n=0;n<t.length;n++)xn(t[n],e,s);else if(Wl(t)||ns(t))t.forEach(n=>{xn(n,e,s)});else if(Kl(t)){for(const n in t)xn(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&xn(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const rs=[];function Co(t){rs.push(t)}function Eo(){rs.pop()}let Pr=!1;function te(t,...e){if(Pr)return;Pr=!0,sn();const s=rs.length?rs[rs.length-1].component:null,n=s&&s.appContext.config.warnHandler,o=yf();if(n)Is(n,s,11,[t+e.map(i=>{var r,a;return(a=(r=i.toString)==null?void 0:r.call(i))!=null?a:JSON.stringify(i)}).join(""),s&&s.proxy,o.map(({vnode:i})=>`at <${vr(s,i.type)}>`).join(`
`),o]);else{const i=[`[Vue warn]: ${t}`,...e];o.length&&i.push(`
`,...vf(o)),console.warn(...i)}on(),Pr=!1}function yf(){let t=rs[rs.length-1];if(!t)return[];const e=[];for(;t;){const s=e[0];s&&s.vnode===t?s.recurseCount++:e.push({vnode:t,recurseCount:0});const n=t.component&&t.component.parent;t=n&&n.vnode}return e}function vf(t){const e=[];return t.forEach((s,n)=>{e.push(...n===0?[]:[`
`],...bf(s))}),e}function bf({vnode:t,recurseCount:e}){const s=e>0?`... (${e} recursive calls)`:"",n=t.component?t.component.parent==null:!1,o=` at <${vr(t.component,t.type,n)}`,i=">"+s;return t.props?[o,...wf(t.props),i]:[o+i]}function wf(t){const e=[],s=Object.keys(t);return s.slice(0,3).forEach(n=>{e.push(...mc(n,t[n]))}),s.length>3&&e.push(" ..."),e}function mc(t,e,s){return tt(e)?(e=JSON.stringify(e),s?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?s?e:[`${t}=${e}`]:ft(e)?(e=mc(t,Ie(e.value),!0),s?e:[`${t}=Ref<`,e,">"]):xe(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=Ie(e),s?e:[`${t}=`,e])}function Sf(t,e){t!==void 0&&(typeof t!="number"?te(`${e} is not a valid number - got ${JSON.stringify(t)}.`):isNaN(t)&&te(`${e} is NaN - the duration expression might be incorrect.`))}const ki={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Is(t,e,s,n){try{return n?t(...n):t()}catch(o){fo(o,e,s)}}function rn(t,e,s,n){if(xe(t)){const o=Is(t,e,s,n);return o&&wi(o)&&o.catch(i=>{fo(i,e,s)}),o}if(Se(t)){const o=[];for(let i=0;i<t.length;i++)o.push(rn(t[i],e,s,n));return o}else te(`Invalid value type passed to callWithAsyncErrorHandling(): ${typeof t}`)}function fo(t,e,s,n=!0){const o=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:r}=e&&e.appContext.config||We;if(e){let a=e.parent;const l=e.proxy,c=ki[s];for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](t,l,c)===!1)return}a=a.parent}if(i){sn(),Is(i,null,10,[t,l,c]),on();return}}Mf(t,s,o,n,r)}function Mf(t,e,s,n=!0,o=!1){{const i=ki[e];if(s&&Co(s),te(`Unhandled error${i?` during execution of ${i}`:""}`),s&&Eo(),n)throw t;console.error(t)}}const Rt=[];let cn=-1;const Ts=[];let $n=null,ys=0;const gc=Promise.resolve();let Fo=null;const Tf=100;function hn(t){const e=Fo||gc;return t?e.then(this?t.bind(this):t):e}function Cf(t){let e=cn+1,s=Rt.length;for(;e<s;){const n=e+s>>>1,o=Rt[n],i=to(o);i<t||i===t&&o.flags&2?e=n+1:s=n}return e}function hr(t){if(!(t.flags&1)){const e=to(t),s=Rt[Rt.length-1];!s||!(t.flags&2)&&e>=to(s)?Rt.push(t):Rt.splice(Cf(e),0,t),t.flags|=1,_c()}}function _c(){Fo||(Fo=gc.then(vc))}function Ri(t){Se(t)?Ts.push(...t):$n&&t.id===-1?$n.splice(ys+1,0,t):t.flags&1||(Ts.push(t),t.flags|=1),_c()}function ya(t,e,s=cn+1){for(e=e||new Map;s<Rt.length;s++){const n=Rt[s];if(n&&n.flags&2){if(t&&n.id!==t.uid||Pi(e,n))continue;Rt.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function yc(t){if(Ts.length){const e=[...new Set(Ts)].sort((s,n)=>to(s)-to(n));if(Ts.length=0,$n){$n.push(...e);return}for($n=e,t=t||new Map,ys=0;ys<$n.length;ys++){const s=$n[ys];Pi(t,s)||(s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2)}$n=null,ys=0}}const to=t=>t.id==null?t.flags&2?-1:1/0:t.id;function vc(t){t=t||new Map;const e=s=>Pi(t,s);try{for(cn=0;cn<Rt.length;cn++){const s=Rt[cn];if(s&&!(s.flags&8)){if(e(s))continue;s.flags&4&&(s.flags&=-2),Is(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2)}}}finally{for(;cn<Rt.length;cn++){const s=Rt[cn];s&&(s.flags&=-2)}cn=-1,Rt.length=0,yc(t),Fo=null,(Rt.length||Ts.length)&&vc(t)}}function Pi(t,e){const s=t.get(e)||0;if(s>Tf){const n=e.i,o=n&&uu(n.type);return fo(`Maximum recursive updates exceeded${o?` in component <${o}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`,null,10),!0}return t.set(e,s+1),!1}let Qt=!1;const xo=new Map;uo().__VUE_HMR_RUNTIME__={createRecord:Ir(bc),rerender:Ir(Af),reload:Ir(kf)};const ls=new Map;function Ef(t){const e=t.type.__hmrId;let s=ls.get(e);s||(bc(e,t.type),s=ls.get(e)),s.instances.add(t)}function xf(t){ls.get(t.type.__hmrId).instances.delete(t)}function bc(t,e){return ls.has(t)?!1:(ls.set(t,{initialDef:jo(e),instances:new Set}),!0)}function jo(t){return du(t)?t.__vccOpts:t}function Af(t,e){const s=ls.get(t);s&&(s.initialDef.render=e,[...s.instances].forEach(n=>{e&&(n.render=e,jo(n.type).render=e),n.renderCache=[],Qt=!0,n.job.flags&8||n.update(),Qt=!1}))}function kf(t,e){const s=ls.get(t);if(!s)return;e=jo(e),va(s.initialDef,e);const n=[...s.instances];for(let o=0;o<n.length;o++){const i=n[o],r=jo(i.type);let a=xo.get(r);a||(r!==s.initialDef&&va(r,e),xo.set(r,a=new Set)),a.add(i),i.appContext.propsCache.delete(i.type),i.appContext.emitsCache.delete(i.type),i.appContext.optionsCache.delete(i.type),i.ceReload?(a.add(i),i.ceReload(e.styles),a.delete(i)):i.parent?hr(()=>{i.job.flags&8||(Qt=!0,i.parent.update(),Qt=!1,a.delete(i))}):i.appContext.reload?i.appContext.reload():typeof window<"u"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required."),i.root.ce&&i!==i.root&&i.root.ce._removeChildStyle(r)}Ri(()=>{xo.clear()})}function va(t,e){ct(t,e);for(const s in t)s!=="__file"&&!(s in e)&&delete t[s]}function Ir(t){return(e,s)=>{try{return t(e,s)}catch(n){console.error(n),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let fn,Bs=[],oi=!1;function po(t,...e){fn?fn.emit(t,...e):oi||Bs.push({event:t,args:e})}function wc(t,e){var s,n;fn=t,fn?(fn.enabled=!0,Bs.forEach(({event:o,args:i})=>fn.emit(o,...i)),Bs=[]):typeof window<"u"&&window.HTMLElement&&!((n=(s=window.navigator)==null?void 0:s.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{wc(i,e)}),setTimeout(()=>{fn||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,oi=!0,Bs=[])},3e3)):(oi=!0,Bs=[])}function Rf(t,e){po("app:init",t,e,{Fragment:Je,Text:mo,Comment:dt,Static:Es})}function Pf(t){po("app:unmount",t)}const If=Ii("component:added"),Sc=Ii("component:updated"),Of=Ii("component:removed"),Lf=t=>{fn&&typeof fn.cleanupBuffer=="function"&&!fn.cleanupBuffer(t)&&Of(t)};function Ii(t){return e=>{po(t,e.appContext.app,e.uid,e.parent?e.parent.uid:void 0,e)}}const Df=Mc("perf:start"),Nf=Mc("perf:end");function Mc(t){return(e,s,n)=>{po(t,e.appContext.app,e.uid,e,s,n)}}function $f(t,e,s){po("component:emit",t.appContext.app,t,e,s)}let It=null,Tc=null;function Bo(t){const e=It;return It=t,Tc=t&&t.type.__scopeId||null,e}function Cc(t,e=It,s){if(!e||t._n)return t;const n=(...o)=>{n._d&&Xo(-1);const i=Bo(e);let r;try{r=t(...o)}finally{Bo(i),n._d&&Xo(1)}return Sc(e),r};return n._n=!0,n._c=!0,n._d=!0,n}function Ec(t){Md(t)&&te("Do not use built-in directive ids as custom directive id: "+t)}function xc(t,e){if(It===null)return te("withDirectives can only be used inside render functions."),t;const s=yr(It),n=t.dirs||(t.dirs=[]);for(let o=0;o<e.length;o++){let[i,r,a,l=We]=e[o];i&&(xe(i)&&(i={mounted:i,updated:i}),i.deep&&xn(r),n.push({dir:i,instance:s,value:r,oldValue:void 0,arg:a,modifiers:l}))}return t}function qn(t,e,s,n){const o=t.dirs,i=e&&e.dirs;for(let r=0;r<o.length;r++){const a=o[r];i&&(a.oldValue=i[r].value);let l=a.dir[n];l&&(sn(),rn(l,s,8,[t.el,a,t,e]),on())}}const Ac=Symbol("_vte"),kc=t=>t.__isTeleport,is=t=>t&&(t.disabled||t.disabled===""),ba=t=>t&&(t.defer||t.defer===""),wa=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Sa=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,ri=(t,e)=>{const s=t&&t.to;if(tt(s))if(e){const n=e(s);return!n&&!is(t)&&te(`Failed to locate Teleport target with selector "${s}". Note the target element must exist before the component is mounted - i.e. the target cannot be rendered by the component itself, and ideally should be outside of the entire Vue component tree.`),n}else return te("Current renderer does not support string target for Teleports. (missing querySelector renderer option)"),null;else return!s&&!is(t)&&te(`Invalid Teleport target: ${s}`),s},Rc={name:"Teleport",__isTeleport:!0,process(t,e,s,n,o,i,r,a,l,c){const{mc:u,pc:d,pbc:h,o:{insert:m,querySelector:_,createText:v,createComment:S}}=c,x=is(e.props);let{shapeFlag:I,children:R,dynamicChildren:E}=e;if(Qt&&(l=!1,E=null),t==null){const T=e.el=S("teleport start"),C=e.anchor=S("teleport end");m(T,s,n),m(C,s,n);const F=(O,ae)=>{I&16&&u(R,O,ae,o,i,r,a,l)},V=()=>{const O=e.target=ri(e.props,_),ae=Ic(O,e,v,m);O?(r!=="svg"&&wa(O)?r="svg":r!=="mathml"&&Sa(O)&&(r="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(O),x||(F(O,ae),Ao(e,!1))):x||te("Invalid Teleport target on mount:",O,`(${typeof O})`)};x&&(F(s,C),Ao(e,!0)),ba(e.props)?(e.el.__isMounted=!1,At(()=>{V(),delete e.el.__isMounted},i)):V()}else{if(ba(e.props)&&t.el.__isMounted===!1){At(()=>{Rc.process(t,e,s,n,o,i,r,a,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const T=e.anchor=t.anchor,C=e.target=t.target,F=e.targetAnchor=t.targetAnchor,V=is(t.props),O=V?s:C,ae=V?T:F;if(r==="svg"||wa(C)?r="svg":(r==="mathml"||Sa(C))&&(r="mathml"),E?(h(t.dynamicChildren,E,O,o,i,r,a),qo(t,e,!1)):l||d(t,e,O,ae,o,i,r,a,!1),x)V?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):bo(e,s,T,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const ee=e.target=ri(e.props,_);ee?bo(e,ee,null,c,0):te("Invalid Teleport target on update:",C,`(${typeof C})`)}else V&&bo(e,C,F,c,1);Ao(e,x)}},remove(t,e,s,{um:n,o:{remove:o}},i){const{shapeFlag:r,children:a,anchor:l,targetStart:c,targetAnchor:u,target:d,props:h}=t;if(d&&(o(c),o(u)),i&&o(l),r&16){const m=i||!is(h);for(let _=0;_<a.length;_++){const v=a[_];n(v,e,s,m,!!v.dynamicChildren)}}},move:bo,hydrate:Gf};function bo(t,e,s,{o:{insert:n},m:o},i=2){i===0&&n(t.targetAnchor,e,s);const{el:r,anchor:a,shapeFlag:l,children:c,props:u}=t,d=i===2;if(d&&n(r,e,s),(!d||is(u))&&l&16)for(let h=0;h<c.length;h++)o(c[h],e,s,2);d&&n(a,e,s)}function Gf(t,e,s,n,o,i,{o:{nextSibling:r,parentNode:a,querySelector:l,insert:c,createText:u}},d){function h(v,S,x,I){S.anchor=d(r(v),S,a(v),s,n,o,i),S.targetStart=x,S.targetAnchor=I}const m=e.target=ri(e.props,l),_=is(e.props);if(m){const v=m._lpa||m.firstChild;if(e.shapeFlag&16)if(_)h(t,e,v,v&&r(v));else{e.anchor=r(t);let S=v;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")e.targetStart=S;else if(S.data==="teleport anchor"){e.targetAnchor=S,m._lpa=e.targetAnchor&&r(e.targetAnchor);break}}S=r(S)}e.targetAnchor||Ic(m,e,u,c),d(v&&r(v),e,m,s,n,o,i)}Ao(e,_)}else _&&e.shapeFlag&16&&h(t,e,t,r(t));return e.anchor&&r(e.anchor)}const Pc=Rc;function Ao(t,e){const s=t.ctx;if(s&&s.ut){let n,o;for(e?(n=t.el,o=t.anchor):(n=t.targetStart,o=t.targetAnchor);n&&n!==o;)n.nodeType===1&&n.setAttribute("data-v-owner",s.uid),n=n.nextSibling;s.ut()}}function Ic(t,e,s,n){const o=e.targetStart=s(""),i=e.targetAnchor=s("");return o[Ac]=i,t&&(n(o,t),n(i,t)),i}const Cn=Symbol("_leaveCb"),wo=Symbol("_enterCb");function Hf(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return et(()=>{t.isMounted=!0}),_t(()=>{t.isUnmounting=!0}),t}const Bt=[Function,Array],Oc={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bt,onEnter:Bt,onAfterEnter:Bt,onEnterCancelled:Bt,onBeforeLeave:Bt,onLeave:Bt,onAfterLeave:Bt,onLeaveCancelled:Bt,onBeforeAppear:Bt,onAppear:Bt,onAfterAppear:Bt,onAppearCancelled:Bt},Lc=t=>{const e=t.subTree;return e.component?Lc(e.component):e},Uf={name:"BaseTransition",props:Oc,setup(t,{slots:e}){const s=_r(),n=Hf();return()=>{const o=e.default&&$c(e.default(),!0);if(!o||!o.length)return;const i=Dc(o),r=Ie(t),{mode:a}=r;if(a&&a!=="in-out"&&a!=="out-in"&&a!=="default"&&te(`invalid <transition> mode: ${a}`),n.isLeaving)return Or(i);const l=Ma(i);if(!l)return Or(i);let c=ii(l,r,n,s,d=>c=d);l.type!==dt&&no(l,c);let u=s.subTree&&Ma(s.subTree);if(u&&u.type!==dt&&!es(u,l)&&Lc(s).type!==dt){let d=ii(u,r,n,s);if(no(u,d),a==="out-in"&&l.type!==dt)return n.isLeaving=!0,d.afterLeave=()=>{n.isLeaving=!1,s.job.flags&8||s.update(),delete d.afterLeave,u=void 0},Or(i);a==="in-out"&&l.type!==dt?d.delayLeave=(h,m,_)=>{const v=Nc(n,u);v[String(u.key)]=u,h[Cn]=()=>{m(),h[Cn]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{_(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function Dc(t){let e=t[0];if(t.length>1){let s=!1;for(const n of t)if(n.type!==dt){if(s){te("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}e=n,s=!0}}return e}const Ff=Uf;function Nc(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function ii(t,e,s,n,o){const{appear:i,mode:r,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:m,onAfterLeave:_,onLeaveCancelled:v,onBeforeAppear:S,onAppear:x,onAfterAppear:I,onAppearCancelled:R}=e,E=String(t.key),T=Nc(s,t),C=(O,ae)=>{O&&rn(O,n,9,ae)},F=(O,ae)=>{const ee=ae[1];C(O,ae),Se(O)?O.every(q=>q.length<=1)&&ee():O.length<=1&&ee()},V={mode:r,persisted:a,beforeEnter(O){let ae=l;if(!s.isMounted)if(i)ae=S||l;else return;O[Cn]&&O[Cn](!0);const ee=T[E];ee&&es(t,ee)&&ee.el[Cn]&&ee.el[Cn](),C(ae,[O])},enter(O){let ae=c,ee=u,q=d;if(!s.isMounted)if(i)ae=x||c,ee=I||u,q=R||d;else return;let L=!1;const Q=O[wo]=we=>{L||(L=!0,we?C(q,[O]):C(ee,[O]),V.delayedLeave&&V.delayedLeave(),O[wo]=void 0)};ae?F(ae,[O,Q]):Q()},leave(O,ae){const ee=String(t.key);if(O[wo]&&O[wo](!0),s.isUnmounting)return ae();C(h,[O]);let q=!1;const L=O[Cn]=Q=>{q||(q=!0,ae(),Q?C(v,[O]):C(_,[O]),O[Cn]=void 0,T[ee]===t&&delete T[ee])};T[ee]=t,m?F(m,[O,L]):L()},clone(O){const ae=ii(O,e,s,n,o);return o&&o(ae),ae}};return V}function Or(t){if(ho(t))return t=vn(t),t.children=null,t}function Ma(t){if(!ho(t))return kc(t.type)&&t.children?Dc(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:s}=t;if(s){if(e&16)return s[0];if(e&32&&xe(s.default))return s.default()}}function no(t,e){t.shapeFlag&6&&t.component?(t.transition=e,no(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function $c(t,e=!1,s){let n=[],o=0;for(let i=0;i<t.length;i++){let r=t[i];const a=s==null?r.key:String(s)+String(r.key!=null?r.key:i);r.type===Je?(r.patchFlag&128&&o++,n=n.concat($c(r.children,e,a))):(e||r.type!==dt)&&n.push(a!=null?vn(r,{key:a}):r)}if(o>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function Gc(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const Ta=new WeakSet,Vo=new WeakMap;function Ys(t,e,s,n,o=!1){if(Se(t)){t.forEach((v,S)=>Ys(v,e&&(Se(e)?e[S]:e),s,n,o));return}if(Js(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ys(t,e,s,n.component.subTree);return}const i=n.shapeFlag&4?yr(n.component):n.el,r=o?null:i,{i:a,r:l}=t;if(!a){te("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const c=e&&e.r,u=a.refs===We?a.refs={}:a.refs,d=a.setupState,h=Ie(d),m=d===We?zl:v=>(Fe(h,v)&&!ft(h[v])&&te(`Template ref "${v}" used on a non-ref value. It will not work in the production build.`),Ta.has(h[v])?!1:Fe(h,v)),_=v=>!Ta.has(v);if(c!=null&&c!==l){if(Ca(e),tt(c))u[c]=null,m(c)&&(d[c]=null);else if(ft(c)){_(c)&&(c.value=null);const v=e;v.k&&(u[v.k]=null)}}if(xe(l))Is(l,a,12,[r,u]);else{const v=tt(l),S=ft(l);if(v||S){const x=()=>{if(t.f){const I=v?m(l)?d[l]:u[l]:_(l)||!t.k?l.value:u[t.k];if(o)Se(I)&&bi(I,i);else if(Se(I))I.includes(i)||I.push(i);else if(v)u[l]=[i],m(l)&&(d[l]=u[l]);else{const R=[i];_(l)&&(l.value=R),t.k&&(u[t.k]=R)}}else v?(u[l]=r,m(l)&&(d[l]=r)):S?(_(l)&&(l.value=r),t.k&&(u[t.k]=r)):te("Invalid template ref type:",l,`(${typeof l})`)};if(r){const I=()=>{x(),Vo.delete(t)};I.id=-1,Vo.set(t,I),At(I,s)}else Ca(t),x()}else te("Invalid template ref type:",l,`(${typeof l})`)}}function Ca(t){const e=Vo.get(t);e&&(e.flags|=8,Vo.delete(t))}uo().requestIdleCallback;uo().cancelIdleCallback;const Js=t=>!!t.type.__asyncLoader,ho=t=>t.type.__isKeepAlive;function jf(t,e){Hc(t,"a",e)}function Bf(t,e){Hc(t,"da",e)}function Hc(t,e,s=Tt){const n=t.__wdc||(t.__wdc=()=>{let o=s;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(mr(e,n,s),s){let o=s.parent;for(;o&&o.parent;)ho(o.parent.vnode)&&Vf(n,e,s,o),o=o.parent}}function Vf(t,e,s,n){const o=mr(e,t,n,!0);Oi(()=>{bi(n[e],o)},s)}function mr(t,e,s=Tt,n=!1){if(s){const o=s[t]||(s[t]=[]),i=e.__weh||(e.__weh=(...r)=>{sn();const a=go(s),l=rn(e,s,t,r);return a(),on(),l});return n?o.unshift(i):o.push(i),i}else{const o=Zn(ki[t].replace(/ hook$/,""));te(`${o} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const Ln=t=>(e,s=Tt)=>{(!oo||t==="sp")&&mr(t,(...n)=>e(...n),s)},zf=Ln("bm"),et=Ln("m"),Uc=Ln("bu"),Wf=Ln("u"),_t=Ln("bum"),Oi=Ln("um"),qf=Ln("sp"),Kf=Ln("rtg"),Xf=Ln("rtc");function Yf(t,e=Tt){mr("ec",t,e)}const Jf=Symbol.for("v-ndc");function qt(t,e,s,n){let o;const i=s,r=Se(t);if(r||tt(t)){const a=r&&os(t);let l=!1,c=!1;a&&(l=!Ot(t),c=yn(t),t=dr(t)),o=new Array(t.length);for(let u=0,d=t.length;u<d;u++)o[u]=e(l?c?Ho(St(t[u])):St(t[u]):t[u],u,void 0,i)}else if(typeof t=="number"){Number.isInteger(t)||te(`The v-for range expect an integer value but got ${t}.`),o=new Array(t);for(let a=0;a<t;a++)o[a]=e(a+1,a,void 0,i)}else if(Be(t))if(t[Symbol.iterator])o=Array.from(t,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(t);o=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];o[l]=e(t[u],u,l,i)}}else o=[];return o}const ai=t=>t?lu(t)?yr(t):ai(t.parent):null,as=ct(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>pn(t.props),$attrs:t=>pn(t.attrs),$slots:t=>pn(t.slots),$refs:t=>pn(t.refs),$parent:t=>ai(t.parent),$root:t=>ai(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Bc(t),$forceUpdate:t=>t.f||(t.f=()=>{hr(t.update)}),$nextTick:t=>t.n||(t.n=hn.bind(t.proxy)),$watch:t=>Rp.bind(t)}),Li=t=>t==="_"||t==="$",Lr=(t,e)=>t!==We&&!t.__isScriptSetup&&Fe(t,e),Fc={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:o,props:i,accessCache:r,type:a,appContext:l}=t;if(e==="__isVue")return!0;let c;if(e[0]!=="$"){const m=r[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return o[e];case 4:return s[e];case 3:return i[e]}else{if(Lr(n,e))return r[e]=1,n[e];if(o!==We&&Fe(o,e))return r[e]=2,o[e];if((c=t.propsOptions[0])&&Fe(c,e))return r[e]=3,i[e];if(s!==We&&Fe(s,e))return r[e]=4,s[e];li&&(r[e]=0)}}const u=as[e];let d,h;if(u)return e==="$attrs"?(bt(t.attrs,"get",""),Ko()):e==="$slots"&&bt(t,"get",e),u(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(s!==We&&Fe(s,e))return r[e]=4,s[e];if(h=l.config.globalProperties,Fe(h,e))return h[e];It&&(!tt(e)||e.indexOf("__v")!==0)&&(o!==We&&Li(e[0])&&Fe(o,e)?te(`Property ${JSON.stringify(e)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):t===It&&te(`Property ${JSON.stringify(e)} was accessed during render but is not defined on instance.`))},set({_:t},e,s){const{data:n,setupState:o,ctx:i}=t;return Lr(o,e)?(o[e]=s,!0):o.__isScriptSetup&&Fe(o,e)?(te(`Cannot mutate <script setup> binding "${e}" from Options API.`),!1):n!==We&&Fe(n,e)?(n[e]=s,!0):Fe(t.props,e)?(te(`Attempting to mutate prop "${e}". Props are readonly.`),!1):e[0]==="$"&&e.slice(1)in t?(te(`Attempting to mutate public property "${e}". Properties starting with $ are reserved and readonly.`),!1):(e in t.appContext.config.globalProperties?Object.defineProperty(i,e,{enumerable:!0,configurable:!0,value:s}):i[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:o,propsOptions:i,type:r}},a){let l,c;return!!(s[a]||t!==We&&a[0]!=="$"&&Fe(t,a)||Lr(e,a)||(l=i[0])&&Fe(l,a)||Fe(n,a)||Fe(as,a)||Fe(o.config.globalProperties,a)||(c=r.__cssModules)&&c[a])},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:Fe(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};Fc.ownKeys=t=>(te("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(t));function Zf(t){const e={};return Object.defineProperty(e,"_",{configurable:!0,enumerable:!1,get:()=>t}),Object.keys(as).forEach(s=>{Object.defineProperty(e,s,{configurable:!0,enumerable:!1,get:()=>as[s](t),set:Ct})}),e}function Qf(t){const{ctx:e,propsOptions:[s]}=t;s&&Object.keys(s).forEach(n=>{Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>t.props[n],set:Ct})})}function ep(t){const{ctx:e,setupState:s}=t;Object.keys(Ie(s)).forEach(n=>{if(!s.__isScriptSetup){if(Li(n[0])){te(`setup() return property ${JSON.stringify(n)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s[n],set:Ct})}})}function Ea(t){return Se(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}function tp(){const t=Object.create(null);return(e,s)=>{t[s]?te(`${e} property "${s}" is already defined in ${t[s]}.`):t[s]=e}}let li=!0;function np(t){const e=Bc(t),s=t.proxy,n=t.ctx;li=!1,e.beforeCreate&&xa(e.beforeCreate,t,"bc");const{data:o,computed:i,methods:r,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:m,updated:_,activated:v,deactivated:S,beforeDestroy:x,beforeUnmount:I,destroyed:R,unmounted:E,render:T,renderTracked:C,renderTriggered:F,errorCaptured:V,serverPrefetch:O,expose:ae,inheritAttrs:ee,components:q,directives:L,filters:Q}=e,we=tp();{const[Y]=t.propsOptions;if(Y)for(const ve in Y)we("Props",ve)}if(c&&sp(c,n,we),r)for(const Y in r){const ve=r[Y];xe(ve)?(Object.defineProperty(n,Y,{value:ve.bind(s),configurable:!0,enumerable:!0,writable:!0}),we("Methods",Y)):te(`Method "${Y}" has type "${typeof ve}" in the component definition. Did you reference the function correctly?`)}if(o){xe(o)||te("The data option must be a function. Plain object usage is no longer supported.");const Y=o.call(s,s);if(wi(Y)&&te("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Be(Y))te("data() should return an object.");else{t.data=Ai(Y);for(const ve in Y)we("Data",ve),Li(ve[0])||Object.defineProperty(n,ve,{configurable:!0,enumerable:!0,get:()=>Y[ve],set:Ct})}}if(li=!0,i)for(const Y in i){const ve=i[Y],Ge=xe(ve)?ve.bind(s,s):xe(ve.get)?ve.get.bind(s,s):Ct;Ge===Ct&&te(`Computed property "${Y}" has no getter.`);const ue=!xe(ve)&&xe(ve.set)?ve.set.bind(s):()=>{te(`Write operation failed: computed property "${Y}" is readonly.`)},A=Ee({get:Ge,set:ue});Object.defineProperty(n,Y,{enumerable:!0,configurable:!0,get:()=>A.value,set:de=>A.value=de}),we("Computed",Y)}if(a)for(const Y in a)jc(a[Y],n,s,Y);if(l){const Y=xe(l)?l.call(s):l;Reflect.ownKeys(Y).forEach(ve=>{cp(ve,Y[ve])})}u&&xa(u,t,"c");function ye(Y,ve){Se(ve)?ve.forEach(Ge=>Y(Ge.bind(s))):ve&&Y(ve.bind(s))}if(ye(zf,d),ye(et,h),ye(Uc,m),ye(Wf,_),ye(jf,v),ye(Bf,S),ye(Yf,V),ye(Xf,C),ye(Kf,F),ye(_t,I),ye(Oi,E),ye(qf,O),Se(ae))if(ae.length){const Y=t.exposed||(t.exposed={});ae.forEach(ve=>{Object.defineProperty(Y,ve,{get:()=>s[ve],set:Ge=>s[ve]=Ge,enumerable:!0})})}else t.exposed||(t.exposed={});T&&t.render===Ct&&(t.render=T),ee!=null&&(t.inheritAttrs=ee),q&&(t.components=q),L&&(t.directives=L),O&&Gc(t)}function sp(t,e,s=Ct){Se(t)&&(t=ci(t));for(const n in t){const o=t[n];let i;Be(o)?"default"in o?i=ko(o.from||n,o.default,!0):i=ko(o.from||n):i=ko(o),ft(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:r=>i.value=r}):e[n]=i,s("Inject",n)}}function xa(t,e,s){rn(Se(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function jc(t,e,s,n){let o=n.includes(".")?tu(s,n):()=>s[n];if(tt(t)){const i=e[t];xe(i)?lt(o,i):te(`Invalid watch handler specified by key "${t}"`,i)}else if(xe(t))lt(o,t.bind(s));else if(Be(t))if(Se(t))t.forEach(i=>jc(i,e,s,n));else{const i=xe(t.handler)?t.handler.bind(s):e[t.handler];xe(i)?lt(o,i,t):te(`Invalid watch handler specified by key "${t.handler}"`,i)}else te(`Invalid watch option: "${n}"`,t)}function Bc(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:o,optionsCache:i,config:{optionMergeStrategies:r}}=t.appContext,a=i.get(e);let l;return a?l=a:!o.length&&!s&&!n?l=e:(l={},o.length&&o.forEach(c=>zo(l,c,r,!0)),zo(l,e,r)),Be(e)&&i.set(e,l),l}function zo(t,e,s,n=!1){const{mixins:o,extends:i}=e;i&&zo(t,i,s,!0),o&&o.forEach(r=>zo(t,r,s,!0));for(const r in e)if(n&&r==="expose")te('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const a=op[r]||s&&s[r];t[r]=a?a(t[r],e[r]):e[r]}return t}const op={data:Aa,props:ka,emits:ka,methods:Vs,computed:Vs,beforeCreate:xt,created:xt,beforeMount:xt,mounted:xt,beforeUpdate:xt,updated:xt,beforeDestroy:xt,beforeUnmount:xt,destroyed:xt,unmounted:xt,activated:xt,deactivated:xt,errorCaptured:xt,serverPrefetch:xt,components:Vs,directives:Vs,watch:ip,provide:Aa,inject:rp};function Aa(t,e){return e?t?function(){return ct(xe(t)?t.call(this,this):t,xe(e)?e.call(this,this):e)}:e:t}function rp(t,e){return Vs(ci(t),ci(e))}function ci(t){if(Se(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function xt(t,e){return t?[...new Set([].concat(t,e))]:e}function Vs(t,e){return t?ct(Object.create(null),t,e):e}function ka(t,e){return t?Se(t)&&Se(e)?[...new Set([...t,...e])]:ct(Object.create(null),Ea(t),Ea(e??{})):e}function ip(t,e){if(!t)return e;if(!e)return t;const s=ct(Object.create(null),t);for(const n in e)s[n]=xt(t[n],e[n]);return s}function Vc(){return{app:null,config:{isNativeTag:zl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ap=0;function lp(t,e){return function(n,o=null){xe(n)||(n=ct({},n)),o!=null&&!Be(o)&&(te("root props passed to app.mount() must be an object."),o=null);const i=Vc(),r=new WeakSet,a=[];let l=!1;const c=i.app={_uid:ap++,_component:n,_props:o,_container:null,_context:i,_instance:null,version:Ha,get config(){return i.config},set config(u){te("app.config cannot be replaced. Modify individual options instead.")},use(u,...d){return r.has(u)?te("Plugin has already been applied to target app."):u&&xe(u.install)?(r.add(u),u.install(c,...d)):xe(u)?(r.add(u),u(c,...d)):te('A plugin must either be a function or an object with an "install" function.'),c},mixin(u){return i.mixins.includes(u)?te("Mixin has already been applied to target app"+(u.name?`: ${u.name}`:"")):i.mixins.push(u),c},component(u,d){return hi(u,i.config),d?(i.components[u]&&te(`Component "${u}" has already been registered in target app.`),i.components[u]=d,c):i.components[u]},directive(u,d){return Ec(u),d?(i.directives[u]&&te(`Directive "${u}" has already been registered in target app.`),i.directives[u]=d,c):i.directives[u]},mount(u,d,h){if(l)te("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{u.__vue_app__&&te("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const m=c._ceVNode||it(n,o);return m.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),i.reload=()=>{const _=vn(m);_.el=null,t(_,u,h)},t(m,u,h),l=!0,c._container=u,u.__vue_app__=c,c._instance=m.component,Rf(c,Ha),yr(m.component)}},onUnmount(u){typeof u!="function"&&te(`Expected function as first argument to app.onUnmount(), but got ${typeof u}`),a.push(u)},unmount(){l?(rn(a,c._instance,16),t(null,c._container),c._instance=null,Pf(c),delete c._container.__vue_app__):te("Cannot unmount an app that is not mounted.")},provide(u,d){return u in i.provides&&(Fe(i.provides,u)?te(`App already provides property with key "${String(u)}". It will be overwritten with the new value.`):te(`App already provides property with key "${String(u)}" inherited from its parent element. It will be overwritten with the new value.`)),i.provides[u]=d,c},runWithContext(u){const d=Cs;Cs=c;try{return u()}finally{Cs=d}}};return c}}let Cs=null;function cp(t,e){if(!Tt)te("provide() can only be used inside setup().");else{let s=Tt.provides;const n=Tt.parent&&Tt.parent.provides;n===s&&(s=Tt.provides=Object.create(n)),s[t]=e}}function ko(t,e,s=!1){const n=_r();if(n||Cs){let o=Cs?Cs._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&t in o)return o[t];if(arguments.length>1)return s&&xe(e)?e.call(n&&n.proxy):e;te(`injection "${String(t)}" not found.`)}else te("inject() can only be used inside setup() or functional components.")}const zc={},Wc=()=>Object.create(zc),qc=t=>Object.getPrototypeOf(t)===zc;function up(t,e,s,n=!1){const o={},i=Wc();t.propsDefaults=Object.create(null),Kc(t,e,o,i);for(const r in t.propsOptions[0])r in o||(o[r]=void 0);Yc(e||{},o,t),s?t.props=n?o:lf(o):t.type.props?t.props=o:t.props=i,t.attrs=i}function dp(t){for(;t;){if(t.type.__hmrId)return!0;t=t.parent}}function fp(t,e,s,n){const{props:o,attrs:i,vnode:{patchFlag:r}}=t,a=Ie(o),[l]=t.propsOptions;let c=!1;if(!dp(t)&&(n||r>0)&&!(r&16)){if(r&8){const u=t.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(gr(t.emitsOptions,h))continue;const m=e[h];if(l)if(Fe(i,h))m!==i[h]&&(i[h]=m,c=!0);else{const _=en(h);o[_]=ui(l,a,_,m,t,!1)}else m!==i[h]&&(i[h]=m,c=!0)}}}else{Kc(t,e,o,i)&&(c=!0);let u;for(const d in a)(!e||!Fe(e,d)&&((u=Fn(d))===d||!Fe(e,u)))&&(l?s&&(s[d]!==void 0||s[u]!==void 0)&&(o[d]=ui(l,a,d,void 0,t,!0)):delete o[d]);if(i!==a)for(const d in i)(!e||!Fe(e,d))&&(delete i[d],c=!0)}c&&dn(t.attrs,"set",""),Yc(e||{},o,t)}function Kc(t,e,s,n){const[o,i]=t.propsOptions;let r=!1,a;if(e)for(let l in e){if(qs(l))continue;const c=e[l];let u;o&&Fe(o,u=en(l))?!i||!i.includes(u)?s[u]=c:(a||(a={}))[u]=c:gr(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,r=!0)}if(i){const l=Ie(s),c=a||We;for(let u=0;u<i.length;u++){const d=i[u];s[d]=ui(o,l,d,c[d],t,!Fe(c,d))}}return r}function ui(t,e,s,n,o,i){const r=t[s];if(r!=null){const a=Fe(r,"default");if(a&&n===void 0){const l=r.default;if(r.type!==Function&&!r.skipFactory&&xe(l)){const{propsDefaults:c}=o;if(s in c)n=c[s];else{const u=go(o);n=c[s]=l.call(null,e),u()}}else n=l;o.ce&&o.ce._setProp(s,n)}r[0]&&(i&&!a?n=!1:r[1]&&(n===""||n===Fn(s))&&(n=!0))}return n}const pp=new WeakMap;function Xc(t,e,s=!1){const n=s?pp:e.propsCache,o=n.get(t);if(o)return o;const i=t.props,r={},a=[];let l=!1;if(!xe(t)){const u=d=>{l=!0;const[h,m]=Xc(d,e,!0);ct(r,h),m&&a.push(...m)};!s&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return Be(t)&&n.set(t,Ms),Ms;if(Se(i))for(let u=0;u<i.length;u++){tt(i[u])||te("props must be strings when using array syntax.",i[u]);const d=en(i[u]);Ra(d)&&(r[d]=We)}else if(i){Be(i)||te("invalid props options",i);for(const u in i){const d=en(u);if(Ra(d)){const h=i[u],m=r[d]=Se(h)||xe(h)?{type:h}:ct({},h),_=m.type;let v=!1,S=!0;if(Se(_))for(let x=0;x<_.length;++x){const I=_[x],R=xe(I)&&I.name;if(R==="Boolean"){v=!0;break}else R==="String"&&(S=!1)}else v=xe(_)&&_.name==="Boolean";m[0]=v,m[1]=S,(v||Fe(m,"default"))&&a.push(d)}}}const c=[r,a];return Be(t)&&n.set(t,c),c}function Ra(t){return t[0]!=="$"&&!qs(t)?!0:(te(`Invalid prop name: "${t}" is a reserved property.`),!1)}function hp(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function Yc(t,e,s){const n=Ie(e),o=s.propsOptions[0],i=Object.keys(t).map(r=>en(r));for(const r in o){let a=o[r];a!=null&&mp(r,n[r],a,pn(n),!i.includes(r))}}function mp(t,e,s,n,o){const{type:i,required:r,validator:a,skipCheck:l}=s;if(r&&o){te('Missing required prop: "'+t+'"');return}if(!(e==null&&!r)){if(i!=null&&i!==!0&&!l){let c=!1;const u=Se(i)?i:[i],d=[];for(let h=0;h<u.length&&!c;h++){const{valid:m,expectedType:_}=_p(e,u[h]);d.push(_||""),c=m}if(!c){te(yp(t,e,d));return}}a&&!a(e,n)&&te('Invalid prop: custom validator check failed for prop "'+t+'".')}}const gp=On("String,Number,Boolean,Function,Symbol,BigInt");function _p(t,e){let s;const n=hp(e);if(n==="null")s=t===null;else if(gp(n)){const o=typeof t;s=o===n.toLowerCase(),!s&&o==="object"&&(s=t instanceof e)}else n==="Object"?s=Be(t):n==="Array"?s=Se(t):s=t instanceof e;return{valid:s,expectedType:n}}function yp(t,e,s){if(s.length===0)return`Prop type [] for prop "${t}" won't match anything. Did you mean to use type Array instead?`;let n=`Invalid prop: type check failed for prop "${t}". Expected ${s.map(ur).join(" | ")}`;const o=s[0],i=Si(e),r=Pa(e,o),a=Pa(e,i);return s.length===1&&Ia(o)&&!vp(o,i)&&(n+=` with value ${r}`),n+=`, got ${i} `,Ia(i)&&(n+=`with value ${a}.`),n}function Pa(t,e){return e==="String"?`"${t}"`:e==="Number"?`${Number(t)}`:`${t}`}function Ia(t){return["string","number","boolean"].some(s=>t.toLowerCase()===s)}function vp(...t){return t.some(e=>e.toLowerCase()==="boolean")}const Di=t=>t==="_"||t==="_ctx"||t==="$stable",Ni=t=>Se(t)?t.map(Zt):[Zt(t)],bp=(t,e,s)=>{if(e._n)return e;const n=Cc((...o)=>(Tt&&!(s===null&&It)&&!(s&&s.root!==Tt.root)&&te(`Slot "${t}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),Ni(e(...o))),s);return n._c=!1,n},Jc=(t,e,s)=>{const n=t._ctx;for(const o in t){if(Di(o))continue;const i=t[o];if(xe(i))e[o]=bp(o,i,n);else if(i!=null){te(`Non-function value encountered for slot "${o}". Prefer function slots for better performance.`);const r=Ni(i);e[o]=()=>r}}},Zc=(t,e)=>{ho(t.vnode)||te("Non-function value encountered for default slot. Prefer function slots for better performance.");const s=Ni(e);t.slots.default=()=>s},di=(t,e,s)=>{for(const n in e)(s||!Di(n))&&(t[n]=e[n])},wp=(t,e,s)=>{const n=t.slots=Wc();if(t.vnode.shapeFlag&32){const o=e._;o?(di(n,e,s),s&&$o(n,"_",o,!0)):Jc(e,n)}else e&&Zc(t,e)},Sp=(t,e,s)=>{const{vnode:n,slots:o}=t;let i=!0,r=We;if(n.shapeFlag&32){const a=e._;a?Qt?(di(o,e,s),dn(t,"set","$slots")):s&&a===1?i=!1:di(o,e,s):(i=!e.$stable,Jc(e,o)),r=e}else e&&(Zc(t,e),r={default:1});if(i)for(const a in o)!Di(a)&&r[a]==null&&delete o[a]};let Hs,En;function gs(t,e){t.appContext.config.performance&&Wo()&&En.mark(`vue-${e}-${t.uid}`),Df(t,e,Wo()?En.now():Date.now())}function _s(t,e){if(t.appContext.config.performance&&Wo()){const s=`vue-${e}-${t.uid}`,n=s+":end",o=`<${vr(t,t.type)}> ${e}`;En.mark(n),En.measure(o,s,n),En.clearMeasures(o),En.clearMarks(s),En.clearMarks(n)}Nf(t,e,Wo()?En.now():Date.now())}function Wo(){return Hs!==void 0||(typeof window<"u"&&window.performance?(Hs=!0,En=window.performance):Hs=!1),Hs}function Mp(){const t=[];if(t.length){const e=t.length>1;console.warn(`Feature flag${e?"s":""} ${t.join(", ")} ${e?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const At=Gp;function Tp(t){return Cp(t)}function Cp(t,e){Mp();const s=uo();s.__VUE__=!0,wc(s.__VUE_DEVTOOLS_GLOBAL_HOOK__,s);const{insert:n,remove:o,patchProp:i,createElement:r,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:m=Ct,insertStaticContent:_}=t,v=(g,b,k,z=null,j=null,G=null,K=void 0,J=null,X=Qt?!1:!!b.dynamicChildren)=>{if(g===b)return;g&&!es(g,b)&&(z=Ke(g),$(g,j,G,!0),g=null),b.patchFlag===-2&&(X=!1,b.dynamicChildren=null);const{type:B,ref:me,shapeFlag:re}=b;switch(B){case mo:S(g,b,k,z);break;case dt:x(g,b,k,z);break;case Es:g==null?I(b,k,z,K):R(g,b,k,K);break;case Je:L(g,b,k,z,j,G,K,J,X);break;default:re&1?C(g,b,k,z,j,G,K,J,X):re&6?Q(g,b,k,z,j,G,K,J,X):re&64||re&128?B.process(g,b,k,z,j,G,K,J,X,at):te("Invalid VNode type:",B,`(${typeof B})`)}me!=null&&j?Ys(me,g&&g.ref,G,b||g,!b):me==null&&g&&g.ref!=null&&Ys(g.ref,null,G,g,!0)},S=(g,b,k,z)=>{if(g==null)n(b.el=a(b.children),k,z);else{const j=b.el=g.el;b.children!==g.children&&c(j,b.children)}},x=(g,b,k,z)=>{g==null?n(b.el=l(b.children||""),k,z):b.el=g.el},I=(g,b,k,z)=>{[g.el,g.anchor]=_(g.children,b,k,z,g.el,g.anchor)},R=(g,b,k,z)=>{if(b.children!==g.children){const j=h(g.anchor);T(g),[b.el,b.anchor]=_(b.children,k,j,z)}else b.el=g.el,b.anchor=g.anchor},E=({el:g,anchor:b},k,z)=>{let j;for(;g&&g!==b;)j=h(g),n(g,k,z),g=j;n(b,k,z)},T=({el:g,anchor:b})=>{let k;for(;g&&g!==b;)k=h(g),o(g),g=k;o(b)},C=(g,b,k,z,j,G,K,J,X)=>{b.type==="svg"?K="svg":b.type==="math"&&(K="mathml"),g==null?F(b,k,z,j,G,K,J,X):ae(g,b,j,G,K,J,X)},F=(g,b,k,z,j,G,K,J)=>{let X,B;const{props:me,shapeFlag:re,transition:he,dirs:fe}=g;if(X=g.el=r(g.type,G,me&&me.is,me),re&8?u(X,g.children):re&16&&O(g.children,X,null,z,j,Dr(g,G),K,J),fe&&qn(g,null,z,"created"),V(X,g,g.scopeId,K,z),me){for(const le in me)le!=="value"&&!qs(le)&&i(X,le,null,me[le],G,z);"value"in me&&i(X,"value",null,me.value,G),(B=me.onVnodeBeforeMount)&&ln(B,z,g)}$o(X,"__vnode",g,!0),$o(X,"__vueParentComponent",z,!0),fe&&qn(g,null,z,"beforeMount");const _e=Ep(j,he);_e&&he.beforeEnter(X),n(X,b,k),((B=me&&me.onVnodeMounted)||_e||fe)&&At(()=>{B&&ln(B,z,g),_e&&he.enter(X),fe&&qn(g,null,z,"mounted")},j)},V=(g,b,k,z,j)=>{if(k&&m(g,k),z)for(let G=0;G<z.length;G++)m(g,z[G]);if(j){let G=j.subTree;if(G.patchFlag>0&&G.patchFlag&2048&&(G=$i(G.children)||G),b===G||ou(G.type)&&(G.ssContent===b||G.ssFallback===b)){const K=j.vnode;V(g,K,K.scopeId,K.slotScopeIds,j.parent)}}},O=(g,b,k,z,j,G,K,J,X=0)=>{for(let B=X;B<g.length;B++){const me=g[B]=J?Gn(g[B]):Zt(g[B]);v(null,me,b,k,z,j,G,K,J)}},ae=(g,b,k,z,j,G,K)=>{const J=b.el=g.el;J.__vnode=b;let{patchFlag:X,dynamicChildren:B,dirs:me}=b;X|=g.patchFlag&16;const re=g.props||We,he=b.props||We;let fe;if(k&&Kn(k,!1),(fe=he.onVnodeBeforeUpdate)&&ln(fe,k,b,g),me&&qn(b,g,k,"beforeUpdate"),k&&Kn(k,!0),Qt&&(X=0,K=!1,B=null),(re.innerHTML&&he.innerHTML==null||re.textContent&&he.textContent==null)&&u(J,""),B?(ee(g.dynamicChildren,B,J,k,z,Dr(b,j),G),qo(g,b)):K||Ge(g,b,J,null,k,z,Dr(b,j),G,!1),X>0){if(X&16)q(J,re,he,k,j);else if(X&2&&re.class!==he.class&&i(J,"class",null,he.class,j),X&4&&i(J,"style",re.style,he.style,j),X&8){const _e=b.dynamicProps;for(let le=0;le<_e.length;le++){const ke=_e[le],Ze=re[ke],nt=he[ke];(nt!==Ze||ke==="value")&&i(J,ke,Ze,nt,j,k)}}X&1&&g.children!==b.children&&u(J,b.children)}else!K&&B==null&&q(J,re,he,k,j);((fe=he.onVnodeUpdated)||me)&&At(()=>{fe&&ln(fe,k,b,g),me&&qn(b,g,k,"updated")},z)},ee=(g,b,k,z,j,G,K)=>{for(let J=0;J<b.length;J++){const X=g[J],B=b[J],me=X.el&&(X.type===Je||!es(X,B)||X.shapeFlag&198)?d(X.el):k;v(X,B,me,null,z,j,G,K,!0)}},q=(g,b,k,z,j)=>{if(b!==k){if(b!==We)for(const G in b)!qs(G)&&!(G in k)&&i(g,G,b[G],null,j,z);for(const G in k){if(qs(G))continue;const K=k[G],J=b[G];K!==J&&G!=="value"&&i(g,G,J,K,j,z)}"value"in k&&i(g,"value",b.value,k.value,j)}},L=(g,b,k,z,j,G,K,J,X)=>{const B=b.el=g?g.el:a(""),me=b.anchor=g?g.anchor:a("");let{patchFlag:re,dynamicChildren:he,slotScopeIds:fe}=b;(Qt||re&2048)&&(re=0,X=!1,he=null),fe&&(J=J?J.concat(fe):fe),g==null?(n(B,k,z),n(me,k,z),O(b.children||[],k,me,j,G,K,J,X)):re>0&&re&64&&he&&g.dynamicChildren?(ee(g.dynamicChildren,he,k,j,G,K,J),qo(g,b)):Ge(g,b,k,me,j,G,K,J,X)},Q=(g,b,k,z,j,G,K,J,X)=>{b.slotScopeIds=J,g==null?b.shapeFlag&512?j.ctx.activate(b,k,z,K,X):we(b,k,z,j,G,K,X):ye(g,b,X)},we=(g,b,k,z,j,G,K)=>{const J=g.component=Wp(g,z,j);if(J.type.__hmrId&&Ef(J),Co(g),gs(J,"mount"),ho(g)&&(J.ctx.renderer=at),gs(J,"init"),Kp(J,!1,K),_s(J,"init"),Qt&&(g.el=null),J.asyncDep){if(j&&j.registerDep(J,Y,K),!g.el){const X=J.subTree=it(dt);x(null,X,b,k),g.placeholder=X.el}}else Y(J,g,b,k,j,G,K);Eo(),_s(J,"mount")},ye=(g,b,k)=>{const z=b.component=g.component;if(Np(g,b,k))if(z.asyncDep&&!z.asyncResolved){Co(b),ve(z,b,k),Eo();return}else z.next=b,z.update();else b.el=g.el,z.vnode=b},Y=(g,b,k,z,j,G,K)=>{const J=()=>{if(g.isMounted){let{next:re,bu:he,u:fe,parent:_e,vnode:le}=g;{const wt=Qc(g);if(wt){re&&(re.el=le.el,ve(g,re,K)),wt.asyncDep.then(()=>{g.isUnmounted||J()});return}}let ke=re,Ze;Co(re||g.vnode),Kn(g,!1),re?(re.el=le.el,ve(g,re,K)):re=le,he&&$s(he),(Ze=re.props&&re.props.onVnodeBeforeUpdate)&&ln(Ze,_e,re,le),Kn(g,!0),gs(g,"render");const nt=La(g);_s(g,"render");const pt=g.subTree;g.subTree=nt,gs(g,"patch"),v(pt,nt,d(pt.el),Ke(pt),g,j,G),_s(g,"patch"),re.el=nt.el,ke===null&&$p(g,nt.el),fe&&At(fe,j),(Ze=re.props&&re.props.onVnodeUpdated)&&At(()=>ln(Ze,_e,re,le),j),Sc(g),Eo()}else{let re;const{el:he,props:fe}=b,{bm:_e,m:le,parent:ke,root:Ze,type:nt}=g,pt=Js(b);Kn(g,!1),_e&&$s(_e),!pt&&(re=fe&&fe.onVnodeBeforeMount)&&ln(re,ke,b),Kn(g,!0);{Ze.ce&&Ze.ce._def.shadowRoot!==!1&&Ze.ce._injectChildStyle(nt),gs(g,"render");const wt=g.subTree=La(g);_s(g,"render"),gs(g,"patch"),v(null,wt,k,z,g,j,G),_s(g,"patch"),b.el=wt.el}if(le&&At(le,j),!pt&&(re=fe&&fe.onVnodeMounted)){const wt=b;At(()=>ln(re,ke,wt),j)}(b.shapeFlag&256||ke&&Js(ke.vnode)&&ke.vnode.shapeFlag&256)&&g.a&&At(g.a,j),g.isMounted=!0,If(g),b=k=z=null}};g.scope.on();const X=g.effect=new Zl(J);g.scope.off();const B=g.update=X.run.bind(X),me=g.job=X.runIfDirty.bind(X);me.i=g,me.id=g.uid,X.scheduler=()=>hr(me),Kn(g,!0),X.onTrack=g.rtc?re=>$s(g.rtc,re):void 0,X.onTrigger=g.rtg?re=>$s(g.rtg,re):void 0,B()},ve=(g,b,k)=>{b.component=g;const z=g.vnode.props;g.vnode=b,g.next=null,fp(g,b.props,z,k),Sp(g,b.children,k),sn(),ya(g),on()},Ge=(g,b,k,z,j,G,K,J,X=!1)=>{const B=g&&g.children,me=g?g.shapeFlag:0,re=b.children,{patchFlag:he,shapeFlag:fe}=b;if(he>0){if(he&128){A(B,re,k,z,j,G,K,J,X);return}else if(he&256){ue(B,re,k,z,j,G,K,J,X);return}}fe&8?(me&16&&De(B,j,G),re!==B&&u(k,re)):me&16?fe&16?A(B,re,k,z,j,G,K,J,X):De(B,j,G,!0):(me&8&&u(k,""),fe&16&&O(re,k,z,j,G,K,J,X))},ue=(g,b,k,z,j,G,K,J,X)=>{g=g||Ms,b=b||Ms;const B=g.length,me=b.length,re=Math.min(B,me);let he;for(he=0;he<re;he++){const fe=b[he]=X?Gn(b[he]):Zt(b[he]);v(g[he],fe,k,null,j,G,K,J,X)}B>me?De(g,j,G,!0,!1,re):O(b,k,z,j,G,K,J,X,re)},A=(g,b,k,z,j,G,K,J,X)=>{let B=0;const me=b.length;let re=g.length-1,he=me-1;for(;B<=re&&B<=he;){const fe=g[B],_e=b[B]=X?Gn(b[B]):Zt(b[B]);if(es(fe,_e))v(fe,_e,k,null,j,G,K,J,X);else break;B++}for(;B<=re&&B<=he;){const fe=g[re],_e=b[he]=X?Gn(b[he]):Zt(b[he]);if(es(fe,_e))v(fe,_e,k,null,j,G,K,J,X);else break;re--,he--}if(B>re){if(B<=he){const fe=he+1,_e=fe<me?b[fe].el:z;for(;B<=he;)v(null,b[B]=X?Gn(b[B]):Zt(b[B]),k,_e,j,G,K,J,X),B++}}else if(B>he)for(;B<=re;)$(g[B],j,G,!0),B++;else{const fe=B,_e=B,le=new Map;for(B=_e;B<=he;B++){const ot=b[B]=X?Gn(b[B]):Zt(b[B]);ot.key!=null&&(le.has(ot.key)&&te("Duplicate keys found during update:",JSON.stringify(ot.key),"Make sure keys are unique."),le.set(ot.key,B))}let ke,Ze=0;const nt=he-_e+1;let pt=!1,wt=0;const Ft=new Array(nt);for(B=0;B<nt;B++)Ft[B]=0;for(B=fe;B<=re;B++){const ot=g[B];if(Ze>=nt){$(ot,j,G,!0);continue}let jt;if(ot.key!=null)jt=le.get(ot.key);else for(ke=_e;ke<=he;ke++)if(Ft[ke-_e]===0&&es(ot,b[ke])){jt=ke;break}jt===void 0?$(ot,j,G,!0):(Ft[jt-_e]=B+1,jt>=wt?wt=jt:pt=!0,v(ot,b[jt],k,null,j,G,K,J,X),Ze++)}const an=pt?xp(Ft):Ms;for(ke=an.length-1,B=nt-1;B>=0;B--){const ot=_e+B,jt=b[ot],Os=b[ot+1],Ls=ot+1<me?Os.el||Os.placeholder:z;Ft[B]===0?v(null,jt,k,Ls,j,G,K,J,X):pt&&(ke<0||B!==an[ke]?de(jt,k,Ls,2):ke--)}}},de=(g,b,k,z,j=null)=>{const{el:G,type:K,transition:J,children:X,shapeFlag:B}=g;if(B&6){de(g.component.subTree,b,k,z);return}if(B&128){g.suspense.move(b,k,z);return}if(B&64){K.move(g,b,k,at);return}if(K===Je){n(G,b,k);for(let re=0;re<X.length;re++)de(X[re],b,k,z);n(g.anchor,b,k);return}if(K===Es){E(g,b,k);return}if(z!==2&&B&1&&J)if(z===0)J.beforeEnter(G),n(G,b,k),At(()=>J.enter(G),j);else{const{leave:re,delayLeave:he,afterLeave:fe}=J,_e=()=>{g.ctx.isUnmounted?o(G):n(G,b,k)},le=()=>{G._isLeaving&&G[Cn](!0),re(G,()=>{_e(),fe&&fe()})};he?he(G,_e,le):le()}else n(G,b,k)},$=(g,b,k,z=!1,j=!1)=>{const{type:G,props:K,ref:J,children:X,dynamicChildren:B,shapeFlag:me,patchFlag:re,dirs:he,cacheIndex:fe}=g;if(re===-2&&(j=!1),J!=null&&(sn(),Ys(J,null,k,g,!0),on()),fe!=null&&(b.renderCache[fe]=void 0),me&256){b.ctx.deactivate(g);return}const _e=me&1&&he,le=!Js(g);let ke;if(le&&(ke=K&&K.onVnodeBeforeUnmount)&&ln(ke,b,g),me&6)He(g.component,k,z);else{if(me&128){g.suspense.unmount(k,z);return}_e&&qn(g,null,b,"beforeUnmount"),me&64?g.type.remove(g,b,k,at,z):B&&!B.hasOnce&&(G!==Je||re>0&&re&64)?De(B,b,k,!1,!0):(G===Je&&re&384||!j&&me&16)&&De(X,b,k),z&&ce(g)}(le&&(ke=K&&K.onVnodeUnmounted)||_e)&&At(()=>{ke&&ln(ke,b,g),_e&&qn(g,null,b,"unmounted")},k)},ce=g=>{const{type:b,el:k,anchor:z,transition:j}=g;if(b===Je){g.patchFlag>0&&g.patchFlag&2048&&j&&!j.persisted?g.children.forEach(K=>{K.type===dt?o(K.el):ce(K)}):pe(k,z);return}if(b===Es){T(g);return}const G=()=>{o(k),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(g.shapeFlag&1&&j&&!j.persisted){const{leave:K,delayLeave:J}=j,X=()=>K(k,G);J?J(g.el,G,X):X()}else G()},pe=(g,b)=>{let k;for(;g!==b;)k=h(g),o(g),g=k;o(b)},He=(g,b,k)=>{g.type.__hmrId&&xf(g);const{bum:z,scope:j,job:G,subTree:K,um:J,m:X,a:B}=g;Oa(X),Oa(B),z&&$s(z),j.stop(),G&&(G.flags|=8,$(K,g,b,k)),J&&At(J,b),At(()=>{g.isUnmounted=!0},b),Lf(g)},De=(g,b,k,z=!1,j=!1,G=0)=>{for(let K=G;K<g.length;K++)$(g[K],b,k,z,j)},Ke=g=>{if(g.shapeFlag&6)return Ke(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const b=h(g.anchor||g.el),k=b&&b[Ac];return k?h(k):b};let Ve=!1;const st=(g,b,k)=>{g==null?b._vnode&&$(b._vnode,null,null,!0):v(b._vnode||null,g,b,null,null,null,k),b._vnode=g,Ve||(Ve=!0,ya(),yc(),Ve=!1)},at={p:v,um:$,m:de,r:ce,mt:we,mc:O,pc:Ge,pbc:ee,n:Ke,o:t};return{render:st,hydrate:void 0,createApp:lp(st)}}function Dr({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Kn({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Ep(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function qo(t,e,s=!1){const n=t.children,o=e.children;if(Se(n)&&Se(o))for(let i=0;i<n.length;i++){const r=n[i];let a=o[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=o[i]=Gn(o[i]),a.el=r.el),!s&&a.patchFlag!==-2&&qo(r,a)),a.type===mo&&a.patchFlag!==-1&&(a.el=r.el),a.type===dt&&!a.el&&(a.el=r.el),a.el&&(a.el.__vnode=a)}}function xp(t){const e=t.slice(),s=[0];let n,o,i,r,a;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(o=s[s.length-1],t[o]<c){e[n]=o,s.push(n);continue}for(i=0,r=s.length-1;i<r;)a=i+r>>1,t[s[a]]<c?i=a+1:r=a;c<t[s[i]]&&(i>0&&(e[n]=s[i-1]),s[i]=n)}}for(i=s.length,r=s[i-1];i-- >0;)s[i]=r,r=e[r];return s}function Qc(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Qc(e)}function Oa(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Ap=Symbol.for("v-scx"),kp=()=>{{const t=ko(Ap);return t||te("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),t}};function lt(t,e,s){return xe(e)||te("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),eu(t,e,s)}function eu(t,e,s=We){const{immediate:n,deep:o,flush:i,once:r}=s;e||(n!==void 0&&te('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),o!==void 0&&te('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'),r!==void 0&&te('watch() "once" option is only respected when using the watch(source, callback, options?) signature.'));const a=ct({},s);a.onWarn=te;const l=e&&n||!e&&i!=="post";let c;if(oo){if(i==="sync"){const m=kp();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Ct,m.resume=Ct,m.pause=Ct,m}}const u=Tt;a.call=(m,_,v)=>rn(m,u,_,v);let d=!1;i==="post"?a.scheduler=m=>{At(m,u&&u.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(m,_)=>{_?m():hr(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,u&&(m.id=u.uid,m.i=u))};const h=_f(t,e,a);return oo&&(c?c.push(h):l&&h()),h}function Rp(t,e,s){const n=this.proxy,o=tt(t)?t.includes(".")?tu(n,t):()=>n[t]:t.bind(n,n);let i;xe(e)?i=e:(i=e.handler,s=e);const r=go(this),a=eu(o,i.bind(n),s);return r(),a}function tu(t,e){const s=e.split(".");return()=>{let n=t;for(let o=0;o<s.length&&n;o++)n=n[s[o]];return n}}const Pp=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${en(e)}Modifiers`]||t[`${Fn(e)}Modifiers`];function Ip(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||We;{const{emitsOptions:u,propsOptions:[d]}=t;if(u)if(!(e in u))(!d||!(Zn(en(e))in d))&&te(`Component emitted event "${e}" but it is neither declared in the emits option nor as an "${Zn(en(e))}" prop.`);else{const h=u[e];xe(h)&&(h(...s)||te(`Invalid event arguments: event validation failed for event "${e}".`))}}let o=s;const i=e.startsWith("update:"),r=i&&Pp(n,e.slice(7));r&&(r.trim&&(o=s.map(u=>tt(u)?u.trim():u)),r.number&&(o=s.map(Ed))),$f(t,e,o);{const u=e.toLowerCase();u!==e&&n[Zn(u)]&&te(`Event "${u}" is emitted in component ${vr(t,t.type)} but the handler is registered for "${e}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${Fn(e)}" instead of "${e}".`)}let a,l=n[a=Zn(e)]||n[a=Zn(en(e))];!l&&i&&(l=n[a=Zn(Fn(e))]),l&&rn(l,t,6,o);const c=n[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,rn(c,t,6,o)}}const Op=new WeakMap;function nu(t,e,s=!1){const n=s?Op:e.emitsCache,o=n.get(t);if(o!==void 0)return o;const i=t.emits;let r={},a=!1;if(!xe(t)){const l=c=>{const u=nu(c,e,!0);u&&(a=!0,ct(r,u))};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(Be(t)&&n.set(t,null),null):(Se(i)?i.forEach(l=>r[l]=null):ct(r,i),Be(t)&&n.set(t,r),r)}function gr(t,e){return!t||!co(e)?!1:(e=e.slice(2).replace(/Once$/,""),Fe(t,e[0].toLowerCase()+e.slice(1))||Fe(t,Fn(e))||Fe(t,e))}let fi=!1;function Ko(){fi=!0}function La(t){const{type:e,vnode:s,proxy:n,withProxy:o,propsOptions:[i],slots:r,attrs:a,emit:l,render:c,renderCache:u,props:d,data:h,setupState:m,ctx:_,inheritAttrs:v}=t,S=Bo(t);let x,I;fi=!1;try{if(s.shapeFlag&4){const T=o||n,C=m.__isScriptSetup?new Proxy(T,{get(F,V,O){return te(`Property '${String(V)}' was accessed via 'this'. Avoid using 'this' in templates.`),Reflect.get(F,V,O)}}):T;x=Zt(c.call(C,T,u,pn(d),m,h,_)),I=a}else{const T=e;a===d&&Ko(),x=Zt(T.length>1?T(pn(d),{get attrs(){return Ko(),pn(a)},slots:r,emit:l}):T(pn(d),null)),I=e.props?a:Lp(a)}}catch(T){Zs.length=0,fo(T,t,1),x=it(dt)}let R=x,E;if(x.patchFlag>0&&x.patchFlag&2048&&([R,E]=su(x)),I&&v!==!1){const T=Object.keys(I),{shapeFlag:C}=R;if(T.length){if(C&7)i&&T.some(No)&&(I=Dp(I,i)),R=vn(R,I,!1,!0);else if(!fi&&R.type!==dt){const F=Object.keys(a),V=[],O=[];for(let ae=0,ee=F.length;ae<ee;ae++){const q=F[ae];co(q)?No(q)||V.push(q[2].toLowerCase()+q.slice(3)):O.push(q)}O.length&&te(`Extraneous non-props attributes (${O.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text or teleport root nodes.`),V.length&&te(`Extraneous non-emits event listeners (${V.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return s.dirs&&(Da(R)||te("Runtime directive used on component with non-element root node. The directives will not function as intended."),R=vn(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(s.dirs):s.dirs),s.transition&&(Da(R)||te("Component inside <Transition> renders non-element root node that cannot be animated."),no(R,s.transition)),E?E(R):x=R,Bo(S),x}const su=t=>{const e=t.children,s=t.dynamicChildren,n=$i(e,!1);if(n){if(n.patchFlag>0&&n.patchFlag&2048)return su(n)}else return[t,void 0];const o=e.indexOf(n),i=s?s.indexOf(n):-1,r=a=>{e[o]=a,s&&(i>-1?s[i]=a:a.patchFlag>0&&(t.dynamicChildren=[...s,a]))};return[Zt(n),r]};function $i(t,e=!0){let s;for(let n=0;n<t.length;n++){const o=t[n];if(Rs(o)){if(o.type!==dt||o.children==="v-if"){if(s)return;if(s=o,e&&s.patchFlag>0&&s.patchFlag&2048)return $i(s.children)}}else return}return s}const Lp=t=>{let e;for(const s in t)(s==="class"||s==="style"||co(s))&&((e||(e={}))[s]=t[s]);return e},Dp=(t,e)=>{const s={};for(const n in t)(!No(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s},Da=t=>t.shapeFlag&7||t.type===dt;function Np(t,e,s){const{props:n,children:o,component:i}=t,{props:r,children:a,patchFlag:l}=e,c=i.emitsOptions;if((o||a)&&Qt||e.dirs||e.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return n?Na(n,r,c):!!r;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(r[h]!==n[h]&&!gr(c,h))return!0}}}else return(o||a)&&(!a||!a.$stable)?!0:n===r?!1:n?r?Na(n,r,c):!0:!!r;return!1}function Na(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const i=n[o];if(e[i]!==t[i]&&!gr(s,i))return!0}return!1}function $p({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const ou=t=>t.__isSuspense;function Gp(t,e){e&&e.pendingBranch?Se(t)?e.effects.push(...t):e.effects.push(t):Ri(t)}const Je=Symbol.for("v-fgt"),mo=Symbol.for("v-txt"),dt=Symbol.for("v-cmt"),Es=Symbol.for("v-stc"),Zs=[];let Ut=null;function D(t=!1){Zs.push(Ut=t?null:[])}function Hp(){Zs.pop(),Ut=Zs[Zs.length-1]||null}let so=1;function Xo(t,e=!1){so+=t,t<0&&Ut&&e&&(Ut.hasOnce=!0)}function ru(t){return t.dynamicChildren=so>0?Ut||Ms:null,Hp(),so>0&&Ut&&Ut.push(t),t}function W(t,e,s,n,o,i){return ru(p(t,e,s,n,o,i,!0))}function Ht(t,e,s,n,o){return ru(it(t,e,s,n,o,!0))}function Rs(t){return t?t.__v_isVNode===!0:!1}function es(t,e){if(e.shapeFlag&6&&t.component){const s=xo.get(e.type);if(s&&s.has(t.component))return t.shapeFlag&=-257,e.shapeFlag&=-513,!1}return t.type===e.type&&t.key===e.key}const Up=(...t)=>Fp(...t),iu=({key:t})=>t??null,Ro=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?tt(t)||ft(t)||xe(t)?{i:It,r:t,k:e,f:!!s}:t:null);function p(t,e=null,s=null,n=0,o=null,i=t===Je?0:1,r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&iu(e),ref:e&&Ro(e),scopeId:Tc,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:It};return a?(Gi(l,s),i&128&&t.normalize(l)):s&&(l.shapeFlag|=tt(s)?8:16),l.key!==l.key&&te("VNode created with invalid key (NaN). VNode type:",l.type),so>0&&!r&&Ut&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Ut.push(l),l}const it=Up;function Fp(t,e=null,s=null,n=0,o=null,i=!1){if((!t||t===Jf)&&(t||te(`Invalid vnode type when creating vnode: ${t}.`),t=dt),Rs(t)){const a=vn(t,e,!0);return s&&Gi(a,s),so>0&&!i&&Ut&&(a.shapeFlag&6?Ut[Ut.indexOf(t)]=a:Ut.push(a)),a.patchFlag=-2,a}if(du(t)&&(t=t.__vccOpts),e){e=jp(e);let{class:a,style:l}=e;a&&!tt(a)&&(e.class=Qe(a)),Be(l)&&(Go(l)&&!Se(l)&&(l=ct({},l)),e.style=zt(l))}const r=tt(t)?1:ou(t)?128:kc(t)?64:Be(t)?4:xe(t)?2:0;return r&4&&Go(t)&&(t=Ie(t),te("Vue received a Component that was made a reactive object. This can lead to unnecessary performance overhead and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,t)),p(t,e,s,n,o,r,i,!0)}function jp(t){return t?Go(t)||qc(t)?ct({},t):t:null}function vn(t,e,s=!1,n=!1){const{props:o,ref:i,patchFlag:r,children:a,transition:l}=t,c=e?Bp(o||{},e):o,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&iu(c),ref:e&&e.ref?s&&i?Se(i)?i.concat(Ro(e)):[i,Ro(e)]:Ro(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:r===-1&&Se(a)?a.map(au):a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Je?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&vn(t.ssContent),ssFallback:t.ssFallback&&vn(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&no(u,l.clone(u)),u}function au(t){const e=vn(t);return Se(t.children)&&(e.children=t.children.map(au)),e}function jn(t=" ",e=0){return it(mo,null,t,e)}function Yo(t,e){const s=it(Es,null,t);return s.staticCount=e,s}function Me(t="",e=!1){return e?(D(),Ht(dt,null,t)):it(dt,null,t)}function Zt(t){return t==null||typeof t=="boolean"?it(dt):Se(t)?it(Je,null,t.slice()):Rs(t)?Gn(t):it(mo,null,String(t))}function Gn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:vn(t)}function Gi(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Se(e))s=16;else if(typeof e=="object")if(n&65){const o=e.default;o&&(o._c&&(o._d=!1),Gi(t,o()),o._c&&(o._d=!0));return}else{s=32;const o=e._;!o&&!qc(e)?e._ctx=It:o===3&&It&&(It.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else xe(e)?(e={default:e,_ctx:It},s=32):(e=String(e),n&64?(s=16,e=[jn(e)]):s=8);t.children=e,t.shapeFlag|=s}function Bp(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const o in n)if(o==="class")e.class!==n.class&&(e.class=Qe([e.class,n.class]));else if(o==="style")e.style=zt([e.style,n.style]);else if(co(o)){const i=e[o],r=n[o];r&&i!==r&&!(Se(i)&&i.includes(r))&&(e[o]=i?[].concat(i,r):r)}else o!==""&&(e[o]=n[o])}return e}function ln(t,e,s,n=null){rn(t,e,7,[s,n])}const Vp=Vc();let zp=0;function Wp(t,e,s){const n=t.type,o=(e?e.appContext:t.appContext)||Vp,i={uid:zp++,vnode:t,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Fd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Xc(n,o),emitsOptions:nu(n,o),emit:null,emitted:null,propsDefaults:We,inheritAttrs:n.inheritAttrs,ctx:We,data:We,props:We,attrs:We,slots:We,refs:We,setupState:We,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx=Zf(i),i.root=e?e.root:i,i.emit=Ip.bind(null,i),t.ce&&t.ce(i),i}let Tt=null;const _r=()=>Tt||It;let Jo,pi;{const t=uo(),e=(s,n)=>{let o;return(o=t[s])||(o=t[s]=[]),o.push(n),i=>{o.length>1?o.forEach(r=>r(i)):o[0](i)}};Jo=e("__VUE_INSTANCE_SETTERS__",s=>Tt=s),pi=e("__VUE_SSR_SETTERS__",s=>oo=s)}const go=t=>{const e=Tt;return Jo(t),t.scope.on(),()=>{t.scope.off(),Jo(e)}},$a=()=>{Tt&&Tt.scope.off(),Jo(null)},qp=On("slot,component");function hi(t,{isNativeTag:e}){(qp(t)||e(t))&&te("Do not use built-in or reserved HTML elements as component id: "+t)}function lu(t){return t.vnode.shapeFlag&4}let oo=!1;function Kp(t,e=!1,s=!1){e&&pi(e);const{props:n,children:o}=t.vnode,i=lu(t);up(t,n,i,e),wp(t,o,s||e);const r=i?Xp(t,e):void 0;return e&&pi(!1),r}function Xp(t,e){var s;const n=t.type;{if(n.name&&hi(n.name,t.appContext.config),n.components){const i=Object.keys(n.components);for(let r=0;r<i.length;r++)hi(i[r],t.appContext.config)}if(n.directives){const i=Object.keys(n.directives);for(let r=0;r<i.length;r++)Ec(i[r])}n.compilerOptions&&Yp()&&te('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Fc),Qf(t);const{setup:o}=n;if(o){sn();const i=t.setupContext=o.length>1?Qp(t):null,r=go(t),a=Is(o,t,0,[pn(t.props),i]),l=wi(a);if(on(),r(),(l||t.sp)&&!Js(t)&&Gc(t),l){if(a.then($a,$a),e)return a.then(c=>{Ga(t,c,e)}).catch(c=>{fo(c,t,0)});if(t.asyncDep=a,!t.suspense){const c=(s=n.name)!=null?s:"Anonymous";te(`Component <${c}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else Ga(t,a,e)}else cu(t,e)}function Ga(t,e,s){xe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Be(e)?(Rs(e)&&te("setup() should not return VNodes directly - return a render function instead."),t.devtoolsRawSetupState=e,t.setupState=hc(e),ep(t)):e!==void 0&&te(`setup() should return an object. Received: ${e===null?"null":typeof e}`),cu(t,s)}const Yp=()=>!0;function cu(t,e,s){const n=t.type;t.render||(t.render=n.render||Ct);{const o=go(t);sn();try{np(t)}finally{on(),o()}}!n.render&&t.render===Ct&&!e&&(n.template?te('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):te("Component is missing template or render function: ",n))}const Jp={get(t,e){return Ko(),bt(t,"get",""),t[e]},set(){return te("setupContext.attrs is readonly."),!1},deleteProperty(){return te("setupContext.attrs is readonly."),!1}};function Zp(t){return new Proxy(t.slots,{get(e,s){return bt(t,"get","$slots"),e[s]}})}function Qp(t){const e=s=>{if(t.exposed&&te("expose() should be called only once per setup()."),s!=null){let n=typeof s;n==="object"&&(Se(s)?n="array":ft(s)&&(n="ref")),n!=="object"&&te(`expose() should be passed a plain object, received ${n}.`)}t.exposed=s||{}};{let s,n;return Object.freeze({get attrs(){return s||(s=new Proxy(t.attrs,Jp))},get slots(){return n||(n=Zp(t))},get emit(){return(o,...i)=>t.emit(o,...i)},expose:e})}}function yr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(hc(cf(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in as)return as[s](t)},has(e,s){return s in e||s in as}})):t.proxy}const eh=/(?:^|[-_])\w/g,th=t=>t.replace(eh,e=>e.toUpperCase()).replace(/[-_]/g,"");function uu(t,e=!0){return xe(t)?t.displayName||t.name:t.name||e&&t.__name}function vr(t,e,s=!1){let n=uu(e);if(!n&&e.__file){const o=e.__file.match(/([^/\\]+)\.\w+$/);o&&(n=o[1])}if(!n&&t&&t.parent){const o=i=>{for(const r in i)if(i[r]===e)return r};n=o(t.components||t.parent.type.components)||o(t.appContext.components)}return n?th(n):s?"App":"Anonymous"}function du(t){return xe(t)&&"__vccOpts"in t}const Ee=(t,e)=>{const s=mf(t,e,oo);{const n=_r();n&&n.appContext.config.warnRecursiveComputed&&(s._warnRecursive=!0)}return s};function nh(t,e,s){try{Xo(-1);const n=arguments.length;return n===2?Be(e)&&!Se(e)?Rs(e)?it(t,null,[e]):it(t,e):it(t,null,e):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&Rs(s)&&(s=[s]),it(t,e,s))}finally{Xo(1)}}function sh(){if(typeof window>"u")return;const t={style:"color:#3ba776"},e={style:"color:#1677ff"},s={style:"color:#f5222d"},n={style:"color:#eb2f96"},o={__vue_custom_formatter:!0,header(d){if(!Be(d))return null;if(d.__isVue)return["div",t,"VueInstance"];if(ft(d)){sn();const h=d.value;return on(),["div",{},["span",t,u(d)],"<",a(h),">"]}else{if(os(d))return["div",{},["span",t,Ot(d)?"ShallowReactive":"Reactive"],"<",a(d),`>${yn(d)?" (readonly)":""}`];if(yn(d))return["div",{},["span",t,Ot(d)?"ShallowReadonly":"Readonly"],"<",a(d),">"]}return null},hasBody(d){return d&&d.__isVue},body(d){if(d&&d.__isVue)return["div",{},...i(d.$)]}};function i(d){const h=[];d.type.props&&d.props&&h.push(r("props",Ie(d.props))),d.setupState!==We&&h.push(r("setup",d.setupState)),d.data!==We&&h.push(r("data",Ie(d.data)));const m=l(d,"computed");m&&h.push(r("computed",m));const _=l(d,"inject");return _&&h.push(r("injected",_)),h.push(["div",{},["span",{style:n.style+";opacity:0.66"},"$ (internal): "],["object",{object:d}]]),h}function r(d,h){return h=ct({},h),Object.keys(h).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},d],["div",{style:"padding-left:1.25em"},...Object.keys(h).map(m=>["div",{},["span",n,m+": "],a(h[m],!1)])]]:["span",{}]}function a(d,h=!0){return typeof d=="number"?["span",e,d]:typeof d=="string"?["span",s,JSON.stringify(d)]:typeof d=="boolean"?["span",n,d]:Be(d)?["object",{object:h?Ie(d):d}]:["span",s,String(d)]}function l(d,h){const m=d.type;if(xe(m))return;const _={};for(const v in d.ctx)c(m,v,h)&&(_[v]=d.ctx[v]);return _}function c(d,h,m){const _=d[m];if(Se(_)&&_.includes(h)||Be(_)&&h in _||d.extends&&c(d.extends,h,m)||d.mixins&&d.mixins.some(v=>c(v,h,m)))return!0}function u(d){return Ot(d)?"ShallowRef":d.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(o):window.devtoolsFormatters=[o]}const Ha="3.5.22",mn=te;/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let mi;const Ua=typeof window<"u"&&window.trustedTypes;if(Ua)try{mi=Ua.createPolicy("vue",{createHTML:t=>t})}catch(t){mn(`Error creating trusted types policy: ${t}`)}const fu=mi?t=>mi.createHTML(t):t=>t,oh="http://www.w3.org/2000/svg",rh="http://www.w3.org/1998/Math/MathML",Tn=typeof document<"u"?document:null,Fa=Tn&&Tn.createElement("template"),ih={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const o=e==="svg"?Tn.createElementNS(oh,t):e==="mathml"?Tn.createElementNS(rh,t):s?Tn.createElement(t,{is:s}):Tn.createElement(t);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>Tn.createTextNode(t),createComment:t=>Tn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Tn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,o,i){const r=s?s.previousSibling:e.lastChild;if(o&&(o===i||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),s),!(o===i||!(o=o.nextSibling)););else{Fa.innerHTML=fu(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const a=Fa.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,s)}return[r?r.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Dn="transition",Us="animation",ro=Symbol("_vtc"),pu={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ah=ct({},Oc,pu),lh=t=>(t.displayName="Transition",t.props=ah,t),ch=lh((t,{slots:e})=>nh(Ff,uh(t),e)),Xn=(t,e=[])=>{Se(t)?t.forEach(s=>s(...e)):t&&t(...e)},ja=t=>t?Se(t)?t.some(e=>e.length>1):t.length>1:!1;function uh(t){const e={};for(const q in t)q in pu||(e[q]=t[q]);if(t.css===!1)return e;const{name:s="v",type:n,duration:o,enterFromClass:i=`${s}-enter-from`,enterActiveClass:r=`${s}-enter-active`,enterToClass:a=`${s}-enter-to`,appearFromClass:l=i,appearActiveClass:c=r,appearToClass:u=a,leaveFromClass:d=`${s}-leave-from`,leaveActiveClass:h=`${s}-leave-active`,leaveToClass:m=`${s}-leave-to`}=t,_=dh(o),v=_&&_[0],S=_&&_[1],{onBeforeEnter:x,onEnter:I,onEnterCancelled:R,onLeave:E,onLeaveCancelled:T,onBeforeAppear:C=x,onAppear:F=I,onAppearCancelled:V=R}=e,O=(q,L,Q,we)=>{q._enterCancelled=we,Yn(q,L?u:a),Yn(q,L?c:r),Q&&Q()},ae=(q,L)=>{q._isLeaving=!1,Yn(q,d),Yn(q,m),Yn(q,h),L&&L()},ee=q=>(L,Q)=>{const we=q?F:I,ye=()=>O(L,q,Q);Xn(we,[L,ye]),Ba(()=>{Yn(L,q?l:i),Mn(L,q?u:a),ja(we)||Va(L,n,v,ye)})};return ct(e,{onBeforeEnter(q){Xn(x,[q]),Mn(q,i),Mn(q,r)},onBeforeAppear(q){Xn(C,[q]),Mn(q,l),Mn(q,c)},onEnter:ee(!1),onAppear:ee(!0),onLeave(q,L){q._isLeaving=!0;const Q=()=>ae(q,L);Mn(q,d),q._enterCancelled?(Mn(q,h),qa(q)):(qa(q),Mn(q,h)),Ba(()=>{q._isLeaving&&(Yn(q,d),Mn(q,m),ja(E)||Va(q,n,S,Q))}),Xn(E,[q,Q])},onEnterCancelled(q){O(q,!1,void 0,!0),Xn(R,[q])},onAppearCancelled(q){O(q,!0,void 0,!0),Xn(V,[q])},onLeaveCancelled(q){ae(q),Xn(T,[q])}})}function dh(t){if(t==null)return null;if(Be(t))return[Nr(t.enter),Nr(t.leave)];{const e=Nr(t);return[e,e]}}function Nr(t){const e=xd(t);return Sf(e,"<transition> explicit duration"),e}function Mn(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[ro]||(t[ro]=new Set)).add(e)}function Yn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const s=t[ro];s&&(s.delete(e),s.size||(t[ro]=void 0))}function Ba(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let fh=0;function Va(t,e,s,n){const o=t._endId=++fh,i=()=>{o===t._endId&&n()};if(s!=null)return setTimeout(i,s);const{type:r,timeout:a,propCount:l}=ph(t,e);if(!r)return n();const c=r+"end";let u=0;const d=()=>{t.removeEventListener(c,h),i()},h=m=>{m.target===t&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),t.addEventListener(c,h)}function ph(t,e){const s=window.getComputedStyle(t),n=_=>(s[_]||"").split(", "),o=n(`${Dn}Delay`),i=n(`${Dn}Duration`),r=za(o,i),a=n(`${Us}Delay`),l=n(`${Us}Duration`),c=za(a,l);let u=null,d=0,h=0;e===Dn?r>0&&(u=Dn,d=r,h=i.length):e===Us?c>0&&(u=Us,d=c,h=l.length):(d=Math.max(r,c),u=d>0?r>c?Dn:Us:null,h=u?u===Dn?i.length:l.length:0);const m=u===Dn&&/\b(?:transform|all)(?:,|$)/.test(n(`${Dn}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:m}}function za(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((s,n)=>Wa(s)+Wa(t[n])))}function Wa(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function qa(t){return(t?t.ownerDocument:document).body.offsetHeight}function hh(t,e,s){const n=t[ro];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const Zo=Symbol("_vod"),hu=Symbol("_vsh"),mu={name:"show",beforeMount(t,{value:e},{transition:s}){t[Zo]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):Fs(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:n}){!e!=!s&&(n?e?(n.beforeEnter(t),Fs(t,!0),n.enter(t)):n.leave(t,()=>{Fs(t,!1)}):Fs(t,e))},beforeUnmount(t,{value:e}){Fs(t,e)}};function Fs(t,e){t.style.display=e?t[Zo]:"none",t[hu]=!e}const gu=Symbol("CSS_VAR_TEXT");function Kt(t){const e=_r();if(!e){mn("useCssVars is called without current active component instance.");return}const s=e.ut=(o=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>Qo(i,o))};e.getCssVars=()=>t(e.proxy);const n=()=>{const o=t(e.proxy);e.ce?Qo(e.ce,o):gi(e.subTree,o),s(o)};Uc(()=>{Ri(n)}),et(()=>{lt(n,Ct,{flush:"post"});const o=new MutationObserver(n);o.observe(e.subTree.el.parentNode,{childList:!0}),Oi(()=>o.disconnect())})}function gi(t,e){if(t.shapeFlag&128){const s=t.suspense;t=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{gi(s.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)Qo(t.el,e);else if(t.type===Je)t.children.forEach(s=>gi(s,e));else if(t.type===Es){let{el:s,anchor:n}=t;for(;s&&(Qo(s,e),s!==n);)s=s.nextSibling}}function Qo(t,e){if(t.nodeType===1){const s=t.style;let n="";for(const o in e){const i=Ud(e[o]);s.setProperty(`--${o}`,i),n+=`--${o}: ${i};`}s[gu]=n}}const mh=/(?:^|;)\s*display\s*:/;function gh(t,e,s){const n=t.style,o=tt(s);let i=!1;if(s&&!o){if(e)if(tt(e))for(const r of e.split(";")){const a=r.slice(0,r.indexOf(":")).trim();s[a]==null&&Po(n,a,"")}else for(const r in e)s[r]==null&&Po(n,r,"");for(const r in s)r==="display"&&(i=!0),Po(n,r,s[r])}else if(o){if(e!==s){const r=n[gu];r&&(s+=";"+r),n.cssText=s,i=mh.test(s)}}else e&&t.removeAttribute("style");Zo in t&&(t[Zo]=i?n.display:"",t[hu]&&(n.display="none"))}const _h=/[^\\];\s*$/,Ka=/\s*!important$/;function Po(t,e,s){if(Se(s))s.forEach(n=>Po(t,e,n));else if(s==null&&(s=""),_h.test(s)&&mn(`Unexpected semicolon at the end of '${e}' style value: '${s}'`),e.startsWith("--"))t.setProperty(e,s);else{const n=yh(t,e);Ka.test(s)?t.setProperty(Fn(n),s.replace(Ka,""),"important"):t[n]=s}}const Xa=["Webkit","Moz","ms"],$r={};function yh(t,e){const s=$r[e];if(s)return s;let n=en(e);if(n!=="filter"&&n in t)return $r[e]=n;n=ur(n);for(let o=0;o<Xa.length;o++){const i=Xa[o]+n;if(i in t)return $r[e]=i}return e}const Ya="http://www.w3.org/1999/xlink";function Ja(t,e,s,n,o,i=Hd(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Ya,e.slice(6,e.length)):t.setAttributeNS(Ya,e,s):s==null||i&&!Xl(s)?t.removeAttribute(e):t.setAttribute(e,i?"":zn(s)?String(s):s)}function Za(t,e,s,n,o){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?fu(s):s);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=s==null?t.type==="checkbox"?"on":"":String(s);(a!==l||!("_value"in t))&&(t.value=l),s==null&&t.removeAttribute(e),t._value=s;return}let r=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=Xl(s):s==null&&a==="string"?(s="",r=!0):a==="number"&&(s=0,r=!0)}try{t[e]=s}catch(a){r||mn(`Failed setting prop "${e}" on <${i.toLowerCase()}>: value ${s} is invalid.`,a)}r&&t.removeAttribute(o||e)}function vh(t,e,s,n){t.addEventListener(e,s,n)}function bh(t,e,s,n){t.removeEventListener(e,s,n)}const Qa=Symbol("_vei");function wh(t,e,s,n,o=null){const i=t[Qa]||(t[Qa]={}),r=i[e];if(n&&r)r.value=tl(n,e);else{const[a,l]=Sh(e);if(n){const c=i[e]=Ch(tl(n,e),o);vh(t,a,c,l)}else r&&(bh(t,a,r,l),i[e]=void 0)}}const el=/(?:Once|Passive|Capture)$/;function Sh(t){let e;if(el.test(t)){e={};let n;for(;n=t.match(el);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Fn(t.slice(2)),e]}let Gr=0;const Mh=Promise.resolve(),Th=()=>Gr||(Mh.then(()=>Gr=0),Gr=Date.now());function Ch(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;rn(Eh(n,s.value),e,5,[n])};return s.value=t,s.attached=Th(),s}function tl(t,e){return xe(t)||Se(t)?t:(mn(`Wrong type passed as event handler to ${e} - did you forget @ or : in front of your prop?
Expected function or array of functions, received type ${typeof t}.`),Ct)}function Eh(t,e){if(Se(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>o=>!o._stopped&&n&&n(o))}else return e}const nl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,xh=(t,e,s,n,o,i)=>{const r=o==="svg";e==="class"?hh(t,n,r):e==="style"?gh(t,s,n):co(e)?No(e)||wh(t,e,s,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ah(t,e,n,r))?(Za(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ja(t,e,n,r,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!tt(n))?Za(t,en(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),Ja(t,e,n,r))};function Ah(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&nl(e)&&xe(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const o=t.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return nl(e)&&tt(s)?!1:e in t}const kh=["ctrl","shift","alt","meta"],Rh={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>kh.some(s=>t[`${s}Key`]&&!e.includes(s))},Pn=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=(o,...i)=>{for(let r=0;r<e.length;r++){const a=Rh[e[r]];if(a&&a(o,e))return}return t(o,...i)})},Ph=ct({patchProp:xh},ih);let sl;function Ih(){return sl||(sl=Tp(Ph))}const ol=(...t)=>{const e=Ih().createApp(...t);Lh(e),Dh(e);const{mount:s}=e;return e.mount=n=>{const o=Nh(n);if(!o)return;const i=e._component;!xe(i)&&!i.render&&!i.template&&(i.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const r=s(o,!1,Oh(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),r},e};function Oh(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Lh(t){Object.defineProperty(t.config,"isNativeTag",{value:e=>Dd(e)||Nd(e)||$d(e),writable:!1})}function Dh(t){{const e=t.config.isCustomElement;Object.defineProperty(t.config,"isCustomElement",{get(){return e},set(){mn("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const s=t.config.compilerOptions,n='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-sfc';Object.defineProperty(t.config,"compilerOptions",{get(){return mn(n),s},set(){mn(n)}})}}function Nh(t){if(tt(t)){const e=document.querySelector(t);return e||mn(`Failed to mount app: mount target selector "${t}" returned null.`),e}return window.ShadowRoot&&t instanceof window.ShadowRoot&&t.mode==="closed"&&mn('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),t}/**
* vue v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function $h(){sh()}$h();const Io={maxRetries:3,retryDelay:1e3,timeout:1e4};let Hr=null;const xs={enabled:!0,maxCacheSize:50*1024*1024,cachePrefix:"mgpic_",version:"1.0.0",loadInterval:50,batchSize:3};class Gh{constructor(){this.cache=new Map,this.totalSize=0}isSupported(){return"caches"in window}getCacheName(){return`${xs.cachePrefix}${xs.version}`}async isCached(e){if(!this.isSupported())return!1;try{return await(await caches.open(this.getCacheName())).match(e)!==void 0}catch(s){return f(":",s.message),!1}}async cacheResource(e,s){if(!this.isSupported())return!1;try{const n=await caches.open(this.getCacheName());if(await n.match(e))return f(`: ${e}`),!0;await n.put(e,s.clone());const i=s.headers.get("content-length");return i&&(this.totalSize+=parseInt(i)),f(`: ${e}`),!0}catch(n){return f(":",n.message),!1}}async getCachedResource(e){if(!this.isSupported())return null;try{return await(await caches.open(this.getCacheName())).match(e)}catch(s){return f(":",s.message),null}}async cleanupCache(){if(this.isSupported())try{const e=await caches.keys(),s=this.getCacheName();for(const n of e)n.startsWith(xs.cachePrefix)&&n!==s&&(await caches.delete(n),f(`: ${n}`))}catch(e){f(":",e.message)}}}const Wt=new Gh;let So=null;function Hh(){return So||(f("R2 URL"),So="https://pub-6f9181bda40946ea92b5e87fe84e27d4.r2.dev",So)}function H(t){let e=t;t.startsWith("/assets/")?e=t.slice(7):t.startsWith("@assets/")&&(e=t.slice(8));const s=Hh(),n=e.startsWith("/")?e.slice(1):e;return`${s}/${n}`}async function _u(t,e={}){if(Wt.isSupported()){const o=await Wt.getCachedResource(t);if(o)return f(` Cache Storage : ${t}`),o}const{maxRetries:s=Io.maxRetries,retryDelay:n=Io.retryDelay}=e;for(let o=1;o<=s;o++)try{f(` (${o}/${s}): ${t}`);const i=new AbortController,r=setTimeout(()=>i.abort(),Io.timeout),a=await fetch(t,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:i.signal,...e});if(clearTimeout(r),a.ok)return Wt.isSupported()&&await Wt.cacheResource(t,a),f(`: ${t}`),a;throw new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(i){if(f(` (${o}/${s}): ${t}`,i.message),o===s)throw f(`: ${t}`,i.message),i;const r=n*o;f(` ${r}ms ...`),await new Promise(a=>setTimeout(a,r))}}async function Uh(t=["high","medium"]){try{if(Hr){f("");const i=rl(Hr,t);return f(` ${i.length}  (: ${t.join(", ")})`),i}const e=H("asset-list.json");f(` R2 CDN : ${e}`);const s=await _u(e);if(!s.ok)throw new Error(`: HTTP ${s.status}`);const n=await s.json();Hr=n,f("");const o=rl(n,t);return f(` ${o.length}  (: ${t.join(", ")})`),o}catch(e){return f(":",e.message),["logo.glb","frontend_resource/start_game.webp","frontend_resource/copper_warehouse.webp","frontend_resource/game_wiki.webp","frontend_resource/Tutorial.webp","frontend_resource/gacha.webp"]}}function rl(t,e){const s=[];for(const n of e)if(t.categories&&t.categories[n]){const o=t.categories[n].resources||[];s.push(...o.map(i=>i.path))}return s}async function er(t=null,e=["high","medium"]){f("..."),await Wt.cleanupCache();const s=await Uh(e),n=xs.batchSize,o=xs.loadInterval,i=s.length;let r=0;t&&t(0,i,0);for(let a=0;a<s.length;a+=n){const l=s.slice(a,a+n);f(` ${Math.floor(a/n)+1}/${Math.ceil(s.length/n)}: ${l.length} `);const c=l.map(async(S,x)=>{const I=H(S);try{if(await Wt.isCached(I))return f(`Cache Storage: ${S}`),{success:!0,path:S,cached:!0,source:"cache"};const E=new AbortController,T=setTimeout(()=>E.abort(),Io.timeout),C=await fetch(I,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:E.signal});if(clearTimeout(T),C.ok){const F=C.headers.get("x-cache")||C.headers.get("cf-cache-status")||C.type==="basic"&&!C.redirected;return Wt.isSupported()&&await Wt.cacheResource(I,C),f(`: ${S}${F?" ()":""}`),{success:!0,path:S,cached:!1,fromBrowserCache:!!F}}else throw new Error(`HTTP ${C.status}: ${C.statusText}`)}catch(R){return f(`: ${S}`,R.message),{success:!1,path:S,error:R.message}}}),u=await Promise.all(c);r+=l.length;const d=Math.round(r/i*100);t&&t(r,i,d);const h=u.filter(S=>S.success).length,m=u.filter(S=>S.cached).length,_=u.filter(S=>S.fromBrowserCache).length,v=u.filter(S=>!S.success).length;f(`:  ${h}, Cache Storage ${m},  ${_},  ${v}`),a+n<s.length&&(f(` ${o}ms ...`),await new Promise(S=>setTimeout(S,o)))}f(""),t&&t(i,i,100)}async function il(){if(!Wt.isSupported())return{supported:!1,message:"API"};try{const e=await(await caches.open(Wt.getCacheName())).keys();return{supported:!0,cacheName:Wt.getCacheName(),resourceCount:e.length,totalSize:Wt.totalSize,maxSize:xs.maxCacheSize}}catch(t){return{supported:!0,error:t.message}}}function io(t,e){return H(`copper/${t.toLowerCase()}/${e}/${e}.glb`)}function ao(t){return H(`enemy/${t}/${t}.glb`)}function _i(t){return H(`structure/${t}/${t}.glb`)}function al(t){return H(t)}const yt=(t,e)=>{const s=t.__vccOpts||t;for(const[n,o]of e)s[n]=o;return s},Fh={__name:"Hall",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["startGame","openWarehouse","openTutorial","openEncyclopedia","toggle-music"],setup(t,{expose:e,emit:s}){e();const n=s,o=t;function i(){n("startGame")}function r(){n("openWarehouse")}function a(){n("openTutorial")}function l(){n("openEncyclopedia")}const c=U(H("@assets/frontend_resource/start_game.webp")),u=U(H("@assets/frontend_resource/copper_warehouse.webp")),d=U(H("@assets/frontend_resource/game_wiki.webp")),h=U(H("@assets/frontend_resource/Tutorial.webp")),m=U(H("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),_=U(!1),v=U(null),S=H("@assets/frontend_resource/hall.mp3");et(()=>{setTimeout(()=>{_.value=!0,f("HallUI")},100),o.musicOn&&!o.paused&&v.value&&setTimeout(()=>{if(v.value.readyState>=2)v.value.play().then(()=>{f("[Hall] ")}).catch(R=>{f("[Hall] :",R)});else{const R=()=>{v.value.play().then(()=>{f("[Hall] ")}).catch(E=>{f("[Hall] :",E)}),v.value.removeEventListener("canplay",R)};v.value.addEventListener("canplay",R,{once:!0})}},200)}),lt(()=>o.musicOn,I=>{if(v.value)if(I&&!o.paused)if(v.value.readyState>=2)v.value.play().catch(R=>{f("[Hall] :",R)});else{const R=()=>{v.value.play().catch(E=>{f("[Hall] :",E)}),v.value.removeEventListener("canplay",R)};v.value.addEventListener("canplay",R)}else v.value.pause()}),lt(()=>o.paused,I=>{if(v.value){if(I)v.value.pause(),f("[Hall] ");else if(o.musicOn){if(v.value.readyState>=2)v.value.play().catch(R=>{f("[Hall] :",R)});else{const R=()=>{v.value.play().catch(E=>{f("[Hall] :",E)}),v.value.removeEventListener("canplay",R)};v.value.addEventListener("canplay",R)}f("[Hall] ")}}}),_t(()=>{v.value&&v.value.pause()});const x={emit:n,props:o,startGame:i,openWarehouse:r,openTutorial:a,openEncyclopedia:l,bgStart:c,bgWarehouse:u,bgWiki:d,bgTutorial:h,bgHall:m,imagesLoaded:_,audioRef:v,musicUrl:S,get log(){return f},ref:U,onMounted:et,onBeforeUnmount:_t,watch:lt,get getAssetUrl(){return H}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},jh={class:"hall-container"},Bh=["src"];function Vh(t,e,s,n,o,i){return D(),W("div",jh,[p("div",{class:"hall-bg",style:zt({backgroundImage:`url('${n.bgHall}')`})},null,4),p("div",{class:Qe(["menu",{"menu--loaded":n.imagesLoaded}])},[p("button",{class:"tile tile--start",style:zt({backgroundImage:`url('${n.bgStart}')`}),onClick:n.startGame},[...e[0]||(e[0]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--bottom"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Begin Adventure")],-1)])],4),p("button",{class:"tile tile--warehouse",style:zt({backgroundImage:`url('${n.bgWarehouse}')`}),onClick:n.openWarehouse},[...e[1]||(e[1]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--top"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Character Collection")],-1)])],4),p("button",{class:"tile tile--wiki",style:zt({backgroundImage:`url('${n.bgWiki}')`}),onClick:n.openEncyclopedia},[...e[2]||(e[2]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--bottom"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Encyclopedia")],-1)])],4),p("button",{class:"tile tile--tutorial",style:zt({backgroundImage:`url('${n.bgTutorial}')`}),onClick:n.openTutorial},[...e[3]||(e[3]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--top"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Tutorial")],-1)])],4)],2),p("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,Bh)])}const zh=yt(Fh,[["render",Vh],["__scopeId","data-v-7603db95"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/Hall.vue"]]),In={HeartCrystalDust:{name:"",icon:H("resource/heart_crystal_dust.webp")},RecallGear:{name:"",icon:H("resource/recall_gear.webp")},ResonantCrystal:{name:"",icon:H("resource/resonant_star_crystal/resonant_star_crystal.webp")},RefinedCopper:{name:"",icon:H("resource/refined_copper_ingot/refined_copper_ingot.webp")},SpiritalSpark:{name:"",icon:H("resource/spiritual_spark.webp")}};function tr(t){var e;if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Resource"){const s=t.item_type[1];return((e=In[s])==null?void 0:e.name)||s}else if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Equipment")return"";return""}function yu(t){var e;return((e=In[t])==null?void 0:e.name)||t}function Wh(t){var e;return((e=In[t])==null?void 0:e.icon)||""}const qh="modulepreload",Kh=function(t){return"/MGPIC-2025/"+t},ll={},vu=function(e,s,n){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),a=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(s.map(l=>{if(l=Kh(l),l in ll)return;ll[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":qh,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return o.then(r=>{for(const a of r||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function Xh(t){return{all:t=t||new Map,on:function(e,s){var n=t.get(e);n?n.push(s):t.set(e,[s])},off:function(e,s){var n=t.get(e);n&&(s?n.splice(n.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var n=t.get(e);n&&n.slice().map(function(o){o(s)}),(n=t.get("*"))&&n.slice().map(function(o){o(e,s)})}}}const Hi=Xh(),vt={UPDATE_RESOURCES:"update:resources",RESOURCES_UPDATED:"resources:updated",COPPER_ID_ADDED:"copper:id:added",START_MENU_PAUSE:"menu:pause",START_MENU_RESUME:"menu:resume",START_MENU_STARTED:"menu:started",CONTROL_MODE_CHANGED:"control:mode:changed",GAME_STARTED:"game:started",GAME_ENDED:"game:ended"},An=(t,e)=>{Hi.emit(t,e)},Bn=(t,e)=>{Hi.on(t,e)},cs=(t,e)=>{Hi.off(t,e)};class Yh{constructor(){this.queue=[],this.isProcessing=!1,this.handlers=new Map,this.sceneContext=null}setSceneContext(e){this.sceneContext=e}registerHandler(e,s){this.handlers.set(e,s)}enqueue(e){["handle_on_click_copper","on_game_start"].includes(e.type_msg)&&f("[MessageQueue] :",e.type_msg),this.queue.push(e),this.isProcessing||this.processNext()}async processNext(){if(this.queue.length===0){this.isProcessing=!1;return}this.isProcessing=!0;const e=50;let s=0;for(;this.queue.length>0&&s<e;){const n=this.queue.shift();s++;try{const{type_msg:o,content:i}=n,r=this.handlers.get(o);if(r){const a=JSON.parse(i),l=r(a,this.sceneContext||{});l&&typeof l.then=="function"&&await l}else f("[MessageQueue] :",o),f("[MessageQueue] :",Array.from(this.handlers.keys()))}catch(o){f("[MessageQueue] :",o),f("[MessageQueue] :",o.message),f("[MessageQueue] :",o.stack)}}this.queue.length>0?requestAnimationFrame(()=>this.processNext()):this.isProcessing=!1}}const Re=new Yh;function Mo(t,e){return t.find(s=>s.id===e)}function cl(t){return new Promise(e=>setTimeout(e,t))}function bu(){f("[MessageQueue] ..."),Re.registerHandler("handle_on_click_copper",async(i,r)=>{var u,d;const{copper:a,resources:l,has_attack_targets:c}=i;f(`[Handler] : ${((u=a.copper.copper_info)==null?void 0:u.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.copper.attribute.health}, =${a.can_move}, =${a.can_attack}, =${a.can_summon}, =${a.can_build}, =${c}`),f(`[Handler] : ${(d=a.copper)==null?void 0:d.copper_type}`),r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowCopperInfo&&r.onShowCopperInfo(a,l,c)}),Re.registerHandler("handle_on_click_enemy",async(i,r)=>{var m,_;const{enemy:a,resources:l,has_attack_targets:c}=i,u=a.owned||!1;f(`[Handler] ${u?"":""}: ${((m=a.enemy_base)==null?void 0:m.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.enemy_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${c}`);const h={id:a.id,now_health:a.now_health,can_move:u?a.can_move:!1,can_attack:u?a.can_attack:!1,can_summon:!1,position:a.position,isEnemy:!u,isOwnedEnemy:u,copper:{copper_info:{name:((_=a.enemy_base)==null?void 0:_.name)||(u?"":"")},attribute:{health:a.enemy_base.health,attack:a.enemy_base.attack,defense:a.enemy_base.defense,speed:a.enemy_base.speed}}};r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowCopperInfo&&r.onShowCopperInfo(h,l,c)}),Re.registerHandler("handle_on_click_structure",async(i,r)=>{var d;const{structure:a,resources:l}=i,u=a.owned||!1?"":"";f(`[Handler] ${u}: ${((d=a.structure_base)==null?void 0:d.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.structure_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${a.structure_base.has_storage}`),r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowStructureInfo&&r.onShowStructureInfo(a,l)}),Re.registerHandler("set_copper",async(i,r)=>{const{id:a,position:l,copper:c}=i;window.__ACTUAL_COPPER_IDS__||(window.__ACTUAL_COPPER_IDS__=[]),window.__ACTUAL_COPPER_IDS__.push(c.id),An(vt.COPPER_ID_ADDED,c.id),r.onSetCopper&&await r.onSetCopper(a,l,c)}),Re.registerHandler("set_enemy",async(i,r)=>{const{id:a,position:l,enemy:c}=i;r.onSetEnemy&&r.onSetEnemy(a,l,c),c.owned&&An(vt.UPDATE_RESOURCES)}),Re.registerHandler("set_material",async(i,r)=>{const{id:a,position:l,material:c}=i;r.onSetMaterial&&await r.onSetMaterial(a,l,c)}),Re.registerHandler("set_structure",async(i,r)=>{const{id:a,position:l,structure:c}=i;r.onSetStructure&&await r.onSetStructure(a,l,c),c.owned&&An(vt.UPDATE_RESOURCES)}),Re.registerHandler("remove_unit",async(i,r)=>{const{id:a}=i,l=Mo(r.models||[],a),c=l&&l.type==="enemy"&&!l.isOwned,u=c?l.position:null;if(f(`[Handler] remove_unit: ID=${a}, type=${l==null?void 0:l.type}, isOwned=${l==null?void 0:l.isOwned}, isEnemyDeath=${c}, position=${JSON.stringify(u)}`),l&&l.object){l.object.traverse(m=>{m.material&&(Array.isArray(m.material)?m.material=m.material.map(_=>_.clone()):m.material=m.material.clone())});const d=500,h=performance.now();if(await new Promise(m=>{function _(){const v=performance.now()-h,S=Math.min(v/d,1);l.object&&l.object.traverse(x=>{x.material&&(Array.isArray(x.material)?x.material.forEach(I=>{I.transparent=!0,I.opacity=1-S}):(x.material.transparent=!0,x.material.opacity=1-S))}),S<1?requestAnimationFrame(_):m()}_()}),r.scene&&r.scene.remove(l.object),l.object.traverse(m=>{m.geometry&&m.geometry.dispose(),m.material&&(Array.isArray(m.material)?m.material.forEach(_=>{_.map&&_.map.dispose(),_.lightMap&&_.lightMap.dispose(),_.bumpMap&&_.bumpMap.dispose(),_.normalMap&&_.normalMap.dispose(),_.specularMap&&_.specularMap.dispose(),_.envMap&&_.envMap.dispose(),_.alphaMap&&_.alphaMap.dispose(),_.aoMap&&_.aoMap.dispose(),_.displacementMap&&_.displacementMap.dispose(),_.emissiveMap&&_.emissiveMap.dispose(),_.metalnessMap&&_.metalnessMap.dispose(),_.roughnessMap&&_.roughnessMap.dispose(),_.dispose()}):(m.material.map&&m.material.map.dispose(),m.material.lightMap&&m.material.lightMap.dispose(),m.material.bumpMap&&m.material.bumpMap.dispose(),m.material.normalMap&&m.material.normalMap.dispose(),m.material.specularMap&&m.material.specularMap.dispose(),m.material.envMap&&m.material.envMap.dispose(),m.material.alphaMap&&m.material.alphaMap.dispose(),m.material.aoMap&&m.material.aoMap.dispose(),m.material.displacementMap&&m.material.displacementMap.dispose(),m.material.emissiveMap&&m.material.emissiveMap.dispose(),m.material.metalnessMap&&m.material.metalnessMap.dispose(),m.material.roughnessMap&&m.material.roughnessMap.dispose(),m.material.dispose()))}),r.models){const m=r.models.indexOf(l);m>-1&&r.models.splice(m,1)}r.onClearState&&r.onClearState(a),r.onRemoveHealthBar&&r.onRemoveHealthBar(a),l.type==="copper"&&r.onRemoveCopper&&r.onRemoveCopper(a)}if(c&&u){f("[Handler] ...");const d=h=>{f("[Handler] :",h),r.onShowResourceGain&&Object.keys(h).length>0&&(f("[Handler] :",u,h),r.onShowResourceGain(u,h))};Bn(vt.RESOURCES_UPDATED,d),An(vt.UPDATE_RESOURCES),setTimeout(()=>{cs(vt.RESOURCES_UPDATED,d)},1e3)}}),Re.registerHandler("change_direction",async(i,r)=>{const{id:a,direction:l}=i,c=Mo(r.models||[],a);if(c&&c.object){let u=0;switch(l){case"PositiveY":u=0;break;case"PositiveX":u=Math.PI/2;break;case"NegativeY":u=Math.PI;break;case"NegativeX":u=-Math.PI/2;break}let d=c.object.rotation.y;d=Math.atan2(Math.sin(d),Math.cos(d));let h=u-d;h>Math.PI?h-=2*Math.PI:h<-Math.PI&&(h+=2*Math.PI);const m=300,_=performance.now();await new Promise(v=>{function S(){const x=performance.now()-_,I=Math.min(x/m,1),R=1-Math.pow(1-I,2);c.object&&(c.object.rotation.y=d+h*R),I<1?requestAnimationFrame(S):(c.object&&(c.object.rotation.y=u),v())}S()})}}),Re.registerHandler("move_to",async(i,r)=>{const{id:a,to:l}=i,c=Mo(r.models||[],a);if(c&&c.object&&r.gridCellSize){const[u,d]=l,h=u,m=d,_=c.object.position.y;c.position=[u,d],r.onMoveStart&&r.onMoveStart(a,c),r.animateModelMove&&await new Promise(v=>{r.animateModelMove(c,{x:h,y:_,z:m},v)}),r.onMoveComplete&&r.onMoveComplete(a)}}),Re.registerHandler("display_can_move",(i,r)=>{const{id:a,can_move:l}=i,c=l==="true"||l===!0;r.onDisplayCanMove&&r.onDisplayCanMove(a,c)}),Re.registerHandler("display_can_attack",(i,r)=>{const{id:a,can_attack:l}=i,c=l==="true"||l===!0;r.onDisplayCanAttack&&r.onDisplayCanAttack(a,c)}),Re.registerHandler("display_can_summon",(i,r)=>{const{id:a,can_summon:l}=i,c=l==="true"||l===!0;f(`[Handler] display_can_summon id=${a}, can_summon=${c}`),r.onDisplayCanSummon&&r.onDisplayCanSummon(a,c)}),Re.registerHandler("update_health",(i,r)=>{const{id:a,now_health:l,max_health:c}=i;r.onUpdateHealth&&r.onUpdateHealth(a,l,c)}),Re.registerHandler("clear_state",(i,r)=>{const{id:a}=i;r.onClearState&&r.onClearState(a)}),Re.registerHandler("animate_move",async(i,r)=>{const{id:a}=i,l=Mo(r.models||[],a);if(!l){f(`[Handler] animate_move:  ID=${a}`);return}if(window.disableAutoFocus){f(`[Handler] animate_move:  ID=${a}`);return}const c=r.followEnemies!==void 0?r.followEnemies:!1;if(l.type==="enemy"&&!c){f(`[Handler] animate_move:  ID=${a}  context.followEnemies = true `);return}if(r.camera&&r.focusOnModel){const u=r.focusOnModel(l.object,r.camera,r.controls);r.focusState&&(r.focusState.focusPosition=u.focusPosition,r.focusState.focusTarget=u.focusTarget,r.focusState.lerpFactor=u.lerpFactor,f(`[Handler] animate_move:  ID=${a} (${l.name})`)),await cl(1e3)}}),Re.registerHandler("animate_reset",async(i,r)=>{if(f("[Handler] animate_reset"),r.camera&&r.controls){const a={x:0,y:2,z:5},l={x:0,y:0,z:0};r.focusState&&(r.focusState.focusPosition=a,r.focusState.focusTarget=l,r.focusState.lerpFactor=.08),await cl(1e3)}}),Re.registerHandler("put_map_block",(i,r)=>{const{position:a}=i;r.onPutMapBlock&&r.onPutMapBlock(a)}),Re.registerHandler("put_room_blocks",async(i,r)=>{const{room_position:a,size:l}=i,[c,u]=a;if(f(`[Handler]  : [${c}, ${u}], ${l}x${l}`),!r.onPutMapBlock){f("[Handler]  context.onPutMapBlock ");return}f("[Handler]  context.onPutMapBlock ...");const d=32,h=l*l;let m=0;for(let _=0;_<l;_++)for(let v=0;v<l;v++){const S=[c+_,u+v];r.onPutMapBlock(S),m++,m%d===0&&await new Promise(x=>requestAnimationFrame(x))}f(`[Handler]  : ${h}`)}),Re.registerHandler("put_resource_marker",(i,r)=>{const{position:a}=i;r.onPutResourceMarker&&r.onPutResourceMarker(a)}),Re.registerHandler("clear_resource_marker",(i,r)=>{const{position:a}=i;r.onClearResourceMarker&&r.onClearResourceMarker(a)});let t=0,e=0,s=0;Re.registerHandler("set_move_block",(i,r)=>{const{position:a}=i;t++,r.onSetMoveBlock&&r.onSetMoveBlock(a)}),Re.registerHandler("set_attack_block",(i,r)=>{const{position:a}=i;e++,r.onSetAttackBlock&&r.onSetAttackBlock(a),(e===1||e%10===0)&&f(`[Handler]  ${e} `)}),Re.registerHandler("set_can_summon_blocks",(i,r)=>{const{position:a}=i;s++,r.onSetCanSummonBlock&&r.onSetCanSummonBlock(a),(s===1||s%10===0)&&f(`[Handler]  ${s} `)});let n=0,o=Date.now();Re.registerHandler("clear_block",(i,r)=>{const{position:a}=i;r.onClearBlock&&r.onClearBlock(a),n++;const l=Date.now();l-o>500&&(n>1&&f(`[Handler]   ${n} `),n=0,t>0&&(f(`[Handler]  ${t} `),t=0),e>0&&(f(`[Handler]  ${e} `),e=0),s>0&&(f(`[Handler]  ${s} `),s=0)),o=l}),Re.registerHandler("attack_complete",(i,r)=>{const{id:a}=i;r.onAttackComplete&&r.onAttackComplete(a)}),Re.registerHandler("on_game_round_pass",(i,r)=>{}),Re.registerHandler("craft_success",(i,r)=>{r.onCraftResult&&r.onCraftResult(!0,i.message||"")}),Re.registerHandler("craft_failed",(i,r)=>{r.onCraftResult&&r.onCraftResult(!1,i.message||"")}),Re.registerHandler("cannot_pick_up_item",(i,r)=>{f("[Handler] :",i.message||i)}),Re.registerHandler("equipment_slot_full",(i,r)=>{f("[Handler] :",i.message||i)}),Re.registerHandler("inventory_full",(i,r)=>{f("[Handler] :",i.message||i)}),Re.registerHandler("resource_not_enough",(i,r)=>{let a="";if(i.missing&&Array.isArray(i.missing)&&i.missing.length>0){const l={HeartCrystalDust:"",RecallGear:"",SpiritalSpark:"",RefinedCopper:"",ResonantCrystal:""};a=`: ${i.missing.map(u=>{const d=l[u.type]||u.type,h=u.needed-u.current;return`${d} ( ${h})`}).join("")}`}f("[Handler] :",a),r.onResourceNotEnough&&r.onResourceNotEnough(a)}),Re.registerHandler("summon_failed",(i,r)=>{f("[Handler] :",i.message||i),r.onSummonFailed&&r.onSummonFailed(i.message||"")}),Re.registerHandler("summon_expired",(i,r)=>{const{id:a,message:l}=i;f(`[Handler] : ID=${a}, ${l}`)}),Re.registerHandler("get_summon_menu",(i,r)=>{const{contents:a}=i;f("[Handler] :",a),r.onShowSummonMenu&&r.onShowSummonMenu(a)}),Re.registerHandler("get_structure_menu",(i,r)=>{const{contents:a}=i;if(!a||a.length===0){f("[Handler]  ");return}const l=a.filter(c=>c.name!=="");f("[Handler] ",l.length,""),r.onShowStructureMenu&&r.onShowStructureMenu(l)}),Re.registerHandler("drill_resource_generate",(i,r)=>{const{position:a,resource_type:l,amount:c}=i;f(`[Handler] : =${JSON.stringify(a)}, =${l}, =${c}`);const u={[l]:parseInt(c)};r.onShowResourceGain&&r.onShowResourceGain(a,u),An(vt.UPDATE_RESOURCES)}),Re.registerHandler("game_over",(i,r)=>{f("[Handler] "),r.onGameOver&&r.onGameOver()}),Re.registerHandler("success",(i,r)=>{f("[Handler] "),r.onGameSuccess&&r.onGameSuccess()})}const Jh=Object.freeze(Object.defineProperty({__proto__:null,messageQueue:Re,registerAllHandlers:bu},Symbol.toStringTag,{value:"Module"}));bu();let Le=null,wn=null;wn=(async()=>{try{return Le=await vu(()=>import("./main-B0Gq2A3n.js"),[]),f("[Glue] main.js "),Le}catch(t){return f("[Glue] main.js :",t.message),null}})();async function ul(){return await wn,Le!=null&&Le.global_gacha?JSON.parse(Le.global_gacha()):{type:"error",content:""}}async function Vn(){return await wn,Le!=null&&Le.global_get_resource?JSON.parse(Le.global_get_resource()):{}}async function dl(){return await wn,Le!=null&&Le.global_craft?JSON.parse(Le.global_craft()):{type:"error",content:""}}async function ws(){return await wn,Le!=null&&Le.global_get_copper_list?JSON.parse(Le.global_get_copper_list()):[]}async function fl(t){return await wn,Le!=null&&Le.global_upgrade_copper?JSON.parse(Le.global_upgrade_copper(t)):{type:"error",content:""}}async function nr(t){await wn,Le!=null&&Le.global_info_subscribe?(Le.global_info_subscribe(e=>{const s=JSON.parse(e);t(s),Re.enqueue(s)}),f("[Glue] global_info_subscribe ")):f("[Glue] global_info_subscribe ")}async function pl(t){await wn,Le!=null&&Le.global_import_save&&Le.global_import_save(t)}async function hl(){return await wn,Le!=null&&Le.global_export_save?JSON.parse(Le.global_export_save()):{type:"error",content:""}}async function Ae(t){await wn,Le!=null&&Le.eventloop?Le.eventloop(t):f("[Glue] eventloop ")}const Zh={__name:"DrawScreen",emits:["draw"],setup(t,{expose:e,emit:s}){e();const n=s,o=U(!1),i=U(!0),r=U(!1),a=U(""),l=U(""),c=U(""),u=U({left:0,top:0,width:0,height:0}),d=U(!1),h=U(!1),m=U(!1),_=U("");function v(E){_.value=E||"",m.value=!0,setTimeout(()=>{m.value=!1},1800)}async function S(){try{const T=await Vn(),C=Number((T==null?void 0:T.SpiritalSpark)??0);i.value=C>=10}catch{i.value=!1}}function x(){r.value=!1,d.value=!1,h.value=!1}function I(){if(o.value)return;if(S(),!i.value){v("");return}o.value=!0,f("[DrawScreen] runDrawSequence start");const E=document.querySelector(".draw-card");if(E){E.classList.add("is-shaking"),setTimeout(()=>E.classList.remove("is-shaking"),500);const T=E.getBoundingClientRect();u.value={left:Math.round(T.left),top:Math.round(T.top),width:Math.round(T.width),height:Math.round(T.height)}}setTimeout(async()=>{r.value=!0,d.value=!1,h.value=!0;try{const T=await ul();if(T&&T.type==="success"&&T.copper&&T.copper.copper_info){const C=T.copper.copper_info;a.value=C.name||"",l.value="",c.value=H(C.icon_url||""),f("[DrawScreen] tempImage resolved:",c.value),await hn(),setTimeout(()=>{h.value=!1,setTimeout(()=>{d.value=!0},350)},450),n("draw",{name:C.name,image:C.icon_url||""}),S()}else T&&T.type==="error"&&(r.value=!1,d.value=!1,h.value=!1,v(T.content||""),n("draw",{error:!0}),S())}catch{r.value=!1,d.value=!1,h.value=!1,v(""),n("draw",{error:!0}),S()}finally{setTimeout(()=>{o.value=!1},800)}},600)}const R={emit:n,isDrawing:o,canDraw:i,showTempCard:r,tempName:a,tempIcon:l,tempImage:c,tempRect:u,infoVisible:d,cardFlipped:h,toastVisible:m,toastText:_,showToast:v,refreshCanDraw:S,onCloseResult:x,runDrawSequence:I,get log(){return f},ref:U,nextTick:hn,get getAssetUrl(){return H},get gacha(){return ul},get get_resource(){return Vn}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},Qh={class:"draw-screen"},em={class:"draw-screen__body"},tm={class:"draw-card"},nm={class:"card-face card-back"},sm=["src"],om={class:"card-face card-front"},rm=["src"],im={key:1,class:"card-icon"},am=["src"],lm={class:"draw-cost"},cm=["src"],um=["disabled","title"],dm={key:0,class:"toast"};function fm(t,e,s,n,o,i){return D(),W("div",Qh,[p("div",em,[p("div",tm,[n.showTempCard?(D(),W("div",{key:0,class:"draw-temp",onClick:n.onCloseResult},[e[3]||(e[3]=p("div",{class:"dim-backdrop"},null,-1)),p("div",{class:"temp-stack",style:zt({left:n.tempRect.left+"px",top:n.tempRect.top+"px",width:n.tempRect.width+"px",height:n.tempRect.height+"px"}),onClick:e[2]||(e[2]=Pn(()=>{},["stop"]))},[p("div",{class:Qe(["card",{flipped:n.cardFlipped}]),onClick:e[0]||(e[0]=Pn(r=>n.cardFlipped=!n.cardFlipped,["stop"]))},[p("div",nm,[p("img",{src:n.getAssetUrl("frontend_resource/gacha.webp"),alt:"back"},null,8,sm)]),p("div",om,[n.tempImage?(D(),W("img",{key:0,src:n.tempImage,alt:"copper",class:"card-front-img"},null,8,rm)):(D(),W("div",im,se(n.tempIcon||""),1))])],2),p("div",{class:Qe(["card-name-below",{show:n.infoVisible}]),onClick:e[1]||(e[1]=Pn(()=>{},["stop"]))},se(n.tempName),3)],4)])):Me("",!0),p("img",{class:"draw-card__img",src:n.getAssetUrl("frontend_resource/gacha.webp"),alt:"card"},null,8,am)]),p("div",lm,[p("img",{class:"draw-cost__icon",src:n.getAssetUrl("resource/spiritual_spark.webp"),alt:"cost"},null,8,cm),e[4]||(e[4]=p("span",{class:"draw-cost__times"},"X 10",-1))]),p("button",{class:"draw-action",disabled:n.isDrawing||!n.canDraw,title:n.canDraw?"":"",onClick:n.runDrawSequence},"  ",8,um),n.toastVisible?(D(),W("div",dm,se(n.toastText),1)):Me("",!0)])])}const pm=yt(Zh,[["render",fm],["__scopeId","data-v-0c4022d9"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/DrawScreen.vue"]]);function ml(t,e){if(e===Hu)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===Kr||e===Dl){let s=t.getIndex();if(s===null){const r=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)r.push(l);t.setIndex(r),s=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const n=s.count-2,o=[];if(e===Kr)for(let r=1;r<=n;r++)o.push(s.getX(0)),o.push(s.getX(r)),o.push(s.getX(r+1));else for(let r=0;r<n;r++)r%2===0?(o.push(s.getX(r)),o.push(s.getX(r+1)),o.push(s.getX(r+2))):(o.push(s.getX(r+2)),o.push(s.getX(r+1)),o.push(s.getX(r)));o.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=t.clone();return i.setIndex(o),i.clearGroups(),i}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class us extends Nl{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(s){return new ym(s)}),this.register(function(s){return new vm(s)}),this.register(function(s){return new Am(s)}),this.register(function(s){return new km(s)}),this.register(function(s){return new Rm(s)}),this.register(function(s){return new wm(s)}),this.register(function(s){return new Sm(s)}),this.register(function(s){return new Mm(s)}),this.register(function(s){return new Tm(s)}),this.register(function(s){return new _m(s)}),this.register(function(s){return new Cm(s)}),this.register(function(s){return new bm(s)}),this.register(function(s){return new xm(s)}),this.register(function(s){return new Em(s)}),this.register(function(s){return new mm(s)}),this.register(function(s){return new Pm(s)}),this.register(function(s){return new Im(s)})}load(e,s,n,o){const i=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const c=zs.extractUrlBase(e);r=zs.resolveURL(c,this.path)}else r=zs.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){o?o(c):console.error(c),i.manager.itemError(e),i.manager.itemEnd(e)},l=new Oo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{i.parse(c,r,function(u){s(u),i.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,s,n,o){let i;const r={},a={},l=new TextDecoder;if(typeof e=="string")i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===wu){try{r[$e.KHR_BINARY_GLTF]=new Om(e)}catch(d){o&&o(d);return}i=JSON.parse(r[$e.KHR_BINARY_GLTF].content)}else i=JSON.parse(l.decode(e));else i=e;if(i.asset===void 0||i.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new Wm(i,{path:s||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,r[d.name]=!0}if(i.extensionsUsed)for(let u=0;u<i.extensionsUsed.length;++u){const d=i.extensionsUsed[u],h=i.extensionsRequired||[];switch(d){case $e.KHR_MATERIALS_UNLIT:r[d]=new gm;break;case $e.KHR_DRACO_MESH_COMPRESSION:r[d]=new Lm(i,this.dracoLoader);break;case $e.KHR_TEXTURE_TRANSFORM:r[d]=new Dm;break;case $e.KHR_MESH_QUANTIZATION:r[d]=new Nm;break;default:h.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(r),c.setPlugins(a),c.parse(n,o)}parseAsync(e,s){const n=this;return new Promise(function(o,i){n.parse(e,s,o,i)})}}function hm(){let t={};return{get:function(e){return t[e]},add:function(e,s){t[e]=s},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const $e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class mm{constructor(e){this.parser=e,this.name=$e.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,s=this.parser.json.nodes||[];for(let n=0,o=s.length;n<o;n++){const i=s[n];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const s=this.parser,n="light:"+e;let o=s.cache.get(n);if(o)return o;const i=s.json,l=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let c;const u=new gn(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],_n);const d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new kn(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new vs(u),c.distance=d;break;case"spot":c=new Uu(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),un(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=s.createUniqueName(l.name||"light_"+e),o=Promise.resolve(c),s.cache.add(n,o),o}getDependency(e,s){if(e==="light")return this._loadLight(s)}createNodeAttachment(e){const s=this,n=this.parser,i=n.json.nodes[e],a=(i.extensions&&i.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(s.cache,a,l)})}}class gm{constructor(){this.name=$e.KHR_MATERIALS_UNLIT}getMaterialType(){return Pt}extendParams(e,s,n){const o=[];e.color=new gn(1,1,1),e.opacity=1;const i=s.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const r=i.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],_n),e.opacity=r[3]}i.baseColorTexture!==void 0&&o.push(n.assignTexture(e,"map",i.baseColorTexture,Rn))}return Promise.all(o)}}class _m{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=o.extensions[this.name].emissiveStrength;return i!==void 0&&(s.emissiveIntensity=i),Promise.resolve()}}class ym{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];if(r.clearcoatFactor!==void 0&&(s.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&i.push(n.assignTexture(s,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(s.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&i.push(n.assignTexture(s,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(i.push(n.assignTexture(s,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;s.clearcoatNormalScale=new Nt(a,a)}return Promise.all(i)}}class vm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=o.extensions[this.name];return s.dispersion=i.dispersion!==void 0?i.dispersion:0,Promise.resolve()}}class bm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];return r.iridescenceFactor!==void 0&&(s.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&i.push(n.assignTexture(s,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(s.iridescenceIOR=r.iridescenceIor),s.iridescenceThicknessRange===void 0&&(s.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(s.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(s.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&i.push(n.assignTexture(s,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(i)}}class wm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[];s.sheenColor=new gn(0,0,0),s.sheenRoughness=0,s.sheen=1;const r=o.extensions[this.name];if(r.sheenColorFactor!==void 0){const a=r.sheenColorFactor;s.sheenColor.setRGB(a[0],a[1],a[2],_n)}return r.sheenRoughnessFactor!==void 0&&(s.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&i.push(n.assignTexture(s,"sheenColorMap",r.sheenColorTexture,Rn)),r.sheenRoughnessTexture!==void 0&&i.push(n.assignTexture(s,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(i)}}class Sm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];return r.transmissionFactor!==void 0&&(s.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&i.push(n.assignTexture(s,"transmissionMap",r.transmissionTexture)),Promise.all(i)}}class Mm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];s.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&i.push(n.assignTexture(s,"thicknessMap",r.thicknessTexture)),s.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return s.attenuationColor=new gn().setRGB(a[0],a[1],a[2],_n),Promise.all(i)}}class Tm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=o.extensions[this.name];return s.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class Cm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];s.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&i.push(n.assignTexture(s,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return s.specularColor=new gn().setRGB(a[0],a[1],a[2],_n),r.specularColorTexture!==void 0&&i.push(n.assignTexture(s,"specularColorMap",r.specularColorTexture,Rn)),Promise.all(i)}}class Em{constructor(e){this.parser=e,this.name=$e.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];return s.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&i.push(n.assignTexture(s,"bumpMap",r.bumpTexture)),Promise.all(i)}}class xm{constructor(e){this.parser=e,this.name=$e.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:bn}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],r=o.extensions[this.name];return r.anisotropyStrength!==void 0&&(s.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(s.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&i.push(n.assignTexture(s,"anisotropyMap",r.anisotropyTexture)),Promise.all(i)}}class Am{constructor(e){this.parser=e,this.name=$e.KHR_TEXTURE_BASISU}loadTexture(e){const s=this.parser,n=s.json,o=n.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const i=o.extensions[this.name],r=s.options.ktx2Loader;if(!r){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return s.loadTextureImage(e,i.source,r)}}class km{constructor(e){this.parser=e,this.name=$e.EXT_TEXTURE_WEBP}loadTexture(e){const s=this.name,n=this.parser,o=n.json,i=o.textures[e];if(!i.extensions||!i.extensions[s])return null;const r=i.extensions[s],a=o.images[r.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return n.loadTextureImage(e,r.source,l)}}class Rm{constructor(e){this.parser=e,this.name=$e.EXT_TEXTURE_AVIF}loadTexture(e){const s=this.name,n=this.parser,o=n.json,i=o.textures[e];if(!i.extensions||!i.extensions[s])return null;const r=i.extensions[s],a=o.images[r.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return n.loadTextureImage(e,r.source,l)}}class Pm{constructor(e){this.name=$e.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const s=this.parser.json,n=s.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const o=n.extensions[this.name],i=this.parser.getDependency("buffer",o.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(a){const l=o.byteOffset||0,c=o.byteLength||0,u=o.count,d=o.byteStride,h=new Uint8Array(a,l,c);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(u,d,h,o.mode,o.filter).then(function(m){return m.buffer}):r.ready.then(function(){const m=new ArrayBuffer(u*d);return r.decodeGltfBuffer(new Uint8Array(m),u,d,h,o.mode,o.filter),m})})}else return null}}class Im{constructor(e){this.name=$e.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const s=this.parser.json,n=s.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const o=s.meshes[n.mesh];for(const c of o.primitives)if(c.mode!==Vt.TRIANGLES&&c.mode!==Vt.TRIANGLE_STRIP&&c.mode!==Vt.TRIANGLE_FAN&&c.mode!==void 0)return null;const r=n.extensions[this.name].attributes,a=[],l={};for(const c in r)a.push(this.parser.getDependency("accessor",r[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,m=[];for(const _ of d){const v=new ts,S=new Pe,x=new ks,I=new Pe(1,1,1),R=new $l(_.geometry,_.material,h);for(let E=0;E<h;E++)l.TRANSLATION&&S.fromBufferAttribute(l.TRANSLATION,E),l.ROTATION&&x.fromBufferAttribute(l.ROTATION,E),l.SCALE&&I.fromBufferAttribute(l.SCALE,E),R.setMatrixAt(E,v.compose(S,x,I));for(const E in l)if(E==="_COLOR_0"){const T=l[E];R.instanceColor=new Fu(T.array,T.itemSize,T.normalized)}else E!=="TRANSLATION"&&E!=="ROTATION"&&E!=="SCALE"&&_.geometry.setAttribute(E,l[E]);Gl.prototype.copy.call(R,_),this.parser.assignFinalMaterial(R),m.push(R)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const wu="glTF",js=12,gl={JSON:1313821514,BIN:5130562};class Om{constructor(e){this.name=$e.KHR_BINARY_GLTF,this.content=null,this.body=null;const s=new DataView(e,0,js),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==wu)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-js,i=new DataView(e,js);let r=0;for(;r<o;){const a=i.getUint32(r,!0);r+=4;const l=i.getUint32(r,!0);if(r+=4,l===gl.JSON){const c=new Uint8Array(e,js+r,a);this.content=n.decode(c)}else if(l===gl.BIN){const c=js+r;this.body=e.slice(c,c+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Lm{constructor(e,s){if(!s)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=$e.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=s,this.dracoLoader.preload()}decodePrimitive(e,s){const n=this.json,o=this.dracoLoader,i=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},l={},c={};for(const u in r){const d=yi[u]||u.toLowerCase();a[d]=r[u]}for(const u in e.attributes){const d=yi[u]||u.toLowerCase();if(r[u]!==void 0){const h=n.accessors[e.attributes[u]],m=As[h.componentType];c[d]=m.name,l[d]=h.normalized===!0}}return s.getDependency("bufferView",i).then(function(u){return new Promise(function(d,h){o.decodeDracoFile(u,function(m){for(const _ in m.attributes){const v=m.attributes[_],S=l[_];S!==void 0&&(v.normalized=S)}d(m)},a,c,_n,h)})})}}class Dm{constructor(){this.name=$e.KHR_TEXTURE_TRANSFORM}extendTexture(e,s){return(s.texCoord===void 0||s.texCoord===e.channel)&&s.offset===void 0&&s.rotation===void 0&&s.scale===void 0||(e=e.clone(),s.texCoord!==void 0&&(e.channel=s.texCoord),s.offset!==void 0&&e.offset.fromArray(s.offset),s.rotation!==void 0&&(e.rotation=s.rotation),s.scale!==void 0&&e.repeat.fromArray(s.scale),e.needsUpdate=!0),e}}class Nm{constructor(){this.name=$e.KHR_MESH_QUANTIZATION}}class Su extends dd{constructor(e,s,n,o){super(e,s,n,o)}copySampleValue_(e){const s=this.resultBuffer,n=this.sampleValues,o=this.valueSize,i=e*o*3+o;for(let r=0;r!==o;r++)s[r]=n[i+r];return s}interpolate_(e,s,n,o){const i=this.resultBuffer,r=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=o-s,d=(n-s)/u,h=d*d,m=h*d,_=e*c,v=_-c,S=-2*m+3*h,x=m-h,I=1-S,R=x-h+d;for(let E=0;E!==a;E++){const T=r[v+E+a],C=r[v+E+l]*u,F=r[_+E+a],V=r[_+E]*u;i[E]=I*T+R*C+S*F+x*V}return i}}const $m=new ks;class Gm extends Su{interpolate_(e,s,n,o){const i=super.interpolate_(e,s,n,o);return $m.fromArray(i).normalize().toArray(i),i}}const Vt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},As={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_l={9728:Ul,9729:Xr,9984:qu,9985:Wu,9986:zu,9987:Hl},yl={33071:Xu,33648:Ku,10497:Yr},Ur={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yi={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Nn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Hm={CUBICSPLINE:void 0,LINEAR:Bl,STEP:ld},Fr={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Um(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new Gt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ud})),t.DefaultMaterial}function Jn(t,e,s){for(const n in s.extensions)t[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=s.extensions[n])}function un(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Fm(t,e,s){let n=!1,o=!1,i=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(o=!0),d.COLOR_0!==void 0&&(i=!0),n&&o&&i)break}if(!n&&!o&&!i)return Promise.resolve(t);const r=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(n){const h=d.POSITION!==void 0?s.getDependency("accessor",d.POSITION):t.attributes.position;r.push(h)}if(o){const h=d.NORMAL!==void 0?s.getDependency("accessor",d.NORMAL):t.attributes.normal;a.push(h)}if(i){const h=d.COLOR_0!==void 0?s.getDependency("accessor",d.COLOR_0):t.attributes.color;l.push(h)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],h=c[2];return n&&(t.morphAttributes.position=u),o&&(t.morphAttributes.normal=d),i&&(t.morphAttributes.color=h),t.morphTargetsRelative=!0,t})}function jm(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let s=0,n=e.weights.length;s<n;s++)t.morphTargetInfluences[s]=e.weights[s];if(e.extras&&Array.isArray(e.extras.targetNames)){const s=e.extras.targetNames;if(t.morphTargetInfluences.length===s.length){t.morphTargetDictionary={};for(let n=0,o=s.length;n<o;n++)t.morphTargetDictionary[s[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Bm(t){let e;const s=t.extensions&&t.extensions[$e.KHR_DRACO_MESH_COMPRESSION];if(s?e="draco:"+s.bufferView+":"+s.indices+":"+jr(s.attributes):e=t.indices+":"+jr(t.attributes)+":"+t.mode,t.targets!==void 0)for(let n=0,o=t.targets.length;n<o;n++)e+=":"+jr(t.targets[n]);return e}function jr(t){let e="";const s=Object.keys(t).sort();for(let n=0,o=s.length;n<o;n++)e+=s[n]+":"+t[s[n]]+";";return e}function vi(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Vm(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":t.search(/\.ktx2($|\?)/i)>0||t.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const zm=new ts;class Wm{constructor(e={},s={}){this.json=e,this.extensions={},this.plugins={},this.options=s,this.cache=new hm,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,o=-1,i=!1,r=-1;if(typeof navigator<"u"){const a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);o=n&&l?parseInt(l[1],10):-1,i=a.indexOf("Firefox")>-1,r=i?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&o<17||i&&r<98?this.textureLoader=new ju(this.options.manager):this.textureLoader=new Bu(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Oo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,s){const n=this,o=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(r){const a={scene:r[0][o.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:o.asset,parser:n,userData:{}};return Jn(i,a,o),un(a,o),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(s)}_markDefs(){const e=this.json.nodes||[],s=this.json.skins||[],n=this.json.meshes||[];for(let o=0,i=s.length;o<i;o++){const r=s[o].joints;for(let a=0,l=r.length;a<l;a++)e[r[a]].isBone=!0}for(let o=0,i=e.length;o<i;o++){const r=e[o];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(n[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,s){s!==void 0&&(e.refs[s]===void 0&&(e.refs[s]=e.uses[s]=0),e.refs[s]++)}_getNodeRef(e,s,n){if(e.refs[s]<=1)return n;const o=n.clone(),i=(r,a)=>{const l=this.associations.get(r);l!=null&&this.associations.set(a,l);for(const[c,u]of r.children.entries())i(u,a.children[c])};return i(n,o),o.name+="_instance_"+e.uses[s]++,o}_invokeOne(e){const s=Object.values(this.plugins);s.push(this);for(let n=0;n<s.length;n++){const o=e(s[n]);if(o)return o}return null}_invokeAll(e){const s=Object.values(this.plugins);s.unshift(this);const n=[];for(let o=0;o<s.length;o++){const i=e(s[o]);i&&n.push(i)}return n}getDependency(e,s){const n=e+":"+s;let o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(s);break;case"node":o=this._invokeOne(function(i){return i.loadNode&&i.loadNode(s)});break;case"mesh":o=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(s)});break;case"accessor":o=this.loadAccessor(s);break;case"bufferView":o=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(s)});break;case"buffer":o=this.loadBuffer(s);break;case"material":o=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(s)});break;case"texture":o=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(s)});break;case"skin":o=this.loadSkin(s);break;case"animation":o=this._invokeOne(function(i){return i.loadAnimation&&i.loadAnimation(s)});break;case"camera":o=this.loadCamera(s);break;default:if(o=this._invokeOne(function(i){return i!=this&&i.getDependency&&i.getDependency(e,s)}),!o)throw new Error("Unknown type: "+e);break}this.cache.add(n,o)}return o}getDependencies(e){let s=this.cache.get(e);if(!s){const n=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];s=Promise.all(o.map(function(i,r){return n.getDependency(e,r)})),this.cache.add(e,s)}return s}loadBuffer(e){const s=this.json.buffers[e],n=this.fileLoader;if(s.type&&s.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+s.type+" buffer type is not supported.");if(s.uri===void 0&&e===0)return Promise.resolve(this.extensions[$e.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(i,r){n.load(zs.resolveURL(s.uri,o.path),i,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+s.uri+'".'))})})}loadBufferView(e){const s=this.json.bufferViews[e];return this.getDependency("buffer",s.buffer).then(function(n){const o=s.byteLength||0,i=s.byteOffset||0;return n.slice(i,i+o)})}loadAccessor(e){const s=this,n=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0){const r=Ur[o.type],a=As[o.componentType],l=o.normalized===!0,c=new a(o.count*r);return Promise.resolve(new Ws(c,r,l))}const i=[];return o.bufferView!==void 0?i.push(this.getDependency("bufferView",o.bufferView)):i.push(null),o.sparse!==void 0&&(i.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(i).then(function(r){const a=r[0],l=Ur[o.type],c=As[o.componentType],u=c.BYTES_PER_ELEMENT,d=u*l,h=o.byteOffset||0,m=o.bufferView!==void 0?n.bufferViews[o.bufferView].byteStride:void 0,_=o.normalized===!0;let v,S;if(m&&m!==d){const x=Math.floor(h/m),I="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+x+":"+o.count;let R=s.cache.get(I);R||(v=new c(a,x*m,o.count*m/u),R=new Vu(v,m/u),s.cache.add(I,R)),S=new cd(R,l,h%m/u,_)}else a===null?v=new c(o.count*l):v=new c(a,h,o.count*l),S=new Ws(v,l,_);if(o.sparse!==void 0){const x=Ur.SCALAR,I=As[o.sparse.indices.componentType],R=o.sparse.indices.byteOffset||0,E=o.sparse.values.byteOffset||0,T=new I(r[1],R,o.sparse.count*x),C=new c(r[2],E,o.sparse.count*l);a!==null&&(S=new Ws(S.array.slice(),S.itemSize,S.normalized)),S.normalized=!1;for(let F=0,V=T.length;F<V;F++){const O=T[F];if(S.setX(O,C[F*l]),l>=2&&S.setY(O,C[F*l+1]),l>=3&&S.setZ(O,C[F*l+2]),l>=4&&S.setW(O,C[F*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}S.normalized=_}return S})}loadTexture(e){const s=this.json,n=this.options,i=s.textures[e].source,r=s.images[i];let a=this.textureLoader;if(r.uri){const l=n.manager.getHandler(r.uri);l!==null&&(a=l)}return this.loadTextureImage(e,i,a)}loadTextureImage(e,s,n){const o=this,i=this.json,r=i.textures[e],a=i.images[s],l=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(s,n).then(function(u){u.flipY=!1,u.name=r.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const h=(i.samplers||{})[r.sampler]||{};return u.magFilter=_l[h.magFilter]||Xr,u.minFilter=_l[h.minFilter]||Hl,u.wrapS=yl[h.wrapS]||Yr,u.wrapT=yl[h.wrapT]||Yr,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==Ul&&u.minFilter!==Xr,o.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,s){const n=this,o=this.json,i=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const r=o.images[e],a=self.URL||self.webkitURL;let l=r.uri||"",c=!1;if(r.bufferView!==void 0)l=n.getDependency("bufferView",r.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:r.mimeType});return l=a.createObjectURL(h),l});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,m){let _=h;s.isImageBitmapLoader===!0&&(_=function(v){const S=new la(v);S.needsUpdate=!0,h(S)}),s.load(zs.resolveURL(d,i.path),_,void 0,m)})}).then(function(d){return c===!0&&a.revokeObjectURL(l),un(d,r),d.userData.mimeType=r.mimeType||Vm(r.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,s,n,o){const i=this;return this.getDependency("texture",n.index).then(function(r){if(!r)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(r=r.clone(),r.channel=n.texCoord),i.extensions[$e.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[$e.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=i.associations.get(r);r=i.extensions[$e.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),i.associations.set(r,l)}}return o!==void 0&&(r.colorSpace=o),e[s]=r,r})}assignFinalMaterial(e){const s=e.geometry;let n=e.material;const o=s.attributes.tangent===void 0,i=s.attributes.color!==void 0,r=s.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Yu,Er.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new Ju,Er.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(o||i||r){let a="ClonedMaterial:"+n.uuid+":";o&&(a+="derivative-tangents:"),i&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),i&&(l.vertexColors=!0),r&&(l.flatShading=!0),o&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return Gt}loadMaterial(e){const s=this,n=this.json,o=this.extensions,i=n.materials[e];let r;const a={},l=i.extensions||{},c=[];if(l[$e.KHR_MATERIALS_UNLIT]){const d=o[$e.KHR_MATERIALS_UNLIT];r=d.getMaterialType(),c.push(d.extendParams(a,i,s))}else{const d=i.pbrMetallicRoughness||{};if(a.color=new gn(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],_n),a.opacity=h[3]}d.baseColorTexture!==void 0&&c.push(s.assignTexture(a,"map",d.baseColorTexture,Rn)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(s.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(s.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),r=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}i.doubleSided===!0&&(a.side=Un);const u=i.alphaMode||Fr.OPAQUE;if(u===Fr.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Fr.MASK&&(a.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&r!==Pt&&(c.push(s.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new Nt(1,1),i.normalTexture.scale!==void 0)){const d=i.normalTexture.scale;a.normalScale.set(d,d)}if(i.occlusionTexture!==void 0&&r!==Pt&&(c.push(s.assignTexture(a,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&r!==Pt){const d=i.emissiveFactor;a.emissive=new gn().setRGB(d[0],d[1],d[2],_n)}return i.emissiveTexture!==void 0&&r!==Pt&&c.push(s.assignTexture(a,"emissiveMap",i.emissiveTexture,Rn)),Promise.all(c).then(function(){const d=new r(a);return i.name&&(d.name=i.name),un(d,i),s.associations.set(d,{materials:e}),i.extensions&&Jn(o,d,i),d})}createUniqueName(e){const s=Zu.sanitizeNodeName(e||"");return s in this.nodeNamesUsed?s+"_"+ ++this.nodeNamesUsed[s]:(this.nodeNamesUsed[s]=0,s)}loadGeometries(e){const s=this,n=this.extensions,o=this.primitiveCache;function i(a){return n[$e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,s).then(function(l){return vl(l,a,s)})}const r=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=Bm(c),d=o[u];if(d)r.push(d.promise);else{let h;c.extensions&&c.extensions[$e.KHR_DRACO_MESH_COMPRESSION]?h=i(c):h=vl(new Fl,c,s),o[u]={primitive:c,promise:h},r.push(h)}}return Promise.all(r)}loadMesh(e){const s=this,n=this.json,o=this.extensions,i=n.meshes[e],r=i.primitives,a=[];for(let l=0,c=r.length;l<c;l++){const u=r[l].material===void 0?Um(this.cache):this.getDependency("material",r[l].material);a.push(u)}return a.push(s.loadGeometries(r)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let m=0,_=u.length;m<_;m++){const v=u[m],S=r[m];let x;const I=c[m];if(S.mode===Vt.TRIANGLES||S.mode===Vt.TRIANGLE_STRIP||S.mode===Vt.TRIANGLE_FAN||S.mode===void 0)x=i.isSkinnedMesh===!0?new Qu(v,I):new rt(v,I),x.isSkinnedMesh===!0&&x.normalizeSkinWeights(),S.mode===Vt.TRIANGLE_STRIP?x.geometry=ml(x.geometry,Dl):S.mode===Vt.TRIANGLE_FAN&&(x.geometry=ml(x.geometry,Kr));else if(S.mode===Vt.LINES)x=new ed(v,I);else if(S.mode===Vt.LINE_STRIP)x=new td(v,I);else if(S.mode===Vt.LINE_LOOP)x=new nd(v,I);else if(S.mode===Vt.POINTS)x=new sd(v,I);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(x.geometry.morphAttributes).length>0&&jm(x,i),x.name=s.createUniqueName(i.name||"mesh_"+e),un(x,i),S.extensions&&Jn(o,x,S),s.assignFinalMaterial(x),d.push(x)}for(let m=0,_=d.length;m<_;m++)s.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return i.extensions&&Jn(o,d[0],i),d[0];const h=new Jt;i.extensions&&Jn(o,h,i),s.associations.set(h,{meshes:e});for(let m=0,_=d.length;m<_;m++)h.add(d[m]);return h})}loadCamera(e){let s;const n=this.json.cameras[e],o=n[n.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?s=new lo(jl.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):n.type==="orthographic"&&(s=new od(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),n.name&&(s.name=this.createUniqueName(n.name)),un(s,n),Promise.resolve(s)}loadSkin(e){const s=this.json.skins[e],n=[];for(let o=0,i=s.joints.length;o<i;o++)n.push(this._loadNodeShallow(s.joints[o]));return s.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",s.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(o){const i=o.pop(),r=o,a=[],l=[];for(let c=0,u=r.length;c<u;c++){const d=r[c];if(d){a.push(d);const h=new ts;i!==null&&h.fromArray(i.array,c*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[c])}return new rd(a,l)})}loadAnimation(e){const s=this.json,n=this,o=s.animations[e],i=o.name?o.name:"animation_"+e,r=[],a=[],l=[],c=[],u=[];for(let d=0,h=o.channels.length;d<h;d++){const m=o.channels[d],_=o.samplers[m.sampler],v=m.target,S=v.node,x=o.parameters!==void 0?o.parameters[_.input]:_.input,I=o.parameters!==void 0?o.parameters[_.output]:_.output;v.node!==void 0&&(r.push(this.getDependency("node",S)),a.push(this.getDependency("accessor",x)),l.push(this.getDependency("accessor",I)),c.push(_),u.push(v))}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const h=d[0],m=d[1],_=d[2],v=d[3],S=d[4],x=[];for(let R=0,E=h.length;R<E;R++){const T=h[R],C=m[R],F=_[R],V=v[R],O=S[R];if(T===void 0)continue;T.updateMatrix&&T.updateMatrix();const ae=n._createAnimationTracks(T,C,F,V,O);if(ae)for(let ee=0;ee<ae.length;ee++)x.push(ae[ee])}const I=new id(i,void 0,x);return un(I,o),I})}createNodeMesh(e){const s=this.json,n=this,o=s.nodes[e];return o.mesh===void 0?null:n.getDependency("mesh",o.mesh).then(function(i){const r=n._getNodeRef(n.meshCache,o.mesh,i);return o.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let l=0,c=o.weights.length;l<c;l++)a.morphTargetInfluences[l]=o.weights[l]}),r})}loadNode(e){const s=this.json,n=this,o=s.nodes[e],i=n._loadNodeShallow(e),r=[],a=o.children||[];for(let c=0,u=a.length;c<u;c++)r.push(n.getDependency("node",a[c]));const l=o.skin===void 0?Promise.resolve(null):n.getDependency("skin",o.skin);return Promise.all([i,Promise.all(r),l]).then(function(c){const u=c[0],d=c[1],h=c[2];h!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(h,zm)});for(let m=0,_=d.length;m<_;m++)u.add(d[m]);return u})}_loadNodeShallow(e){const s=this.json,n=this.extensions,o=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const i=s.nodes[e],r=i.name?o.createUniqueName(i.name):"",a=[],l=o._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),i.camera!==void 0&&a.push(o.getDependency("camera",i.camera).then(function(c){return o._getNodeRef(o.cameraCache,i.camera,c)})),o._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(i.isBone===!0?u=new ad:c.length>1?u=new Jt:c.length===1?u=c[0]:u=new Gl,u!==c[0])for(let d=0,h=c.length;d<h;d++)u.add(c[d]);if(i.name&&(u.userData.name=i.name,u.name=r),un(u,i),i.extensions&&Jn(n,u,i),i.matrix!==void 0){const d=new ts;d.fromArray(i.matrix),u.applyMatrix4(d)}else i.translation!==void 0&&u.position.fromArray(i.translation),i.rotation!==void 0&&u.quaternion.fromArray(i.rotation),i.scale!==void 0&&u.scale.fromArray(i.scale);if(!o.associations.has(u))o.associations.set(u,{});else if(i.mesh!==void 0&&o.meshCache.refs[i.mesh]>1){const d=o.associations.get(u);o.associations.set(u,{...d})}return o.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const s=this.extensions,n=this.json.scenes[e],o=this,i=new Jt;n.name&&(i.name=o.createUniqueName(n.name)),un(i,n),n.extensions&&Jn(s,i,n);const r=n.nodes||[],a=[];for(let l=0,c=r.length;l<c;l++)a.push(o.getDependency("node",r[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)i.add(l[u]);const c=u=>{const d=new Map;for(const[h,m]of o.associations)(h instanceof Er||h instanceof la)&&d.set(h,m);return u.traverse(h=>{const m=o.associations.get(h);m!=null&&d.set(h,m)}),d};return o.associations=c(i),i})}_createAnimationTracks(e,s,n,o,i){const r=[],a=e.name?e.name:e.uuid,l=[];Nn[i.path]===Nn.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(a);let c;switch(Nn[i.path]){case Nn.weights:c=ua;break;case Nn.rotation:c=da;break;case Nn.translation:case Nn.scale:c=ca;break;default:switch(n.itemSize){case 1:c=ua;break;case 2:case 3:default:c=ca;break}break}const u=o.interpolation!==void 0?Hm[o.interpolation]:Bl,d=this._getArrayFromAccessor(n);for(let h=0,m=l.length;h<m;h++){const _=new c(l[h]+"."+Nn[i.path],s.array,d,u);o.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(_),r.push(_)}return r}_getArrayFromAccessor(e){let s=e.array;if(e.normalized){const n=vi(s.constructor),o=new Float32Array(s.length);for(let i=0,r=s.length;i<r;i++)o[i]=s[i]*n;s=o}return s}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const o=this instanceof da?Gm:Su;return new o(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function qm(t,e,s){const n=e.attributes,o=new kt;if(n.POSITION!==void 0){const a=s.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(o.set(new Pe(l[0],l[1],l[2]),new Pe(c[0],c[1],c[2])),a.normalized){const u=vi(As[a.componentType]);o.min.multiplyScalar(u),o.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const i=e.targets;if(i!==void 0){const a=new Pe,l=new Pe;for(let c=0,u=i.length;c<u;c++){const d=i[c];if(d.POSITION!==void 0){const h=s.json.accessors[d.POSITION],m=h.min,_=h.max;if(m!==void 0&&_!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(_[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(_[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(_[2]))),h.normalized){const v=vi(As[h.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(a)}t.boundingBox=o;const r=new fd;o.getCenter(r.center),r.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=r}function vl(t,e,s){const n=e.attributes,o=[];function i(r,a){return s.getDependency("accessor",r).then(function(l){t.setAttribute(a,l)})}for(const r in n){const a=yi[r]||r.toLowerCase();a in t.attributes||o.push(i(n[r],a))}if(e.indices!==void 0&&!t.index){const r=s.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});o.push(r)}return Jr.workingColorSpace!==_n&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Jr.workingColorSpace}" not supported.`),un(t,e),qm(t,e,s),Promise.all(o).then(function(){return e.targets!==void 0?Fm(t,e.targets,s):t})}const Br=new WeakMap;class ds extends Nl{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,s,n,o){const i=new Oo(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,r=>{this.parse(r,s,o)},n,o)}parse(e,s,n=()=>{}){this.decodeDracoFile(e,s,null,null,Rn,n).catch(n)}decodeDracoFile(e,s,n,o,i=_n,r=()=>{}){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:i};return this.decodeGeometry(e,a).then(s).catch(r)}decodeGeometry(e,s){const n=JSON.stringify(s);if(Br.has(e)){const l=Br.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const i=this.workerNextTaskID++,r=e.byteLength,a=this._getWorker(i,r).then(l=>(o=l,new Promise((c,u)=>{o._callbacks[i]={resolve:c,reject:u},o.postMessage({type:"decode",id:i,taskConfig:s,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{o&&i&&this._releaseTask(o,i)}),Br.set(e,{key:n,promise:a}),a}_createGeometry(e){const s=new Fl;e.index&&s.setIndex(new Ws(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n],i=o.name,r=o.array,a=o.itemSize,l=new Ws(r,a);i==="color"&&(this._assignVertexColorSpace(l,o.vertexColorSpace),l.normalized=!(r instanceof Float32Array)),s.setAttribute(i,l)}return s}_assignVertexColorSpace(e,s){if(s!==Rn)return;const n=new gn;for(let o=0,i=e.count;o<i;o++)n.fromBufferAttribute(e,o),Jr.colorSpaceToWorking(n,Rn),e.setXYZ(o,n.r,n.g,n.b)}_loadLibrary(e,s){const n=new Oo(this.manager);return n.setPath(this.decoderPath),n.setResponseType(s),n.setWithCredentials(this.withCredentials),new Promise((o,i)=>{n.load(e,o,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",s=[];return e?s.push(this._loadLibrary("draco_decoder.js","text")):(s.push(this._loadLibrary("draco_wasm_wrapper.js","text")),s.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(s).then(n=>{const o=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const i=Km.toString(),r=["/* draco decoder */",o,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,s){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const o=new Worker(this.workerSourceURL);o._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:this.decoderConfig}),o.onmessage=function(i){const r=i.data;switch(r.type){case"decode":o._callbacks[r.id].resolve(r);break;case"error":o._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,i){return o._taskLoad>i._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=s,n._taskLoad+=s,n})}_releaseTask(e,s){e._taskLoad-=e._taskCosts[s],delete e._callbacks[s],delete e._taskCosts[s]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Km(){let t,e;onmessage=function(r){const a=r.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(u){t.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const d=u.draco,h=new d.Decoder;try{const m=s(d,h,new Int8Array(l),c),_=m.attributes.map(v=>v.array.buffer);m.index&&_.push(m.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:m},_)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}finally{d.destroy(h)}});break}};function s(r,a,l,c){const u=c.attributeIDs,d=c.attributeTypes;let h,m;const _=a.GetEncodedGeometryType(l);if(_===r.TRIANGULAR_MESH)h=new r.Mesh,m=a.DecodeArrayToMesh(l,l.byteLength,h);else if(_===r.POINT_CLOUD)h=new r.PointCloud,m=a.DecodeArrayToPointCloud(l,l.byteLength,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const v={index:null,attributes:[]};for(const S in u){const x=self[d[S]];let I,R;if(c.useUniqueIDs)R=u[S],I=a.GetAttributeByUniqueId(h,R);else{if(R=a.GetAttributeId(h,r[u[S]]),R===-1)continue;I=a.GetAttribute(h,R)}const E=o(r,a,h,S,x,I);S==="color"&&(E.vertexColorSpace=c.vertexColorSpace),v.attributes.push(E)}return _===r.TRIANGULAR_MESH&&(v.index=n(r,a,h)),r.destroy(h),v}function n(r,a,l){const u=l.num_faces()*3,d=u*4,h=r._malloc(d);a.GetTrianglesUInt32Array(l,d,h);const m=new Uint32Array(r.HEAPF32.buffer,h,u).slice();return r._free(h),{array:m,itemSize:1}}function o(r,a,l,c,u,d){const h=d.num_components(),_=l.num_points()*h,v=_*u.BYTES_PER_ELEMENT,S=i(r,u),x=r._malloc(v);a.GetAttributeDataArrayForAllPoints(l,d,S,v,x);const I=new u(r.HEAPF32.buffer,x,_).slice();return r._free(x),{name:c,array:I,itemSize:h}}function i(r,a){switch(a){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}class Xm{constructor(){this.gltfCache=new Map,this.modelPool=new Map,this.instancedMeshes=new Map,this.gltfLoader=null,this.dracoLoader=null,this.maxCacheSize=50,this.maxInstancesPerModel=1e3,this.preloadStatus=new Map,this.preloadQueue=[],this.initLoaders()}initLoaders(){this.gltfLoader||(this.gltfLoader=new us,this.gltfLoader.setCrossOrigin("anonymous"),this.dracoLoader=new ds,this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setCrossOrigin("anonymous"),this.gltfLoader.setDRACOLoader(this.dracoLoader),f("[ModelCache] GLTFDraco"))}async loadModel(e,s=!0){if(s&&this.modelPool.has(e)){const i=this.modelPool.get(e);return f(`[ModelCache] : ${e}`),i.clone(!0)}let n;if(this.gltfCache.has(e))f(`[ModelCache] GLTF: ${e}`),n=this.gltfCache.get(e);else try{const r=await(await _u(e)).arrayBuffer();f(`[ModelCache] GLTF: ${e}`),n=await new Promise((a,l)=>{this.gltfLoader.parse(r,"",c=>a(c),c=>l(c))}),this.cacheGLTF(e,n)}catch(i){throw f(`[ModelCache] : ${e}`,i),i}const o=n.scene.clone(!0);return s&&this.addToModelPool(e,o),o}async createInstancedMesh(e,s=100){if(this.instancedMeshes.has(e))return f(`[ModelCache] : ${e}`),this.instancedMeshes.get(e);const n=await this.loadModel(e,!0),o=[];if(n.traverse(l=>{l.isMesh&&o.push(l)}),o.length===0)throw new Error(`[ModelCache] : ${e}`);const i=o[0],r=new $l(i.geometry,i.material,s),a=new ts;for(let l=0;l<s;l++)a.setPosition(0,-1e3,0),r.setMatrixAt(l,a);return r.instanceMatrix.needsUpdate=!0,this.instancedMeshes.set(e,r),f(`[ModelCache] : ${e}, : ${s}`),r}updateInstancedMeshInstance(e,s,n,o,i){const r=this.instancedMeshes.get(e);if(!r){f(`[ModelCache] : ${e}`);return}if(s>=r.count){f(`[ModelCache] : ${s}/${r.count}`);return}const a=new ts;a.compose(n,new ks().setFromEuler(o),i),r.setMatrixAt(s,a),r.instanceMatrix.needsUpdate=!0}hideInstancedMeshInstance(e,s){const n=this.instancedMeshes.get(e);if(!n)return;const o=new ts;o.setPosition(0,-1e3,0),n.setMatrixAt(s,o),n.instanceMatrix.needsUpdate=!0}cacheGLTF(e,s){if(this.gltfCache.size>=this.maxCacheSize){const n=this.gltfCache.keys().next().value;this.gltfCache.delete(n),f(`[ModelCache] GLTF: ${n}`)}this.gltfCache.set(e,s),f(`[ModelCache] GLTF: ${e}`)}addToModelPool(e,s){if(this.modelPool.size>=this.maxCacheSize){const n=this.modelPool.keys().next().value,o=this.modelPool.get(n);this.disposeModel(o),this.modelPool.delete(n),f(`[ModelCache] : ${n}`)}this.modelPool.set(e,s),f(`[ModelCache] : ${e}`)}async preloadModels(e,s=null){f(`[ModelCache]  ${e.length} `);const n=e.length;let o=0;const i=e.filter(a=>{const l=this.preloadStatus.get(a);return!l||l==="failed"});f(`[ModelCache]  ${i.length} `);const r=3;for(let a=0;a<i.length;a+=r){const c=i.slice(a,a+r).map(async u=>{try{this.preloadStatus.set(u,"loading"),await this.loadModel(u,!0),this.preloadStatus.set(u,"loaded"),o++,s&&s(o,n,Math.round(o/n*100)),f(`[ModelCache] : ${u} (${o}/${n})`)}catch(d){f(`[ModelCache] : ${u}`,d),this.preloadStatus.set(u,"failed"),o++,s&&s(o,n,Math.round(o/n*100))}});await Promise.all(c),a+r<i.length&&await new Promise(u=>setTimeout(u,100))}f(`[ModelCache] : ${o}/${n} `)}isPreloaded(e){return this.preloadStatus.get(e)==="loaded"}getPreloadStatus(){const e={total:this.preloadStatus.size,loaded:0,loading:0,failed:0};for(const s of this.preloadStatus.values())e[s]++;return e}disposeModel(e){e&&e.traverse(s=>{s.isMesh&&(s.geometry&&s.geometry.dispose(),s.material&&(Array.isArray(s.material)?s.material.forEach(n=>{n.map&&n.map.dispose(),n.dispose&&n.dispose()}):(s.material.map&&s.material.map.dispose(),s.material.dispose&&s.material.dispose())))})}clearCache(){f("[ModelCache] ..."),this.modelPool.forEach(e=>{this.disposeModel(e)}),this.modelPool.clear(),this.instancedMeshes.forEach(e=>{this.disposeModel(e)}),this.instancedMeshes.clear(),this.gltfCache.clear(),this.preloadStatus.clear(),f("[ModelCache] ")}getCacheStatus(){return{gltfCacheSize:this.gltfCache.size,modelPoolSize:this.modelPool.size,instancedMeshesSize:this.instancedMeshes.size,preloadStatus:this.getPreloadStatus(),maxCacheSize:this.maxCacheSize,maxInstancesPerModel:this.maxInstancesPerModel,gltfLoaderInitialized:!!this.gltfLoader,dracoLoaderInitialized:!!this.dracoLoader}}updateConfig(e){e.maxCacheSize!==void 0&&(this.maxCacheSize=Math.max(10,e.maxCacheSize)),e.maxInstancesPerModel!==void 0&&(this.maxInstancesPerModel=Math.max(10,e.maxInstancesPerModel)),f("[ModelCache] :",this.getCacheStatus())}}const Mt=new Xm,Ym={__name:"PuppetModelView",props:{puppet:{type:Object,default:null}},setup(t,{expose:e}){e();const s=t,n=U(null),o=U(!1);let i=null,r=null,a=null,l=0,c=null,u=null,d=new hd,h=null,m=null,_=0,v=!1;window.__GLTF_MEMORY_CACHE__||(window.__GLTF_MEMORY_CACHE__=new Map,f("[PuppetModelView] Initialized global GLTF memory cache"));const S=window.__GLTF_MEMORY_CACHE__;function x(){if(v)return;const C=n.value;if(!C){f("[PuppetModelView] Container not ready for Three.js initialization");return}f("[PuppetModelView] Initializing Three.js..."),r=new or,a=new lo(45,1,.1,1e3),a.position.set(0,1,3),i=new rr({antialias:!0,alpha:!0}),i.setPixelRatio(window.devicePixelRatio||1),i.outputColorSpace=Rn,m=new ds,m.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),m.setCrossOrigin("anonymous"),f("[PuppetModelView] Draco loader initialized:",!!m),C.innerHTML="",C.appendChild(i.domElement);const F=new ir(16777215,1.2),V=new kn(16777215,1.5);V.position.set(3,5,2);const O=new kn(16777215,.8);O.position.set(-2,3,4);const ae=new vs(16777215,1,10);ae.position.set(0,2,3),r.add(F,V,O,ae);const ee=()=>{if(!C||!i)return;let L=C.clientWidth,Q=C.clientHeight;if(!L||!Q){const we=C.getBoundingClientRect();if(L=we.width||200,Q=we.height||200,!we.width||!we.height){requestAnimationFrame(ee);return}}i.setSize(L,Q,!0),a.aspect=L/Math.max(1,Q),a.updateProjectionMatrix()};ee(),h=new ResizeObserver(ee),h.observe(C),requestAnimationFrame(()=>{ee(),requestAnimationFrame(()=>{ee(),requestAnimationFrame(ee)})});const q=()=>{if(!i||!r||!a)return;l=requestAnimationFrame(q);const L=d.getDelta();u&&u.update(L),c&&(c.rotation.y+=L*.6),i.render(r,a)};q(),v=!0,f("[PuppetModelView] Three.js initialized successfully, container size:",C.clientWidth,"x",C.clientHeight)}function I(){u&&(u.stopAllAction(),u=null),c&&(r.remove(c),c.traverse(C=>{C.isMesh&&(C.geometry&&C.geometry.dispose(),Array.isArray(C.material)?C.material.forEach(F=>{F.map&&F.map.dispose(),F&&F.dispose&&F.dispose()}):C.material&&(C.material.map&&C.material.map.dispose(),C.material.dispose&&C.material.dispose()))}),c=null)}function R(C){const F=new kt().setFromObject(C),V=new Pe,O=new Pe;F.getSize(V),F.getCenter(O),C.position.sub(O),C.position.add(new Pe(0,0,0)),C.scale.multiplyScalar(.8);const ee=i==null?void 0:i.domElement,q=ee?ee.clientWidth||ee.width:200,L=ee?ee.clientHeight||ee.height:200,Q=Math.max(1e-6,q/Math.max(1,L)),we=a.fov*(Math.PI/180),ye=2*Math.atan(Math.tan(we/2)*Q),Y=1.05,ve=V.y/2/Math.tan(we/2),Ge=V.x/2/Math.tan(ye/2),ue=Y*Math.max(ve,Ge,.1);a.position.set(0,0,ue),a.lookAt(0,0,0)}async function E(C){var O;if(!C)return;f("[PuppetModelView] Loading puppet:",C.name),o.value=!0,x(),I();const F=++_;f("[PuppetModelView] ");let V=C.modelUrl||"";if(f("[PuppetModelView] Original modelUrl:",V),f("[PuppetModelView] Puppet image:",C.image),f("[PuppetModelView] Puppet name:",C.name),f("[PuppetModelView] Puppet data:",C),!V||V.trim()===""){f("[PuppetModelView] No model URL found");return}f("[PuppetModelView] Final Model URL:",V);try{f("[PuppetModelView] Starting to load:",V),f("[PuppetModelView] Cache status:",Mt.getCacheStatus());const ae=await Mt.loadModel(V);if(f("[PuppetModelView] Model loaded from cache manager:",ae),F!==_){f("[PuppetModelView] Ignoring outdated load result for:",C.name),gltf&&gltf.scene&&gltf.scene.traverse(ee=>{ee.isMesh&&(ee.geometry&&ee.geometry.dispose(),Array.isArray(ee.material)?ee.material.forEach(q=>{q.map&&q.map.dispose(),q.dispose&&q.dispose()}):ee.material&&(ee.material.map&&ee.material.map.dispose(),ee.material.dispose&&ee.material.dispose()))});return}if(f("[PuppetModelView] Applying model for:",C.name),!r){f("[PuppetModelView] Scene not ready, initializing..."),x();let ee=0;for(;!r&&ee<40;)await new Promise(q=>setTimeout(q,50)),ee++;if(!r){f("[PuppetModelView] Scene initialization timeout");return}}if(c=ae,!c){f("[PuppetModelView] No model instance received");return}r.add(c),R(c),f("[PuppetModelView] Model loaded successfully:",C.name,"Scene children:",r.children.length),o.value=!1}catch(ae){if(f("[PuppetModelView] Load failed:",ae),f("[PuppetModelView] Failed URL:",V),f("[PuppetModelView] Puppet data:",C),typeof(ae==null?void 0:ae.message)=="string"&&ae.message.includes("DRACOLoader")){f("[PuppetModelView] Retrying without Draco decoder...");try{const ee=new us;ee.setCrossOrigin("anonymous");const q=await ee.loadAsync(V);if(F===_&&(c=q.scene||((O=q.scenes)==null?void 0:O[0]),c)){r.add(c),q.animations&&q.animations.length&&(u=new pd(c),u.clipAction(q.animations[0]).play()),R(c),f("[PuppetModelView] Model loaded successfully without Draco:",C.name);return}}catch(ee){f("[PuppetModelView] Fallback load also failed:",ee)}}if(F===_){const ee=new Yt(1,1,1),q=new Gt({color:8947967});c=new rt(ee,q),r.add(c),R(c)}o.value=!1}}lt(()=>s.puppet,async C=>{await hn(),E(C)},{immediate:!1}),et(()=>{f("[PuppetModelView] Component mounted"),hn(()=>{n.value&&(x(),s.puppet&&setTimeout(()=>{E(s.puppet)},0))})}),_t(()=>{if(f("[PuppetModelView] Cleaning up..."),cancelAnimationFrame(l),I(),h&&n.value)try{h.unobserve(n.value)}catch{}const C=r,F=i;i=null,r=null,a=null,v=!1,_=0;const V=()=>{if(f("[PuppetModelView] Starting deferred cleanup..."),C&&C.traverse(O=>{if(O.isMesh)try{if(O.geometry&&O.geometry.dispose(),Array.isArray(O.material))O.material.forEach(ae=>{try{ae.map&&ae.map.dispose(),ae.dispose&&ae.dispose()}catch{}});else if(O.material)try{O.material.map&&O.material.map.dispose(),O.material.dispose&&O.material.dispose()}catch{}}catch{}}),F)try{F.dispose(),F.forceContextLoss&&F.forceContextLoss()}catch{}f("[PuppetModelView] Deferred cleanup completed")};typeof window<"u"&&window.requestIdleCallback?window.requestIdleCallback(V,{timeout:1e3}):setTimeout(V,100),f("[PuppetModelView] Quick cleanup completed, heavy cleanup deferred")});const T={props:s,mountEl:n,isLoading:o,get renderer(){return i},set renderer(C){i=C},get scene(){return r},set scene(C){r=C},get camera(){return a},set camera(C){a=C},get animationId(){return l},set animationId(C){l=C},get currentModel(){return c},set currentModel(C){c=C},get currentMixer(){return u},set currentMixer(C){u=C},get clock(){return d},set clock(C){d=C},get resizeObserver(){return h},set resizeObserver(C){h=C},get dracoLoader(){return m},set dracoLoader(C){m=C},get loadSequence(){return _},set loadSequence(C){_=C},get isInitialized(){return v},set isInitialized(C){v=C},gltfMemoryCache:S,initThreeIfNeeded:x,clearCurrentModel:I,fitCameraToObject:R,loadPuppetModel:E,get log(){return f},ref:U,watch:lt,onMounted:et,onBeforeUnmount:_t,nextTick:hn,get THREE(){return ar},get GLTFLoader(){return us},get DRACOLoader(){return ds},get modelCache(){return Mt}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}},Jm={class:"model-wrapper"},Zm={ref:"mountEl",class:"model-canvas"},Qm={key:0,class:"model-loading"};function eg(t,e,s,n,o,i){return D(),W("div",Jm,[p("div",Zm,null,512),n.isLoading?(D(),W("div",Qm,[...e[0]||(e[0]=[p("div",{class:"loading-spinner"},null,-1)])])):Me("",!0)])}const tg=yt(Ym,[["render",eg],["__scopeId","data-v-c3e07470"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/PuppetModelView.vue"]]),ng={__name:"Warehouse",props:{musicOn:{type:Boolean,default:!0}},setup(t,{expose:e}){Kt(ue=>({"58eda787-warehouseBgSrc":ye,"58eda787-panel5Src":we,"58eda787-panel2Src":q,"58eda787-panel3Src":L,"58eda787-panel4Src":Q}));const s=t,n=["SpiritalSpark","RecallGear","ResonantCrystal","RefinedCopper","HeartCrystalDust"];function o(ue){return n.map(A=>({icon:In[A].icon,name:In[A].name,value:Number((ue==null?void 0:ue[A])??0)}))}const i={IronWall:"",Arcanist:"",CraftsMan:"",Mechanic:"",Resonator:""};function r(ue){const A=Number(ue??1);return A===1?5:A===2?10:A===3?20:A===4?30:0}function a(ue){return(ue||[]).map((A,de)=>{var G,K,J,X,B,me;const $=(A==null?void 0:A.copper_info)||{},ce=($==null?void 0:$.skill)||{},pe=(A==null?void 0:A.equipment_slot)||{},He=(pe==null?void 0:pe.slot1)||null,De=(pe==null?void 0:pe.slot2)||null,Ke=(A==null?void 0:A.attribute)||{},Ve=((G=He==null?void 0:He.equipment_base)==null?void 0:G.attribute)||{},st=((K=De==null?void 0:De.equipment_base)==null?void 0:K.attribute)||{},at=Number(Ve.attack||0)+Number(st.attack||0),Lt=Number(Ve.defense||0)+Number(st.defense||0),g=Number(Ve.dodge||0)+Number(st.dodge||0),b=A==null?void 0:A.copper_type,k=(A==null?void 0:A.level)??1,z=($==null?void 0:$.model_url)||"",j=z?H(z):"";return{id:Number((A==null?void 0:A.id)??de+1),name:($==null?void 0:$.name)??"",level:k,suffix:(A==null?void 0:A.suffix)??0,image:H(($==null?void 0:$.icon_url)||""),modelUrl:j,quantity:1,description:($==null?void 0:$.description)||"",stats:{level:`${k}/5`,health:Number(Ke.health||0),live_left:Number((A==null?void 0:A.live_left)??0),attack:{base:Number(Ke.attack||0),bonus:at},defense:{base:Number(Ke.defense||0),bonus:Lt},dodge:{base:Number(Ke.dodge||0),bonus:g},class:i[b]||""},equipment:[He?{name:((J=He.equipment_base)==null?void 0:J.name)||"",icon:H(((X=He.equipment_base)==null?void 0:X.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},pe!=null&&pe.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:De?{name:((B=De.equipment_base)==null?void 0:B.name)||"",icon:H(((me=De.equipment_base)==null?void 0:me.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}],skill:{name:(ce==null?void 0:ce.name)||"",cooldown:(ce==null?void 0:ce.cool_down)!=null?`${ce.cool_down}`:"",effect:(ce==null?void 0:ce.description)||"",icon:H((ce==null?void 0:ce.resource_url)||"")},upgradeCost:r(k)}})}function l(ue,A,de=[]){if(!ue||typeof ue!="object")return null;if(Object.prototype.hasOwnProperty.call(ue,A))return[...de,A];if(Array.isArray(ue)){for(let $=0;$<ue.length;$++){const ce=l(ue[$],A,[...de,$]);if(ce)return ce}return null}for(const $ of Object.keys(ue)){const ce=l(ue[$],A,[...de,$]);if(ce)return ce}return null}function c(ue,A){return A.reduce((de,$)=>de!=null?de[$]:void 0,ue)}const u=U([]);async function d(){try{const ue=await Vn();ue&&(u.value=o(ue))}catch(ue){console.error("[Warehouse] :",ue),u.value=o({})}}et(()=>{d(),Bn(vt.UPDATE_RESOURCES,d)});function h(ue){let A=ue;if(typeof ue=="string")try{A=JSON.parse(ue)}catch{}A&&A.type_msg&&(A.type_msg==="upgrade_cost_error"?alert(A.content||""):f("[GlobalInfo]",A))}et(()=>{try{nr(h)}catch{}s.musicOn&&Y.value&&setTimeout(()=>{if(Y.value.readyState>=2)Y.value.play().then(()=>{f("[Warehouse] ")}).catch(A=>{f("[Warehouse] :",A)});else{const A=()=>{Y.value.play().then(()=>{f("[Warehouse] ")}).catch(de=>{f("[Warehouse] :",de)}),Y.value.removeEventListener("canplay",A)};Y.value.addEventListener("canplay",A,{once:!0})}},200)}),lt(()=>s.musicOn,ue=>{if(Y.value)if(ue)if(Y.value.readyState>=2)Y.value.play().catch(A=>{f("[Warehouse] :",A)});else{const A=()=>{Y.value.play().catch(de=>{f("[Warehouse] :",de)}),Y.value.removeEventListener("canplay",A)};Y.value.addEventListener("canplay",A)}else Y.value.pause()}),_t(()=>{Y.value&&Y.value.pause(),cs(vt.UPDATE_RESOURCES,d)});const m=U([]);et(async()=>{try{const ue=await ws();let A=ue&&Array.isArray(ue.coppers)?ue.coppers:[];if(!Array.isArray(A)){const de=l(ue,"coppers");if(f("[Warehouse] copper key path:",de),de){const $=c(ue,de);f("[Warehouse] copper found by path:",$),Array.isArray($)&&(A=$)}!Array.isArray(A)&&ue&&ue.entries&&f("[Warehouse] copper entries sample:",ue.entries)}Array.isArray(A)||f("[Warehouse] copper list not array"),m.value=a(A),Array.isArray(m.value)&&m.value.length>0&&(_.value=m.value[0]),!_.value&&Array.isArray(m.value)&&m.value.length>0&&(_.value=m.value[0])}catch{m.value=[]}});const _=U(null),v=U([]),S=U(null),x=U(null),I=U(null);function R(ue,A){ue&&(v.value[A]=ue)}async function E(ue,A){_.value=ue,await hn();const de=v.value[A];if(de&&typeof de.scrollIntoView=="function"&&de.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),S.value=A,x.value)try{x.value.scrollTo({top:0,behavior:"smooth"})}catch{x.value.scrollTop=0}setTimeout(()=>{S.value===A&&(S.value=null)},320)}const T=U(!1);function C(){T.value=!0}function F(){T.value=!1}function V(){const ue=Math.max(0,u.value.length-1),A=u.value;if(!A[ue]||A[ue].value<10){alert("");return}A[ue].value-=10;const de=m.value,$=Math.floor(Math.random()*de.length),ce=de[$];ce.quantity=(ce.quantity||0)+1,_.value=ce,drawResult.value={name:ce.name,image:ce.image}}function O(){return T.value?(T.value=!1,!0):!1}e({handleBack:O});async function ae(ue){try{await d();const A=await ws(),de=Array.isArray(A==null?void 0:A.coppers)?A.coppers:[];m.value=a(de)}catch{}}async function ee(){if(!_.value)return;if(Number(_.value.level||0)>=5){alert("");return}const ue=_.value.id,A=await fl(ue);if(!A||A.type!=="success"){alert(A&&A.content?A.content:"");return}try{await d();const de=await ws(),$=Array.isArray(de==null?void 0:de.coppers)?de.coppers:[];m.value=a($);const ce=m.value.find(pe=>pe.id===ue);ce&&(_.value=ce)}catch{}}const q=`url('${H("@assets/ui/panel2.png")}')`,L=`url('${H("@assets/ui/panel3.png")}')`,Q=`url('${H("@assets/ui/panel4.png")}')`,we=`url('${H("@assets/ui/panel5.png")}')`,ye=`url('${H("@assets/frontend_resource/Gemini_Generated_Image_e03q5oe03q5oe03q.png")}')`,Y=U(null),Ge={props:s,ORDERED_RESOURCE_KEYS:n,mapResources:o,TYPE_MAP:i,getUpgradeCostByLevel:r,mapPuppets:a,findKeyPath:l,getByPath:c,resources:u,updateResources:d,handleGlobalInfo:h,puppets:m,selectedPuppet:_,puppetItemRefs:v,highlightedIndex:S,detailWrap:x,hoveredIndex:I,setPuppetItemRef:R,selectPuppet:E,showDrawScreen:T,drawMore:C,closeDrawScreen:F,drawTen:V,handleBack:O,onGachaResult:ae,upgradeSelected:ee,panel2Src:q,panel3Src:L,panel4Src:Q,panel5Src:we,warehouseBgSrc:ye,audioRef:Y,musicUrl:"/assets/warehouse.mp3",get log(){return f},ref:U,onMounted:et,onBeforeUnmount:_t,watch:lt,nextTick:hn,get getAssetUrl(){return H},get RESOURCE_META(){return In},DrawScreen:pm,PuppetModelView:tg,get get_resource(){return Vn},get get_copper_list(){return ws},get upgrade_copper(){return fl},get info_subscribe(){return nr},get onEvent(){return Bn},get offEvent(){return cs},get EventTypes(){return vt}};return Object.defineProperty(Ge,"__isScriptSetup",{enumerable:!1,value:!0}),Ge}},sg={class:"warehouse"},og={class:"warehouse__resources"},rg={class:"resource-icon"},ig=["src","alt"],ag={class:"resource-value"},lg={class:"resource-tooltip"},cg={key:0,class:"warehouse__main"},ug={class:"warehouse__sidebar"},dg={class:"puppet-list"},fg=["onClick","onMouseenter"],pg={class:"puppet-card__quantity"},hg={class:"puppet-card__image"},mg=["src","alt"],gg={class:"puppet-card__info"},_g={class:"puppet-card__name"},yg={class:"puppet-card__level"},vg={class:"warehouse__detail",ref:"detailWrap"},bg={class:"puppet-detail__header"},wg={class:"puppet-detail__name"},Sg={class:"puppet-detail__content"},Mg={class:"puppet-detail__row"},Tg={class:"puppet-detail__model"},Cg={class:"puppet-detail__description"},Eg={class:"puppet-detail__row"},xg={class:"puppet-detail__stats"},Ag={class:"stats-section"},kg={class:"stat-item"},Rg={class:"stat-value"},Pg={class:"stat-item"},Ig={class:"stat-value"},Og={class:"stat-item"},Lg={class:"stat-value"},Dg={class:"stat-item"},Ng={class:"stat-value"},$g={class:"stat-item"},Gg={class:"stat-value"},Hg={class:"stat-item"},Ug={class:"stat-value"},Fg={class:"stat-item"},jg={class:"stat-value"},Bg={class:"equipment-section"},Vg={class:"equipment-slots"},zg=["src","alt"],Wg=["src"],qg=["src"],Kg={key:3,class:"equipment-icon"},Xg={key:0,class:"skill-section"},Yg={class:"skill-info"},Jg={class:"skill-text"},Zg={class:"skill-name"},Qg={class:"skill-cooldown"},e_={class:"skill-effect"},t_={class:"skill-icon"},n_=["src","alt"],s_={key:1},o_={class:"puppet-detail__upgrade"},r_={class:"upgrade-cost"},i_=["src"],a_={class:"cost-amount"},l_=["disabled"],c_=["src"],u_={class:"warehouse__placeholder",key:"placeholder"},d_=["src"];function f_(t,e,s,n,o,i){return D(),W("div",sg,[p("div",og,[(D(!0),W(Je,null,qt(n.resources,r=>(D(),W("div",{class:"resource-item",key:r.name},[p("div",rg,[p("img",{src:r.icon,alt:r.name},null,8,ig)]),p("div",ag,se(r.value),1),p("div",lg,se(r.name),1)]))),128))]),n.showDrawScreen?Me("",!0):(D(),W("div",cg,[p("div",ug,[e[2]||(e[2]=p("div",{class:"warehouse__title"},"",-1)),p("div",dg,[(D(!0),W(Je,null,qt(n.puppets,(r,a)=>{var l;return D(),W("div",{class:Qe(["puppet-card",{"puppet-card--selected":((l=n.selectedPuppet)==null?void 0:l.id)===r.id,"puppet-card--pulse":n.highlightedIndex===a,"puppet-card--hover":n.hoveredIndex===a}]),key:r.id,ref_for:!0,ref:c=>n.setPuppetItemRef(c,a),onClick:c=>n.selectPuppet(r,a),onMouseenter:c=>n.hoveredIndex=a,onMouseleave:e[0]||(e[0]=c=>n.hoveredIndex=null)},[p("div",pg,se(r.level),1),p("div",hg,[p("img",{src:r.image,alt:r.name},null,8,mg)]),p("div",gg,[p("div",_g,se(r.name)+se(r.suffix),1),p("div",yg,se(r.level)+"",1)])],42,fg)}),128)),p("div",{class:"puppet-card puppet-card--add",onClick:n.drawMore},[...e[1]||(e[1]=[p("div",{class:"puppet-card__add-icon"},"+",-1),p("div",{class:"puppet-card__add-text"},"",-1)])])])]),p("div",vg,[it(ch,{name:"fade-slide",mode:"out-in"},{default:Cc(()=>{var r,a,l,c;return[n.selectedPuppet?(D(),W("div",{class:"puppet-detail",key:((r=n.selectedPuppet)==null?void 0:r.id)||"none"},[p("div",bg,[p("h2",wg,se(n.selectedPuppet.name),1)]),p("div",Sg,[p("div",Mg,[p("div",Tg,[it(n.PuppetModelView,{puppet:n.selectedPuppet},null,8,["puppet"])]),p("div",Cg,se(n.selectedPuppet.description),1)]),p("div",Eg,[p("div",xg,[p("div",Ag,[p("div",kg,[e[3]||(e[3]=p("span",{class:"stat-label"},":",-1)),p("span",Rg,se(n.selectedPuppet.stats.health),1)]),p("div",Pg,[e[4]||(e[4]=p("span",{class:"stat-label"},":",-1)),p("span",Ig,se(n.selectedPuppet.stats.level),1)]),p("div",Og,[e[5]||(e[5]=p("span",{class:"stat-label"},":",-1)),p("span",Lg,se(n.selectedPuppet.stats.live_left),1)]),p("div",Dg,[e[6]||(e[6]=p("span",{class:"stat-label"},":",-1)),p("span",Ng,se(n.selectedPuppet.stats.attack.base),1)]),p("div",$g,[e[7]||(e[7]=p("span",{class:"stat-label"},":",-1)),p("span",Gg,se(n.selectedPuppet.stats.defense.base),1)]),p("div",Hg,[e[8]||(e[8]=p("span",{class:"stat-label"},":",-1)),p("span",Ug,se(n.selectedPuppet.stats.dodge.base)+"% ",1)]),p("div",Fg,[e[9]||(e[9]=p("span",{class:"stat-label"},":",-1)),p("span",jg,se(n.selectedPuppet.stats.class),1)])])]),p("div",Bg,[e[10]||(e[10]=p("h4",{class:"section-title"},"",-1)),p("div",Vg,[(D(!0),W(Je,null,qt(n.selectedPuppet.equipment,(u,d)=>(D(),W("div",{key:d,class:Qe(["equipment-slot",{"equipment-slot--empty":!u.equipped&&!u.locked,"equipment-slot--locked":u.locked}])},[u.equipped&&u.icon&&(u.icon.startsWith("/")||u.icon.startsWith("http"))?(D(),W("img",{key:0,src:u.icon,alt:u.name,class:"equipment-icon"},null,8,zg)):u.locked?(D(),W("img",{key:1,src:n.getAssetUrl("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,Wg)):u.icon===""?(D(),W("img",{key:2,src:n.getAssetUrl("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,qg)):(D(),W("span",Kg,se(u.icon),1))],2))),128))])])]),((l=(a=n.selectedPuppet)==null?void 0:a.stats)==null?void 0:l.class)!==""?(D(),W("div",Xg,[e[11]||(e[11]=p("h4",{class:"section-title"},"",-1)),p("div",Yg,[p("div",Jg,[p("div",Zg,se(n.selectedPuppet.skill.name),1),p("div",Qg," : "+se(n.selectedPuppet.skill.cooldown),1),p("div",e_,se(n.selectedPuppet.skill.effect),1)]),p("div",t_,[n.selectedPuppet.skill.icon&&(n.selectedPuppet.skill.icon.startsWith("/")||n.selectedPuppet.skill.icon.startsWith("http"))?(D(),W("img",{key:0,src:n.selectedPuppet.skill.icon,alt:n.selectedPuppet.skill.name,class:"skill-icon-img"},null,8,n_)):(D(),W("span",s_,se(n.selectedPuppet.skill.icon),1))])])])):Me("",!0)]),p("div",o_,[p("div",r_,[n.selectedPuppet.level<5?(D(),W("img",{key:0,src:n.RESOURCE_META.SpiritalSpark.icon,alt:"",class:"cost-icon-img"},null,8,i_)):Me("",!0),p("span",a_,se(n.selectedPuppet.level>=5?"":"X "+n.selectedPuppet.upgradeCost),1)]),p("button",{class:"upgrade-btn",onClick:n.upgradeSelected,disabled:((c=n.selectedPuppet)==null?void 0:c.level)>=5},[p("img",{src:n.getAssetUrl("@assets/ui/upgrade.png"),class:"upgrade-icon",alt:""},null,8,c_)],8,l_)])])):(D(),W("div",u_,[...e[12]||(e[12]=[p("p",null,"",-1)])]))]}),_:1})],512)])),n.showDrawScreen?(D(),Ht(n.DrawScreen,{key:1,onDraw:n.onGachaResult})):Me("",!0),p("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,d_)])}const p_=yt(ng,[["render",f_],["__scopeId","data-v-58eda787"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/Warehouse.vue"]]),h_={__name:"TopLeftPanel",props:{musicOn:{type:Boolean,default:!0}},emits:["back","open-settings","toggle-music"],setup(t,{expose:e,emit:s}){e();const o={emit:s};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}},m_={class:"panel",style:{left:"24px",right:"auto"}},g_=["title"],__={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y_={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v_={class:"sr-only"};function b_(t,e,s,n,o,i){return D(),W("div",m_,[p("button",{class:"btn",onClick:e[0]||(e[0]=r=>t.$emit("back")),title:""},[...e[3]||(e[3]=[p("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[p("path",{d:"M15 18L9 12L15 6",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),p("span",{class:"sr-only"},"",-1)])]),p("button",{class:"btn",onClick:e[1]||(e[1]=r=>t.$emit("toggle-music")),title:s.musicOn?"":""},[s.musicOn?(D(),W("svg",__,[...e[4]||(e[4]=[p("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),p("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1)])])):(D(),W("svg",y_,[...e[5]||(e[5]=[p("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),p("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("line",{x1:"2",y1:"2",x2:"22",y2:"22",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),p("span",v_,se(s.musicOn?"":""),1)],8,g_),p("button",{class:"btn",onClick:e[2]||(e[2]=r=>t.$emit("open-settings")),title:""},[...e[6]||(e[6]=[p("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[p("path",{d:"M12 15.5C13.933 15.5 15.5 13.933 15.5 12C15.5 10.067 13.933 8.5 12 8.5C10.067 8.5 8.5 10.067 8.5 12C8.5 13.933 10.067 15.5 12 15.5Z",stroke:"#ffffff","stroke-width":"2"}),p("path",{d:"M19.4 15A7.964 7.964 0 0 0 20 12C20 11.49 19.95 10.99 19.86 10.5L22 8.5L20 5.5L17.34 6.07C16.78 5.58 16.14 5.18 15.44 4.9L15 2H9L8.56 4.9C7.86 5.18 7.22 5.58 6.66 6.07L4 5.5L2 8.5L4.14 10.5C4.05 10.99 4 11.49 4 12C4 12.51 4.05 13.01 4.14 13.5L2 15.5L4 18.5L6.66 17.93C7.22 18.42 7.86 18.82 8.56 19.1L9 22H15L15.44 19.1C16.14 18.82 16.78 18.42 17.34 17.93L20 18.5L22 15.5L19.86 13.5C19.95 13.01 20 12.51 20 12",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),p("span",{class:"sr-only"},"",-1)])])])}const w_=yt(h_,[["render",b_],["__scopeId","data-v-fb6ccffd"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/TopLeftPanel.vue"]]),S_=["automatic_loading_gun","charging_coil","heart_source_mineral_drill","mirro_light_refraction_tower","repair_workshop","resonance_alarm_bell","rivet_barrier","steam_mining_car","storm_anvil"];function M_(){const t=[],e=[{type:"arcanist",name:"bubble"},{type:"craftsman",name:"coil"},{type:"iron_wall",name:"bell"},{type:"mechanic",name:"gyro"},{type:"resonator",name:"clawster"}];for(const n of e){const o=io(n.type,n.name);t.push(o)}const s=["goblin","guard","demon"];for(const n of s){const o=ao(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function T_(){const t=[],e=[{type:"arcanist",name:"glimmer"},{type:"arcanist",name:"spark"},{type:"craftsman",name:"artifex"},{type:"craftsman",name:"wrench"},{type:"iron_wall",name:"chief"},{type:"iron_wall",name:"rocky"},{type:"mechanic",name:"karin"},{type:"mechanic",name:"tricky"},{type:"resonator",name:"diggs"},{type:"resonator",name:"hive"}];for(const n of e){const o=io(n.type,n.name);t.push(o)}const s=["assassin","boxer","cruiser","devourer","glutton"];for(const n of s){const o=ao(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function C_(){const t=[],e=[{type:"arcanist",name:"syrup"},{type:"arcanist",name:"turner"},{type:"craftsman",name:"drillbit"},{type:"craftsman",name:"quickhand"},{type:"iron_wall",name:"tumble"},{type:"iron_wall",name:"wesley"},{type:"mechanic",name:"pendulum"},{type:"mechanic",name:"yoyo"},{type:"resonator",name:"melody"},{type:"resonator",name:"murmur"}];for(const n of e){const o=io(n.type,n.name);t.push(o)}const s=["horn","mirror","scout","shatra","variant"];for(const n of s){const o=ao(n);t.push(o)}for(const n of S_){const o=_i(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function E_(t=["high","medium"]){const e=[];for(const n of t)switch(n){case"high":e.push(...M_());break;case"medium":e.push(...T_());break;case"low":e.push(...C_());break}const s=[...new Set(e)];return f(`[ModelPreloadConfig]  ${t.join(", ")}  ${s.length} URL`),s}class x_{constructor(){this.isPreloading=!1,this.preloadProgress=0,this.preloadCallbacks=[]}async startPreload(e=["high","medium"],s=null){if(this.isPreloading){f("[ModelPreloadManager] ");return}this.isPreloading=!0,this.preloadProgress=0;try{const n=E_(e);f(`[ModelPreloadManager]  ${n.length}  (: ${e.join(", ")})`),s&&this.preloadCallbacks.push(s),await Mt.preloadModels(n,(o,i,r)=>{this.preloadProgress=r,this.notifyProgress(o,i,r)}),f("[ModelPreloadManager] ")}catch(n){f("[ModelPreloadManager] :",n)}finally{this.isPreloading=!1,this.preloadCallbacks=[]}}notifyProgress(e,s,n){this.preloadCallbacks.forEach(o=>{try{o(e,s,n)}catch(i){f("[ModelPreloadManager] :",i)}})}getStatus(){return{isPreloading:this.isPreloading,progress:this.preloadProgress,cacheStatus:Mt.getCacheStatus()}}isModelPreloaded(e){return Mt.isPreloaded(e)}async preloadModel(e){try{await Mt.loadModel(e,!0),f(`[ModelPreloadManager] : ${e}`)}catch(s){f(`[ModelPreloadManager] : ${e}`,s)}}async preloadModels(e){const s=e.map(n=>this.preloadModel(n));await Promise.all(s),f(`[ModelPreloadManager] : ${e.length} `)}}const Vr=new x_,Mu="mgpic_game_settings",bl={controlMode:"touchpad",mouseSensitivity:.002};function Ps(){try{const t=localStorage.getItem(Mu);if(t){const e=JSON.parse(t);return{...bl,...e}}}catch(t){console.error("[GameSettings] :",t)}return{...bl}}function A_(t){try{return localStorage.setItem(Mu,JSON.stringify(t)),!0}catch(e){return console.error("[GameSettings] :",e),!1}}function zr(t){return Ps()[t]}function sr(t,e){const s=Ps();return s[t]=e,A_(s)}const k_={__name:"StartMenu",props:{visible:{type:Boolean,default:!0}},emits:["started"],setup(t,{expose:e,emit:s}){e(),Kt(L=>({"00070bd8-panel5Src":S}));const n=t,o=U(null);let i=null,r=null,a=null,l=null,c=null,u=1.2;const d=U(!1),h=U(!1),m=U(!1),_=U("touchpad"),v=U(H("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),S=`url('${H("@assets/ui/panel4.png")}')`,x=s;lt(()=>n.visible,L=>{L&&i&&c?T():L||E()});function I(){if(l=requestAnimationFrame(I),c){const L=Date.now()*.001;c.position.y=Math.sin(L*.8)*.1,c.rotation.y=Math.sin(L*.6)*.1;const Q=u+Math.sin(L*1.2)*.04;c.scale.setScalar(Q)}a&&a.render(i,r)}function R(){!a||!r||(r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight))}function E(){l&&(cancelAnimationFrame(l),l=null),a&&a.setAnimationLoop(null)}function T(){l||I()}function C(){try{E()}catch{}try{window.removeEventListener("resize",R)}catch{}try{i&&(i.traverse(L=>{if(L.isMesh){L.geometry&&L.geometry.dispose&&L.geometry.dispose();const Q=L.material;Array.isArray(Q)?Q.forEach(we=>we&&we.dispose&&we.dispose()):Q&&Q.dispose&&Q.dispose()}}),i.clear())}catch{}try{if(a){a.clear(!0,!0,!0),a.dispose();const L=a.getContext&&a.getContext(),Q=L&&L.getExtension&&L.getExtension("WEBGL_lose_context");Q&&Q.loseContext&&Q.loseContext()}}catch{}i=null,r=null,a=null,c=null}async function F(L=null){try{window.getAssetUrl=H,window.precacheAllResources=er,window.getCacheStatus=il}catch{}if(!i||!a){f("[StartMenu] Scene or renderer not initialized in onMounted");return}if(L&&L(0,100,20),!i.children.some(ye=>ye.isLight)){const ye=new ir(4210752,.4);i.add(ye);const Y=new kn(16777215,12.5);Y.position.set(-5,-2,1),i.add(Y)}L&&L(0,100,50);const we=H("logo.glb");try{L&&L(0,100,60),f("[StartMenu] Logo...");const ye=await Mt.loadModel(we,!0);L&&L(0,100,80),ye.position.set(0,0,0),i.add(ye);const ve=new kt().setFromObject(ye).getCenter(new Pe);ye.position.set(-ve.x,-ve.y,-ve.z-.3);try{ye.scale.setScalar(u)}catch{}c=ye,L&&L(0,100,80),f("[StartMenu] Logo ...");try{await Vr.startPreload(["high","medium"],(Ge,ue,A)=>{const de=80+A*.15;L&&L(0,100,Math.round(de)),f(`[StartMenu] : ${Ge}/${ue} (${A}%)`)}),f("[StartMenu] ")}catch(Ge){f("[StartMenu] :",Ge)}L&&L(0,100,100),d.value=!0,f("[StartMenu] "),h.value=!0}catch(ye){f("[StartMenu] 3D",ye);const Y=new Yt(1,1,1),ve=new Pt({color:16096779}),Ge=new rt(Y,ve);i.add(Ge),c=Ge,f("[StartMenu] ...");try{await Vr.startPreload(["high","medium"],(ue,A,de)=>{const $=80+de*.15;L&&L(0,100,Math.round($)),f(`[StartMenu] : ${ue}/${A} (${de}%)`)}),f("[StartMenu] ")}catch(ue){f("[StartMenu] :",ue)}L&&L(0,100,100),d.value=!0,f("[StartMenu] "),h.value=!0}window.__START_MENU_PAUSE__=()=>E(),window.__START_MENU_RESUME__=()=>T()}function V(){x("started"),E()}function O(){const L=Ps();_.value=L.controlMode,m.value=!0}function ae(){m.value=!1}function ee(L){_.value=L,sr("controlMode",L),window.updateControlMode&&window.updateControlMode(L),f(`[StartMenu] : ${L}`)}et(()=>{h.value=!1,d.value=!1,f("[StartMenu] ..."),!i&&o.value?(i=new or,i.background=null,r=new lo(50,window.innerWidth/window.innerHeight,.1,1e3),r.position.set(-3.655,.2,-.006),r.rotation.set(-1.618275,-1.538307,-1.6183,"XYZ"),a=new rr({antialias:!0,alpha:!0,canvas:o.value}),a.setSize(window.innerWidth,window.innerHeight),a.setPixelRatio(window.devicePixelRatio),a.setClearColor(0,0),window.addEventListener("resize",R),I(),f("[StartMenu] ")):i&&!c?f("[StartMenu] "):c&&(f("[StartMenu] Logo"),h.value=!0,d.value=!0),window.__INIT_THREE_SCENE__=async L=>{if(i&&c){f("[StartMenu] Logo"),h.value=!0,d.value=!0;return}f("[StartMenu] 3D..."),await F(L)}}),_t(()=>{C()});const q={props:n,canvasRef:o,get scene(){return i},set scene(L){i=L},get camera(){return r},set camera(L){r=L},get renderer(){return a},set renderer(L){a=L},get animationId(){return l},set animationId(L){l=L},get logoObject(){return c},set logoObject(L){c=L},get baseScale(){return u},set baseScale(L){u=L},isReady:d,showButtons:h,showSettings:m,controlMode:_,startBg:v,panel5Src:S,emit:x,renderLoop:I,handleResize:R,pause:E,resume:T,destroyScene:C,initScene:F,onStart:V,onOpenSettings:O,onCloseSettings:ae,setControlMode:ee,get log(){return f},onMounted:et,onBeforeUnmount:_t,ref:U,watch:lt,get THREE(){return ar},get getAssetUrl(){return H},get precacheAllResources(){return er},get getCacheStatus(){return il},get modelPreloadManager(){return Vr},get modelCache(){return Mt},get getSettings(){return Ps},get updateSetting(){return sr}};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}},R_={class:"startmenu"},P_={ref:"canvasRef",class:"startmenu__canvas"},I_={key:0,class:"settings-local"},O_={class:"settings-local__card"},L_={class:"settings-local__content"},D_={class:"settings-local__row"},N_={class:"setting-options"};function $_(t,e,s,n,o,i){return D(),W("div",R_,[p("div",{class:"startmenu__bg",style:zt({backgroundImage:`url('${n.startBg}')`})},null,4),p("canvas",P_,null,512),xc(p("div",{class:Qe(["startmenu-ui",{"fade-in":n.showButtons}])},[p("button",{id:"start-btn",class:"startmenu-btn","aria-label":"",onClick:n.onStart},"  "),p("button",{id:"settings-btn",class:"startmenu-btn","aria-label":"",onClick:n.onOpenSettings},"  ")],2),[[mu,n.showButtons]]),n.showSettings?(D(),W("div",I_,[p("div",O_,[p("div",{class:"settings-local__header"},[e[2]||(e[2]=p("div",{class:"settings-local__title"},"",-1)),p("button",{class:"settings-local__close",onClick:n.onCloseSettings,"aria-label":""},"  ")]),p("div",L_,[p("div",D_,[e[5]||(e[5]=p("div",{class:"setting-label"},"",-1)),p("div",N_,[p("button",{class:Qe(["option-btn",{active:n.controlMode==="touchpad"}]),onClick:e[0]||(e[0]=r=>n.setControlMode("touchpad"))},[...e[3]||(e[3]=[p("span",{class:"option-title"},"",-1),p("span",{class:"option-desc"},"",-1)])],2),p("button",{class:Qe(["option-btn",{active:n.controlMode==="mouse"}]),onClick:e[1]||(e[1]=r=>n.setControlMode("mouse"))},[...e[4]||(e[4]=[p("span",{class:"option-title"},"",-1),p("span",{class:"option-desc"},"",-1)])],2)])])])])])):Me("",!0)])}const G_=yt(k_,[["render",$_],["__scopeId","data-v-00070bd8"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/StartMenu.vue"]]),wl={type:"change"},Ui={type:"start"},Tu={type:"end"},To=new gd,Sl=new Vl,H_=Math.cos(70*jl.DEG2RAD),gt=new Pe,Dt=2*Math.PI,Ye={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Wr=1e-6;class Ml extends md{constructor(e,s=null){super(e,s),this.state=Ye.NONE,this.target=new Pe,this.cursor=new Pe,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ss.ROTATE,MIDDLE:Ss.DOLLY,RIGHT:Ss.PAN},this.touches={ONE:bs.ROTATE,TWO:bs.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Pe,this._lastQuaternion=new ks,this._lastTargetPosition=new Pe,this._quat=new ks().setFromUnitVectors(e.up,new Pe(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new fa,this._sphericalDelta=new fa,this._scale=1,this._panOffset=new Pe,this._rotateStart=new Nt,this._rotateEnd=new Nt,this._rotateDelta=new Nt,this._panStart=new Nt,this._panEnd=new Nt,this._panDelta=new Nt,this._dollyStart=new Nt,this._dollyEnd=new Nt,this._dollyDelta=new Nt,this._dollyDirection=new Pe,this._mouse=new Nt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=F_.bind(this),this._onPointerDown=U_.bind(this),this._onPointerUp=j_.bind(this),this._onContextMenu=X_.bind(this),this._onMouseWheel=z_.bind(this),this._onKeyDown=W_.bind(this),this._onTouchStart=q_.bind(this),this._onTouchMove=K_.bind(this),this._onMouseDown=B_.bind(this),this._onMouseMove=V_.bind(this),this._interceptControlDown=Y_.bind(this),this._interceptControlUp=J_.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(wl),this.update(),this.state=Ye.NONE}update(e=null){const s=this.object.position;gt.copy(s).sub(this.target),gt.applyQuaternion(this._quat),this._spherical.setFromVector3(gt),this.autoRotate&&this.state===Ye.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(n)&&isFinite(o)&&(n<-Math.PI?n+=Dt:n>Math.PI&&(n-=Dt),o<-Math.PI?o+=Dt:o>Math.PI&&(o-=Dt),n<=o?this._spherical.theta=Math.max(n,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+o)/2?Math.max(n,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=r!=this._spherical.radius}if(gt.setFromSpherical(this._spherical),gt.applyQuaternion(this._quatInverse),s.copy(this.target).add(gt),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const a=gt.length();r=this._clampDistance(a*this._scale);const l=a-r;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),i=!!l}else if(this.object.isOrthographicCamera){const a=new Pe(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=l!==this.object.zoom;const c=new Pe(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),r=gt.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(To.origin.copy(this.object.position),To.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(To.direction))<H_?this.object.lookAt(this.target):(Sl.setFromNormalAndCoplanarPoint(this.object.up,this.target),To.intersectPlane(Sl,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>Wr||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Wr||this._lastTargetPosition.distanceToSquared(this.target)>Wr?(this.dispatchEvent(wl),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Dt/60*this.autoRotateSpeed*e:Dt/60/60*this.autoRotateSpeed}_getZoomScale(e){const s=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,s){gt.setFromMatrixColumn(s,0),gt.multiplyScalar(-e),this._panOffset.add(gt)}_panUp(e,s){this.screenSpacePanning===!0?gt.setFromMatrixColumn(s,1):(gt.setFromMatrixColumn(s,0),gt.crossVectors(this.object.up,gt)),gt.multiplyScalar(e),this._panOffset.add(gt)}_pan(e,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const o=this.object.position;gt.copy(o).sub(this.target);let i=gt.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*s*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),o=e-n.left,i=s-n.top,r=n.width,a=n.height;this._mouse.x=o/r*2-1,this._mouse.y=-(i/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Dt*this._rotateDelta.x/s.clientHeight),this._rotateUp(Dt*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let s=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Dt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Dt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Dt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Dt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._rotateStart.set(n,o)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panStart.set(n,o)}}_handleTouchStartDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,i=Math.sqrt(n*n+o*o);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),o=.5*(e.pageX+n.x),i=.5*(e.pageY+n.y);this._rotateEnd.set(o,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Dt*this._rotateDelta.x/s.clientHeight),this._rotateUp(Dt*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panEnd.set(n,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,i=Math.sqrt(n*n+o*o);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(e.pageX+s.x)*.5,a=(e.pageY+s.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(e){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId)return!0;return!1}_trackPointer(e){let s=this._pointerPositions[e.pointerId];s===void 0&&(s=new Nt,this._pointerPositions[e.pointerId]=s),s.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const s=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(e){const s=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function U_(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function F_(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function j_(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Tu),this.state=Ye.NONE;break;case 1:const e=this._pointers[0],s=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:s.x,pageY:s.y});break}}function B_(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ss.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=Ye.DOLLY;break;case Ss.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Ye.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Ye.ROTATE}break;case Ss.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Ye.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Ye.PAN}break;default:this.state=Ye.NONE}this.state!==Ye.NONE&&this.dispatchEvent(Ui)}function V_(t){switch(this.state){case Ye.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case Ye.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case Ye.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function z_(t){this.enabled===!1||this.enableZoom===!1||this.state!==Ye.NONE||(t.preventDefault(),this.dispatchEvent(Ui),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(Tu))}function W_(t){this.enabled!==!1&&this._handleKeyDown(t)}function q_(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case bs.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=Ye.TOUCH_ROTATE;break;case bs.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=Ye.TOUCH_PAN;break;default:this.state=Ye.NONE}break;case 2:switch(this.touches.TWO){case bs.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=Ye.TOUCH_DOLLY_PAN;break;case bs.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=Ye.TOUCH_DOLLY_ROTATE;break;default:this.state=Ye.NONE}break;default:this.state=Ye.NONE}this.state!==Ye.NONE&&this.dispatchEvent(Ui)}function K_(t){switch(this._trackPointer(t),this.state){case Ye.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case Ye.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case Ye.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case Ye.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=Ye.NONE}}function X_(t){this.enabled!==!1&&t.preventDefault()}function Y_(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function J_(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Z_={__name:"StartGame",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["confirm","close"],setup(t,{expose:e,emit:s}){e(),Kt($=>({"7da17356-panel1Src":Q,"7da17356-panel3Src":ye,"7da17356-panel9Src":ue,"7da17356-panel10Src":A,"7da17356-panel6Src":Y,"7da17356-panel8Src":Ge,"7da17356-panel2Src":we,"7da17356-panel7Src":ve}));const n=s,o=t,i=U(!0),r=U(""),a=U([]),l=U(new Set),c=U(null),u=U(null),d=H("@assets/frontend_resource/startgame.mp3");let h,m,_,v,S;const x=new Map,I=Ee(()=>l.value.size===3),R=Ee(()=>a.value.filter($=>l.value.has($.id)));function E(){if(!c.value)return;h=new or,h.background=new gn(1710618),m=new lo(45,c.value.clientWidth/c.value.clientHeight,.1,100),m.position.set(0,3,8),_=new rr({antialias:!0}),_.setSize(c.value.clientWidth,c.value.clientHeight),_.setPixelRatio(window.devicePixelRatio),c.value.appendChild(_.domElement),v=new Ml(m,_.domElement),v.enableDamping=!0,v.dampingFactor=.05,v.target.set(0,1,0);const $=new ir(16777215,.5);h.add($);const ce=new kn(16777215,1);ce.position.set(0,5,10),h.add(ce);const pe=new kn(11193599,.4);pe.position.set(-5,3,5),h.add(pe);const He=new kn(16764074,.4);He.position.set(5,3,5),h.add(He);const De=new kn(16777215,.3);De.position.set(0,5,-5),h.add(De);const Ke=new Lo(20,20),Ve=new Gt({color:2763306,side:Un}),st=new rt(Ke,Ve);st.rotation.x=-Math.PI/2,st.position.y=0,h.add(st),S=new us;const at=new ds;at.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),S.setDRACOLoader(at),T(),window.addEventListener("resize",C)}function T(){requestAnimationFrame(T),v&&v.update(),_&&h&&m&&_.render(h,m)}function C(){!c.value||!m||!_||(m.aspect=c.value.clientWidth/c.value.clientHeight,m.updateProjectionMatrix(),_.setSize(c.value.clientWidth,c.value.clientHeight))}function F($){const ce=l.value;if(ce.has($))ce.delete($);else{if(ce.size>=3)return;ce.add($)}l.value=new Set(ce)}async function V($,ce){if(!h||!S)return;let pe=$.modelUrl;f(`[StartGame] model_url: ${$.name}, URL: ${pe}`);try{const He=await Mt.loadModel(pe,!0);f(`[StartGame] : ${$.name}`);const Ke=new kt().setFromObject(He).getSize(new Pe),Ve=new Jt;Ve.add(He);const st=2.5,at=-(R.value.length-1)*st/2;Ve.position.set(at+ce*st,0,0),Ve.scale.set(1,1,1),Ve.rotation.y=-Math.PI/2;const Lt=new kt().setFromObject(Ve);Ve.position.y=-Lt.min.y,h.add(Ve),x.set($.id,Ve),f(`[StartGame] : ${$.name}`)}catch(He){f(`[StartGame] : ${$.name}`,He),O($,ce)}}function O($,ce){if(!h)return;const pe=new Yt(.8,.8,.8),He=new Gt({color:4491519}),De=new rt(pe,He),Ke=2.5,Ve=-(R.value.length-1)*Ke/2;De.position.set(Ve+ce*Ke,.8,0),De.rotation.y=-Math.PI/2,h.add(De),x.set($.id,De)}function ae(){h&&(x.forEach($=>{h.remove($),$.geometry&&$.geometry.dispose(),$.material&&(Array.isArray($.material)?$.material.forEach(ce=>ce.dispose()):$.material.dispose())}),x.clear(),R.value.forEach(($,ce)=>{V($,ce)}))}async function ee(){i.value=!0,r.value="";try{const $=await ws(),ce=Array.isArray($==null?void 0:$.coppers)?$.coppers:[];a.value=(ce||[]).map((pe,He)=>{var Ke,Ve,st,at,Lt,g;const De=(Ke=pe==null?void 0:pe.copper_info)==null?void 0:Ke.model_url;return f(`[StartGame] Copper ${((Ve=pe==null?void 0:pe.copper_info)==null?void 0:Ve.name)||He+1}: model_url=${De}`),{id:Number((pe==null?void 0:pe.id)??He+1),name:((st=pe==null?void 0:pe.copper_info)==null?void 0:st.name)||`#${He+1}`,icon:H(((at=pe==null?void 0:pe.copper_info)==null?void 0:at.icon_url)||""),level:Number((pe==null?void 0:pe.level)??1),copperType:(pe==null?void 0:pe.copper_type)||"Arcanist",modelName:((g=(Lt=pe==null?void 0:pe.copper_info)==null?void 0:Lt.name)==null?void 0:g.toLowerCase())||"",modelUrl:De?H(De):""}})}catch($){f("[StartGame] ",$),r.value=""}finally{i.value=!1}}async function q(){if(l.value.size!==3)return;const $=Array.from(l.value).map(ce=>String(ce));window.__ACTUAL_COPPER_IDS__=$,f("[StartGame] ID:",$),n("confirm",{ids:$})}function L(){n("close")}lt(R,()=>{ae()},{deep:!0}),et(()=>{ee(),setTimeout(()=>{E()},100),o.musicOn&&!o.paused&&u.value&&setTimeout(()=>{if(u.value.readyState>=2)u.value.play().then(()=>{f("[StartGame] ")}).catch(ce=>{f("[StartGame] :",ce)});else{const ce=()=>{u.value.play().then(()=>{f("[StartGame] ")}).catch(pe=>{f("[StartGame] :",pe)}),u.value.removeEventListener("canplay",ce)};u.value.addEventListener("canplay",ce,{once:!0})}},200)}),lt(()=>o.musicOn,$=>{if(u.value)if($&&!o.paused)if(u.value.readyState>=2)u.value.play().catch(ce=>{f("[StartGame] :",ce)});else{const ce=()=>{u.value.play().catch(pe=>{f("[StartGame] :",pe)}),u.value.removeEventListener("canplay",ce)};u.value.addEventListener("canplay",ce)}else u.value.pause()}),lt(()=>o.paused,$=>{if(u.value){if($)u.value.pause(),f("[StartGame] ");else if(o.musicOn){if(u.value.readyState>=2)u.value.play().catch(ce=>{f("[StartGame] :",ce)});else{const ce=()=>{u.value.play().catch(pe=>{f("[StartGame] :",pe)}),u.value.removeEventListener("canplay",ce)};u.value.addEventListener("canplay",ce)}f("[StartGame] ")}}}),_t(()=>{window.removeEventListener("resize",C),u.value&&u.value.pause(),x.forEach($=>{h&&h.remove($)}),x.clear(),_&&_.dispose(),v&&v.dispose()});const Q=`url('${H("@assets/ui/panel1.png")}')`,we=`url('${H("@assets/ui/panel2.png")}')`,ye=`url('${H("@assets/ui/panel3.png")}')`,Y=`url('${H("@assets/ui/panel6.png")}')`,ve=`url('${H("@assets/ui/panel7.png")}')`,Ge=`url('${H("@assets/ui/panel8.png")}')`,ue=`url('${H("@assets/ui/panel9.png")}')`,A=`url('${H("@assets/ui/panel10.png")}')`,de={emit:n,props:o,loading:i,error:r,copperList:a,selectedIds:l,previewContainer:c,audioRef:u,musicUrl:d,get scene(){return h},set scene($){h=$},get camera(){return m},set camera($){m=$},get renderer(){return _},set renderer($){_=$},get controls(){return v},set controls($){v=$},get gltfLoader(){return S},set gltfLoader($){S=$},loadedModels:x,canConfirm:I,selectedCoppers:R,init3DScene:E,animate3D:T,onWindowResize:C,toggleSelect:F,loadCopperModel:V,createPlaceholderCube:O,updateModels:ae,loadCoppers:ee,startGame:q,close:L,panel1Src:Q,panel2Src:we,panel3Src:ye,panel6Src:Y,panel7Src:ve,panel8Src:Ge,panel9Src:ue,panel10Src:A,get log(){return f},ref:U,onMounted:et,onBeforeUnmount:_t,computed:Ee,watch:lt,get get_copper_list(){return ws},get eventloop(){return Ae},get getAssetUrl(){return H},get modelCache(){return Mt},get THREE(){return ar},get OrbitControls(){return Ml},get GLTFLoader(){return us},get DRACOLoader(){return ds}};return Object.defineProperty(de,"__isScriptSetup",{enumerable:!1,value:!0}),de}},Q_={class:"startgame-modal"},ey={class:"card"},ty={class:"card__header"},ny=["src"],sy={class:"card__body"},oy={class:"card__content"},ry={key:0,class:"loading"},iy={key:1,class:"error"},ay={key:2,class:"list"},ly=["onClick"],cy={class:"item__img"},uy=["src","alt"],dy={class:"item__meta"},fy={class:"item__name"},py={class:"item__level"},hy={class:"preview"},my={ref:"previewContainer",class:"preview__scene"},gy={class:"preview__info"},_y={key:0,class:"preview__empty"},yy={key:1,class:"preview__names"},vy={class:"preview__name-number"},by={class:"preview__name-text"},wy={class:"card__footer"},Sy=["disabled"],My=["src"];function Ty(t,e,s,n,o,i){return D(),W("div",Q_,[p("div",ey,[p("div",ty,[e[0]||(e[0]=p("div",{class:"card__title"},"",-1)),p("button",{class:"card__close",onClick:n.close,"aria-label":""},[p("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,ny)])]),p("div",sy,[p("div",oy,[n.loading?(D(),W("div",ry,"...")):n.error?(D(),W("div",iy,se(n.error),1)):(D(),W("div",ay,[(D(!0),W(Je,null,qt(n.copperList,r=>(D(),W("div",{key:r.id,class:Qe(["item",{"item--selected":n.selectedIds.has(r.id)}]),onClick:a=>n.toggleSelect(r.id)},[p("div",cy,[p("img",{src:r.icon,alt:r.name},null,8,uy)]),p("div",dy,[p("div",fy,se(r.name),1),p("div",py,"Lv. "+se(r.level),1)])],10,ly))),128))])),e[1]||(e[1]=p("div",{class:"hint"},"3",-1))]),p("div",hy,[e[2]||(e[2]=p("div",{class:"preview__title"},"",-1)),p("div",my,null,512),p("div",gy,[n.selectedCoppers.length===0?(D(),W("div",_y,"  ")):(D(),W("div",yy,[(D(!0),W(Je,null,qt(n.selectedCoppers,(r,a)=>(D(),W("div",{key:r.id,class:"preview__name"},[p("span",vy,se(a+1),1),p("span",by,se(r.name),1)]))),128))]))])])]),p("div",wy,[p("button",{class:"btn btn--primary",disabled:!n.canConfirm,onClick:n.startGame},"  ",8,Sy),p("button",{class:"btn",onClick:n.close},"")])]),p("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,My)])}const Cy=yt(Z_,[["render",Ty],["__scopeId","data-v-7da17356"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/StartGame.vue"]]),Ey={:"spark",:"syrup",:"bubble",:"glimmer",:"turner",:"wrench",:"artifex",:"coil",:"drillbit",:"quickhand",:"rocky",:"wesley",:"bell",:"tumble",:"chief",:"gyro",:"tricky",:"pendulum",:"yoyo",:"karin",:"murmur",:"melody",:"clawster",:"diggs",:"hive"},xy={IronWall:"iron_wall",Arcanist:"arcanist",Mechanic:"mechanic",Resonator:"resonator",CraftsMan:"craftsman"};function Tl(t){return Ey[t]||t.toLowerCase()}function Cl(t){return xy[t]||t.toLowerCase()}const Ay={:"rivet_barrier",:"gear_arrow_tower",:"heart_source_mineral_drill",:"steam_mining_car",:"charging_coil",:"repair_workshop",:"mirro_light_refraction_tower",:"resonance_alarm_bell",:"storm_anvil",:"automatic_loading_gun"};function El(t){return Ay[t]||t.toLowerCase().replace(/\s+/g,"_")}function xl(t,e){const s=new Map;function n(c,u,d){if(s.has(c)){const T=s.get(c);T.maxHp=d,o(c,u,d);return}const h=1,m=.1,_=new Lo(h,m),v=new Pt({color:4456448,side:Un,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),S=new rt(_,v),x=new Lo(h,m),I=new Pt({color:i(u,d),side:Un,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),R=new rt(x,I);R.position.z=.001;const E=new Jt;E.add(S),E.add(R),E.renderOrder=999,S.renderOrder=999,R.renderOrder=1e3,t.add(E),s.set(c,{bar:R,background:S,container:E,maxHp:d}),o(c,u,d)}function o(c,u,d){const h=s.get(c);if(!h)return;const{bar:m}=h,_=Math.max(0,Math.min(1,u/d));m.scale.x=_,m.position.x=-(1-_)*.5,m.material.color.setHex(i(u,d))}function i(c,u){const d=c/u;return d>.6?65280:d>.3?16776960:16711680}function r(c){const u=s.get(c);if(!u)return;const{bar:d,background:h,container:m}=u;d.geometry.dispose(),d.material.dispose(),h.geometry.dispose(),h.material.dispose(),t.remove(m),s.delete(c)}function a(c){s.forEach((u,d)=>{const h=c.find(m=>m.id===d);if(h&&h.object){const{container:m}=u,_=h.object.position.clone();_.y+=1.5,m.position.copy(_),m.lookAt(e.position)}})}function l(){s.forEach((c,u)=>{r(u)}),s.clear()}return{healthBars:s,createOrUpdateHealthBar:n,updateHealthBarValue:o,removeHealthBar:r,updateHealthBarsPosition:a,dispose:l}}function Al(t){const e={move:[],attack:[],summon:[]},s={move:{color:4521796,opacity:.6},attack:{color:16729156,opacity:.6},summon:{color:16776960,opacity:.6}};function n(c,u="move"){const[d,h]=c,m=s[u]||s.move,_=new Lo(.9,.9),v=new Pt({color:m.color,side:Un,transparent:!0,opacity:m.opacity}),S=new rt(_,v);return S.rotation.x=-Math.PI/2,S.position.set(d,.08,h),S.userData={position:c,type:u},t.add(S),e[u].push(S),S}function o(c){const[u,d]=c;let h=!1;return Object.keys(e).forEach(m=>{const _=e[m].findIndex(v=>{const S=v.userData.position;return S[0]===u&&S[1]===d});if(_!==-1){const v=e[m][_];t.remove(v),v.geometry.dispose(),v.material.dispose(),e[m].splice(_,1),h=!0}}),h}function i(c){e[c]&&(e[c].forEach(u=>{t.remove(u),u.geometry.dispose(),u.material.dispose()}),e[c]=[])}function r(){Object.keys(e).forEach(c=>{i(c)})}function a(c,u){var m;const[d,h]=c;return(m=e[u])==null?void 0:m.some(_=>{const v=_.userData.position;return v[0]===d&&v[1]===h})}function l(){r()}return{indicators:e,createIndicator:n,clearIndicatorAt:o,clearIndicators:i,clearAllIndicators:r,hasIndicatorAt:a,dispose:l}}function ky(){const t={geometries:[],materials:[],meshes:[],maxSize:10},e={geometries:[],materials:[],meshes:[],maxSize:10};function s(a){let l;if(t.meshes.length>0)l=t.meshes.pop(),l.geometry.dispose(),l.geometry=new Do(.05,.05,a,8),l.material.opacity=.9;else{const c=new Do(.05,.05,a,8),u=new Pt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5});l=new rt(c,u)}return l}function n(a){t.meshes.length<t.maxSize?t.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function o(){let a;if(e.meshes.length>0)a=e.meshes.pop(),a.scale.set(1,1,1),a.material.opacity=.8;else{const l=new Zr(.2,.4,32),c=new Pt({color:16711680,side:Un,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5});a=new rt(l,c),a.rotation.x=-Math.PI/2}return a}function i(a){e.meshes.length<e.maxSize?e.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function r(){t.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),t.meshes=[],t.geometries=[],t.materials=[],e.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),e.meshes=[],e.geometries=[],e.materials=[]}return{getAttackRay:s,recycleAttackRay:n,getExplosionRing:o,recycleExplosionRing:i,dispose:r}}function kl(t){const e=ky();function s(i,r){const a=new Pe(i[0],.5,i[1]),l=new Pe(r[0],.5,r[1]),c=a.distanceTo(l),u=e.getAttackRay(c),d=new Pe().addVectors(a,l).multiplyScalar(.5);u.position.copy(d);const h=new Pe().subVectors(l,a).normalize(),m=new ks;m.setFromUnitVectors(new Pe(0,1,0),h),u.quaternion.copy(m),t.add(u);let _=.9;const v=()=>{_-=.05,u.material.opacity=_,_<=0?(t.remove(u),e.recycleAttackRay(u)):requestAnimationFrame(v)};setTimeout(v,300);const S=e.getExplosionRing();S.position.set(r[0],.1,r[1]),t.add(S);let x=1,I=.8;const R=()=>{x+=.1,I-=.08,S.scale.set(x,x,1),S.material.opacity=I,I<=0?(t.remove(S),e.recycleExplosionRing(S)):requestAnimationFrame(R)};R()}function n(i,r){const a=Object.entries(r).filter(([E,T])=>T>0).map(([E,T])=>{const C=yu(E);return`+${T} ${C}`});if(a.length===0)return;const l=a.join(`
`),c=document.createElement("canvas"),u=c.getContext("2d");c.width=512,c.height=256,u.fillStyle="rgba(0, 0, 0, 0)",u.fillRect(0,0,c.width,c.height),u.font="bold 48px Arial",u.fillStyle="#ffff00",u.strokeStyle="#000000",u.lineWidth=4,u.textAlign="center",u.textBaseline="middle";const d=l.split(`
`),h=60,m=c.height/2-(d.length-1)*h/2;d.forEach((E,T)=>{const C=m+T*h;u.strokeText(E,c.width/2,C),u.fillText(E,c.width/2,C)});const _=new _d(c),v=new yd({map:_,transparent:!0,opacity:1}),S=new vd(v);S.scale.set(2,1,1),S.position.set(i[0],1.5,i[1]),t.add(S);let x=1.5,I=1;const R=()=>{x+=.02,I-=.01,S.position.y=x,S.material.opacity=I,I<=0?(t.remove(S),S.material.map.dispose(),S.material.dispose()):requestAnimationFrame(R)};R()}function o(){e.dispose()}return{createAttackEffect:s,createResourceGainEffect:n,dispose:o}}const Ry={__name:"DiamondPanel",props:{copperInfo:{type:Object,required:!0},inventoryItems:{type:Array,default:()=>[]},inventoryCapacity:{type:Number,default:5}},emits:["inventory-click"],setup(t,{expose:e,emit:s}){e(),Kt(E=>({"7c3070e2-namePanelSrc":m,"7c3070e2-borderBlueSrc":n,"7c3070e2-borderGreenSrc":o,"7c3070e2-borderOrangeRedSrc":i}));const n=`url('${H("ui/border-blue.png")}')`,o=`url('${H("ui/border-green.png")}')`,i=`url('${H("ui/border-orange-red.png")}')`,r=t,a=s,l=Ee(()=>{var E;return(((E=r.copperInfo)==null?void 0:E.name)||"").trim()}),c=Ee(()=>{var E,T;return((E=r.copperInfo)==null?void 0:E.isOwnedEnemy)===!0||((T=r.copperInfo)==null?void 0:T.isEnemy)===!0}),u=Ee(()=>c.value&&l.value!==""),d=Ee(()=>{var T;const E=(T=r.copperInfo)==null?void 0:T.position;return!Array.isArray(E)||E.length<2?"--":`${E[0]},${E[1]}`}),h=Ee(()=>c.value===!0),m=`url('${H("@assets/ui/panel4.png")}')`,_=U({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0});async function v(){try{const E=await Vn();E&&Object.keys(_.value).forEach(T=>{_.value[T]=E[T]||0})}catch(E){console.error("[DiamondPanel] :",E)}}const S=Ee(()=>Object.values(_.value).filter(E=>E>0).length);function x(){h.value||a("inventory-click")}const I=U(null);et(async()=>{if(v(),Bn(vt.UPDATE_RESOURCES,v),!I.value)return;function E(C){return new Promise((F,V)=>{const O=new Image;O.onload=()=>F(O),O.onerror=()=>V(),O.src=C})}function T(C,F){I.value&&I.value.style.setProperty(C,String(F))}try{const[C,F,V]=await Promise.all([E(H("ui/border-blue.png")),E(H("ui/border-green.png")),E(H("ui/border-orange-red.png"))]),O=Math.max(3,Math.round(C.naturalHeight/4)),ae=Math.max(3,Math.round(F.naturalHeight/4)),ee=Math.max(3,Math.round(V.naturalHeight/4));T("--border-blue-slice",O),T("--border-green-slice",ae),T("--border-orange-red-slice",ee)}catch{T("--border-blue-slice","8"),T("--border-green-slice","8"),T("--border-orange-red-slice","8")}});const R={borderBlueSrc:n,borderGreenSrc:o,borderOrangeRedSrc:i,props:r,emit:a,copperName:l,isEnemyUnit:c,shouldShowCopperName:u,positionText:d,isInventoryDisabled:h,namePanelSrc:m,resources:_,updateResources:v,globalResourceCount:S,handleInventoryClick:x,diamondPanelRef:I,ref:U,computed:Ee,onMounted:et,onBeforeUnmount:_t,get getAssetUrl(){return H},get get_resource(){return Vn},get onEvent(){return Bn},get offEvent(){return cs},get EventTypes(){return vt}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},Py={ref:"diamondPanelRef",class:"diamond-panel"},Iy={key:0,class:"diamond-name"},Oy={class:"diamond-row diamond-row--top"},Ly=["title","aria-disabled"],Dy={class:"diamond border-orange-red"},Ny={class:"diamond-content"},$y={class:"diamond-text"},Gy={class:"diamond-value"},Hy={class:"diamond-row diamond-row--bottom"},Uy={class:"diamond border-orange-red"},Fy={class:"diamond-content"},jy={class:"diamond-text"},By={class:"diamond-value"},Vy={class:"diamond border-green"},zy={class:"diamond-content"},Wy={class:"diamond-text"},qy={class:"diamond-value"},Ky={class:"diamond border-blue"},Xy={class:"diamond-content"},Yy={class:"diamond-text"},Jy={class:"diamond-value"};function Zy(t,e,s,n,o,i){return D(),W("div",Py,[n.shouldShowCopperName?(D(),W("div",Iy,se(n.copperName),1)):Me("",!0),p("div",Oy,[p("div",{class:Qe(["diamond","border-blue",{"diamond--disabled":n.isInventoryDisabled}]),onClick:n.handleInventoryClick,title:n.isInventoryDisabled?"":"","aria-disabled":n.isInventoryDisabled?"true":"false"},[...e[0]||(e[0]=[p("div",{class:"diamond-content"},[p("div",{class:"diamond-text"},[p("div",{class:"diamond-label"},"")])],-1)])],10,Ly),p("div",Dy,[p("div",Ny,[p("div",$y,[e[1]||(e[1]=p("div",{class:"diamond-label"},"",-1)),p("div",Gy,se(n.positionText),1)])])])]),p("div",Hy,[p("div",Uy,[p("div",Fy,[p("div",jy,[e[2]||(e[2]=p("div",{class:"diamond-label"},"",-1)),p("div",By,se(s.copperInfo.attack),1)])])]),p("div",Vy,[p("div",zy,[p("div",Wy,[e[3]||(e[3]=p("div",{class:"diamond-label"},"",-1)),p("div",qy,se(s.copperInfo.defense),1)])])]),p("div",Ky,[p("div",Xy,[p("div",Yy,[e[4]||(e[4]=p("div",{class:"diamond-label"},"",-1)),p("div",Jy,se(s.copperInfo.speed),1)])])])])],512)}const Qy=yt(Ry,[["render",Zy],["__scopeId","data-v-7c3070e2"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/DiamondPanel.vue"]]),ev={__name:"InventoryModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},equipment:{type:Array,default:()=>[]}},emits:["close"],setup(t,{expose:e,emit:s}){e();const n=t,o=Ee(()=>n.equipment||[]),i=s;function r(){i("close")}const a={props:n,equipmentItems:o,emit:i,close:r,computed:Ee,get getAssetUrl(){return H}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}},tv={class:"minecraft-inventory"},nv={class:"inventory-layout"},sv={class:"inventory-section"},ov={class:"equipment-header-mc"},rv={class:"copper-name"},iv={class:"inventory-grid"},av={class:"slot-icon"},lv=["src","alt"],cv=["src"],uv=["src"],dv={key:3,class:"equipment-icon"},fv={class:"slot-tooltip"},pv={class:"tooltip-name"};function hv(t,e,s,n,o,i){return s.visible?(D(),W("div",{key:0,class:"inventory-modal",onClick:Pn(n.close,["self"])},[p("div",tv,[p("div",nv,[p("div",sv,[p("div",ov,[p("h4",null,[p("span",rv,se(s.copperName),1),e[0]||(e[0]=jn("  ",-1))])]),p("div",iv,[(D(),W(Je,null,qt(2,(r,a)=>{var l,c,u,d,h,m,_,v,S,x;return p("div",{key:a,class:Qe(["inv-slot",{"has-item":a<n.equipmentItems.length&&((l=n.equipmentItems[a])==null?void 0:l.equipped),"slot-locked":(c=n.equipmentItems[a])==null?void 0:c.locked}])},[a<n.equipmentItems.length?(D(),W(Je,{key:0},[p("div",av,[(u=n.equipmentItems[a])!=null&&u.equipped&&((d=n.equipmentItems[a])!=null&&d.icon)&&n.equipmentItems[a].icon!==""&&(n.equipmentItems[a].icon.startsWith("/")||n.equipmentItems[a].icon.startsWith("http")||n.equipmentItems[a].icon.includes("."))?(D(),W("img",{key:0,src:n.equipmentItems[a].icon,alt:((h=n.equipmentItems[a])==null?void 0:h.name)||"",class:"equipment-icon"},null,8,lv)):(m=n.equipmentItems[a])!=null&&m.locked?(D(),W("img",{key:1,src:n.getAssetUrl("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,cv)):((_=n.equipmentItems[a])==null?void 0:_.icon)===""?(D(),W("img",{key:2,src:n.getAssetUrl("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,uv)):(D(),W("span",dv,se(((v=n.equipmentItems[a])==null?void 0:v.icon)||""),1))]),p("div",fv,[p("div",pv,se(((S=n.equipmentItems[a])==null?void 0:S.name)||((x=n.equipmentItems[a])!=null&&x.locked?"":"")),1)])],64)):Me("",!0)],2)}),64))])])])])])):Me("",!0)}const mv=yt(ev,[["render",hv],["__scopeId","data-v-691681c6"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/InventoryModal.vue"]]),gv={__name:"HealthBar",props:{hp:{type:Number,default:0},maxHp:{type:Number,default:100}},setup(t,{expose:e}){e(),Kt(u=>({"8139fe94-bloodBorderMiddleSrc":i,"8139fe94-bloodBarSrc":r}));const s=t,n=H("ui/blood-border-left.png"),o=H("ui/blood-border-right.png"),i=`url('${H("ui/blood-border-middle.png")}')`,r=`url('${H("ui/blood-bar.png")}')`,a=Ee(()=>{if(!s.maxHp||s.maxHp===0)return 0;const d=Math.max(0,Math.min(s.hp,s.maxHp))/s.maxHp*100;return Math.max(0,Math.min(100,d))}),l=Ee(()=>{const u=Math.max(0,Math.min(s.hp,s.maxHp)),d=s.maxHp||100;return`${Math.round(u)}/${Math.round(d)}`}),c={props:s,bloodBorderLeftSrc:n,bloodBorderRightSrc:o,bloodBorderMiddleSrc:i,bloodBarSrc:r,hpPercentage:a,hpText:l,computed:Ee,get getAssetUrl(){return H}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}},_v={class:"health-bar","aria-label":"Health Bar"},yv={class:"health-bar__border"},vv={class:"health-bar__border-left"},bv=["src"],wv={class:"health-bar__border-right"},Sv=["src"],Mv={class:"health-bar__text"};function Tv(t,e,s,n,o,i){return D(),W("div",_v,[p("div",yv,[p("div",vv,[p("img",{src:n.bloodBorderLeftSrc,alt:""},null,8,bv)]),e[0]||(e[0]=p("div",{class:"health-bar__border-middle"},null,-1)),p("div",wv,[p("img",{src:n.bloodBorderRightSrc,alt:""},null,8,Sv)]),p("div",{class:"health-bar__fill",style:zt({width:`calc(${n.hpPercentage}% + 20px)`})},null,4),p("div",Mv,se(n.hpText),1)])])}const Cv=yt(gv,[["render",Tv],["__scopeId","data-v-8139fe94"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/HealthBar.vue"]]),Ev={__name:"TriPanel",props:{copperType:{type:String,default:""},canMove:{type:Boolean,default:!0},canAttack:{type:Boolean,default:!0},canSummon:{type:Boolean,default:!1}},emits:["move","wait","attack","summon","build"],setup(t,{expose:e,emit:s}){e();const n=t,o=s,i=Ee(()=>n.copperType==="CraftsMan"?"build":n.copperType==="Resonator"?"summon":"attack"),r=Ee(()=>i.value==="build"?n.canSummon?"":"":i.value==="summon"?n.canSummon?"":"":n.canAttack?"":""),a=Ee(()=>i.value==="build"||i.value==="summon"?!n.canSummon:!n.canAttack),l=H("ui/your-image.png"),c=H("ui/boot.png"),u=H("ui/mushroom.png"),d=H("ui/sword.png"),h=H("@assets/ui/summon.png"),m=H("@assets/ui/build.png");function _(){n.canMove&&o("move")}function v(){o("wait")}function S(){if(i.value==="build"){if(!n.canSummon)return;o("build")}else if(i.value==="summon"){if(!n.canSummon)return;o("summon")}else{if(!n.canAttack)return;o("attack")}}const x={props:n,emit:o,rightButtonType:i,rightButtonTitle:r,rightButtonLocked:a,hexSrc:l,moveIconSrc:c,waitIconSrc:u,attackIconSrc:d,summonIconSrc:h,buildIconSrc:m,onMove:_,onWait:v,onRightButton:S,computed:Ee,get getAssetUrl(){return H}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},xv={class:"tri-panel"},Av={class:"diamond","aria-label":""},kv=["src"],Rv=["src"],Pv=["title"],Iv=["src"],Ov=["src"],Lv=["title"],Dv=["src"],Nv=["src","alt"];function $v(t,e,s,n,o,i){return D(),W("div",xv,[p("div",Av,[p("div",{class:"hex top",title:"",onClick:n.onWait},[p("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,kv),p("img",{class:"hex-icon",src:n.moveIconSrc,alt:""},null,8,Rv)]),p("div",{class:Qe(["hex left",{"is-locked":s.canMove===!1}]),title:s.canMove?"":"",onClick:n.onMove},[p("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,Iv),p("img",{class:"hex-icon",src:n.waitIconSrc,alt:""},null,8,Ov)],10,Pv),p("div",{class:Qe(["hex right",{"is-locked":n.rightButtonLocked}]),title:n.rightButtonTitle,onClick:n.onRightButton},[p("img",{class:"hex-bg",src:n.hexSrc,alt:""},null,8,Dv),p("img",{class:"hex-icon",src:n.rightButtonType==="build"?n.buildIconSrc:n.rightButtonType==="summon"?n.summonIconSrc:n.attackIconSrc,alt:n.rightButtonType==="build"?"":n.rightButtonType==="summon"?"":""},null,8,Nv)],10,Lv)])])}const Gv=yt(Ev,[["render",$v],["__scopeId","data-v-d9064d28"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/TriPanel.vue"]]),Hv={__name:"BuildModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},structureList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","build"],setup(t,{expose:e,emit:s}){e(),Kt(I=>({"db5e67f3-panel11Src":h,"db5e67f3-panel5Src":v,"db5e67f3-panel8Src":_,"db5e67f3-panel7Src":m,"db5e67f3-panel12Src":S}));const n=t,o=s,i=U(null),r=Ee(()=>[...n.structureList].sort((I,R)=>{const E=T=>{var F;const C=((F=T.cost)==null?void 0:F.cost)||T.cost;return!Array.isArray(C)||C.length===0?0:Array.isArray(C[0])?C[0][1]:C[0].count};return E(I)-E(R)}));function a(I){i.value=I}function l(){if(!i.value){f("[BuildModal] ");return}f("[BuildModal] :",i.value.name),o("build",i.value.name),c()}function c(){i.value=null,o("close")}function u(I){return{:"",:"",:"",:""}[I]||""}function d(I){if(!I)return"";const R=I.cost||I;return!Array.isArray(R)||R.length===0?"":R.map(E=>{var T;if(Array.isArray(E)){const C=E[0],F=E[1];return`${((T=In[C])==null?void 0:T.name)||C} x${F}`}return`${tr(E)} x${E.count}`}).join(", ")}const h=`url('${H("@assets/ui/panel11.png")}')`,m=`url('${H("@assets/ui/panel7.png")}')`,_=`url('${H("@assets/ui/panel8.png")}')`,v=`url('${H("@assets/ui/panel5.png")}')`,S=`url('${H("@assets/ui/panel12.png")}')`,x={props:n,emit:o,selectedStructure:i,sortedStructures:r,selectStructure:a,handleConfirm:l,handleClose:c,getStructureTypeLabel:u,formatCost:d,panel11Src:h,panel7Src:m,panel8Src:_,panel5Src:v,panel12Src:S,ref:U,computed:Ee,get getAssetUrl(){return H},get getItemName(){return tr},get RESOURCE_META(){return In},get log(){return f}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}},Uv={class:"modal-header"},Fv=["src"],jv={class:"modal-info"},Bv={class:"info-text"},Vv={class:"copper-name"},zv={class:"modal-body"},Wv={class:"structure-list"},qv=["onClick"],Kv={class:"structure-header"},Xv={class:"structure-name-row"},Yv={class:"structure-name"},Jv={class:"structure-type"},Zv={class:"structure-stats"},Qv={class:"stat"},eb={class:"stat-value"},tb={class:"stat"},nb={class:"stat-value"},sb={class:"stat"},ob={class:"stat-value"},rb={class:"stat"},ib={class:"stat-value"},ab={class:"structure-cost"},lb={class:"cost-value"},cb={class:"structure-desc"},ub={key:0,class:"selected-badge"},db={class:"modal-footer"},fb=["disabled"];function pb(t,e,s,n,o,i){return D(),Ht(Pc,{to:"body"},[s.visible?(D(),W("div",{key:0,class:"modal-overlay",onClick:Pn(n.handleClose,["self"])},[p("div",{class:"build-modal",onClick:e[0]||(e[0]=Pn(()=>{},["stop"]))},[p("div",Uv,[e[1]||(e[1]=p("h2",{class:"modal-title"}," ",-1)),p("button",{class:"close-btn",onClick:n.handleClose,title:""},[p("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,Fv)])]),p("div",jv,[p("p",Bv,[p("span",Vv,se(s.copperName),1),e[2]||(e[2]=jn("  ",-1))]),e[3]||(e[3]=p("p",{class:"tip-text"},"   ",-1))]),p("div",zv,[p("div",Wv,[(D(!0),W(Je,null,qt(n.sortedStructures,r=>{var a,l,c;return D(),W("div",{key:r.name,class:Qe(["structure-card",{selected:((a=n.selectedStructure)==null?void 0:a.name)===r.name}]),onClick:u=>n.selectStructure(r)},[p("div",Kv,[p("div",Xv,[p("span",Yv,se(r.name),1)]),p("span",Jv,se(n.getStructureTypeLabel(r.name)),1)]),p("div",Zv,[p("div",Qv,[e[4]||(e[4]=p("span",{class:"stat-label"},"",-1)),p("span",eb,se(r.health),1)]),p("div",tb,[e[5]||(e[5]=p("span",{class:"stat-label"},"",-1)),p("span",nb,se(((l=r.attribute)==null?void 0:l.attack)||""),1)]),p("div",sb,[e[6]||(e[6]=p("span",{class:"stat-label"},"",-1)),p("span",ob,se(r.has_storage?"":""),1)]),p("div",rb,[e[7]||(e[7]=p("span",{class:"stat-label"},"",-1)),p("span",ib,se(r.attack_range||""),1)])]),p("div",ab,[e[8]||(e[8]=p("span",{class:"cost-label"}," ",-1)),p("span",lb,se(n.formatCost(r.cost)),1)]),p("div",cb,se(r.description),1),((c=n.selectedStructure)==null?void 0:c.name)===r.name?(D(),W("div",ub,"  ")):Me("",!0)],10,qv)}),128))])]),p("div",db,[p("button",{class:"btn btn-cancel",onClick:n.handleClose},""),p("button",{class:"btn btn-confirm",disabled:!n.selectedStructure,onClick:n.handleConfirm},"  ",8,fb)])])])):Me("",!0)])}const hb=yt(Hv,[["render",pb],["__scopeId","data-v-db5e67f3"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/BuildModal.vue"]]),mb={__name:"ActionPanel",props:{copper:{type:Object,default:null},resources:{type:Array,default:()=>[]},hasAttackTargets:{type:Boolean,default:!0},onSelectCopper:{type:Function,default:null}},emits:["close","action","selectCopper"],setup(t,{expose:e,emit:s}){Kt(A=>({"fce84ec9-swordImgSrc":i.value,"fce84ec9-redPanelBg":r.value,"fce84ec9-bootImgSrc":a.value,"fce84ec9-greenPanelBg":l.value,"fce84ec9-summonImgSrc":u.value,"fce84ec9-buildImgSrc":c.value}));const n=t,o=s,i=Ee(()=>`url('${H("ui/sword.png")}')`),r=Ee(()=>`url('${H("ui/red.png")}')`),a=Ee(()=>`url('${H("ui/boot.png")}')`),l=Ee(()=>`url('${H("ui/green.png")}')`),c=Ee(()=>`url('${H("@assets/ui/build.png")}')`),u=Ee(()=>`url('${H("@assets/ui/summon.png")}')`),d=H("@assets/ui/close.png"),h=U("full"),m=U(null),_=U(!1),v=U(!1),S=U([]),x=Ee(()=>{var de,$,ce,pe,He,De,Ke,Ve,st,at,Lt,g,b,k,z,j,G,K,J,X,B,me,re,he,fe,_e,le,ke,Ze,nt,pt,wt,Ft,an,ot;if(!n.copper)return null;const A=(($=(de=n.copper.copper)==null?void 0:de.copper_info)==null?void 0:$.name)||((pe=(ce=n.copper.enemy)==null?void 0:ce.enemy_base)==null?void 0:pe.name)||((He=n.copper.enemy_base)==null?void 0:He.name)||n.copper.name||` #${n.copper.id}`;return{id:n.copper.id,name:A,level:((De=n.copper.copper)==null?void 0:De.level)??((Ke=n.copper.enemy)==null?void 0:Ke.level)??((Ve=n.copper.enemy_base)==null?void 0:Ve.level)??1,hp:n.copper.now_health,maxHp:((at=(st=n.copper.copper)==null?void 0:st.attribute)==null?void 0:at.health)??((g=(Lt=n.copper.enemy)==null?void 0:Lt.enemy_base)==null?void 0:g.health)??((b=n.copper.enemy_base)==null?void 0:b.health)??100,attack:((z=(k=n.copper.copper)==null?void 0:k.attribute)==null?void 0:z.attack)??((G=(j=n.copper.enemy)==null?void 0:j.enemy_base)==null?void 0:G.attack)??((K=n.copper.enemy_base)==null?void 0:K.attack)??0,defense:((X=(J=n.copper.copper)==null?void 0:J.attribute)==null?void 0:X.defense)??((me=(B=n.copper.enemy)==null?void 0:B.enemy_base)==null?void 0:me.defense)??((re=n.copper.enemy_base)==null?void 0:re.defense)??0,speed:((fe=(he=n.copper.copper)==null?void 0:he.attribute)==null?void 0:fe.speed)??((le=(_e=n.copper.enemy)==null?void 0:_e.enemy_base)==null?void 0:le.speed)??((ke=n.copper.enemy_base)==null?void 0:ke.speed)??0,canMove:n.copper.can_move,canAttack:n.copper.can_attack,canSummon:n.copper.can_summon,position:Array.isArray(n.copper.position)&&n.copper.position.length>=2?n.copper.position:Array.isArray((Ze=n.copper.enemy)==null?void 0:Ze.position)&&n.copper.enemy.position.length>=2?n.copper.enemy.position:Array.isArray((nt=n.copper.enemy_base)==null?void 0:nt.position)&&n.copper.enemy_base.position.length>=2?n.copper.enemy_base.position:[0,0],inventoryCapacity:((pt=n.copper.inventory)==null?void 0:pt.capacity)||0,copperType:((wt=n.copper.copper)==null?void 0:wt.copper_type)||((an=(Ft=n.copper.enemy)==null?void 0:Ft.enemy_base)==null?void 0:an.enemy_type)||((ot=n.copper.enemy_base)==null?void 0:ot.enemy_type)||"",isOwnedEnemy:n.copper.isOwnedEnemy===!0,isEnemy:n.copper.isEnemy===!0}}),I=Ee(()=>{var ce,pe,He,De,Ke;if(!n.copper)return[];const A=((ce=n.copper.copper)==null?void 0:ce.equipment_slot)||{},de=(A==null?void 0:A.slot1)||null,$=(A==null?void 0:A.slot2)||null;return[de?{name:((pe=de.equipment_base)==null?void 0:pe.name)||"",icon:H(((He=de.equipment_base)==null?void 0:He.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},A!=null&&A.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:$?{name:((De=$.equipment_base)==null?void 0:De.name)||"",icon:H(((Ke=$.equipment_base)==null?void 0:Ke.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}]});lt(()=>{var A;return(A=n.copper)==null?void 0:A.id},(A,de)=>{A!==de&&(h.value="full",m.value=null,_.value=!1,v.value=!1)});async function R(){if(!x.value.canMove)return;f("[ActionPanel] ");const A=n.copper.isOwnedEnemy===!0,de=A?"on_enemy_move_start":"on_move_start";f(`[ActionPanel] : ${A?"":""}, : ${de}`);const $=JSON.stringify({type:de,content:{id:String(x.value.id)}});await Ae($),h.value="minimized",m.value="moving",o("action",{type:"moveStart",copperId:x.value.id})}async function E(){if(f("[ActionPanel] ",{canAttack:x.value.canAttack,copperId:x.value.id,name:x.value.name}),!x.value.canAttack){f("[ActionPanel] : ");return}f("[ActionPanel] ");const A=n.copper.isOwnedEnemy===!0,de=A?"on_enemy_attack_start":"on_attack_start";f(`[ActionPanel] : ${A?"":""}, : ${de}`);const $=JSON.stringify({type:de,content:{id:String(x.value.id)}});await Ae($),h.value="minimized",m.value="attacking",o("action",{type:"attackStart",copperId:x.value.id})}async function T(){if(f("[ActionPanel] ",{canSummon:x.value.canSummon,copperId:x.value.id,name:x.value.name}),!x.value.canSummon){f("[ActionPanel] : ");return}f("[ActionPanel] ");const A=JSON.stringify({type:"on_summon_start",content:{id:String(x.value.id)}});await Ae(A),h.value="minimized",m.value="summoning",o("action",{type:"summonStart",copperId:x.value.id})}async function C(){if(f("[ActionPanel] ",{copperId:x.value.id,name:x.value.name}),!x.value.canSummon){f("[ActionPanel] : /");return}o("action",{type:"buildRequest",copperId:x.value.id})}function F(A){f("[ActionPanel] ",(A==null?void 0:A.length)||0,""),S.value=A||[],v.value=!0}async function V(A){f("[ActionPanel] :",A),v.value=!1;const de=JSON.stringify({type:"on_structure_build_start",content:{id:String(x.value.id),name:A}});await Ae(de),h.value="minimized",m.value="building",o("action",{type:"buildStart",copperId:x.value.id,structureName:A})}function O(){f("[ActionPanel] "),_.value=!0}async function ae(A){f(`[ActionPanel] : index=${A}`);const de=JSON.stringify({type:"on_copper_pick_up",content:{id:String(x.value.id),index:String(A)}});await Ae(de),await L()}async function ee(){f("[ActionPanel] ");const A=JSON.stringify({type:"on_copper_craft",content:{id:String(x.value.id)}});await Ae(A),await L()}async function q(){await ee()}async function L(){const de=n.copper.isOwnedEnemy===!0?"on_click_enemy":"on_click_copper",$=JSON.stringify({type:de,content:{id:String(x.value.id)}});await Ae($)}function Q(){f("[ActionPanel] "),o("action",{type:"wait",copperId:x.value.id})}function we(){h.value="full",m.value=null,_.value=!1,o("close")}function ye(){_.value=!1}function Y(){h.value="full",m.value=null,o("action",{type:"cancel",copperId:x.value.id})}function ve(){Y(),we()}async function Ge(A){n.onSelectCopper?await n.onSelectCopper(A):o("selectCopper",A)}e({cancelAction:Y,handleSelectCopper:Ge,showBuildMenu:F});const ue={props:n,emit:o,swordImgSrc:i,redPanelBg:r,bootImgSrc:a,greenPanelBg:l,buildImgSrc:c,summonImgSrc:u,closeIconSrc:d,panelMode:h,actionMode:m,showInventory:_,showBuildModal:v,structureList:S,copperInfo:x,equipmentData:I,handleMove:R,handleAttack:E,handleSummon:T,handleBuild:C,showBuildMenu:F,handleBuildConfirm:V,handleInventory:O,handlePickup:ae,handleCraft:ee,handleInventoryCraft:q,refreshCopperState:L,handleWait:Q,close:we,handleCloseInventory:ye,cancelAction:Y,handleMinimizedClose:ve,handleSelectCopper:Ge,get log(){return f},ref:U,computed:Ee,watch:lt,get eventloop(){return Ae},get getItemName(){return tr},get getAssetUrl(){return H},DiamondPanel:Qy,InventoryModal:mv,HealthBar:Cv,TriPanel:Gv,BuildModal:hb};return Object.defineProperty(ue,"__isScriptSetup",{enumerable:!1,value:!0}),ue}},gb={key:0,class:"copper-panel-parent"},_b={key:0,class:"minimized-content"},yb=["src"],vb={class:"minimized-info"},bb={class:"minimized-name"},wb={class:"minimized-action"},Sb=["src"],Mb={class:"panel-content"},Tb={key:0,class:"resources"},Cb={class:"resources-list"},Eb=["onClick"],xb={class:"resource-name"},Ab={class:"resource-count"},kb={key:2,class:"enemy-info-tip"};function Rb(t,e,s,n,o,i){var r,a,l,c,u,d,h,m;return D(),W(Je,null,[s.copper?(D(),W("div",gb,[it(n.DiamondPanel,{"copper-info":n.copperInfo,"inventory-items":[],"inventory-capacity":5,onInventoryClick:n.handleInventory},null,8,["copper-info"]),it(n.HealthBar,{hp:((r=n.copperInfo)==null?void 0:r.hp)||0,"max-hp":((a=n.copperInfo)==null?void 0:a.maxHp)||100},null,8,["hp","max-hp"]),n.panelMode==="minimized"||s.resources&&s.resources.length>0&&n.panelMode==="full"?(D(),W("div",{key:0,class:Qe(["copper-panel",{"copper-panel--minimized":n.panelMode==="minimized","copper-panel--min-attack":n.panelMode==="minimized"&&n.actionMode==="attacking","copper-panel--min-move":n.panelMode==="minimized"&&n.actionMode==="moving","copper-panel--min-summon":n.panelMode==="minimized"&&n.actionMode==="summoning","copper-panel--min-build":n.panelMode==="minimized"&&n.actionMode==="building"}]),onClick:e[0]||(e[0]=Pn(()=>{},["stop"]))},[n.panelMode==="minimized"?(D(),W("div",_b,[p("button",{class:"minimized-close",type:"button",onClick:n.handleMinimizedClose,title:""},[p("img",{src:n.closeIconSrc,alt:""},null,8,yb)]),p("div",vb,[p("span",bb,se(n.copperInfo.name),1),p("span",wb,se(n.actionMode==="moving"?"...":n.actionMode==="attacking"?"...":n.actionMode==="summoning"?"...":n.actionMode==="building"?"...":""),1)])])):(D(),W(Je,{key:1},[p("button",{class:"close-btn",onClick:n.close,title:""},[p("img",{src:n.closeIconSrc,alt:""},null,8,Sb)]),p("div",Mb,[s.resources&&s.resources.length>0?(D(),W("div",Tb,[e[3]||(e[3]=p("div",{class:"resources-header"}," ",-1)),p("div",Cb,[(D(!0),W(Je,null,qt(s.resources,(_,v)=>(D(),W("div",{key:v,class:"resource-item",onClick:S=>n.handlePickup(v),title:""},[p("span",xb,se(n.getItemName(_)),1),p("span",Ab,"x"+se(_.count||1),1),e[2]||(e[2]=p("span",{class:"resource-pickup"},"",-1))],8,Eb))),128))])])):Me("",!0)])],64))],2)):Me("",!0),n.props.copper.isEnemy?Me("",!0):(D(),Ht(n.TriPanel,{key:1,"copper-type":(l=n.copperInfo)==null?void 0:l.copperType,"can-move":((c=n.copperInfo)==null?void 0:c.canMove)!==!1,"can-attack":((u=n.copperInfo)==null?void 0:u.canAttack)!==!1,"can-summon":((d=n.copperInfo)==null?void 0:d.canSummon)!==!1,onMove:n.handleMove,onWait:n.handleWait,onAttack:n.handleAttack,onSummon:n.handleSummon,onBuild:n.handleBuild},null,8,["copper-type","can-move","can-attack","can-summon"])),n.props.copper.isEnemy?(D(),W("div",kb,[...e[4]||(e[4]=[p("span",null," ",-1)])])):Me("",!0)])):Me("",!0),it(n.InventoryModal,{visible:n.showInventory,"copper-name":((h=n.copperInfo)==null?void 0:h.name)||"",equipment:n.equipmentData,onClose:n.handleCloseInventory,onCraft:n.handleInventoryCraft},null,8,["visible","copper-name","equipment"]),it(n.BuildModal,{visible:n.showBuildModal,"copper-name":((m=n.copperInfo)==null?void 0:m.name)||"","structure-list":n.structureList,onClose:e[1]||(e[1]=_=>n.showBuildModal=!1),onBuild:n.handleBuildConfirm},null,8,["visible","copper-name","structure-list"])],64)}const Pb=yt(mb,[["render",Rb],["__scopeId","data-v-fce84ec9"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanel.vue"]]),Ib={__name:"TurnSystem",props:{currentCopperId:{type:Number,default:null},copperList:{type:Array,default:()=>[]},roundNumber:{type:Number,default:1},isEnemyMoving:{type:Boolean,default:!1}},emits:["nextCopper","endRound","selectCopper"],setup(t,{expose:e,emit:s}){e(),Kt(E=>({"403c6abe-ribbonLeftSrc":l,"403c6abe-ribbonRightSrc":u,"403c6abe-ribbonMiddleSrc":c,"403c6abe-panelSrc":d,"403c6abe-round1Src":h,"403c6abe-currentCupperSrc":m,"403c6abe-btnSrc":_}));const n=t,o=s,i=U(null),r=H("ui/choice.png"),a=H("ui/choice-active.png"),l=`url('${H("ui/ribbon-left.png")}')`,c=`url('${H("ui/ribbon-middle.png")}')`,u=`url('${H("ui/ribbon-right.png")}')`,d=`url('${H("ui/panel.png")}')`,h=`url('${H("ui/round1.png")}')`,m=`url('${H("ui/currentcupper.png")}')`,_=`url('${H("ui/btn.png")}')`,v=Ee(()=>{if(!n.currentCopperId)return null;const E=n.copperList.find(T=>T.id===n.currentCopperId);return E?{id:E.id,name:E.name||` #${E.id}`,level:E.level??0,isSummon:E.type==="summon"}:null});function S(){o("nextCopper")}async function x(){const E=JSON.stringify({type:"on_game_round_pass"});await Ae(E),o("endRound")}function I(E){o("selectCopper",E)}et(async()=>{if(!i.value)return;function E(C){return new Promise((F,V)=>{const O=new Image;O.onload=()=>F(O),O.onerror=ae=>{f(":",C,ae),V(ae)},O.src=C})}function T(C,F){i.value&&(i.value.style.setProperty(C,String(F)),f(` CSS  ${C} = ${F}`))}try{const[C,F,V]=await Promise.all([E(H("ui/panel.png")),E(H("ui/btn.png")),E(H("ui/currentcupper.png"))]),O=Math.max(4,Math.round(C.naturalHeight/4)),ae=Math.max(3,Math.round(F.naturalHeight/3)),ee=Math.max(3,Math.round(V.naturalHeight/4));f(":",{panelSlice:O,btnSlice:ae,currentSlice:ee,currentImgSize:`${V.naturalWidth}x${V.naturalHeight}`}),T("--panel-slice",O),T("--btn-slice",ae),T("--current-slice",ee),setTimeout(()=>{const q=getComputedStyle(i.value);f("CSS :",{"--current-slice":q.getPropertyValue("--current-slice"),"--panel-slice":q.getPropertyValue("--panel-slice"),"--btn-slice":q.getPropertyValue("--btn-slice")})},100)}catch(C){f(":",C),T("--panel-slice","8"),T("--btn-slice","11"),T("--current-slice","8")}});const R={props:n,emit:o,turnSystemRef:i,choiceImgSrc:r,choiceActiveImgSrc:a,ribbonLeftSrc:l,ribbonMiddleSrc:c,ribbonRightSrc:u,panelSrc:d,round1Src:h,currentCupperSrc:m,btnSrc:_,currentCopperInfo:v,handleNextCopper:S,handleEndRound:x,handleSelectCopper:I,get log(){return f},computed:Ee,onMounted:et,ref:U,get eventloop(){return Ae},get getAssetUrl(){return H}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}},Ob={ref:"turnSystemRef",class:"turn-system"},Lb={class:"panel"},Db={class:"panel-inner"},Nb={class:"section section-header"},$b=["aria-label"],Gb={class:"section section-body"},Hb={class:"current-doll",role:"status","aria-live":"polite"},Ub={key:0},Fb={class:"section section-choices",role:"group","aria-label":"Character Queue"},jb=["aria-pressed","data-copper-id","title","onClick"],Bb=["alt","src","data-default-src","data-selected-src"],Vb={class:"actions"},zb=["disabled"],Wb=["disabled"];function qb(t,e,s,n,o,i){return D(),W("div",Ob,[e[0]||(e[0]=p("div",{class:"ribbon","aria-hidden":"true"},[p("div",{class:"ribbon-cap left"}),p("div",{class:"ribbon-fill"},"CONTROL"),p("div",{class:"ribbon-cap right"})],-1)),p("div",Lb,[p("div",Db,[p("section",Nb,[p("div",{class:"round-header",role:"img","aria-label":`Round ${s.roundNumber}`}," Round "+se(s.roundNumber),9,$b)]),p("section",Gb,[p("div",Hb,[p("span",null,se(n.currentCopperInfo?`${n.currentCopperInfo.name||` #${s.currentCopperId}`}`:""),1),n.currentCopperInfo&&!n.currentCopperInfo.isSummon?(D(),W("span",Ub," Lv."+se(n.currentCopperInfo.level??0)+" ",1)):Me("",!0)])]),p("section",Fb,[(D(!0),W(Je,null,qt(s.copperList,r=>(D(),W("button",{key:r.id,class:"choice",type:"button","aria-pressed":String(r.id===s.currentCopperId),"data-copper-id":r.id,title:r.name||` #${r.id}`,onClick:a=>n.handleSelectCopper(r.id)},[p("img",{alt:r.name||`Character ${r.id}`,src:r.id===s.currentCopperId?n.choiceActiveImgSrc:n.choiceImgSrc,"data-default-src":n.choiceImgSrc,"data-selected-src":n.choiceActiveImgSrc},null,8,Bb)],8,jb))),128))])])]),p("div",Vb,[p("button",{class:"btn btn-primary",onClick:n.handleNextCopper,disabled:!s.currentCopperId||s.isEnemyMoving},"  ",8,zb),p("button",{class:"btn btn-secondary",onClick:n.handleEndRound,disabled:s.isEnemyMoving},"  ",8,Wb)])],512)}const Kb=yt(Ib,[["render",qb],["__scopeId","data-v-403c6abe"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/TurnSystem.vue"]]),Xb={__name:"SummonModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},enemyList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","summon"],setup(t,{expose:e,emit:s}){e(),Kt(m=>({"f4bd8aaf-panel6Src":n}));const n=`url('${H("@assets/ui/panel6.png")}')`,o=t,i=s,r=U(null),a=Ee(()=>[...o.enemyList].sort((m,_)=>m.level-_.level));function l(m){r.value=m}function c(){if(!r.value){f("[SummonModal] ");return}f("[SummonModal] :",r.value.name),i("summon",r.value.name),u()}function u(){r.value=null,i("close")}function d(m){return{goblin:"",cruiser:"",scout:"",boxer:"",horn:"",assassin:"",devourer:"",mirror:"",guard:"",demon:"",variant:"",shatra:"BOSS",glutton:"BOSS"}[m]||m}const h={panel6Src:n,props:o,emit:i,selectedEnemy:r,sortedEnemies:a,selectEnemy:l,handleConfirm:c,handleClose:u,getEnemyTypeLabel:d,ref:U,computed:Ee,get getAssetUrl(){return H},get log(){return f}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}},Yb={class:"modal-info"},Jb={class:"info-text"},Zb={class:"copper-name"},Qb={class:"cost-text"},ew=["src"],tw={class:"modal-body"},nw={class:"enemy-list"},sw=["onClick"],ow={class:"enemy-header"},rw={class:"enemy-name-row"},iw={class:"enemy-name"},aw={class:"enemy-level"},lw={class:"enemy-type"},cw={class:"enemy-stats"},uw={class:"stat"},dw={class:"stat-value"},fw={class:"stat"},pw={class:"stat-value"},hw={class:"stat"},mw={class:"stat-value"},gw={class:"stat"},_w={class:"stat-value"},yw={class:"stat"},vw={class:"stat-value"},bw={class:"enemy-desc"},ww={key:0,class:"selected-badge"},Sw={class:"modal-footer"},Mw=["disabled"];function Tw(t,e,s,n,o,i){return D(),Ht(Pc,{to:"body"},[s.visible?(D(),W("div",{key:0,class:"modal-overlay",onClick:Pn(n.handleClose,["self"])},[p("div",{class:"summon-modal",onClick:e[0]||(e[0]=Pn(()=>{},["stop"]))},[p("div",{class:"modal-header"},[e[1]||(e[1]=p("h2",{class:"modal-title"}," ",-1)),p("button",{class:"close-btn",onClick:n.handleClose,title:""},"")]),p("div",Yb,[p("p",Jb,[p("span",Zb,se(s.copperName),1),e[2]||(e[2]=jn("  ",-1))]),p("p",Qb,[p("img",{class:"cost-icon",src:n.getAssetUrl("resource/spiritual_spark.webp"),alt:""},null,8,ew),e[3]||(e[3]=jn(" ",-1)),e[4]||(e[4]=p("strong",null,"1 ",-1))])]),p("div",tw,[p("div",nw,[(D(!0),W(Je,null,qt(n.sortedEnemies,r=>{var a,l;return D(),W("div",{key:r.name,class:Qe(["enemy-card",{selected:((a=n.selectedEnemy)==null?void 0:a.name)===r.name}]),onClick:c=>n.selectEnemy(r)},[p("div",ow,[p("div",rw,[p("span",iw,se(r.name),1),p("span",aw,"Lv."+se(r.level),1)]),p("span",lw,se(n.getEnemyTypeLabel(r.enemy_type)),1)]),p("div",cw,[p("div",uw,[e[5]||(e[5]=p("span",{class:"stat-label"},"",-1)),p("span",dw,se(r.health),1)]),p("div",fw,[e[6]||(e[6]=p("span",{class:"stat-label"},"",-1)),p("span",pw,se(r.attack),1)]),p("div",hw,[e[7]||(e[7]=p("span",{class:"stat-label"},"",-1)),p("span",mw,se(r.defense),1)]),p("div",gw,[e[8]||(e[8]=p("span",{class:"stat-label"},"",-1)),p("span",_w,se(r.attack_range),1)]),p("div",yw,[e[9]||(e[9]=p("span",{class:"stat-label"},"",-1)),p("span",vw,se(r.move_range),1)])]),p("div",bw,se(r.description),1),((l=n.selectedEnemy)==null?void 0:l.name)===r.name?(D(),W("div",ww,"   ")):Me("",!0)],10,sw)}),128))])]),p("div",Sw,[p("button",{class:"btn btn-cancel",onClick:n.handleClose},""),p("button",{class:"btn btn-confirm",disabled:!n.selectedEnemy,onClick:n.handleConfirm},"  ",8,Mw)])])])):Me("",!0)])}const Cw=yt(Xb,[["render",Tw],["__scopeId","data-v-f4bd8aaf"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ActionPanelParts/SummonModal.vue"]]),Ew={__name:"StructurePanel",props:{structure:{type:Object,required:!0},resources:{type:Array,default:()=>[]},actionMode:{type:String,default:null}},emits:["close","action","cancel"],setup(t,{expose:e,emit:s}){e(),Kt(F=>({"76912848-panel11Src":S}));const n=t,o=s,i=Ee(()=>{var F;return((F=n.structure.structure_base)==null?void 0:F.name)||""}),r=Ee(()=>n.structure.owned||!1),a=Ee(()=>{var F;return((F=n.structure.structure_base)==null?void 0:F.has_storage)||!1}),l=Ee(()=>n.structure.storage||null),c=Ee(()=>n.structure.can_move||!1),u=Ee(()=>n.structure.can_attack||!1),d=Ee(()=>n.structure.now_health||0),h=Ee(()=>{var F;return((F=n.structure.structure_base)==null?void 0:F.health)||100}),m=Ee(()=>h.value===0?0:Math.max(0,Math.min(100,d.value/h.value*100))),_=Ee(()=>{const F=m.value;return F>60?"#4ade80":F>30?"#facc15":"#ef4444"}),v=H("@assets/ui/panel.png"),S=`url('${H("@assets/ui/panel11.png")}')`,x=Ee(()=>n.actionMode!==null),I=Ee(()=>n.actionMode==="move"?"...":n.actionMode==="attack"?"...":n.actionMode==="extract"?"...":n.actionMode==="transfer"?"...":"");function R(F){f(`[StructurePanel] : ${F}`),o("action",{type:F})}function E(){f("[StructurePanel] "),o("cancel")}function T(){o("close")}const C={props:n,emit:o,structureName:i,isOwned:r,hasStorage:a,storage:l,canMove:c,canAttack:u,nowHealth:d,maxHealth:h,healthPercent:m,healthColor:_,panelSrc:v,panel11Src:S,isInActionMode:x,actionModeText:I,handleAction:R,handleCancel:E,handleClose:T,get log(){return f},ref:U,computed:Ee,watch:lt,nextTick:hn,get getAssetUrl(){return H},get getItemName(){return tr}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}},xw={key:0,class:"minimized-content"},Aw={class:"minimized-info"},kw={class:"minimized-name"},Rw={class:"minimized-action"},Pw={key:1},Iw={class:"structure-panel__header"},Ow={class:"structure-panel__title"},Lw={class:"structure-panel__body"},Dw={class:"structure-panel__health"},Nw={class:"structure-panel__health-bar"},$w={class:"structure-panel__health-text"},Gw={key:0,class:"structure-panel__storage"},Hw={class:"structure-panel__storage-content"},Uw={key:0,class:"structure-panel__storage-item"},Fw={class:"structure-panel__storage-name"},jw={class:"structure-panel__storage-count"},Bw={key:1,class:"structure-panel__storage-empty"},Vw={key:1,class:"structure-panel__ground-resources"},zw={class:"structure-panel__ground-list"},Ww={class:"structure-panel__resource-name"},qw={class:"structure-panel__resource-count"},Kw={key:2,class:"structure-panel__actions"};function Xw(t,e,s,n,o,i){return D(),W("div",{class:Qe(["structure-panel",{"structure-panel--minimized":n.isInActionMode}])},[n.isInActionMode?(D(),W("div",xw,[p("div",Aw,[p("span",kw,se(n.structureName),1),p("span",Rw,se(n.actionModeText),1)]),p("div",{class:"minimized-actions"},[p("button",{class:"mini-btn mini-btn--cancel",onClick:n.handleCancel,title:""},"  ")])])):(D(),W("div",Pw,[p("div",Iw,[p("div",Ow,[jn(se(n.structureName)+" ",1),p("span",{class:Qe(["structure-panel__badge",{"structure-panel__badge--owned":n.isOwned}])},se(n.isOwned?"":""),3)]),p("button",{class:"structure-panel__close",onClick:n.handleClose,"aria-label":""},"  ")]),p("div",Lw,[p("div",Dw,[e[4]||(e[4]=p("div",{class:"structure-panel__health-label"},"",-1)),p("div",Nw,[p("div",{class:"structure-panel__health-fill",style:zt({width:n.healthPercent+"%",backgroundColor:n.healthColor})},null,4)]),p("div",$w,se(Math.ceil(n.nowHealth))+" / "+se(Math.ceil(n.maxHealth)),1)]),n.hasStorage?(D(),W("div",Gw,[e[5]||(e[5]=p("div",{class:"structure-panel__storage-label"},"",-1)),p("div",Hw,[n.storage?(D(),W("div",Uw,[p("span",Fw,se(n.getItemName(n.storage)),1),p("span",jw,"x"+se(n.storage.count||0),1)])):(D(),W("div",Bw,""))])])):Me("",!0),s.resources&&s.resources.length>0?(D(),W("div",Vw,[e[6]||(e[6]=p("div",{class:"structure-panel__ground-label"},"",-1)),p("div",zw,[(D(!0),W(Je,null,qt(s.resources,(r,a)=>(D(),W("div",{key:a,class:"structure-panel__ground-item"},[p("span",Ww,se(r.name||""),1),p("span",qw,"x"+se(r.count||0),1)]))),128))])])):Me("",!0),n.isOwned?(D(),W("div",Kw,[n.canMove?(D(),W("button",{key:0,class:"structure-panel__action-btn structure-panel__action-btn--move",onClick:e[0]||(e[0]=r=>n.handleAction("move"))},"  ")):Me("",!0),n.canAttack?(D(),W("button",{key:1,class:"structure-panel__action-btn structure-panel__action-btn--attack",onClick:e[1]||(e[1]=r=>n.handleAction("attack"))},"  ")):Me("",!0),n.hasStorage&&n.storage?(D(),W("button",{key:2,class:"structure-panel__action-btn structure-panel__action-btn--transfer",onClick:e[2]||(e[2]=r=>n.handleAction("transfer"))},"  ")):Me("",!0),n.hasStorage?(D(),W("button",{key:3,class:"structure-panel__action-btn structure-panel__action-btn--extract",onClick:e[3]||(e[3]=r=>n.handleAction("extract"))},"  ")):Me("",!0)])):Me("",!0)])]))],2)}const Yw=yt(Ew,[["render",Xw],["__scopeId","data-v-76912848"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/StructurePanel.vue"]]),Jw={__name:"ResourcePanel",setup(t,{expose:e}){Kt(h=>({"e44a1df5-panel5Src":n}));const s=H("@assets/ui/panel5.png"),n=`url('${s}')`,o=U({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0}),i=["HeartCrystalDust","RecallGear","ResonantCrystal","RefinedCopper"],r=U(!1),a=U({visible:!1,success:!0,text:""});function l(h,m=!0,_=1500){a.value={visible:!0,success:m,text:h},window.clearTimeout(l._timer),l._timer=window.setTimeout(()=>{a.value.visible=!1},_)}async function c(){if(!r.value){r.value=!0;try{const h=await dl();An(vt.UPDATE_RESOURCES),(h==null?void 0:h.type)==="error"?(console.warn("[ResourcePanel] :",(h==null?void 0:h.content)||h),l("",!1)):(console.log("[ResourcePanel] :",h),l("",!0))}catch(h){console.error("[ResourcePanel] :",h),l("",!1)}finally{r.value=!1}}}async function u(){try{const h=await Vn();if(h){const m={},_={};return Object.keys(o.value).forEach(v=>{const S=o.value[v],x=h[v]||0;_[v]=x;const I=x-S;I>0&&(m[v]=I)}),o.value=_,An(vt.RESOURCES_UPDATED,m),m}}catch(h){console.error("[ResourcePanel] :",h)}return{}}et(()=>{u(),Bn(vt.UPDATE_RESOURCES,u)}),_t(()=>{cs(vt.UPDATE_RESOURCES,u)}),e({updateResources:u});const d={buildIconSrc:s,panel5Src:n,resources:o,recipeItems:i,isCrafting:r,toast:a,showToast:l,handleCraft:c,updateResources:u,ref:U,onMounted:et,onBeforeUnmount:_t,get get_resource(){return Vn},get craft(){return dl},get getResourceIcon(){return Wh},get getResourceName(){return yu},get RESOURCE_META(){return In},get onEvent(){return Bn},get offEvent(){return cs},get emitEvent(){return An},get EventTypes(){return vt},get getAssetUrl(){return H}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}},Zw={class:"resource-panel"},Qw={class:"resource-list"},eS={class:"resource-layout"},tS={class:"row row-top"},nS=["title"],sS=["src","alt"],oS={class:"resource-count"},rS={class:"resource-tooltip"},iS=["title"],aS=["src","alt"],lS={class:"resource-count"},cS={class:"resource-tooltip"},uS={class:"row row-middle"},dS=["title"],fS=["src","alt"],pS={class:"resource-count"},hS={class:"resource-tooltip"},mS={class:"row row-bottom"},gS=["title"],_S=["src","alt"],yS={class:"resource-count"},vS={class:"resource-tooltip"},bS=["title"],wS=["src","alt"],SS={class:"resource-count"},MS={class:"resource-tooltip"},TS={class:"crafting-section"},CS={class:"crafting-grid"},ES=["src"],xS={class:"craft-count"},AS={class:"craft-arrow-group"},kS=["src","alt"],RS={class:"craft-result"},PS={class:"recipe-display"},IS=["src"],OS={class:"craft-count"};function LS(t,e,s,n,o,i){var r;return D(),W("div",Zw,[e[0]||(e[0]=p("div",{class:"resource-header"},[p("span",{class:"header-text"},"")],-1)),p("div",Qw,[p("div",eS,[p("div",tS,[p("div",{class:"resource-slot small",title:n.getResourceName("RecallGear")},[n.getResourceIcon("RecallGear")?(D(),W("img",{key:0,src:n.getResourceIcon("RecallGear"),alt:n.getResourceName("RecallGear"),class:"resource-icon"},null,8,sS)):Me("",!0),p("div",oS,se(n.resources.RecallGear||0),1),p("div",rS,se(n.getResourceName("RecallGear")),1)],8,nS),p("div",{class:"resource-slot small",title:n.getResourceName("HeartCrystalDust")},[n.getResourceIcon("HeartCrystalDust")?(D(),W("img",{key:0,src:n.getResourceIcon("HeartCrystalDust"),alt:n.getResourceName("HeartCrystalDust"),class:"resource-icon"},null,8,aS)):Me("",!0),p("div",lS,se(n.resources.HeartCrystalDust||0),1),p("div",cS,se(n.getResourceName("HeartCrystalDust")),1)],8,iS)]),p("div",uS,[p("div",{class:"resource-slot large",title:n.getResourceName("SpiritalSpark")},[n.getResourceIcon("SpiritalSpark")?(D(),W("img",{key:0,src:n.getResourceIcon("SpiritalSpark"),alt:n.getResourceName("SpiritalSpark"),class:"resource-icon"},null,8,fS)):Me("",!0),p("div",pS,se(n.resources.SpiritalSpark||0),1),p("div",hS,se(n.getResourceName("SpiritalSpark")),1)],8,dS)]),p("div",mS,[p("div",{class:"resource-slot small",title:n.getResourceName("ResonantCrystal")},[n.getResourceIcon("ResonantCrystal")?(D(),W("img",{key:0,src:n.getResourceIcon("ResonantCrystal"),alt:n.getResourceName("ResonantCrystal"),class:"resource-icon"},null,8,_S)):Me("",!0),p("div",yS,se(n.resources.ResonantCrystal||0),1),p("div",vS,se(n.getResourceName("ResonantCrystal")),1)],8,gS),p("div",{class:"resource-slot small",title:n.getResourceName("RefinedCopper")},[n.getResourceIcon("RefinedCopper")?(D(),W("img",{key:0,src:n.getResourceIcon("RefinedCopper"),alt:n.getResourceName("RefinedCopper"),class:"resource-icon"},null,8,wS)):Me("",!0),p("div",SS,se(n.resources.RefinedCopper||0),1),p("div",MS,se(n.getResourceName("RefinedCopper")),1)],8,bS)])])]),p("div",TS,[p("div",CS,[(D(),W(Je,null,qt(n.recipeItems,(a,l)=>{var c;return p("div",{class:"craft-slot",key:l},[(c=n.RESOURCE_META[a])!=null&&c.icon?(D(),W("img",{key:0,src:n.RESOURCE_META[a].icon,class:"craft-icon"},null,8,ES)):Me("",!0),p("div",xS,se(n.resources[a]||0),1)])}),64))]),p("div",AS,[p("img",{class:Qe(["craft-arrow-img",{disabled:n.isCrafting}]),src:n.getAssetUrl("@assets/ui/upgrade.png"),alt:n.isCrafting?"":"",onClick:n.handleCraft},null,10,kS),n.toast.visible?(D(),W("div",{key:0,class:Qe(["craft-toast",{success:n.toast.success,error:!n.toast.success}])},se(n.toast.text),3)):Me("",!0)]),p("div",RS,[p("div",PS,[(r=n.RESOURCE_META.SpiritalSpark)!=null&&r.icon?(D(),W("img",{key:0,src:n.RESOURCE_META.SpiritalSpark.icon,class:"recipe-icon"},null,8,IS)):Me("",!0),p("div",OS,se(n.resources.SpiritalSpark||0),1)])])])])}const DS=yt(Jw,[["render",LS],["__scopeId","data-v-e44a1df5"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/ResourcePanel.vue"]]),Rl=.2,NS=.003,Pl="url('/assets/panel7.png')",Il="url('/assets/panel8.png')",$S={__name:"GameScene",props:{isGameMode:{type:Boolean,default:!1},musicOn:{type:Boolean,default:!0}},emits:["back"],setup(t,{expose:e,emit:s}){e(),Kt(w=>({"76eb1444-panel7Src":Pl,"76eb1444-panel8Src":Il}));const n=t,o=U(null),i=s,r=U(null),a=H("@assets/frontend_resource/gamescene.mp3"),l=U(null),c=U(null),u=U(null),d=U(null),h=U(null),m=U(null),_=H("@assets/frontend_resource/move.mp3"),v=H("@assets/frontend_resource/move_enemy.mp3"),S=H("@assets/frontend_resource/attack.mp3"),x=H("@assets/frontend_resource/attack_enemy.mp3"),I=H("@assets/frontend_resource/me_hurt.mp3"),R=H("@assets/frontend_resource/enemy_hurt.mp3");let E,T,C,F,V=[],O={focusPosition:null,focusTarget:null,lerpFactor:.08},ae=null,ee=new Nt,q=null,L=null,Q=null,we=null;const ye=new Map,Y={w:!1,a:!1,s:!1,d:!1,shift:!1,space:!1},ve=U(zr("controlMode")||"touchpad"),Ge=U(zr("mouseSensitivity")||.002);window.updateControlMode=w=>{ve.value=w,f(`[GameScene] : ${w}`)},window.updateMouseSensitivity=w=>{Ge.value=w};function ue(w){const P=w.key.toLowerCase();P==="w"||P==="a"||P==="s"||P==="d"?Y[P]=!0:P==="shift"?Y.shift=!0:P===" "?(Y.space=!0,w.preventDefault()):P==="escape"&&document.pointerLockElement&&document.exitPointerLock()}function A(w){const P=w.key.toLowerCase();P==="w"||P==="a"||P==="s"||P==="d"?Y[P]=!1:P==="shift"?Y.shift=!1:P===" "&&(Y.space=!1)}let de=!1,$=0,ce=0,pe=0,He=0,De=!1;function Ke(w){w.button===0&&(ve.value==="mouse"&&o.value&&o.value.requestPointerLock(),de=!0,$=w.clientX,ce=w.clientY)}function Ve(){de=!1}function st(w){if(ve.value==="touchpad"){if(!de)return;const P=w.clientX-$,Z=w.clientY-ce;He-=P*Ge.value,pe-=Z*Ge.value,$=w.clientX,ce=w.clientY}else if(ve.value==="mouse"&&De){const P=w.movementX||0,Z=w.movementY||0;He-=P*Ge.value,pe-=Z*Ge.value}pe=Math.max(-Math.PI/2,Math.min(Math.PI/2,pe)),T.rotation.order="YXZ",T.rotation.y=He,T.rotation.x=pe}function at(){De=document.pointerLockElement===o.value,f(De?"[GameScene] ":"[GameScene] ")}function Lt(){f("[GameScene] ")}const g=U(null),b=U([]),k=U(null),z=U(!1),j=U([]),G=U([]),K=U(null),J=U(null),X=U(!1),B=U(null),me=U([]),re=U(null),he=U(1),fe=U([]),_e=U(-1),le=U(null),ke=U(!1),Ze=U(new Set),nt=U(!1),pt=new Map,wt=U(!1),Ft=U(!1),an=U(!1),ot=U(!1),jt=Ee(()=>{if(fe.value.length===0||_e.value<0||_e.value>=fe.value.length)return null;const w=fe.value[_e.value];return w?w.id:null});et(async()=>{var P;f("[GameScene] "),Os(),f("[GameScene] "),Vi(),f("[GameScene] ");const{messageQueue:w}=await vu(async()=>{const{messageQueue:Z}=await Promise.resolve().then(()=>Jh);return{messageQueue:Z}},void 0);if((P=w.sceneContext)!=null&&P.setTestMode&&w.sceneContext.setTestMode("eventloop"),window.__ACTUAL_COPPER_IDS__){const Z=window.__ACTUAL_COPPER_IDS__;f("[GameScene] ID:",Z);const ne=JSON.stringify({type:"on_game_start",content:{ids:Z}});Ae(ne).catch(be=>{f("[GameScene] ",be)}),delete window.__ACTUAL_COPPER_IDS__}else f("[GameScene] ID");window.addEventListener("keydown",ue),window.addEventListener("keyup",A),window.addEventListener("mousedown",Ke),window.addEventListener("mouseup",Ve),window.addEventListener("mousemove",st),document.addEventListener("pointerlockchange",at),document.addEventListener("pointerlockerror",Lt),wr(),window.setCameraFocus=(Z=8,ne=6)=>{window.cameraFocusDistance=Z,window.cameraFocusHeight=ne,f(`[GameScene] : =${Z}, =${ne}`)},window.resetCamera=()=>{T.position.set(0,10,15),T.lookAt(0,0,0),He=T.rotation.y,pe=T.rotation.x,O.focusPosition=null,O.focusTarget=null,f("[GameScene] ")},window.toggleAutoFocus=()=>{window.disableAutoFocus=!window.disableAutoFocus,f(`[GameScene] ${window.disableAutoFocus?"":""}`),window.disableAutoFocus&&(O.focusPosition=null,O.focusTarget=null)},n.musicOn&&r.value&&setTimeout(()=>{if(r.value.readyState>=2)r.value.play().then(()=>{f("[GameScene] ")}).catch(ne=>{f("[GameScene] :",ne)});else{const ne=()=>{r.value.play().then(()=>{f("[GameScene] ")}).catch(be=>{f("[GameScene] :",be)}),r.value.removeEventListener("canplay",ne)};r.value.addEventListener("canplay",ne,{once:!0})}},200)}),lt(()=>n.musicOn,w=>{if(r.value)if(w)if(r.value.readyState>=2)r.value.play().catch(P=>{f("[GameScene] :",P)});else{const P=()=>{r.value.play().catch(Z=>{f("[GameScene] :",Z)}),r.value.removeEventListener("canplay",P)};r.value.addEventListener("canplay",P)}else r.value.pause()}),_t(()=>{window.removeEventListener("resize",br),window.removeEventListener("click",Sr),window.removeEventListener("keydown",ue),window.removeEventListener("keyup",A),window.removeEventListener("mousedown",Ke),window.removeEventListener("mouseup",Ve),window.removeEventListener("mousemove",st),document.removeEventListener("pointerlockchange",at),document.removeEventListener("pointerlockerror",Lt),document.pointerLockElement&&document.exitPointerLock(),r.value&&r.value.pause(),L&&L.dispose(),Q&&Q.dispose(),we&&we.dispose(),C&&C.dispose()});function Os(){E=new or,E.background=new gn(2236962),T=new lo(60,window.innerWidth/window.innerHeight,.1,2e3),T.position.set(0,5,10),ae=new pa,C=new rr({antialias:!0}),C.setSize(window.innerWidth,window.innerHeight),C.setPixelRatio(window.devicePixelRatio),o.value.appendChild(C.domElement),F=null;const w=new ir(16777215,.8);E.add(w);const P=new kn(16777215,1);P.position.set(5,10,5),E.add(P),q=new us;const Z=new ds;Z.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),q.setDRACOLoader(Z),n.isGameMode&&window.addEventListener("click",Sr),Ls(),L=xl(E,T),Q=Al(E),we=kl(E),f("[GameScene] "),f('[GameScene] - /(ID=1,2)""'),f("[GameScene] - EventLoop"),window.addEventListener("resize",br)}function Ls(){const w=new Yt(.8,.8,.8),P=new Gt({color:4491519}),Z=new rt(w,P);Z.position.set(.5,.4,.5),E.add(Z),V.push({id:1,object:Z,name:"1",type:"test"});const ne=new Yt(.8,.8,.8),be=new Gt({color:16729156}),y=new rt(ne,be);y.position.set(4.5,.4,4.5),E.add(y),V.push({id:2,object:y,name:"2",type:"test"}),f("[GameScene] :",V.map(M=>`ID=${M.id}`))}async function Fi(w,P,Z,ne=1){const be=io(w,P);try{const y=await Mt.loadModel(be,!0);f(`[GameScene] : ${P}`);const M=y.clone(!0);M.traverse(Te=>{Te.material&&(Array.isArray(Te.material)?Te.material=Te.material.map(Ce=>Ce.clone()):Te.material=Te.material.clone())});const oe=new kt().setFromObject(M).getSize(new Pe),ie=new Jt;ie.add(M),ie.position.set(Z[0],0,Z[1]),ie.scale.set(ne,ne,ne),ie.rotation.y=0;const ge=new kt().setFromObject(ie);return ie.position.y=-ge.min.y,f(`[GameScene] : ${P}, URL: ${be}`),ie}catch(y){return f(`[GameScene] : ${P}`,y),null}}async function ji(w,P,Z=1,ne="model"){try{const be=await Mt.loadModel(w,!0);f(`[GameScene] : ${ne}, url=${w}`);const y=be.clone(!0);y.traverse(ie=>{ie.material&&(Array.isArray(ie.material)?ie.material=ie.material.map(ge=>ge.clone()):ie.material=ie.material.clone())});const N=new kt().setFromObject(y).getSize(new Pe),oe=new Jt;return oe.add(y),oe.position.set(P[0],0,P[1]),oe.scale.set(Z,Z,Z),oe}catch(be){return f(`[GameScene] : ${ne}, url=${w}, error=${be}`),null}}async function Bi(w,P,Z=1){const ne=ao(w);try{const be=await Mt.loadModel(ne,!0);f(`[GameScene] : ${w}`);const y=be.clone(!0);y.traverse(Te=>{Te.material&&(Array.isArray(Te.material)?Te.material=Te.material.map(Ce=>Ce.clone()):Te.material=Te.material.clone())});const N=new kt().setFromObject(y).getSize(new Pe),oe=new Jt;oe.add(y),oe.position.set(P[0],0,P[1]),oe.scale.set(Z,Z,Z),oe.rotation.y=0;const ie=new kt().setFromObject(oe);oe.position.y=-ie.min.y;const ge=new vs(16729156,2.5,12);return ge.position.set(0,N.y*Z*.8,0),oe.add(ge),f(`[GameScene] : ${w}, URL: ${ne}`),oe}catch(be){return f(`[GameScene] : ${w}`,be),null}}let fs=null;function Vi(){const w=new Map,P=new Map,Z=new Map;function ne(y,M,N){const oe=V.find(Ce=>Ce.id===y);if(!oe||!oe.object)return;let ie,ge;M==="move"?(ie=65280,ge=.8):M==="attack"?(ie=16711680,ge=1):M==="summon"?(ie=16776960,ge=1.2):(ie=16777215,ge=1),w.has(y)||w.set(y,{});const Te=w.get(y);if(Te[M]&&(E.remove(Te[M]),Te[M].geometry.dispose(),Te[M].material.dispose(),delete Te[M]),N){const Ce=new Zr(ge-.1,ge,32),Oe=new Pt({color:ie,side:Un,transparent:!0,opacity:.6}),Xe=new rt(Ce,Oe);Xe.rotation.x=-Math.PI/2,Xe.position.set(oe.object.position.x,.1,oe.object.position.z),E.add(Xe),Te[M]=Xe}}const be=y=>{if(V.forEach(M=>{M.object&&(M.object.scale.set(1,1,1),M.object.traverse(N=>{var oe;N.material&&((oe=N.material.emissive)==null||oe.setHex(0),N.material.emissiveIntensity!==void 0&&(N.material.emissiveIntensity=0))}))}),y!==null){const M=V.find(N=>N.id===y);if(M){M.object.scale.set(1.1,1.1,1.1),M.object.traverse(oe=>{oe.material&&oe.material.emissive&&(oe.material.emissive.setHex(16755200),oe.material.emissiveIntensity=.5)});const N=M.type==="summon"?"":M.type==="copper"?"":"";f(`[GameScene] ${N}: ${M.name} (ID=${y})`)}}};fs=(y,M)=>{const N=V.find(ut=>ut.id===y);if(!N)return;const oe=new Map;N.object.traverse(ut=>{ut.material&&ut.material.emissive&&(oe.set(ut,{color:ut.material.emissive.getHex(),intensity:ut.material.emissiveIntensity||0}),ut.material.emissive.setHex(16711680),ut.material.emissiveIntensity=.8)}),setTimeout(()=>{oe.forEach((ut,Xt)=>{Xt.material&&Xt.material.emissive&&(Xt.material.emissive.setHex(ut.color),Xt.material.emissiveIntensity=ut.intensity)})},500);const ie=new Pe(N.object.position.x,.5,N.object.position.z),ge=new Pe(M[0],.5,M[1]),Te=new Pe().subVectors(ge,ie),Ce=Te.length(),Oe=new Pe().addVectors(ie,ge).multiplyScalar(.5),Xe=new Do(.05,.05,Ce,8),Ue=new Pt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5}),Ne=new rt(Xe,Ue);Ne.position.copy(Oe),Ne.quaternion.setFromUnitVectors(new Pe(0,1,0),Te.normalize()),E.add(Ne);const je=new Zr(.2,.4,32),qe=new Pt({color:16711680,side:Un,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5}),Et=new rt(je,qe);Et.rotation.x=-Math.PI/2,Et.position.copy(ge),E.add(Et);const Wn=performance.now(),ht=300;function mt(){const Xt=(performance.now()-Wn)/ht;if(Xt<1){const Ns=1-Xt;Ue&&(Ue.opacity=Ns),qe&&(qe.opacity=Ns),Et.scale.set(1+Xt*2,1+Xt*2,1),requestAnimationFrame(mt)}else E.remove(Ne),E.remove(Et),Xe.dispose(),Ue.dispose(),je.dispose(),qe.dispose()}mt(),f(`[GameScene] : ID=${y}, =${ie.x.toFixed(1)},${ie.z.toFixed(1)}  [${M[0]},${M[1]}]`)},Re.setSceneContext({scene:E,camera:T,controls:F,models:V,gridCellSize:1,focusState:O,focusOnModel:zi,onShowCopperInfo:(y,M,N)=>{var ie,ge,Te,Ce,Oe,Xe,Ue,Ne,je,qe,Et;f(`[GameScene] onShowCopperInfo : type=${(ie=y.copper)==null?void 0:ie.copper_type}, can_build=${y.can_build}, can_summon=${y.can_summon}`),((ge=y.copper)==null?void 0:ge.copper_type)==="CraftsMan"&&y.id!==void 0&&pt.set(y.id,y.can_build===!0);const oe=((Ce=(Te=y.copper)==null?void 0:Te.copper_info)==null?void 0:Ce.name)||y.name||((Xe=(Oe=y.enemy)==null?void 0:Oe.enemy_base)==null?void 0:Xe.name)||((Ne=(Ue=y.enemy)==null?void 0:Ue.enemy_base)==null?void 0:Ne.enemy_type)||((je=y.enemy_base)==null?void 0:je.name)||((qe=y.enemy_base)==null?void 0:qe.enemy_type)||` #${y.id}`;((Et=y.copper)==null?void 0:Et.copper_type)==="CraftsMan"?(f(`[GameScene]  can_build=${y.can_build}  can_summon`),g.value={...y,name:oe,can_summon:y.can_build===!0}):g.value={...y,name:oe},b.value=M||[],z.value=N||!1,f(`[GameScene] : ID=${g.value.id}, has_attack_targets=${z.value}, can_summon=${g.value.can_summon}`)},onShowStructureInfo:(y,M)=>{var N;K.value=y,J.value={structure:y,resources:M},f(`[GameScene] : ID=${y.id}, =${(N=y.structure_base)==null?void 0:N.name}, =${y.now_health}/${y.structure_base.health}`)},highlightSelectedCopper:be,createAttackEffect:fs,onMoveStart:(y,M)=>{n.isGameMode&&ke.value&&(M==null?void 0:M.type)==="enemy"&&!(M!=null&&M.isOwned)&&(f(`[GameScene]  ${y} `),Ze.value.add(y))},onMoveComplete:y=>{if(!n.isGameMode)return;const M=V.find(ge=>ge.id===y);if((M==null?void 0:M.type)==="structure"){f("[GameScene] "),le.value=null,nt.value=!1,setTimeout(async()=>{await hs(y)},300);return}if((M==null?void 0:M.type)==="enemy"&&!(M!=null&&M.isOwned)){ke.value&&Ze.value.has(y)?(f(`[GameScene]  ${y} `),Ze.value.delete(y),Ze.value.size===0&&(f("[GameScene] "),ke.value=!1)):f(`[GameScene]  ${y} `);return}const oe=fe.value.some(ge=>ge.id===y),ie=(M==null?void 0:M.type)==="summon"||(M==null?void 0:M.isOwned);!oe&&!ie||(nt.value=!1,f("[GameScene] "),le.value=null,k.value&&k.value.cancelAction(),setTimeout(async()=>{(M==null?void 0:M.type)==="summon"?await Ds(y,!1):await ps(y),setTimeout(()=>{if(b.value&&b.value.length>0){f("[GameScene] ");return}Tr()},100)},300))},onCraftResult:(y,M)=>{f(`[GameScene] : ${y?"":""} - ${M}`),alert(M)},onResourceNotEnough:y=>{f(`[GameScene] : ${y}`),alert(` ${y}`),le.value=null,re.value=null,X.value=!1,B.value=null},onSummonFailed:y=>{f(`[GameScene] : ${y}`),alert(` ${y}`),le.value=null,X.value=!1,B.value=null},onShowSummonMenu:y=>{f("[GameScene] :",y),me.value=y||[]},onShowStructureMenu:y=>{var M;f("[GameScene] ",(y==null?void 0:y.length)||0,""),(M=k.value)!=null&&M.showBuildMenu?k.value.showBuildMenu(y||[]):f("[GameScene]  copperActionPanelRef.value.showBuildMenu ")},onRemoveCopper:y=>{const M=fe.value.findIndex(N=>N.id===y);M>-1&&(f(`[GameScene] : ID=${y}`),fe.value.splice(M,1),g.value&&g.value.id===y&&Mr(),fe.value.length===0||_e.value===M?_e.value=-1:_e.value>M?_e.value-=1:_e.value>=fe.value.length&&(_e.value=fe.value.length-1))},onShowResourceGain:(y,M)=>{f("[GameScene] :",y,M),we&&Object.keys(M).length>0&&we.createResourceGainEffect(y,M)},onGameOver:()=>{f("[GameScene] "),wt.value=!0},onGameSuccess:()=>{f("[GameScene] "),Ft.value=!0},onAttackComplete:y=>{if(!n.isGameMode)return;const M=V.find(oe=>oe.id===y);if((M==null?void 0:M.type)==="structure"){f("[GameScene] "),le.value=null,setTimeout(async()=>{await hs(y)},300);return}if(!fe.value.some(oe=>oe.id===y)){f("[GameScene] ");return}f("[GameScene] "),le.value=null,k.value&&k.value.cancelAction(),setTimeout(async()=>{(M==null?void 0:M.type)==="summon"?await Ds(y,!1):await ps(y),setTimeout(()=>{if(b.value&&b.value.length>0){f("[GameScene] ");return}Tr()},100)},300)},onSetMoveBlock:y=>{Q&&Q.createIndicator(y,"move"),f(`[GameScene] : =${y}`)},onSetAttackBlock:y=>{if(le.value==="transferring"){j.value.push(y);const M=V.find(N=>{if(N.type==="copper"&&N.object){const oe=N.object.position;return Math.abs(oe.x-y[0])<.1&&Math.abs(oe.z-y[1])<.1}return!1});if(M){const N=fe.value.find(ie=>ie.id===M.id);G.value.find(ie=>ie.id===M.id)||(G.value.push({id:M.id,name:M.name||(N?N.name:` #${M.id}`)||` #${M.id}`,position:y}),f(`[GameScene] : ${M.name||M.id} (ID=${M.id}), =${G.value.length}`))}else f(`[GameScene]  ${y} `)}else Q&&Q.createIndicator(y,"attack"),z.value=!0,f(`[GameScene] : ${y}`)},onSetCanSummonBlock:y=>{Q&&Q.createIndicator(y,"summon"),f(`[GameScene] : =${y}`)},onClearBlock:y=>{Q&&Q.clearIndicatorAt(y)},onSetCopper:async(y,M,N)=>{var Ue,Ne,je,qe,Et,Wn;if(f(`[GameScene] : id=${N.id}, pos=${M}`),V.find(ht=>ht.id===N.id)){f(`[GameScene] ID=${N.id}`);return}if(((Ue=N.copper)==null?void 0:Ue.copper_type)==="CraftsMan"&&(pt.set(N.id,N.can_build===!0),f(`[GameScene]  can_build : id=${N.id}, can_build=${N.can_build}`)),n.isGameMode){const ht={id:N.id,name:((Ne=N.copper.copper_info)==null?void 0:Ne.name)||` #${N.id}`,level:Number(((je=N.copper)==null?void 0:je.level)??0),turnDone:!1};fe.value.find(mt=>mt.id===N.id)||(fe.value.push(ht),f(`[GameScene] : ${ht.name}`))}const ie=N.copper.copper_type||"Arcanist",ge=((qe=N.copper.copper_info)==null?void 0:qe.name)||"default",Te=(Et=N.copper.copper_info)==null?void 0:Et.model_url;let Ce=1;switch(ie){case"IronWall":Ce=1.2;break;case"Arcanist":Ce=1;break;case"Mechanic":Ce=1.1;break;case"Resonator":Ce=1;break;case"CraftsMan":Ce=1;break;default:Ce=1}let Oe;if(Te&&Te.includes("/enemy/")){const ht=H(Te);if(f(`[GameScene] URL: ${Te} -> ${ht}`),Oe=await ji(ht,M,Ce,ge),Oe){const ut=new kt().setFromObject(Oe).getSize(new Pe),Xt=new kt().setFromObject(Oe);Oe.position.y=-Xt.min.y;const Ns=new vs(4474111,2.5,12);Ns.position.set(0,ut.y*Ce*.8,0),Oe.add(Ns)}}else{const ht=Tl(ge),mt=Cl(ie);f(`[GameScene] : =${ge}, =${ht}, type=${ie}, typeFolder=${mt}`),Oe=await Fi(mt,ht,M,Ce)}if(!Oe){f(`[GameScene] : ${ge}`);const ht=new Yt(.8,.8,.8);let mt=4491519;switch(ie){case"IronWall":mt=8947848;break;case"Arcanist":mt=16729224;break;case"Mechanic":mt=4521864;break;case"Resonator":mt=16755268;break;case"CraftsMan":mt=4474111;break}const ut=new Gt({color:mt});Oe=new rt(ht,ut),Oe.position.set(M[0],.4,M[1])}Oe.userData.modelId=N.id,E.add(Oe);const Xe={id:N.id,object:Oe,name:((Wn=N.copper.copper_info)==null?void 0:Wn.name)||`Copper_${N.id}`,type:"copper"};V.push(Xe),f(`[GameScene] : ${Xe.name} (ID=${N.id})`)},onSetEnemy:async(y,M,N)=>{var Ne,je,qe,Et,Wn;const oe=N.id,ie=N.owned||!1;if(f(`[GameScene] : id=${oe}, pos=${M}, owned=${ie}`),V.find(ht=>ht.id===oe)){f(`[GameScene] ID=${oe}`);return}const Ce=(((Ne=N.enemy_base)==null?void 0:Ne.enemy_type)||"").toLowerCase()||"goblin";let Oe=1;switch(Ce){case"demon":case"glutton":case"devourer":Oe=1.5;break;case"guard":case"horn":Oe=1.2;break;default:Oe=1}const Xe={id:oe,object:null,name:((je=N.enemy_base)==null?void 0:je.enemy_type)||`Enemy_${oe}`,type:ie?"summon":"enemy",position:M,isOwned:ie,isLoading:!0};V.push(Xe);let Ue=await Bi(Ce,M,Oe);if(!Ue){f(`[GameScene] : ${Ce}`);const ht=new Yt(.8,.8,.8),mt=new Gt({color:ie?4474111:16711680});Ue=new rt(ht,mt),Ue.position.set(M[0],.4,M[1])}if(ie&&Ue){const mt=new kt().setFromObject(Ue).getSize(new Pe),ut=new vs(4474111,2.5,12);ut.position.set(0,mt.y*Oe*.8,0),Ue.add(ut),f(`[GameScene] : ${Ce}`)}Ue.userData.modelId=oe,E.add(Ue),Xe.object=Ue,Xe.isLoading=!1,N.now_health!==void 0&&((qe=N.enemy_base)==null?void 0:qe.health)!==void 0&&L&&(L.createOrUpdateHealthBar(oe,N.now_health,N.enemy_base.health),f(`[GameScene] : ${Ce} (${N.now_health}/${N.enemy_base.health})`)),ie&&(fe.value.push({id:oe,name:((Et=N.enemy_base)==null?void 0:Et.name)||Ce,type:"summon",enemy:N}),f(`[GameScene] : ${Ce} (ID=${oe})`)),f(`[GameScene] : ${((Wn=N.enemy_base)==null?void 0:Wn.enemy_type)||oe}, owned=${ie}`)},onSetMaterial:async(y,M,N)=>{var Oe,Xe,Ue;if(f(`[GameScene] : id=${y}, pos=${M}, name=${(Oe=N.material_base)==null?void 0:Oe.name}`),V.find(Ne=>Ne.id===y)){f(`[GameScene] ID=${y}`);return}const ie=((Xe=N.material_base)==null?void 0:Xe.name)||"",ge=(Ue=N.material_base)==null?void 0:Ue.model_url;if(!ge){f("[GameScene] model_url");const Ne=new Yt(.5,.5,.5),je=new Gt({color:16755200,metalness:.3,roughness:.7}),qe=new rt(Ne,je);qe.position.set(M[0],.25,M[1]),qe.userData.modelId=y,E.add(qe),V.push({id:y,object:qe,name:ie||`Material_${y}`,type:"material"});return}const Te=al(ge);let Ce=null;try{const Ne=await Mt.loadModel(Te,!0),je=new Jt;je.add(Ne),je.position.set(M[0],0,M[1]),je.scale.set(1,1,1),je.rotation.y=0;const qe=new kt().setFromObject(je);je.position.y=-qe.min.y,Ce=je,f(`[GameScene] : ${ie}, URL: ${Te}`)}catch(Ne){f(`[GameScene] : ${ie}`,Ne);const je=new Yt(.5,.5,.5),qe=new Gt({color:16755200,metalness:.3,roughness:.7});Ce=new rt(je,qe),Ce.position.set(M[0],.25,M[1])}Ce.userData.modelId=y,E.add(Ce),V.push({id:y,object:Ce,name:ie||`Material_${y}`,type:"material"}),f(`[GameScene] : ${ie}`)},onSetStructure:async(y,M,N)=>{var Oe,Xe;if(f(`[GameScene] : id=${y}, pos=${M}`),V.find(Ue=>Ue.id===y)){f(`[GameScene] ID=${y}`);return}const ie=((Oe=N.structure_base)==null?void 0:Oe.name)||"",ge=El(ie),Te=_i(ge);let Ce=null;try{const Ue=await Mt.loadModel(Te,!0),Ne=new Jt;Ne.add(Ue),Ne.position.set(M[0],0,M[1]),Ne.scale.set(1,1,1),Ne.rotation.y=0;const je=new kt().setFromObject(Ne);Ne.position.y=-je.min.y,Ce=Ne,f(`[GameScene] : ${ie}, URL: ${Te}`)}catch(Ue){f(`[GameScene] : ${ie}`,Ue);const Ne=new Yt(.9,1.2,.9),je=new Gt({color:6710886,metalness:.5,roughness:.6});Ce=new rt(Ne,je),Ce.position.set(M[0],.6,M[1])}Ce.userData.modelId=y,E.add(Ce),V.push({id:y,object:Ce,name:ie||`Structure_${y}`,type:"structure"}),f(`[GameScene] : ${ie}`),N.now_health!==void 0&&((Xe=N.structure_base)!=null&&Xe.health)&&L&&(L.createOrUpdateHealthBar(y,N.now_health,N.structure_base.health),f(`[GameScene] : ${ie} (${N.now_health}/${N.structure_base.health})`))},onPutResourceMarker:y=>{const M=`${y[0]},${y[1]}`;if(Z.has(M)){const je=Z.get(M);E.remove(je),je.traverse(qe=>{qe.geometry&&qe.geometry.dispose(),qe.material&&(Array.isArray(qe.material)?qe.material.forEach(Et=>Et.dispose()):qe.material.dispose())}),Z.delete(M)}const N=new Jt,oe=new Do(.15,.2,.25,8),ie=new Gt({color:16766720,emissive:16755200,emissiveIntensity:.6,metalness:.7,roughness:.3}),ge=new rt(oe,ie);ge.position.y=.125,N.add(ge);const Te=new bd(.08,8,8),Ce=new Gt({color:16776960,emissive:16776960,emissiveIntensity:1}),Oe=new rt(Te,Ce);Oe.position.y=.3,N.add(Oe);const Xe=y[0],Ue=y[1];N.position.set(Xe,.15,Ue);const Ne=new vs(16766720,1.5,3);Ne.position.set(0,.3,0),N.add(Ne),E.add(N),Z.set(M,N)},onClearResourceMarker:y=>{const M=`${y[0]},${y[1]}`;if(Z.has(M)){const N=Z.get(M);E.remove(N),N.traverse(oe=>{oe.geometry&&oe.geometry.dispose(),oe.material&&(Array.isArray(oe.material)?oe.material.forEach(ie=>ie.dispose()):oe.material.dispose())}),Z.delete(M)}},onDisplayCanMove:(y,M)=>{f(`[GameScene] : id=${y}, show=${M}`),ne(y,"move",M),g.value&&g.value.id===y&&(g.value={...g.value,can_move:M},f(`[GameScene] selectedCopper.can_move=${M}`))},onDisplayCanAttack:(y,M)=>{f(`[GameScene] : id=${y}, show=${M}`),ne(y,"attack",M),g.value&&g.value.id===y&&(g.value={...g.value,can_attack:M},f(`[GameScene] selectedCopper.can_attack=${M}`))},onDisplayCanSummon:(y,M)=>{var ge;let N=M,oe=!1,ie=!1;g.value&&g.value.id===y?(oe=((ge=g.value.copper)==null?void 0:ge.copper_type)==="CraftsMan",ie=g.value.can_build===!0):pt.has(y)&&(oe=!0,ie=pt.get(y)),oe&&(N=ie,f(`[GameScene] : id=${y}, can_build=${N}`)),f(`[GameScene] /: id=${y}, show=${N}`),ne(y,"summon",N),g.value&&g.value.id===y&&(g.value={...g.value,can_summon:N},f(`[GameScene] selectedCopper.can_summon=${N}`))},onClearState:y=>{if(f(`[GameScene] : id=${y}`),w.has(y)){const M=w.get(y);M.move&&(E.remove(M.move),M.move.geometry.dispose(),M.move.material.dispose(),delete M.move),M.attack&&(E.remove(M.attack),M.attack.geometry.dispose(),M.attack.material.dispose(),delete M.attack),M.summon&&(E.remove(M.summon),M.summon.geometry.dispose(),M.summon.material.dispose(),delete M.summon),w.delete(y)}},onUpdateHealth:(y,M,N)=>{f(`[GameScene] : id=${y}, hp=${M}/${N}`);const oe=ye.get(y);if(oe!==void 0&&M<oe&&M>0){const ie=V.find(ge=>ge.id===y);if(ie){const ge=ie.type==="copper",Te=ge?h.value:m.value;Te&&(Te.currentTime=0,Te.play().catch(Ce=>{f(`[GameScene]  (${ge?"":""}):`,Ce)}),f(`[GameScene] : ${ge?"":""} (ID=${y})`))}}ye.set(y,M),L&&L.createOrUpdateHealthBar(y,M,N)},onRemoveHealthBar:y=>{f(`[GameScene] : id=${y}`),L&&L.removeHealthBar(y),ye.delete(y)},onPutMapBlock:y=>{const M=`${y[0]},${y[1]}`;if(P.has(M)){const ge=P.get(M);E.remove(ge),ge.geometry.dispose(),ge.material.dispose()}const N=new Yt(.9,.05,.9),oe=new Pt({color:8421504}),ie=new rt(N,oe);ie.position.set(y[0],.025,y[1]),E.add(ie),P.set(M,ie)},animateModelMove:(y,M,N)=>{if(!y||!y.object)return;const oe=y.type==="enemy",ie=oe?c.value:l.value;ie&&(ie.currentTime=0,ie.play().catch(Ue=>{f(`[GameScene]  (${oe?"":""}):`,Ue)})),y.isMoving=!0;const ge=y.object.position.clone(),Te=new Pe(M.x,M.y,M.z),Ce=500,Oe=performance.now();function Xe(){if(!y||!y.object){N&&N();return}const Ue=performance.now()-Oe,Ne=Math.min(Ue/Ce,1),je=1-Math.pow(1-Ne,2);y.object.position.lerpVectors(ge,Te,je),Ne<1?requestAnimationFrame(Xe):(y.object.position.copy(Te),y.isMoving=!1,N&&N())}Xe()},setTestMode:y=>{f(`[GameScene] ${y==="backend"?"":"EventLoop"}`),V.forEach(M=>{M.type==="test"?M.object.visible=y==="backend":(M.type==="copper"||M.type==="enemy")&&(M.object.visible=y==="eventloop")}),f(`[GameScene] ${y==="backend"?"":""}${y==="eventloop"?"":""}EventLoop`)}}),f("[GameScene] ")}function zi(w,P,Z){const ne=new Pe;w.getWorldPosition(ne);const be=window.cameraFocusDistance||8,y=window.cameraFocusHeight||6,M=0,N=be;return{focusPosition:new Pe(ne.x+M,ne.y+y,ne.z+N).clone(),focusTarget:ne.clone(),lerpFactor:.1}}function br(){T.aspect=window.innerWidth/window.innerHeight,T.updateProjectionMatrix(),C.setSize(window.innerWidth,window.innerHeight)}function wr(){if(requestAnimationFrame(wr),Y.w||Y.a||Y.s||Y.d||Y.shift||Y.space){const w=new Pe;Y.w&&(w.z-=1),Y.s&&(w.z+=1),Y.a&&(w.x-=1),Y.d&&(w.x+=1),Y.shift&&(w.y-=1),Y.space&&(w.y+=1),w.applyQuaternion(T.quaternion),w.y=Y.shift?-1:Y.space?1:0,T.position.add(w.multiplyScalar(Rl))}O.focusPosition&&O.focusTarget&&(T.position.lerp(O.focusPosition,O.lerpFactor),T.lookAt(O.focusTarget),He=T.rotation.y,pe=T.rotation.x,T.position.distanceTo(O.focusPosition)<.5&&(f("[GameScene] "),O.focusPosition=null,O.focusTarget=null)),L&&L.updateHealthBarsPosition(V),C.render(E,T)}function Eu(){i("back")}function Sr(w){if(w.target.tagName!=="CANVAS")return;if(ee.x=w.clientX/window.innerWidth*2-1,ee.y=-(w.clientY/window.innerHeight)*2+1,ae.setFromCamera(ee,T),le.value==="moving"||le.value==="attacking"||le.value==="summoning"||le.value==="building"||le.value==="transferring"||le.value==="structureMoving"||le.value==="structureAttacking"||le.value==="structureExtract"||le.value==="structureTransfer"){Wi(ee);return}const P=V.filter(ne=>(ne.type==="copper"||ne.type==="summon"||ne.type==="enemy"||ne.type==="structure")&&ne.object).map(ne=>ne.object),Z=ae.intersectObjects(P,!0);if(Z.length>0){let ne=Z[0].object;for(;ne.parent&&!ne.userData.modelId;)ne=ne.parent;const be=ne.userData.modelId;if(be!==void 0){const y=V.find(oe=>oe.id===be),N={copper:"",summon:"",enemy:"",structure:""}[y==null?void 0:y.type]||"";f(`[GameScene] ${N}ID:`,be),(y==null?void 0:y.type)==="summon"||(y==null?void 0:y.type)==="enemy"?Ds(be,(y==null?void 0:y.type)==="enemy"):(y==null?void 0:y.type)==="structure"?hs(be):ps(be)}}else g.value=null,K.value=null}async function Wi(w){const P=new Vl(new Pe(0,1,0),0),Z=new pa;if(Z.setFromCamera(w,T),le.value==="moving"&&nt.value){f("[GameScene] ");return}const ne=new Pe;if(Z.ray.intersectPlane(P,ne),ne){const be=Math.round(ne.x),y=Math.round(ne.z);f(`[GameScene] : (${be}, ${y})`);const M={moving:"move",attacking:"attack",summoning:"summon",building:"summon",structureMoving:"move",structureAttacking:"attack",structureExtract:"attack",structureTransfer:"attack"}[le.value];if(!Q||!Q.hasIndicatorAt([be,y],M)){f(`[GameScene]  (${be}, ${y}) `);return}le.value==="moving"?await qi(be,y):le.value==="attacking"?await Ki(be,y):le.value==="summoning"?await Xi(be,y):le.value==="building"?await Yi(be,y):le.value==="structureMoving"?await na(be,y):le.value==="structureAttacking"?await sa(be,y):le.value==="structureExtract"?await oa(be,y):le.value==="structureTransfer"&&await ra(be,y)}}async function qi(w,P){if(!g.value)return;if(nt.value){f("[GameScene] ");return}const Z=g.value.isOwnedEnemy===!0,ne=Z?"on_enemy_move_apply":"on_move_apply";f(`[GameScene] : (${w}, ${P}), =${Z?"":""}, =${ne}`);const be=JSON.stringify({type:ne,content:{id:String(g.value.id),position:{x:String(w),y:String(P)}}});nt.value=!0,await Ae(be)}async function Ki(w,P){if(!g.value)return;const Z=g.value.isOwnedEnemy===!0,ne=Z?"on_enemy_attack_apply":"on_attack_apply";f(`[GameScene] : (${w}, ${P}), =${Z?"":""}, =${ne}`);const be=g.value.id,y=V.find(N=>N.id===be);if(y){const N=y.type==="enemy",oe=N?d.value:u.value;oe&&(oe.currentTime=0,oe.play().catch(ie=>{f(`[GameScene]  (${N?"":""}):`,ie)})),fs&&fs(be,[w,P])}const M=JSON.stringify({type:ne,content:{id:String(g.value.id),position:{x:String(w),y:String(P)}}});await Ae(M)}async function Xi(w,P){if(!g.value)return;f(`[GameScene] : (${w}, ${P})`),B.value=[w,P];const Z=JSON.stringify({type:"on_get_summon_menu"});await Ae(Z),await new Promise(ne=>setTimeout(ne,100)),X.value=!0}async function Yi(w,P){if(!g.value||!re.value)return;f(`[GameScene]  ${re.value} : (${w}, ${P})`);const Z=g.value.id,ne=JSON.stringify({type:"on_structure_build_apply",content:{id:String(Z),position:{x:String(w),y:String(P)},name:re.value}});await Ae(ne),le.value=null,re.value=null,k.value&&k.value.cancelAction(),await new Promise(be=>setTimeout(be,100)),f("[GameScene] "),await ps(Z)}async function xu(w){if(!g.value||!B.value)return;const[P,Z]=B.value;f(`[GameScene]  ${w} : (${P}, ${Z})`);try{const ne=JSON.stringify({type:"on_summon_apply",content:{id:String(g.value.id),position:{x:String(P),y:String(Z)},name:w}});await Ae(ne)}catch(ne){f("[GameScene] :",ne)}finally{X.value=!1,le.value=null,B.value=null,k.value&&k.value.cancelAction();try{const ne=JSON.stringify({type:"on_summon_end"});await Ae(ne)}catch(ne){f("[GameScene] :",ne)}}}function Au(){X.value=!1,B.value=null,le.value=null;const w=JSON.stringify({type:"on_summon_end"});Ae(w).catch(P=>{f("[GameScene] ",P)})}function Ji(){if(f("[GameScene] "),le.value==="structureMoving"){const w=JSON.stringify({type:"on_structure_move_end"});Ae(w).catch(P=>{f("[GameScene] ",P)})}else if(le.value==="structureAttacking"){const w=JSON.stringify({type:"on_structure_attack_end"});Ae(w).catch(P=>{f("[GameScene] ",P)})}else if(le.value==="structureExtract"){const w=JSON.stringify({type:"on_structure_extract_end"});Ae(w).catch(P=>{f("[GameScene] ",P)})}else if(le.value==="structureTransfer"){const w=JSON.stringify({type:"on_structure_transfer_end"});Ae(w).catch(P=>{f("[GameScene] ",P)})}le.value=null}function ku(){Ji(),K.value=null,J.value=null,f("[GameScene] ")}async function Ru(w){if(!K.value)return;const P=K.value.id;switch(f(`[GameScene] : ${w.type}, ID=${P}`),w.type){case"move":await Zi(P);break;case"attack":await Qi(P);break;case"transfer":await ta(P);break;case"extract":await ea(P);break;default:f("[GameScene] :",w.type)}}async function Zi(w){f(`[GameScene]  ${w} `);const P=JSON.stringify({type:"on_structure_move_start",content:{id:String(w)}});await Ae(P),le.value="structureMoving"}async function Qi(w){f(`[GameScene]  ${w} `);const P=JSON.stringify({type:"on_structure_attack_start",content:{id:String(w)}});await Ae(P),le.value="structureAttacking"}async function ea(w){f(`[GameScene]  ${w} `);const P=JSON.stringify({type:"on_structure_extract_start",content:{id:String(w)}});await Ae(P),le.value="structureExtract"}async function ta(w){f(`[GameScene]  ${w} `);const P=JSON.stringify({type:"on_structure_transfer_start",content:{id:String(w)}});await Ae(P),le.value="structureTransfer"}async function na(w,P){if(!K.value)return;f(`[GameScene]  ${K.value.id}  (${w}, ${P})`);const Z=JSON.stringify({type:"on_structure_move_apply",content:{id:String(K.value.id),position:{x:String(w),y:String(P)}}});await Ae(Z),le.value=null}async function sa(w,P){if(!K.value)return;f(`[GameScene]  ${K.value.id}  (${w}, ${P})`);const Z=JSON.stringify({type:"on_structure_attack_apply",content:{id:String(K.value.id),position:{x:String(w),y:String(P)}}});await Ae(Z),le.value=null}async function oa(w,P){if(!K.value)return;f(`[GameScene]  ${K.value.id}  (${w}, ${P}) `);const Z=K.value.id,ne=JSON.stringify({type:"on_structure_extract_apply",content:{id:String(Z),position:{x:String(w),y:String(P)}}});await Ae(ne),f("[GameScene] ");const be=JSON.stringify({type:"on_structure_extract_end"});await Ae(be),await new Promise(y=>setTimeout(y,100)),f("[GameScene] "),le.value=null,setTimeout(async()=>{f("[GameScene] "),await hs(Z)},300)}async function ra(w,P){if(!K.value)return;f(`[GameScene]  ${K.value.id}  (${w}, ${P}) `);const Z=K.value.id,ne=JSON.stringify({type:"on_structure_transfer_apply",content:{id:String(Z),position:{x:String(w),y:String(P)}}});await Ae(ne),f("[GameScene] ");const be=JSON.stringify({type:"on_structure_transfer_end"});await Ae(be),await new Promise(y=>setTimeout(y,100)),f("[GameScene] "),le.value=null,setTimeout(async()=>{f("[GameScene] "),await hs(Z)},300)}async function ps(w){const P=fe.value.findIndex(ne=>ne.id===w);P!==-1&&(_e.value=P),K.value=null;const Z=JSON.stringify({type:"on_click_copper",content:{id:String(w)}});await Ae(Z)}async function hs(w){f(`[GameScene] : ID=${w}`),g.value=null;const P=JSON.stringify({type:"on_click_structure",content:{id:String(w)}});await Ae(P)}async function Ds(w,P=!1){if(P)_e.value=-1,Mr();else{const ne=fe.value.findIndex(be=>be.id===w);ne!==-1&&(_e.value=ne)}K.value=null;const Z=JSON.stringify({type:"on_click_enemy",content:{id:String(w)}});await Ae(Z)}function Mr(){g.value=null,b.value=[],le.value=null}async function Pu(w){if(f("[GameScene] :",w),w.type==="moveStart")le.value="moving";else if(w.type==="attackStart")le.value="attacking";else if(w.type==="summonStart")le.value="summoning";else if(w.type==="buildRequest"){f("[GameScene] ");const P=JSON.stringify({type:"on_get_structure_menu"});await Ae(P)}else if(w.type==="buildStart")le.value="building",re.value=w.structureName||null;else if(w.type==="transferring"||w.type==="transferStart")le.value="transferring",j.value=[],G.value=[];else if(w.type==="transferComplete")le.value=null,j.value=[],G.value=[];else if(w.type==="cancel"){const P=le.value;if(P==="moving"){const Z=JSON.stringify({type:"on_move_end"});Ae(Z).catch(ne=>{f("[GameScene] ",ne)})}else if(P==="attacking"){const Z=JSON.stringify({type:"on_attack_end"});Ae(Z).catch(ne=>{f("[GameScene] ",ne)})}else if(P==="transferring"){const Z=JSON.stringify({type:"on_transfer_end"});Ae(Z).catch(ne=>{f("[GameScene] ",ne)}),j.value=[],G.value=[]}else if(P==="summoning"){const Z=JSON.stringify({type:"on_summon_end"});Ae(Z).catch(ne=>{f("[GameScene] ",ne)}),X.value=!1}else if(P==="building"){const Z=JSON.stringify({type:"on_structure_build_end"});Ae(Z).catch(ne=>{f("[GameScene] ",ne)}),re.value=null,B.value=null}le.value=null}else w.type==="wait"&&(f("[GameScene] "),Cr())}function Tr(){if(fe.value.length!==0){if(g.value){const w=g.value.can_move,P=g.value.can_attack,Z=g.value.can_summon;if(f(`[GameScene] : ID=${g.value.id}, can_move=${w}, can_attack=${P}, can_summon=${Z}, hasAttackTargets=${z.value}`),w||P&&z.value||Z){f("[GameScene] ");return}}f("[GameScene] "),Cr()}}async function Cr(){var Z,ne,be;if(fe.value.length===0)return;g.value=null,le.value=null,_e.value;let w=0;const P=fe.value.length;for(;w<P;){_e.value=(_e.value+1)%fe.value.length;const y=fe.value[_e.value];f(`[GameScene] : ${y.name||y.id} ( ${w+1}/${P})`),await new Promise(ge=>{setTimeout(async()=>{const Te=V.find(Oe=>Oe.id===y.id);(Te==null?void 0:Te.type)==="summon"?await Ds(y.id,!1):await ps(y.id),ge()},300)}),await new Promise(ge=>setTimeout(ge,200));const M=((Z=g.value)==null?void 0:Z.can_move)||!1,N=((ne=g.value)==null?void 0:ne.can_attack)||!1,oe=((be=g.value)==null?void 0:be.can_summon)||!1,ie=M||N&&z.value||oe;if(f(`[GameScene]  ${y.name}: can_move=${M}, can_attack=${N}, can_summon=${oe}, hasTargets=${z.value}, valid=${ie}`),g.value&&ie){f(`[GameScene] : ${y.name||y.id}`);return}w++}f("[GameScene] "),g.value=null,n.isGameMode&&f('[GameScene] ""')}function Iu(){he.value++,_e.value=-1,g.value=null,le.value=null,fe.value.forEach(P=>P.turnDone=!1),f(`[GameScene]  ${he.value}`);const w=V.filter(P=>P.type==="enemy"&&!P.isOwned);if(f(`[GameScene]  ${w.length} `),w.length===0)f("[GameScene] "),ke.value=!1;else{ke.value=!0,Ze.value.clear(),f("[GameScene] ");let P=setTimeout(()=>{ke.value&&Ze.value.size>0&&(f("[GameScene] "),ke.value=!1,Ze.value.clear())},3e3),Z=setInterval(()=>{ke.value||(clearTimeout(P),clearInterval(Z))},100);setTimeout(()=>{ke.value&&Ze.value.size===0&&(f("[GameScene] "),ke.value=!1,clearTimeout(P),clearInterval(Z))},1e3)}}async function Ou(){f("[GameScene] "),wt.value=!1;const w=JSON.stringify({type:"on_game_over"});await Ae(w).catch(P=>{f("[GameScene]  on_game_over ",P)}),i("back")}async function Lu(){f("[GameScene] game over"),Ft.value=!1;const w=JSON.stringify({type:"on_game_over"});await Ae(w).catch(P=>{f("[GameScene]  on_game_over ",P)}),ia()}function ia(){f("[GameScene] "),an.value=!0,setTimeout(()=>{f("[GameScene] "),an.value=!1,i("back")},5e3)}function Du(){f("[GameScene] "),an.value=!1,i("back")}function Nu(){f("[GameScene] "),ot.value=!0}function $u(){f("[GameScene] "),ot.value=!1}async function Gu(){f("[GameScene]  game_over "),ot.value=!1;const w=JSON.stringify({type:"on_game_over"});await Ae(w).catch(P=>{f("[GameScene]  on_game_over ",P)}),i("back")}const aa={props:n,container:o,emit:i,audioRef:r,musicUrl:a,moveSoundRef:l,moveEnemySoundRef:c,attackSoundRef:u,attackEnemySoundRef:d,meHurtSoundRef:h,enemyHurtSoundRef:m,moveSoundUrl:_,moveEnemySoundUrl:v,attackSoundUrl:S,attackEnemySoundUrl:x,meHurtSoundUrl:I,enemyHurtSoundUrl:R,get scene(){return E},set scene(w){E=w},get camera(){return T},set camera(w){T=w},get renderer(){return C},set renderer(w){C=w},get controls(){return F},set controls(w){F=w},get models(){return V},set models(w){V=w},get focusState(){return O},set focusState(w){O=w},get raycaster(){return ae},set raycaster(w){ae=w},get mouse(){return ee},set mouse(w){ee=w},get gltfLoader(){return q},set gltfLoader(w){q=w},get healthBarsManager(){return L},set healthBarsManager(w){L=w},get indicatorsManager(){return Q},set indicatorsManager(w){Q=w},get effectsManager(){return we},set effectsManager(w){we=w},previousHealth:ye,keys:Y,moveSpeed:Rl,rotationSpeed:NS,controlMode:ve,mouseSensitivity:Ge,handleKeyDown:ue,handleKeyUp:A,get isMouseDown(){return de},set isMouseDown(w){de=w},get lastMouseX(){return $},set lastMouseX(w){$=w},get lastMouseY(){return ce},set lastMouseY(w){ce=w},get pitch(){return pe},set pitch(w){pe=w},get yaw(){return He},set yaw(w){He=w},get isPointerLocked(){return De},set isPointerLocked(w){De=w},handleMouseDown:Ke,handleMouseUp:Ve,handleMouseMove:st,handlePointerLockChange:at,handlePointerLockError:Lt,selectedCopper:g,selectedCopperResources:b,copperActionPanelRef:k,hasAttackTargets:z,transferTargetPositions:j,transferTargets:G,selectedStructure:K,selectedStructureData:J,showSummonModal:X,summonPosition:B,enemyList:me,currentBuildingName:re,currentRound:he,playerCoppers:fe,currentCopperIndex:_e,currentActionMode:le,isEnemyMoving:ke,pendingEnemyMoves:Ze,isMoveLocked:nt,copperCanBuildMap:pt,showGameOverDialog:wt,showGameSuccessDialog:Ft,showCredits:an,showWithdrawDialog:ot,currentCopperId:jt,initScene:Os,createTestUnits:Ls,loadGLTFModel:Fi,loadModelFromUrl:ji,loadEnemyModel:Bi,get createAttackEffectFunc(){return fs},set createAttackEffectFunc(w){fs=w},setupMessageQueue:Vi,focusOnModelFunc:zi,onWindowResize:br,animate:wr,goBack:Eu,onSceneClick:Sr,handleFloorClick:Wi,handleMoveApply:qi,handleAttackApply:Ki,handleSummonApply:Xi,handleBuildApply:Yi,handleSummonConfirm:xu,handleCloseSummonModal:Au,handleStructurePanelCancel:Ji,closeStructurePanel:ku,handleStructureAction:Ru,handleStructureMoveStart:Zi,handleStructureAttackStart:Qi,handleStructureExtractStart:ea,handleStructureTransferStart:ta,handleStructureMoveApply:na,handleStructureAttackApply:sa,handleStructureExtractApply:oa,handleStructureTransferApply:ra,handleClickCopper:ps,handleClickStructure:hs,handleClickEnemy:Ds,closeCopperPanel:Mr,handleCopperAction:Pu,tryNextCopper:Tr,nextCopper:Cr,endRound:Iu,handleGameOverConfirm:Ou,handleGameSuccessConfirm:Lu,showCreditsScreen:ia,skipCredits:Du,openWithdrawDialog:Nu,cancelWithdraw:$u,confirmWithdraw:Gu,panel7Src:Pl,panel8Src:Il,get log(){return f},ref:U,computed:Ee,onMounted:et,onBeforeUnmount:_t,watch:lt,get THREE(){return ar},get GLTFLoader(){return us},get DRACOLoader(){return ds},get messageQueue(){return Re},get eventloop(){return Ae},get getAssetUrl(){return H},get getCopperModelUrl(){return io},get getEnemyModelUrl(){return ao},get getStructureModelUrl(){return _i},get getMaterialModelUrl(){return al},get modelCache(){return Mt},get getCopperEnglishName(){return Tl},get getCopperTypeFolder(){return Cl},get getStructureEnglishName(){return El},get getSetting(){return zr},get onEvent(){return Bn},get offEvent(){return cs},get emitEvent(){return An},get EventTypes(){return vt},get useHealthBars(){return xl},get useIndicators(){return Al},get useEffects(){return kl},ActionPanel:Pb,TurnSystem:Kb,SummonModal:Cw,StructurePanel:Yw,ResourcePanel:DS};return Object.defineProperty(aa,"__isScriptSetup",{enumerable:!1,value:!0}),aa}},GS={class:"game-scene"},HS={ref:"container",class:"scene-container"},US={key:6,class:"info-panel"},FS={key:7,class:"game-over-overlay"},jS={key:8,class:"game-over-overlay"},BS={key:9,class:"credits-overlay"},VS={key:10,class:"game-over-overlay"},zS=["src"],WS=["src"],qS=["src"],KS=["src"],XS=["src"],YS=["src"],JS=["src"];function ZS(t,e,s,n,o,i){var r,a,l,c;return D(),W("div",GS,[p("div",HS,null,512),s.isGameMode?(D(),Ht(n.TurnSystem,{key:0,currentCopperId:n.currentCopperId,copperList:n.playerCoppers,roundNumber:n.currentRound,isEnemyMoving:n.isEnemyMoving,onNextCopper:n.nextCopper,onEndRound:n.endRound,onSelectCopper:n.handleClickCopper},null,8,["currentCopperId","copperList","roundNumber","isEnemyMoving"])):Me("",!0),s.isGameMode?(D(),W("button",{key:1,class:"withdraw-button",onClick:n.openWithdrawDialog},"  ")):Me("",!0),s.isGameMode?(D(),Ht(n.ResourcePanel,{key:2})):Me("",!0),s.isGameMode&&n.selectedCopper?(D(),Ht(n.ActionPanel,{key:3,ref:"copperActionPanelRef",copper:n.selectedCopper,resources:n.selectedCopperResources,hasAttackTargets:n.hasAttackTargets,transferTargets:n.transferTargets,onSelectCopper:n.handleClickCopper,onClose:n.closeCopperPanel,onAction:n.handleCopperAction},null,8,["copper","resources","hasAttackTargets","transferTargets"])):Me("",!0),s.isGameMode?(D(),Ht(n.SummonModal,{key:4,visible:n.showSummonModal,"copper-name":((l=(a=(r=n.selectedCopper)==null?void 0:r.copper)==null?void 0:a.copper_info)==null?void 0:l.name)||"","enemy-list":n.enemyList,position:n.summonPosition,onClose:n.handleCloseSummonModal,onSummon:n.handleSummonConfirm},null,8,["visible","copper-name","enemy-list","position"])):Me("",!0),s.isGameMode&&n.selectedStructure?(D(),Ht(n.StructurePanel,{key:5,structure:n.selectedStructure,resources:((c=n.selectedStructureData)==null?void 0:c.resources)||[],"action-mode":n.currentActionMode==="structureMoving"?"move":n.currentActionMode==="structureAttacking"?"attack":n.currentActionMode==="structureExtract"?"extract":n.currentActionMode==="structureTransfer"?"transfer":null,onClose:n.closeStructurePanel,onAction:n.handleStructureAction,onCancel:n.handleStructurePanelCancel},null,8,["structure","resources","action-mode"])):Me("",!0),s.isGameMode?Me("",!0):(D(),W("div",US,[...e[0]||(e[0]=[Yo('<h3 data-v-76eb1444>3D</h3><p style="color:#ffd700;font-weight:600;" data-v-76eb1444> </p><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-76eb1444><p style="font-weight:600;" data-v-76eb1444> </p><p style="font-size:12px;" data-v-76eb1444>  = ID:1</p><p style="font-size:12px;" data-v-76eb1444>  = ID:2</p></div><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-76eb1444><p style="font-weight:600;" data-v-76eb1444> EventLoop</p><p style="font-size:12px;" data-v-76eb1444>1.   EventLoop</p><p style="font-size:12px;" data-v-76eb1444>2. &quot; &quot;</p><p style="font-size:12px;" data-v-76eb1444>3. 3</p><p style="font-size:11px;" data-v-76eb1444>  =IronWall  =Arcanist  =CraftsMan </p></div>',4)])])),n.showGameOverDialog?(D(),W("div",FS,[p("div",{class:"game-over-dialog"},[e[1]||(e[1]=p("h2",{class:"game-over-title"},"",-1)),e[2]||(e[2]=p("p",{class:"game-over-message"},"",-1)),p("button",{class:"game-over-button",onClick:n.handleGameOverConfirm},"  ")])])):Me("",!0),n.showGameSuccessDialog?(D(),W("div",jS,[p("div",{class:"game-over-dialog success-dialog"},[e[3]||(e[3]=p("h2",{class:"success-title"},"  ",-1)),e[4]||(e[4]=p("p",{class:"game-over-message"},"",-1)),p("button",{class:"game-over-button success-button",onClick:n.handleGameSuccessConfirm},"  ")])])):Me("",!0),n.showCredits?(D(),W("div",BS,[p("div",{class:"credits-container"},[e[5]||(e[5]=Yo('<h1 class="credits-title" data-v-76eb1444></h1><div class="credits-content" data-v-76eb1444><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>MGPIC Team</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>Backend Developer</p><p data-v-76eb1444>Frontend Developer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>3D Artist</p><p data-v-76eb1444>UI Designer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444>Sound Designer</p></div><div class="credits-section" data-v-76eb1444><h2 data-v-76eb1444></h2><p data-v-76eb1444></p></div></div>',2)),p("button",{class:"skip-credits-button",onClick:n.skipCredits},"")])])):Me("",!0),n.showWithdrawDialog?(D(),W("div",VS,[p("div",{class:"game-over-dialog"},[e[6]||(e[6]=p("h2",{class:"withdraw-title"},"",-1)),e[7]||(e[7]=p("p",{class:"game-over-message"},[jn(""),p("br"),jn("")],-1)),p("div",{class:"dialog-buttons"},[p("button",{class:"dialog-button cancel-button",onClick:n.cancelWithdraw},"  "),p("button",{class:"dialog-button confirm-button",onClick:n.confirmWithdraw},"  ")])])])):Me("",!0),p("audio",{ref:"audioRef",src:n.musicUrl,loop:"",preload:"auto"},null,8,zS),p("audio",{ref:"moveSoundRef",src:n.moveSoundUrl,preload:"auto"},null,8,WS),p("audio",{ref:"moveEnemySoundRef",src:n.moveEnemySoundUrl,preload:"auto"},null,8,qS),p("audio",{ref:"attackSoundRef",src:n.attackSoundUrl,preload:"auto"},null,8,KS),p("audio",{ref:"attackEnemySoundRef",src:n.attackEnemySoundUrl,preload:"auto"},null,8,XS),p("audio",{ref:"meHurtSoundRef",src:n.meHurtSoundUrl,preload:"auto"},null,8,YS),p("audio",{ref:"enemyHurtSoundRef",src:n.enemyHurtSoundUrl,preload:"auto"},null,8,JS)])}const QS=yt($S,[["render",ZS],["__scopeId","data-v-76eb1444"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/vue/GameScene.vue"]]),e0={__name:"App",setup(t,{expose:e}){e();const s=U(!1),n=U(null),o=U(!1),i=U(null),r=U([]),a=U(0),l=U(!0),c=U(!1),u=U("touchpad"),d=U(!1);let h=null;function m(){const Q=!s.value;s.value=Q,Q?window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__():window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}function _(Q){n.value!==Q&&(r.value.push(n.value),n.value=Q),window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__(),s.value=!0}function v(){l.value=!1,h&&clearTimeout(h),h=setTimeout(()=>{l.value||(f("[App] StartMenu"),d.value=!0)},5*60*1e3)}function S(){n.value=null,r.value=[],window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),s.value=!1}function x(Q){f("[App] ID:",Q.ids),S(),c.value=!0,f("[App] ")}function I(){c.value=!1}function R(){const Q=Ps();u.value=Q.controlMode,o.value=!0,s.value=!0}function E(){o.value=!1,n.value||(window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),s.value=!1)}function T(Q){u.value=Q,sr("controlMode",Q),window.updateControlMode&&window.updateControlMode(Q),f(`[App] : ${Q}`)}function C(){if(o.value){E();return}if(n.value){if(n.value==="warehouse"&&i.value&&i.value.handleBack&&i.value.handleBack())return;const Q=r.value.pop()??null;n.value=Q,Q||(s.value=!1);return}if(!l.value){h&&(clearTimeout(h),h=null),d.value&&(d.value=!1,f("[App] StartMenu")),l.value=!0,setTimeout(()=>{window.__INIT_THREE_SCENE__?window.__INIT_THREE_SCENE__().then(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}).catch(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}):window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()},100),s.value=!1;return}}const F=U(!0),V=U(null);function O(){F.value=!F.value,f("[App] :",F.value?"":"")}async function ae(){try{f("[App] ...");const Q=await hl();if(Q.type==="error"){f("[App] :",Q.content),alert(": "+Q.content);return}f("[App] ...");const we=new Blob([JSON.stringify(Q,null,2)],{type:"application/json"}),ye=document.createElement("a");ye.href=URL.createObjectURL(we);const Y=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);ye.download=`mgpic-save-${Y}.json`,ye.click(),URL.revokeObjectURL(ye.href),f("[App] ")}catch(Q){f("[App] :",Q),alert("")}}function ee(){try{V.value&&V.value.click()}catch{}}async function q(Q){try{const we=Q.target&&Q.target.files&&Q.target.files[0];if(!we)return;f("[App] ...");const ye=new FileReader;ye.onload=async()=>{try{const Y=String(ye.result||"{}"),ve=JSON.parse(Y);f("[App] ..."),await pl(Y),f("[App] "),alert("")}catch(Y){f("[App] :",Y),alert(": "+Y.message)}Q.target.value=""},ye.onerror=()=>{f("[App] "),alert(""),Q.target.value=""},ye.readAsText(we)}catch(we){f("[App] :",we),alert("")}}et(()=>{nr(Q=>{})}),_t(()=>{h&&(clearTimeout(h),h=null)});const L={isPaused:s,overlay:n,showSettingsOverlay:o,warehouseRef:i,overlayHistory:r,currentPuppetIndex:a,showStartMenu:l,showGameScene:c,controlMode:u,destroyStartMenu:d,get startMenuDestroyTimer(){return h},set startMenuDestroyTimer(Q){h=Q},togglePause:m,openOverlay:_,onStartMenuStarted:v,closeOverlay:S,handleGameStart:x,closeGameScene:I,openSettings:R,closeSettings:E,setControlMode:T,goBack:C,musicOn:F,fileInput:V,onToggleMusic:O,onDownloadSave:ae,onUploadSave:ee,onFileChange:q,get log(){return f},ref:U,onMounted:et,onBeforeUnmount:_t,nextTick:hn,Hall:zh,Warehouse:p_,TopLeftPanel:w_,StartMenu:G_,StartGame:Cy,GameScene:QS,get getAssetUrl(){return H},get getSettings(){return Ps},get updateSetting(){return sr},get info_subscribe(){return nr},get export_save(){return hl},get import_save(){return pl}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}},t0={class:"stage"},n0={key:0,style:{position:"relative",width:"100%",height:"100%"}},s0={key:2,class:"modal"},o0={class:"modal-title"},r0={key:2,class:"overlay",style:{"z-index":"30000","align-items":"flex-start","justify-content":"flex-start",background:"rgba(0, 0, 0, 0.25)"}},i0={class:"settings"},a0={class:"settings__header"},l0=["src"],c0={class:"settings__content"},u0={class:"settings__section"},d0={class:"settings__control-options"};function f0(t,e,s,n,o,i){return D(),W("div",t0,[n.showGameScene?(D(),Ht(n.GameScene,{key:0,isGameMode:!0,"music-on":n.musicOn,onBack:n.closeGameScene},null,8,["music-on"])):Me("",!0),n.showGameScene?Me("",!0):(D(),W(Je,{key:1},[n.destroyStartMenu?Me("",!0):xc((D(),Ht(n.StartMenu,{key:0,visible:n.showStartMenu,onStarted:n.onStartMenuStarted},null,8,["visible"])),[[mu,n.showStartMenu]]),n.showStartMenu?Me("",!0):(D(),Ht(n.TopLeftPanel,{key:1,"music-on":n.musicOn,onBack:n.goBack,onOpenSettings:n.openSettings,onToggleMusic:n.onToggleMusic},null,8,["music-on"])),it(n.Hall,{"music-on":n.musicOn,paused:n.overlay==="start"||n.overlay==="warehouse"||n.showGameScene,onStartGame:e[0]||(e[0]=r=>n.openOverlay("start")),onOpenWarehouse:e[1]||(e[1]=r=>n.openOverlay("warehouse")),onOpenTutorial:e[2]||(e[2]=r=>n.openOverlay("tutorial")),onOpenEncyclopedia:e[3]||(e[3]=r=>n.openOverlay("encyclopedia")),onToggleMusic:n.onToggleMusic},null,8,["music-on","paused"]),n.overlay?(D(),W("div",{key:2,class:Qe(["overlay",{"overlay--warehouse":n.overlay==="warehouse"}])},[n.overlay==="warehouse"?(D(),W("div",n0,[it(n.TopLeftPanel,{"music-on":n.musicOn,onBack:n.goBack,onOpenSettings:n.openSettings,onToggleMusic:n.onToggleMusic},null,8,["music-on"]),it(n.Warehouse,{ref:"warehouseRef","music-on":n.musicOn},null,8,["music-on"])])):n.overlay==="start"?(D(),Ht(n.StartGame,{key:1,"music-on":n.musicOn,paused:n.showGameScene,onClose:n.closeOverlay,onConfirm:n.handleGameStart},null,8,["music-on","paused"])):(D(),W("div",s0,[p("h2",o0,se(n.overlay==="warehouse"?"  Copper Warehouse":n.overlay==="tutorial"?"  Tutorial":n.overlay==="encyclopedia"?"  Game Encyclopedia":"  Start Game"),1),e[6]||(e[6]=p("p",{class:"modal-body"},"",-1)),p("button",{class:"close-btn",onClick:n.closeOverlay},"")]))],2)):Me("",!0)],64)),n.showSettingsOverlay?(D(),W("div",r0,[p("div",i0,[p("div",a0,[e[7]||(e[7]=p("div",{class:"settings__title"},"",-1)),p("button",{class:"settings__close",onClick:n.closeSettings,"aria-label":""},[p("img",{src:n.getAssetUrl("@assets/ui/close.png"),alt:""},null,8,l0)])]),p("div",c0,[p("div",u0,[e[10]||(e[10]=p("div",{class:"settings__section-title"},"",-1)),p("div",d0,[p("button",{class:Qe(["settings__control-btn",{active:n.controlMode==="touchpad"}]),onClick:e[4]||(e[4]=r=>n.setControlMode("touchpad"))},[...e[8]||(e[8]=[p("span",{class:"control-title"},"",-1),p("span",{class:"control-desc"},"",-1)])],2),p("button",{class:Qe(["settings__control-btn",{active:n.controlMode==="mouse"}]),onClick:e[5]||(e[5]=r=>n.setControlMode("mouse"))},[...e[9]||(e[9]=[p("span",{class:"control-title"},"",-1),p("span",{class:"control-desc"},"",-1)])],2)])]),p("button",{class:"settings__item",onClick:n.onDownloadSave},[...e[11]||(e[11]=[Yo('<span class="settings__icon" data-v-7a7a37b1><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7a7a37b1><path d="M12 3v12m0 0l-4-4m4 4l4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-7a7a37b1></path><path d="M4 19h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-7a7a37b1></path></svg></span><span class="settings__label" data-v-7a7a37b1></span>',2)])]),p("button",{class:"settings__item",onClick:n.onUploadSave},[...e[12]||(e[12]=[Yo('<span class="settings__icon" data-v-7a7a37b1><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7a7a37b1><path d="M12 21V9m0 0l4 4m-4-4L8 13" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-7a7a37b1></path><path d="M4 5h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-7a7a37b1></path></svg></span><span class="settings__label" data-v-7a7a37b1></span>',2)])]),p("input",{ref:"fileInput",type:"file",accept:".json",onChange:n.onFileChange,style:{display:"none"}},null,544)])])])):Me("",!0)])}const Ol=yt(e0,[["render",f0],["__scopeId","data-v-7a7a37b1"],["__file","C:/Individuation/GitHubProject/MGPIC-2025/src/App.vue"]]);function p0(){const t=navigator.userAgent;return/Safari/.test(t)&&!/Chrome/.test(t)&&!/Chromium/.test(t)}function h0(){const t=document.getElementById("safari-warning"),e=document.getElementById("loading-screen");t.style.display="flex",e.style.display="none",document.getElementById("continue-safari").addEventListener("click",()=>{t.style.display="none",e.style.display="flex",Cu()}),document.getElementById("download-chrome").addEventListener("click",()=>{window.open("https://www.google.com/chrome/","_blank")})}function qr(t,e,s,n=""){const o=document.getElementById("progress-bar"),i=document.getElementById("progress-text"),r=document.querySelector(".loading-subtitle");o&&(o.style.width=s+"%"),i&&(t===0&&e===0?i.textContent=`${s}%`:i.textContent=`${t} / ${e} (${s}%)`),r&&n&&(r.textContent=n)}function Ll(){const t=document.getElementById("loading-screen");t&&(t.classList.add("fade-out"),setTimeout(()=>{t.style.display="none"},500))}async function Cu(){try{f("..."),await er(qr,["high"]),f(""),qr(0,100,100,"..."),ol(Ol).mount("#app"),await new Promise(e=>setTimeout(e,200)),window.__INIT_THREE_SCENE__&&await window.__INIT_THREE_SCENE__((e,s,n)=>{qr(0,0,n,`3D... ${n}%`)}),f(""),setTimeout(()=>{Ll()},300),setTimeout(async()=>{try{f("..."),await er(null,["medium"]),f("")}catch(e){f(":",e)}},1e3)}catch(t){f(":",t),ol(Ol).mount("#app"),Ll()}}p0()?(f("Safari"),h0()):(f("Safari"),Cu());
